var __awaiter=this&&this.__awaiter||function(t,e,o,n){function s(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,l){function a(t){try{r(n.next(t))}catch(e){l(e)}}function i(t){try{r(n["throw"](t))}catch(e){l(e)}}function r(t){t.done?o(t.value):s(t.value).then(a,i)}r((n=n.apply(t,e||[])).next())}))};var __generator=this&&this.__generator||function(t,e){var o={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},n,s,l,a;return a={next:i(0),throw:i(1),return:i(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function i(t){return function(e){return r([t,e])}}function r(a){if(n)throw new TypeError("Generator is already executing.");while(o)try{if(n=1,s&&(l=a[0]&2?s["return"]:a[0]?s["throw"]||((l=s["return"])&&l.call(s),0):s.next)&&!(l=l.call(s,a[1])).done)return l;if(s=0,l)a=[a[0]&2,l.value];switch(a[0]){case 0:case 1:l=a;break;case 4:o.label++;return{value:a[1],done:false};case 5:o.label++;s=a[1];a=[0];continue;case 7:a=o.ops.pop();o.trys.pop();continue;default:if(!(l=o.trys,l=l.length>0&&l[l.length-1])&&(a[0]===6||a[0]===2)){o=0;continue}if(a[0]===3&&(!l||a[1]>l[0]&&a[1]<l[3])){o.label=a[1];break}if(a[0]===6&&o.label<l[1]){o.label=l[1];l=a;break}if(l&&o.label<l[2]){o.label=l[2];o.ops.push(a);break}if(l[2])o.ops.pop();o.trys.pop();continue}a=e.call(t,o)}catch(i){a=[6,i];s=0}finally{n=l=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};System.register(["./p-7243f468.system.js","./p-eed37127.system.js","./p-46752feb.system.js","./p-b0bfb44c.system.js","./p-86e59901.system.js"],(function(t){"use strict";var e,o,n,s,l,a,i,r,c,u,f;return{setters:[function(t){e=t.r;o=t.c;n=t.h;s=t.g},function(){},function(t){l=t.a},function(t){a=t.o;i=t.b},function(t){r=t.i;c=t.a;u=t.b;f=t.c}],execute:function(){function d(t,e){var o=-1,n=t==null?0:t.length;while(++o<n){if(e(t[o],o,t)===false){break}}return t}var h=d;var g=a(Object.keys,Object);var B=g;var y=Object.prototype;var p=y.hasOwnProperty;function k(t){if(!r(t)){return B(t)}var e=[];for(var o in Object(t)){if(p.call(t,o)&&o!="constructor"){e.push(o)}}return e}var v=k;function C(t){return c(t)?u(t):v(t)}var w=C;function m(t,e){return t&&i(t,e,w)}var b=m;function _(t,e){return function(o,n){if(o==null){return o}if(!c(o)){return t(o,n)}var s=o.length,l=e?s:-1,a=Object(o);while(e?l--:++l<s){if(n(a[l],l,a)===false){break}}return o}}var S=_;var T=S(b);var M=T;function x(t){return typeof t=="function"?t:f}var I=x;function j(t,e){var o=l(t)?h:M;return o(t,I(e))}var D=j;var E=t("nb_mechtool_group",function(){function t(t){e(this,t);this.isPlay=true;this.keycode="";this.drawTShow=false;this.toolTShow=false;this.updateui=0;this.firstMecBtnArr=[];this.drawBlocks=[{active:false,default:"rectBtn",type:"rect",name:"绘制",lan_key:"canvas.mec_tool.rect",key:"R"},{active:false,default:"circleBtn",type:"circle",name:"圆",lan_key:"canvas.mec_tool.circle",key:"C"},{active:false,default:"ropeBtn",type:"rope",name:"绳子",lan_key:"canvas.mec_tool.rope",key:"O"},{active:false,default:"gearBtn",type:"gear",name:"齿轮",lan_key:"canvas.mec_tool.gear",key:"G"},{active:false,default:"polyBtn",type:"poly",name:"钢笔",lan_key:"canvas.mec_tool.poly",key:"L"}];this.toolBlocks=[{active:false,default:"fixBtn",type:"fixed",name:"固定",lan_key:"canvas.mec_tool.fixed",key:"F"},{active:false,default:"bearBtn",type:"bearing",name:"轴承",lan_key:"canvas.mec_tool.bearing",key:"B"},{active:false,default:"springBtn",type:"spring",name:"弹簧",lan_key:"canvas.mec_tool.spring",key:"P"},{active:false,default:"thrusBtn",type:"thruster",name:"推力",lan_key:"canvas.mec_tool.thruster",key:"T"},{active:false,default:"sliceBtn",type:"slice",name:"切割",lan_key:"canvas.mec_tool.slice",key:"S"},{active:false,default:"rotaBtn",type:"rota",name:"旋转",lan_key:"canvas.mec_tool.rota",key:"Q"}];this.drawCurt=null;this.toolCurt=null;this.firstCurMec=null;this.toggleBtnConfigs={dragBtn:{selectedBoxClass:"font-box-se",deSelectedBoxClass:"font-box-dese",selectedClass:"dragBtnSe",deSelectedClass:"dragBtnDese",name:"挥动",lan_key:"canvas.mec_tool.drag",selected:true},drawBlocksBtn:{selectedBoxClass:"font-box-dese",deSelectedBoxClass:"font-box-dese",selectedClass:"drawBtn",deSelectedClass:"drawBtn",name:"绘制",lan_key:"canvas.mec_tool.draw",hasSanjiao:true},toolBlocksBtn:{selectedBoxClass:"font-box-dese",deSelectedBoxClass:"font-box-dese",selectedClass:"toolBtn",deSelectedClass:"toolBtn",name:"工具",lan_key:"canvas.mec_tool.tools",hasSanjiao:true},drawBlocks:[],toolBlocks:[]};this.mechToolChange=o(this,"mechToolChange",7);this.playChange=o(this,"playChange",7)}t.prototype.keycodeChange=function(t,e){if(t==""){t="drag"}var o=this.typeInDraw(t);if(!o){o=this.typeInTool(t);if(o){this.toolCurt=o}else{this.toolCurt=null}}else{this.drawCurt=o}};t.prototype.typeInDraw=function(t){var e=null;D(this.drawBlocks,(function(o){if(o.type===t){e=o}}));return e};t.prototype.typeInTool=function(t){var e=null;D(this.toolBlocks,(function(o){if(o.type===t){e=o}}));return e};t.prototype.componentDidLoad=function(){return __awaiter(this,void 0,void 0,(function(){var t,e,o,n,s,l,a,i,a,i;return __generator(this,(function(r){switch(r.label){case 0:this.leftBody=this.ele.querySelector("#leftBody");t=this.ele.querySelector("#dragBtnId");e=this;return[4,t.getTarget()];case 1:e.dragBtnId=r.sent();o=this.ele.querySelector("#drawBlocksBtnId");n=this;return[4,o.getTarget()];case 2:n.drawBlocksBtnId=r.sent();s=this.ele.querySelector("#toolBlocksBtnId");l=this;return[4,s.getTarget()];case 3:l.toolBlocksBtnId=r.sent();this.firstMecBtnArr.push(this.dragBtnId,this.drawBlocksBtnId,this.toolBlocksBtnId);this.firstCurMec=this.dragBtnId;for(a=0;a<this.drawBlocks.length;a++){i=this.drawBlocks[a];this.toggleBtnConfigs.drawBlocks.push({selectedBoxClass:"font-box-se",deSelectedBoxClass:"font-box-dese",selectedClass:"inBlock "+i.default+"-se",deSelectedClass:"inBlock "+i.default+"-dese",name:this.getlan(i.lan_key)})}for(a=0;a<this.toolBlocks.length;a++){i=this.toolBlocks[a];this.toggleBtnConfigs.toolBlocks.push({selectedBoxClass:"font-box-se",deSelectedBoxClass:"font-box-dese",selectedClass:"inBlock "+i.default+"-se",deSelectedClass:"inBlock "+i.default+"-dese",name:this.getlan(i.lan_key)})}this.toggleBtnConfigs.dragBtn.name=this.getlan(this.toggleBtnConfigs.dragBtn.lan_key);this.toggleBtnConfigs.drawBlocksBtn.name=this.getlan(this.toggleBtnConfigs.drawBlocksBtn.lan_key);this.toggleBtnConfigs.toolBlocksBtn.name=this.getlan(this.toggleBtnConfigs.toolBlocksBtn.lan_key);this.updateui=Math.random();return[2]}}))}))};t.prototype.getTip=function(t){return t};t.prototype.playClick=function(t){this.playChange.emit(t)};t.prototype.firstMecChaged=function(t){if(this.firstCurMec!==t.target){var e=null;this.firstMecBtnArr.forEach((function(o){o.selected=o===t.target;if(o.selected){e=t.target}}));this.firstCurMec=e}if(this.firstCurMec===this.dragBtnId){if(this.dragBtnId.selected){this.sendMec({type:"drag"})}else{this.sendMec({type:"move"})}this.hideDrawBlock();this.hideToolBlock();this.toolTShow=false;this.drawTShow=false;this.drawCurt=null;this.toolCurt=null}else if(this.firstCurMec===this.drawBlocksBtnId){this.sendMec({type:"move"});this.drawTShow=this.firstCurMec.selected;this.toolTShow=false;this.toolCurt=null;this.hideToolBlock()}else if(this.firstCurMec===this.toolBlocksBtnId){this.sendMec({type:"move"});this.drawTShow=false;this.drawCurt=null;this.toolTShow=this.firstCurMec.selected;this.hideDrawBlock()}else{this.drawTShow=false;this.toolTShow=false;this.drawCurt=null;this.toolCurt=null;this.sendMec({type:"move"})}};t.prototype.hideDrawBlock=function(){this.toggleBtnConfigs.drawBlocks.forEach((function(t){t.selected=false}))};t.prototype.hideToolBlock=function(){this.toggleBtnConfigs.toolBlocks.forEach((function(t){t.selected=false}))};t.prototype.sendMec=function(t){this.mechToolChange.emit(t)};t.prototype.drawBlockActive=function(t,e){this.toggleBtnConfigs.drawBlocks.forEach((function(e){if(e.target!==t){e.target.selected=false}}));if(t.selected){this.drawCurt=e;this.sendMec({type:e.type})}else{this.drawCurt=null;this.sendMec({type:"drag"})}};t.prototype.toolBlockActive=function(t,e){this.toggleBtnConfigs.toolBlocks.forEach((function(e){if(e.target!==t){e.target.selected=false}}));if(t.selected){this.toolCurt=e;this.sendMec({type:e.type})}else{this.toolCurt=null;this.sendMec({type:"move"})}};t.prototype.documentTouchEnd=function(t){if(!(this.leftBody&&this.leftBody.contains(t.target))){this.mouseleaveHandle()}};t.prototype.mouseleaveHandle=function(){if(!this.drawCurt&&!this.toolCurt&&(this.drawTShow||this.toolTShow)){this.drawTShow=false;this.toolTShow=false;if(this.firstCurMec){this.firstCurMec.selected=false}}};t.prototype.getlan=function(t){if(!this.trans){return t}return this.trans.getStrFromKey(t,"")};t.prototype.drawTShowDom=function(){var t=this;if(this.drawTShow){return n("div",{class:"block-con"},this.toggleBtnConfigs.drawBlocks.map((function(e,o){return n("mec-toggle-btn",{onSelectChange:function(e){t.drawBlockActive(e.detail.target,t.drawBlocks[o])},config:e})})))}};t.prototype.addTooldom=function(){var t=this;if(this.toolTShow){return n("div",{class:"outBlock2 second-tool-left shandow-block"},n("div",{class:"block-con"},this.toggleBtnConfigs.toolBlocks.map((function(e,o){return n("mec-toggle-btn",{onSelectChange:function(e){t.toolBlockActive(e.detail.target,t.toolBlocks[o])},config:e})}))))}};t.prototype.addPlayDom=function(){var t=this;if(this.isPlay){return n("div",{class:"groupDiv2"},n("div",{class:"pasueBtn",onClick:function(){t.playClick(false)}}),n("div",{class:"play-btn"},this.getlan("canvas.mec_tool.pause")))}else{return n("div",{class:"groupDiv2"},n("div",{class:"playBtn",onClick:function(){t.playClick(true)}}),n("div",{class:"play-btn"},this.getlan("canvas.mec_tool.play")))}};t.prototype.render=function(){var t=this;return n("div",{id:"leftBody",class:"mecToolClass shandow-block",onMouseLeave:function(){t.mouseleaveHandle()}},n("div",{class:"groupDiv"},n("mec-toggle-btn",{id:"dragBtnId",config:this.toggleBtnConfigs.dragBtn,onSelectChange:function(e){t.firstMecChaged(e.detail)}}),n("mec-toggle-btn",{id:"drawBlocksBtnId",config:this.toggleBtnConfigs.drawBlocksBtn,onSelectChange:function(e){t.firstMecChaged(e.detail)}}),n("mec-toggle-btn",{class:"tool-tog-btn",id:"toolBlocksBtnId",config:this.toggleBtnConfigs.toolBlocksBtn,onSelectChange:function(e){t.firstMecChaged(e.detail)}}),n("div",{class:"outBlock second-tool-left shandow-block"},this.drawTShowDom()),this.addTooldom()),this.addPlayDom(),n("div",{class:"mecTool-back"}))};Object.defineProperty(t.prototype,"ele",{get:function(){return s(this)},enumerable:true,configurable:true});Object.defineProperty(t,"watchers",{get:function(){return{keycode:["keycodeChange"]}},enumerable:true,configurable:true});Object.defineProperty(t,"style",{get:function(){return".toolbar_icon_play_default,nb-mechTool-group .playBtn{background-position:0 0}.toolbar_icon_play_default,.toolbar_icon_play_hover,nb-mechTool-group .playBtn,nb-mechTool-group .playBtn:hover{background-image:url(assets/imgs/nbk/nbk_mechtool-group_sprite.png);background-size:34px 229px;background-repeat:no-repeat;width:34px;height:34px}.toolbar_icon_play_hover,nb-mechTool-group .playBtn:hover{background-position:0 -39px}.toolbar_icon_play_pressed{background-position:0 -78px}.toolbar_icon_play_pressed,.toolbar_icon_stop_default,nb-mechTool-group .pasueBtn{background-image:url(assets/imgs/nbk/nbk_mechtool-group_sprite.png);background-size:34px 229px;background-repeat:no-repeat;width:34px;height:34px}.toolbar_icon_stop_default,nb-mechTool-group .pasueBtn{background-position:0 -117px}.toolbar_icon_stop_hover,nb-mechTool-group .pasueBtn:hover{background-position:0 -156px}.toolbar_icon_stop_hover,.toolbar_icon_stop_pressed,nb-mechTool-group .pasueBtn:hover{background-image:url(assets/imgs/nbk/nbk_mechtool-group_sprite.png);background-size:34px 229px;background-repeat:no-repeat;width:34px;height:34px}.toolbar_icon_stop_pressed{background-position:0 -195px}nb-mechTool-group .mecToolClass{position:absolute;width:60px;left:30px;top:95px}nb-mechTool-group .mecToolClass .blockBtn{margin:0 13px 0 13px}nb-mechTool-group .mecToolClass .outBlock{top:72px;position:absolute}nb-mechTool-group .mecToolClass .outBlock2{top:135px;position:absolute}nb-mechTool-group .mecToolClass .groupDiv{padding-top:7px;width:100%}nb-mechTool-group .mecToolClass .groupDiv .tool-tog-btn .toggle-box{margin-top:3px}nb-mechTool-group .mecToolClass .second-tool-left{left:62px;width:60px}nb-mechTool-group .mecToolClass .block-con{width:100%;padding-bottom:18px;padding-top:1px}nb-mechTool-group .shandow-block{background:rgba(26,28,30,.95);-webkit-box-shadow:6px 6px 15px rgba(0,0,0,.2);box-shadow:6px 6px 15px rgba(0,0,0,.2);border-radius:10px}nb-mechTool-group .groupDiv2{padding:8px 13px 20px 13px;border-radius:0 0 10px 10px;cursor:pointer}nb-mechTool-group .groupDiv2 .play-btn{color:#ccc;text-align:center}nb-mechTool-group .mecTool-back{width:5px;height:195px;background-color:rgba(255,0,0,0);position:absolute;left:60px;top:79px}"},enumerable:true,configurable:true});return t}())}}}));