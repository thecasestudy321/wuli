import{r as t,c as s,h as i,g as o}from"./p-05c16912.js";import"./p-ba1f185e.js";import"./p-e0dd32b5.js";import{g as n}from"./p-c07cb541.js";import"./p-69a83435.js";const e=class{constructor(i){t(this,i),this.eqData={},this.ownerSetAddPos=!1,this.ownerSetAddPosUid=0,this.isvip=!1,this.iconstyle={},this.isclick=!0,this.startOffset=null,this._iconNode=null,this.addNum=0,this.eqsDistance=100,this.layerCount=0,this.startP={x:0,y:0},this.clickItem=s(this,"clickItem",7),this.registerItem=s(this,"registerItem",7)}componentWillLoad(){}componentDidLoad(){this.setIconStyles(),this.registerItem.emit({target:this})}componentDidUnload(){this.canvas=null,console.log("library item unload")}setIconStyles(){const t=this.eqData;let s;this.iconstyle={"background-image":t.bgImgUrl,"background-size":"auto","background-position":s=t.iconPngData?`-${t.iconPngData.x}px -${t.iconPngData.y}px`:""}}itemClick(){if(!this.isclick)return;e.oriOwnerSetAddPosUid!==this.ownerSetAddPosUid&&(e.oriOwnerSetAddPosUid=this.ownerSetAddPosUid,e.addNum2=0,e.layerCount2=0);const t=n(this.canvas,"phyCanvas.viewScale",1),s=0===e.addNum2?0:Math.PI/2/e.addNum2,i=window.innerWidth/2,o=window.innerHeight/2,h=i+Math.cos(e.layerCount2*s)*e.addNum2*this.eqsDistance*t,c=o+Math.sin(e.layerCount2*s)*e.addNum2*this.eqsDistance*t;e.layerCount2++,0!==e.addNum2&&e.layerCount2%(4*e.addNum2)!=0||(e.addNum2++,e.layerCount2=0),this.clickItem.emit({target:this,data:this.eqData,pos:{x:h,y:c}})}moveCloneImg(t){if(!t)return null;const s=window.$,i=this.iconNode;let o=this.startOffset;o={x:40,y:40},s(i).css("pointer-events","none"),i.isadd||s(document.body).append(i);const n=t.clientX-o.x,e=t.clientY-o.y;return i.css("left",n+"px"),i.css("top",e+"px"),{x:n,y:e}}removeCloneImg(){this.iconNode.remove()}showLoading(){const t=(0,window.$)(this._iconNode).children()[0];t&&(t.style.display="block")}hideLoading(){const t=(0,window.$)(this._iconNode).children()[0];t&&(t.style.display="none")}get iconNode(){const t=this.element.querySelector(".iconBlock"),s=window.$;return this._iconNode||(this._iconNode=s(t).clone()),this._iconNode.addClass("showedDragElement"),this._iconNode.css({position:"absolute",zIndex:"9999",width:`${t.clientWidth}px`,height:`${t.clientHeight}px`,opacity:.5}),this._iconNode}async touchBegin(t){const s=this.element.querySelector(".eqsBlock").getBoundingClientRect();if(t.clientX>=s.left&&t.clientX<=s.right&&t.clientY>=s.top&&t.clientY<=s.bottom){const s=this.element.querySelector(".iconBlock").getBoundingClientRect();return this.startOffset={x:t.clientX-s.left,y:t.clientY-s.top},this.isclick=!0,this}return null}get eqIsLock(){return!(this.canvas&&this.canvas.removeLock||this.eqData&&(this.isvip||!this.eqData.isLock))}addLockIcon(){if(this.eqIsLock)return i("span",{class:"iconfont"})}render(){return i("div",{class:"eqsBlock",onClick:()=>{setTimeout(()=>{this.itemClick()},0)}},this.addLockIcon(),i("div",{class:"iconPareBox"},i("div",{class:"iconBlock",style:this.iconstyle})),i("span",{class:"eqsName"},this.eqData.name))}get element(){return o(this)}static get style(){return".editor_icon_lock,nb-library-item .eqsBlock .iconfont{background-image:url(assets/imgs/nbk/nbk_commons_sprite.png);background-size:24px 24px;background-repeat:no-repeat;background-position:0 0;width:24px;height:24px}nb-library-item .eqsBlock{cursor:pointer;width:120px;height:120px;display:block;background-color:rgba(26,27,28,.15);border:1px solid rgba(26,27,28,.15);margin-left:6px;margin-top:6px;border-radius:8px;-webkit-transition:background-color .25s;transition:background-color .25s}nb-library-item .eqsBlock:hover{background:rgba(0,0,0,.15);border:1px solid #4b515e}nb-library-item .eqsBlock .iconPareBox{position:relative;width:100%;min-height:80px;padding-top:3px}nb-library-item .eqsBlock .iconPareBox .iconBlock{position:relative;width:80px;height:80px;margin:0 auto;text-align:center;bottom:0}nb-library-item .eqsBlock .eqsName{text-align:center;font-size:14px;word-break:break-word;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden;margin-top:5px}nb-library-item .eqsBlock .iconfont{position:absolute;margin-left:83px;margin-top:8px;display:block;z-index:10}"}};e.oriOwnerSetAddPosUid=0,e.addNum2=0,e.layerCount2=0;export{e as nb_library_item};