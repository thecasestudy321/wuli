window.AudioContext=window.AudioContext?window.AudioContext:window.webkitAudioContext,window.AudioContext||console.log("%cYour browser does not support AudioContext!","background: #222; color: #bada55");var Beep={VERSION:7,verbosity:.5,AudioContext:window.AudioContext,voices:[],samples:[],triggers:[],instruments:[],domContainer:null,isKeyboarding:!0,setupTasks:[function(){try{Beep.audioContext||(Beep.audioContext=new Beep.AudioContext)}catch(e){}},function(){null===Beep.domContainer&&(Beep.domContainer=document.getElementById("beep"))},function(){Beep.verbosity>0&&console.log("Beep",Beep.VERSION)}],setup:function(){for(var e;e=this.setupTasks.shift();)"function"==typeof e&&e()},teardown:function(){for(;this.instruments.length;)this.instruments.pop().teardown();for(;this.triggers.length;)this.triggers.pop().teardown();for(;this.samples.length;)this.samples.pop().teardown();for(;this.voices.length;)this.voices.pop().teardown()},reset:function(){this.teardown(),this.setup()},parseMultilineString:function(e){var t=(e=e.toString()).indexOf("/*")+2,o=e.indexOf("*/",t);return e.substring(t,o).replace(/\/\+/g,"/*").replace(/\+\//g,"*/")}};document.addEventListener("DOMContentLoaded",function(){Beep.setup()});
Beep.Note=function(e){var t=this;if("number"==typeof e)this.hertz=e;else{if("object"!=typeof e||void 0===e.hertz)return Beep.Note.EDO12(e);Object.keys(e).forEach(function(n){t[n]=e[n]})}},Beep.Note.validateWestern=function(e){function t(e){return e.letterIndex<0&&(e.letterIndex+=r.length,e.octaveIndex--),e.letterIndex>=r.length&&(e.letterIndex-=r.length),e.letter=r.substr(e.letterIndex,1),e}var n,i=["A♭","A♮","B♭","B♮","C♮","C♯","D♮","E♭","E♮","F♮","F♯","G♮"],r="ABCDEFG",o="CF",d="EAB";return void 0===e?e={}:"string"==typeof e&&(n=e,e={},n.split("").forEach(function(t,n){+t+""!="NaN"?e.octaveIndex=+t:-1!=="♭♮♯#".indexOf(t)?e.modifier=t:-1!==(r+"H").indexOf(t.toUpperCase())&&("H"===t.toUpperCase()?e.letter="B":"b"===t&&n>0?e.modifier="♭":e.letter=t.toUpperCase())})),void 0!==e.octaveIndex&&""!==e.octaveIndex&&+e.octaveIndex+""!="NaN"||(e.octaveIndex=4),e.octaveIndex=+e.octaveIndex,e.octaveIndex<0?e.octaveIndex=0:e.octaveIndex>8&&(e.octaveIndex=8),void 0===e.letter&&(e.letter="A"),e.letterIndex=r.indexOf(e.letter),void 0===e.modifier&&(e.modifier="♮"),void 0===e.A&&(e.A=440),"b"===e.modifier&&(e.modifier="♭"),"#"===e.modifier&&(e.modifier="♯"),"♭"===e.modifier&&-1===d.indexOf(e.letter)?(e.letterIndex=r.indexOf(e.letter)-1,e=t(e),o.indexOf(e.letter)>-1?e.modifier="♯":e.modifier="♮"):"♯"===e.modifier&&-1===o.indexOf(e.letter)&&(e.letterIndex=r.indexOf(e.letter)+1,e=t(e),d.indexOf(e.letter)>-1?e.modifier="♭":e.modifier="♮"),"♯"===e.modifier?e.isSharp=!0:"♭"===e.modifier?e.isFlat=!0:e.isNatural=!0,e=t(e),e.name=e.letter+e.modifier,e.nameSimple=e.letter,"♮"!==e.modifier&&(e.nameSimple+=e.modifier),e.nameIndex=i.indexOf(e.name),8===e.octaveIndex&&"C"!==e.nameSimple&&(e.octaveIndex=7),e.pianoKeyIndex=12*e.octaveIndex+e.nameIndex,e.nameIndex>3&&(e.pianoKeyIndex-=12),e.midiNumber=e.pianoKeyIndex+20,void 0===e.tuning&&(e.tuning="EDO12"),e},Beep.Note.EDO12=function(e){return e=Beep.Note.validateWestern(e),e.hertz=e.A*Math.pow(Math.pow(2,1/12),e.pianoKeyIndex-49),e.tuning="EDO12",new Beep.Note(e)},Beep.Note.JustIntonation=function(e,t){var n;return e=Beep.Note.validateWestern(e),e.tuning="JustIntonation",e.key=new Beep.Note.EDO12(t),n=(e.nameIndex-e.key.nameIndex)%12,n<0&&(n+=12),e.hertz=[e.key.hertz,16*e.key.hertz/15,9*e.key.hertz/8,6*e.key.hertz/5,5*e.key.hertz/4,4*e.key.hertz/3,45*e.key.hertz/32,3*e.key.hertz/2,8*e.key.hertz/5,5*e.key.hertz/3,16*e.key.hertz/9,15*e.key.hertz/8,2*e.key.hertz][n],e.hertz=e.hertz*Math.pow(2,e.octaveIndex-e.key.octaveIndex),new Beep.Note(e)},Beep.Note.seemsLegit=function(e){var t,n,i=!0,r=0,o=0,d=0,a=0;if(e instanceof Beep.Note)return!0;if("number"==typeof e)return!0;if("string"==typeof e){if(e.length>3)return!1;for(n=0;n<e.length;n++)if(+(t=e[n])+""!="NaN"&&+t>=0&&+t<=8)o++;else if("ABCDEFGHacdefgh".indexOf(t)>=0)r++;else if("♮♯♭#".indexOf(t)>=0)d++;else{if("b"!==t){i=!1;break}a++}return(o>1||r>1||d>1||a>1||r+d+a>2)&&(i=!1),i}return!1};
Beep.Voice=function(t,i){t instanceof Beep.AudioContext||t instanceof GainNode?(t instanceof Beep.AudioContext?(this.audioContext=t,this.destination=t.destination):t instanceof GainNode&&(this.audioContext=t.audioContext,this.destination=t),i instanceof Beep.Note?this.note=i:this.note=new Beep.Note(i)):(t instanceof Beep.Note?this.note=t:this.note=new Beep.Note(t),i instanceof Beep.AudioContext?(this.audioContext=i,this.destination=i.destination):i instanceof GainNode?(this.audioContext=i.audioContext,this.destination=i):(this.audioContext=Beep.audioContext,this.destination=this.audioContext.destination)),this.setup(),Beep.voices.push(this)},Beep.Voice.prototype.setup=function(){this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=0,this.gainNode.connect(this.destination),this.delayDuration=0,this.attackGain=.15,this.attackDuration=.05,this.decayDuration=.05,this.sustainGain=.8,this.sustainDuration=1/0,this.releaseDuration=.1,this.isPlaying=!1,this.noteEnabled=!0,this.oscillator=this.audioContext.createOscillator(),this.oscillator.connect(this.gainNode),this.oscillator.type="sine",this.oscillator.frequency.value=this.note.hertz,this.sampleEnabled=!1,this.isTorndown=!1},Beep.Voice.prototype.play=function(t){var i=this,e=this.audioContext.currentTime,a=this.gainNode.gain.value;return"number"!=typeof t&&(t=.5),this.noteEnabled&&(this.oscillator.frequency.value=this.note.hertz),this.sampleEnabled&&(this.sampleResetOnPlay&&(this.sample.currentTime=0),this.sample.play()),this.gainNode.gain.cancelScheduledValues(e),this.gainNode.gain.setValueAtTime(a,e),this.delayDuration&&this.gainNode.gain.setValueAtTime(a,e+this.delayDuration),this.gainNode.gain.linearRampToValueAtTime(t*this.attackGain,e+this.delayDuration+this.attackDuration),this.gainNode.gain.linearRampToValueAtTime(t*this.attackGain*this.sustainGain,e+this.delayDuration+this.attackDuration+this.decayDuration),!1===this.isPlaying&&(this.isPlaying=!0,this.noteEnabled&&this.oscillator.start(0)),this.sustainDuration!==1/0&&setTimeout(function(){i.pause()},e+this.delayDuration+this.attackDuration+1e3*this.sustainDuration),this},Beep.Voice.prototype.pause=function(){var t=this.audioContext.currentTime;return this.gainNode.gain.cancelScheduledValues(t),this.gainNode.gain.setValueAtTime(this.gainNode.gain.value,t),this.gainNode.gain.linearRampToValueAtTime(1e-4,t+this.releaseDuration),this.gainNode.gain.setValueAtTime(0,t+this.releaseDuration+1e-4),this},Beep.Voice.prototype.teardown=function(){return!1===this.isTorndown&&(this.oscillator&&(this.isPlaying&&this.oscillator.stop(0),this.oscillator.disconnect()),this.source&&this.source.disconnect(),this.isTorndown=!0),this},["delayDuration","attackGain","attackDuration","decayDuration","sustainGain","sustainDuration","releaseDuration"].forEach(function(t){var i=t.substr(0,1).toUpperCase()+t.substr(1);Beep.Voice.prototype["get"+i]=function(){return this[t]},Beep.Voice.prototype["set"+i]=function(i){return this[t]=i,this}}),Beep.Voice.prototype.getOscillatorType=function(){return this.oscillator?this.oscillator.type:void 0},Beep.Voice.prototype.setOscillatorType=function(t){return this.oscillator&&(this.oscillator.type=t),this};
Beep.Trigger=function(){var e=this;Array.prototype.slice.call(arguments).forEach(function(t){t instanceof Beep.Instrument?e.instrument=t:t instanceof Function?e.createVoices=t:t instanceof Beep.Note?e.note=t:e.note=new Beep.Note(t)}),this.id=Date.now()+"-"+Math.round(1e10*Math.random()),this.instrument?this.audioContext=this.instrument.audioContext:this.audioContext=Beep.audioContext,void 0===this.note&&(this.note=new Beep.Note),this.engaged=!1,this.voices=[],this.createVoices(),this.domContainer=document.createElement("div"),this.domContainer.classList.add("trigger-container"),this.note.isSharp||this.note.isFlat?this.domContainer.classList.add("unnatural"):this.domContainer.classList.add("natural"),this.domContainer.classList.add("name-index-"+this.note.nameIndex),this.domContainer.setAttribute("id","trigger-"+this.id),this.domNoteName=document.createElement("div"),this.domNoteName.classList.add("note-name"),this.domNoteName.innerHTML="<strong>"+this.note.nameSimple+"</strong>"+this.note.octaveIndex,this.domContainer.appendChild(this.domNoteName),this.domTrigger=document.createElement("div"),this.domTrigger.classList.add("trigger"),this.domContainer.appendChild(this.domTrigger),this.domCharsList=document.createElement("div"),this.domCharsList.classList.add("chars-list"),this.domTrigger.appendChild(this.domCharsList),this.instrument&&this.instrument.domTriggers?this.instrument.domTriggers.appendChild(this.domContainer):document.body.appendChild(this.domContainer),this.eventListeners=[],this.domTrigger.addEventListener("mouseenter",function(){e.engage("mouseenter")}),this.domTrigger.addEventListener("mouseleave",function(){e.disengage("mouseenter")}),this.domTrigger.addEventListener("touchstart",function(t){e.engage("touched"),t.preventDefault()}),this.domTrigger.addEventListener("touchend",function(t){e.disengage("touched"),t.preventDefault()}),this.midiNumber=this.note.midiNumber,navigator.requestMIDIAccess&&navigator.requestMIDIAccess().then(function(t){t.inputs.forEach(function(t){t.onmidimessage=e.onMidiMessage.bind(e)})}),Beep.triggers.push(this)},Beep.Trigger.prototype.addEventListener=function(e,t){this.eventListeners.push({type:e,action:t}),window.addEventListener(e,t)},Beep.Trigger.prototype.removeEventListener=function(e,t){var i=eventListeners.length-1;for(i=eventListeners.length-1;i>=0;i--)eventListeners[i].type===e&&eventListeners[i].action===t&&eventListeners.splice(i,1);window.removeEventListener(e,t)},Beep.Trigger.prototype.removeEventListeners=function(){for(var e;e=this.eventListeners.pop();)window.removeEventListener(e.type,e.action)},Beep.Trigger.prototype.addTriggerChar=function(e){var t,i,n=this;return"string"==typeof e?(t=e.toUpperCase(),i=t.charCodeAt(0),"<"===t&&(i=188)):"number"==typeof e&&(i=e,t=String.fromCharCode(i),188===i&&(t="<")),this.addEventListener("keydown",function(e){var t=e.which||e.keyCode;!Beep.isKeyboarding||t!==i||e.metaKey||e.ctrlKey||n.engage("keydown-"+i)}),this.addEventListener("keyup",function(e){(e.which||e.keyCode)!==i||e.metaKey||e.ctrlKey||n.disengage("keydown-"+i)}),this.domCharsList.innerHTML+="<br>"+t,this},Beep.Trigger.prototype.onMidiMessage=function(e){var t=e.data[0]>>4,i=15&e.data[0],n=e.data[1],s=e.data[2];Beep.verbosity>=.7&&(console.log("\nMIDI Command",t),console.log("MIDI Channel",i),console.log("MIDI Item",n),console.log("MIDI Velocity",s)),(8===t||9===t&&0===s)&&n===this.midiNumber?this.disengage("midi"):9===t&&n===this.midiNumber?this.engage("midi",s/127):11===t||14===t&&this.voices.forEach(function(e){e.oscillator&&(e.oscillator.detune.value=1200*(s-63)/63)})},Beep.Trigger.prototype.createVoices=function(){this.voices.push(new Beep.Voice(this.note,this.audioContext).setOscillatorType("sine").setAttackGain(.2).setReleaseDuration(.2),new Beep.Voice(this.note.hertz/2,this.audioContext).setOscillatorType("square").setAttackDuration(.01).setAttackGain(.3))},Beep.Trigger.prototype.teardownVoices=function(){for(var e=this.voices.length;e--;)void 0!==this.voices[e]&&this.voices[e].teardown(),delete this.voices[e];return this.voices=[],this.engaged=!1,this},Beep.Trigger.prototype.play=function(e){this.voices.forEach(function(t){t.play(e)})},Beep.Trigger.prototype.pause=function(){this.voices.forEach(function(e){e.pause()})},Beep.Trigger.prototype.engage=function(e,t){var i,n=1;return"string"==typeof e?i=e:"number"==typeof e&&(n=e),"string"==typeof t?i=t:"number"==typeof t&&(n=t),!1===this.engaged&&(this.engaged=!0,this.eventType=i,this.domContainer.classList.add("engaged"),this.play(n)),this},Beep.Trigger.prototype.disengage=function(e){return!0!==this.engaged||this.eventType!==e&&"code"!==this.eventType||(this.engaged=!1,this.pause(),this.domContainer.classList.remove("engaged")),this},Beep.Trigger.prototype.teardown=function(){this.pause(),this.teardownVoices(),this.removeEventListeners(),this.domContainer.remove()};
Beep.Instrument=function(){var n=this;document.getElementById("play-pause-container");Array.prototype.slice.call(arguments).forEach(function(e){e instanceof window.Element?n.domContainer=e:"string"==typeof e?n.domContainer=document.getElementById(e):e instanceof Function&&(n.createVoices=e)}),this.context=Beep.audioContext,this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination),this.gainNode.gain.value=.3,void 0===this.domContainer&&(this.domContainer=document.createElement("div")),this.domContainer.classList.add("instrument"),Beep.domContainer?Beep.domContainer.appendChild(this.domContainer):document.body.appendChild(this.domContainer),this.triggers={},this.playTriggersMap=new Map,this.domTriggers=document.createElement("div"),this.domTriggers.classList.add("triggers"),this.domContainer.appendChild(this.domTriggers),this.bpm=140,this.beatsPerBar=4,this.oneBeat=.25,this.beats=0,this.timePrevious=0,this.scoreCompleted=[],this.scoreRemaining=[],this.scoreIsPlaying=!1,this.build(),Beep.instruments.push(this)},Beep.Instrument.prototype.get_hertz=function(e){var n=Array.from(this.playTriggersMap.values());return 0<n.length?n[0].note.hertz:0},Beep.Instrument.prototype.addStyleClass=function(e){return this.domContainer.classList.add(e),this},Beep.Instrument.prototype.removeStyleClass=function(e){return this.domContainer.classList.remove(e),this},Beep.Instrument.prototype.teardown=function(){this.unbuild(),this.gainNode.disconnect(),this.domTriggers.remove(),this.domContainer.remove()},Beep.Instrument.prototype.newTrigger=function(e,n){var t;return e instanceof Beep.Note==!1&&(e=new Beep.Note(e)),t=void 0!==this.createVoices?new Beep.Trigger(this,e,this.createVoices):new Beep.Trigger(this,e),n instanceof Array==!1&&(n=[n]),n.forEach(function(e){void 0!==e&&t.addTriggerChar(e)}),this.triggers[e.octaveIndex+e.nameSimple]=t,this},Beep.Instrument.prototype.play=function(e){var n=Object.keys(this.triggers),t=Math.floor(n.length/2);return void 0===e&&(e=n[t]),"string"==typeof e&&this.triggers[e]&&(e=this.triggers[e]),e instanceof Beep.Trigger&&e.engage("code"),e&&this.playTriggersMap.set(e.id,e),this},Beep.Instrument.prototype.pause=function(e){var n=this;return"string"==typeof e&&this.triggers[e]&&(e=this.triggers[e]),e instanceof Beep.Trigger&&(this.playTriggersMap.delete(e.id),e.disengage()),void 0===e&&Object.keys(this.triggers).forEach(function(e){n.triggers[e].disengage()}),this},Beep.Instrument.prototype.applyVoices=function(n){var t=this;return this.createVoices=n,Object.keys(this.triggers).forEach(function(e){(e=t.triggers[e]).teardownVoices(),e.createVoices=n,e.createVoices()}),this},Beep.Instrument.prototype.buildStandard=function(){return this.unbuild().newTrigger("3C","z").newTrigger("3C♯","s").newTrigger("3D","x").newTrigger("3E♭","d").newTrigger("3E","c").newTrigger("3F","v").newTrigger("3F♯","g").newTrigger("3G","b").newTrigger("3A♭","h").newTrigger("3A","n").newTrigger("3B♭","j").newTrigger("3B","m").newTrigger("4C",["q","<"]).newTrigger("4C♯","2").newTrigger("4D","w").newTrigger("4E♭","3").newTrigger("4E","e").newTrigger("4F","r").newTrigger("4F♯","5").newTrigger("4G","t").newTrigger("4A♭","6").newTrigger("4A","y").newTrigger("4B♭","7").newTrigger("4B","u").newTrigger("5C","i"),this.scoreLoadDoReMi(),this.scoreLoadFromHash(),this},Beep.Instrument.prototype.buildCloseEncounters=function(){return this.unbuild().newTrigger("4G","1").newTrigger("4A","2").newTrigger("4F","3").newTrigger("3F","4").newTrigger("4C","5"),this},Beep.Instrument.prototype.buildCloseEncountersJust=function(){return this.unbuild().newTrigger(new Beep.Note.JustIntonation("4G","4C"),"1").newTrigger(new Beep.Note.JustIntonation("4A","4C"),"2").newTrigger(new Beep.Note.JustIntonation("4F","4C"),"3").newTrigger(new Beep.Note.JustIntonation("3F","4C"),"4").newTrigger(new Beep.Note.JustIntonation("4C","4C"),"5"),this},Beep.Instrument.prototype.buildJustVsEDO12=function(){return this.unbuild().newTrigger("4C","1").newTrigger("4D","2").newTrigger("4A","3").newTrigger(new Beep.Note.JustIntonation("4C","4C"),"7").newTrigger(new Beep.Note.JustIntonation("4D","4C"),"8").newTrigger(new Beep.Note.JustIntonation("4A","4C"),"9"),this},Beep.Instrument.prototype.buildC=function(){return this.unbuild().newTrigger("3C","z").newTrigger("3C♯").newTrigger("3D","x").newTrigger("3E♭").newTrigger("3E","c").newTrigger("3F","v").newTrigger("3F♯").newTrigger("3G","b").newTrigger("3A♭").newTrigger("3A","n").newTrigger("3B♭").newTrigger("3B","m").newTrigger("4C",["a","<"]).newTrigger("4C♯").newTrigger("4D","s").newTrigger("4E♭").newTrigger("4E","d").newTrigger("4F","f").newTrigger("4F♯").newTrigger("4G","g").newTrigger("4A♭").newTrigger("4A","h").newTrigger("4B♭").newTrigger("4B","j").newTrigger("5C",["k","q"]).newTrigger("5C♯").newTrigger("5D","w").newTrigger("5E♭").newTrigger("5E","e").newTrigger("5F","r").newTrigger("5F♯").newTrigger("5G","t").newTrigger("5A♭").newTrigger("5A","y").newTrigger("5B♭").newTrigger("5B","u").newTrigger("6C",["i","1"]).newTrigger("6C♯").newTrigger("6D","2").newTrigger("6E♭").newTrigger("6E","3").newTrigger("6F","4").newTrigger("6F♯").newTrigger("6G","5").newTrigger("6A♭").newTrigger("6A","6").newTrigger("6B♭").newTrigger("6B","7").newTrigger("7C","8").domContainer.classList.add("mini"),this},Beep.Instrument.prototype.buildCRainbow=function(){return this.buildC(),this.domContainer.classList.add("rainbow"),this.scoreLoadDoReMi(),this.scoreLoadFromHash(),this},Beep.Instrument.prototype.buildCJust=function(){return this.unbuild().newTrigger(new Beep.Note.JustIntonation("3C","4C"),"z").newTrigger(new Beep.Note.JustIntonation("3C♯","4C")).newTrigger(new Beep.Note.JustIntonation("3D","4C"),"x").newTrigger(new Beep.Note.JustIntonation("3E♭","4C")).newTrigger(new Beep.Note.JustIntonation("3E","4C"),"c").newTrigger(new Beep.Note.JustIntonation("3F","4C"),"v").newTrigger(new Beep.Note.JustIntonation("3F♯","4C")).newTrigger(new Beep.Note.JustIntonation("3G","4C"),"b").newTrigger(new Beep.Note.JustIntonation("3A♭","4C")).newTrigger(new Beep.Note.JustIntonation("3A","4C"),"n").newTrigger(new Beep.Note.JustIntonation("3B♭","4C")).newTrigger(new Beep.Note.JustIntonation("3B","4C"),"m").newTrigger(new Beep.Note.JustIntonation("4C","4C"),["a","<"]).newTrigger(new Beep.Note.JustIntonation("4C♯","4C")).newTrigger(new Beep.Note.JustIntonation("4D","4C"),"s").newTrigger(new Beep.Note.JustIntonation("4E♭","4C")).newTrigger(new Beep.Note.JustIntonation("4E","4C"),"d").newTrigger(new Beep.Note.JustIntonation("4F","4C"),"f").newTrigger(new Beep.Note.JustIntonation("4F♯","4C")).newTrigger(new Beep.Note.JustIntonation("4G","4C"),"g").newTrigger(new Beep.Note.JustIntonation("4A♭","4C")).newTrigger(new Beep.Note.JustIntonation("4A","4C"),"h").newTrigger(new Beep.Note.JustIntonation("4B♭","4C")).newTrigger(new Beep.Note.JustIntonation("4B","4C"),"j").newTrigger(new Beep.Note.JustIntonation("5C","4C"),["k","q"]).newTrigger(new Beep.Note.JustIntonation("5C♯","4C")).newTrigger(new Beep.Note.JustIntonation("5D","4C"),"w").newTrigger(new Beep.Note.JustIntonation("5E♭","4C")).newTrigger(new Beep.Note.JustIntonation("5E","4C"),"e").newTrigger(new Beep.Note.JustIntonation("5F","4C"),"r").newTrigger(new Beep.Note.JustIntonation("5F♯","4C")).newTrigger(new Beep.Note.JustIntonation("5G","4C"),"t").newTrigger(new Beep.Note.JustIntonation("5A♭","4C")).newTrigger(new Beep.Note.JustIntonation("5A","4C"),"y").newTrigger(new Beep.Note.JustIntonation("5B♭","4C")).newTrigger(new Beep.Note.JustIntonation("5B","4C"),"u").newTrigger(new Beep.Note.JustIntonation("6C","4C"),["i","1"]).newTrigger(new Beep.Note.JustIntonation("6C♯","4C")).newTrigger(new Beep.Note.JustIntonation("6D","4C"),"2").newTrigger(new Beep.Note.JustIntonation("6E♭","4C")).newTrigger(new Beep.Note.JustIntonation("6E","4C"),"3").newTrigger(new Beep.Note.JustIntonation("6F","4C"),"4").newTrigger(new Beep.Note.JustIntonation("6F♯","4C")).newTrigger(new Beep.Note.JustIntonation("6G","4C"),"5").newTrigger(new Beep.Note.JustIntonation("6A♭","4C")).newTrigger(new Beep.Note.JustIntonation("6A","4C"),"6").newTrigger(new Beep.Note.JustIntonation("6B♭","4C")).newTrigger(new Beep.Note.JustIntonation("6B","4C"),"7").newTrigger(new Beep.Note.JustIntonation("7C","4C"),"8").domContainer.classList.add("mini"),this},Beep.Instrument.prototype.build=Beep.Instrument.prototype.buildStandard,Beep.Instrument.prototype.unbuild=function(){var n=this;return Object.keys(this.triggers).forEach(function(e){n.triggers[e].teardown(),delete n.triggers[e]}),this.domContainer.classList.remove("mini"),this.domContainer.classList.remove("rainbow"),this},Beep.Instrument.prototype.scoreLoadFromHash=function(){if(""!==document.location.hash){var score=document.location.hash.substr(1).split(",").map(function(element){var value;try{value=eval(element)}catch(e){}return value});this.scoreUnload(),this.scoreLoad(score)}},Beep.Instrument.prototype.scoreLoad=function(e){var n,t,r=0;for(n=0;n<e.length;n+=3)t=new Beep.Note(e[n+1]),r+=e[n+0]||0,this.scoreRemaining.push([r,t.octaveIndex+t.nameSimple,!0]),this.scoreRemaining.push([r+e[n+2],t.octaveIndex+t.nameSimple,!1]);return this.scoreRemaining.sort(function(e,n){return e[0]-n[0]}),this},Beep.Instrument.prototype.scorePlayLoop=function(){var e=window.performance&&window.performance.now?performance.now():Date.now(),n=e-this.timePrevious;for(0===this.timePrevious&&(n=1);this.scoreRemaining.length&&this.beats>=this.scoreRemaining[0][0];)this.scoreRemaining[0][2]?this.play(this.scoreRemaining[0][1]):this.pause(this.scoreRemaining[0][1]),this.scoreCompleted.push(this.scoreRemaining.shift());return this.beats+=this.bpm/60/n*this.oneBeat,this.timePrevious=e,0===this.scoreRemaining.length&&(this.scoreIsPlaying=!1,this.scoreRemaining=this.scoreRemaining.concat(this.scoreCompleted),this.scoreCompleted=[],this.beats=0,this.timePrevious=0),this.scoreIsPlaying&&requestAnimationFrame(this.scorePlayLoop.bind(this)),this},Beep.Instrument.prototype.scorePlay=function(){return Object.keys(this.triggers).length&&(this.scoreIsPlaying=!0,this.scorePlayLoop()),this},Beep.Instrument.prototype.scoreStop=function(){return this.scoreIsPlaying=!1,this.pause(),this},Beep.Instrument.prototype.scoreToggle=function(){return this.scoreIsPlaying?this.scoreStop():this.scorePlay(),this},Beep.Instrument.prototype.scoreUnload=function(){this.scoreStop(),this.scoreCompleted=[],this.scoreRemaining=[],this.beats=0,this.timePrevious=0},Beep.Instrument.prototype.scoreLoadDoReMi=function(){this.scoreUnload(),this.scoreLoad([9,"4C",1.5,1.5,"4D",.5,.5,"4E",5/4,1.5,"4C",.5,.5,"4E",1,1,"4C",.75,1,"4E",1,2,"4D",1.5,1.5,"4E",.5,.5,"4F",.25,.5,"4F",.25,.5,"4E",.5,.5,"4D",.5,.5,"4F",2,4,"4E",1.5,1.5,"4F",.5,.5,"4G",5/4,1.5,"4E",.5,.5,"4G",1,1,"4E",.75,1,"4G",1.5,2,"4F",1.5,1.5,"4G",.5,.5,"4A",.25,.5,"4A",.25,.5,"4G",.5,.5,"4F",.5,.5,"4A",2,4,"4G",1.5,1.5,"4C",.5,.5,"4D",.5,.5,"4E",.5,.5,"4F",.5,.5,"4G",.5,.5,"4A",3,4,"4A",1.5,1.5,"4D",.5,.5,"4E",.5,.5,"4F",.5,.5,"4G",.5,.5,"4A",.5,.5,"4B",3,4,"4B",1.5,1.5,"4E",.5,.5,"4F",.5,.5,"4G",.5,.5,"4A",.5,.5,"4B",.5,.5,"5C",3,3,"4A",.25,.5,"4A",.25,.5,"4A",.75,1,"4F",.75,1,"4B",.75,1,"4G",.75,1,"5C",2,1,"3C",1/16,1/16,"3D",1/16,1/16,"3C",1/16,1/16,"3E",1/16,1/16,"3F",1/16,1/16,"3G",1/16,1/16,"3A",1/16,1/16,"3B",1/16,1/16,"4C",1/16,1/16,"4D",1/16,1/16,"4C",1/16,1/16,"4E",1/16,1/16,"4F",1/16,1/16,"4G",1/16,1/16,"4A",1/16,1/16,"4B",1/16,1/16,"5C",2,.5,"4C",1.5,.5,"3C",1]),this.scoreLoad([1,"3C",.25,1,"3G",.25,1,"3C",.25,1,"3G",.25,1,"3C",.25,1,"3G",.25,1,"3C",.25,1,"3G",.25,1,"3C",.5,1,"3G",.5,1,"3C",.5,1,"3G",.5,1,"3C",.5,1,"3G",.5,1,"3C",.5,1,"3G",.5,1,"3F",.5,1,"3D",.5,1,"3F",.5,1,"3D",.5,1,"3F",.5,1,"3D",.5,1,"3F",.5,1,"3D",.5,1,"3G",.5,1,"3E",.5,1,"3G",.5,1,"3E",.5,1,"3G",.5,1,"3E",.5,1,"3G",.5,.5,"3F",.5,.5,"3E",.5,.5,"3D",.5,.5,"3F",.5,1,"3D",.5,1,"3F",.5,1,"3D",.5,1,"3F",.5,1,"3D",.5,1,"3G",.5,.5,"3F",.5,.5,"3E",.5,.5,"3D",.5,.5,"3C",.5,.5,"3D",.5,.5,"3E",.5,.5,"3F",.5,.5,"3G",.5,.5,"3A",.5,.5,"3B",.5,.5,"4C",.5,.5,"3C",.5,.5,"3D",.5,.5,"3E",.5,.5,"3F",.5,.5,"3G",.5,.5,"3A",.5,.5,"3B",.5,.5,"4C",.5,.5,"3C",.5,.5,"3D",.5,.5,"3E",.5,.5,"3F",.5,.5,"3G",.5,.5,"3A",.5,.5,"3B",.5,.5,"4C",1,1,"3B",.5,.5,"3A",.5,.5,"3G",.5,.5,"3F",.5,.5,"3E",.5,.5,"3D",.5,.5,"3C",1,1,"3D",.5,.5,"3E",.5,.5,"3F",.5,.5,"3G",.5,.5,"3A",.5,.5,"3B",.5,.5,"4C",1,1,"3B",.5,.5,"3A",.5,.5,"3G",.5,.5,"3F",.5,.5,"3E",.5,.5,"3D",.5,.5,"3C",.5,.5,"3G",.5,.5,"3C",.5,.5,"3A",.5,.5,"3F",.5,.5,"3E",.5,.5,"3C",.5,.5,"3D",1,1,"3G",.5,.5,"3C",.5,.5,"3A",.5,.5,"3B",.5,.5,"4C",.5,.5,"4D",.5,.5,"4C",1])},Beep.Instrument.prototype.scoreLoadHSB=function(){this.scoreUnload(),this.scoreLoad([1,"3A♭",.75,1,"4E♭",.75,1,"4A♭",.75,1,"4E♭",.75])};