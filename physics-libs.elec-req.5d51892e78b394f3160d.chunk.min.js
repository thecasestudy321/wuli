/*!
 * Copyright (c) 2017 Nobook inc.
 * 
 * (TBD)
 * 
 * Version: 0.6.57
 * Date: Mon Apr 27 2020 08:22:33 GMT+0800 (CST)
 */
webpackJsonpPhysicsCanvas([11],{453:function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var s=function(){function t(t,e){for(var i=0;e.length>i;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),h=function m(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(n===undefined){var r=Object.getPrototypeOf(t);return null===r?undefined:m(r,e,i)}if("value"in n)return n.value;var o=n.get;return o===undefined?undefined:o.call(i)},u=i(1),c=i(498),l=n(c),f=i(481),p=n(f),g=i(469),y=n(g),d=function(t){function e(t){r(this,e),t.magType=2;var i=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i._leftMagNum=isNaN(t.leftMagNum)?0:t.leftMagNum,i._rightMagNum=isNaN(t.rightMagNum)?0:t.rightMagNum,i.is_hitPoints_debug=!1,i.isYuan=!0,i.isLock=!1,i.allCompArr=[],i.staCompArr=[],i.friendArr=[],i.thisObj=null,i.magPoint=new u.Point,i.gan_magPoint=null,i.gan_magPointSP=null,i.isZuHeMag=!1,i.zuheCompArrMag=[],i.hitRect=null,i.hitPoints=null,i._magDotBMDArr_=[],i._magDotRadius=null,i.hitSP=null,i.canCreateGanYingMag=!1,i.txtNum=0,i.ciji=1,i.has_initFirst=!1,i.magNumTxt=new PIXI.Text("0",{font:"30px 微软雅黑",fill:0,align:"left"}),i.GAN_VALID_MAXDIS=120,i.GAN_VALID_MINDIS=40,i.shiDis_=50,i.xiItemArr=new u.HashMap,i.xiPareObj=null,i.xiPareP=new u.Point,i.QU_DUI_NUM=5,i._shiDis=50,i._ganNum=0,i._magNum=0,i.showMagLine=!0,i.coilArr=[],i.I=1,i.hasIronCore=!1,i}return a(e,t),s(e,[{key:"initFirst",value:function(){}},{key:"init",value:function(t,e,i,n,r,o){this.initFirst(),this.ciji=o,this.ciji||(this.ciji=0!==e?e/Math.abs(e):1),this.canRotate=i,this.magNum=e,this.hitPoints=t,this.hitRect=u.M.getPArrRect(t),this.add_hitSP(),this.is_hitPoints_debug&&this.add_magNumTxt(),this.gan_magPoint_&&this.add_gan_magPointSP(this.gan_magPoint_),this.freshDotFrom_magNum(),this.fresh_magPoint()}},{key:"add_hitSP",value:function(){var t=0;this.is_hitPoints_debug&&(t=.4);var e=new PIXI.Graphics;e.beginFill(65280,t),e.drawRect(0,0,this.hitRect.width,this.hitRect.height),e.endFill(),e.beginFill(16711680,t),e.drawCircle(this.hitRect.width/2,this.hitRect.height/2,4),e.endFill(),this.hitSP=new PIXI.Sprite,this.hitSP.addChild(e),this.hitSP.x=this.hitRect.x,this.hitSP.y=this.hitRect.y,this.componentBox.addChild(this.hitSP)}},{key:"freshDotFrom_magNum",value:function(){}},{key:"txtNumChanged",value:function(){}},{key:"getRandPoint",value:function(){}},{key:"add_magNumTxt",value:function(){}},{key:"add_gan_magPointSP",value:function(t){}},{key:"diyChangedMag",value:function(){this.hadDestory||(this.elecUtil.magneticField_Update.checkAllChanged(),this.globalConfig.main.dispatchEvent("magElecChanged2",this))}},{key:"setMagNumOnly",value:function(){}},{key:"setGanYingMag",value:function(t){}},{key:"fresh_magPoint",value:function(){this.left&&this.right&&(this.left._fresh_magPointTar(this.left),this.right._fresh_magPointTar(this.right))}},{key:"_fresh_magPointTar",value:function(t){var e=new u.Point(t.hitRect.x+t.hitRect.width/2,t.hitRect.y+t.hitRect.height/2);e=this.toGlobalView(e,t.hitSP),u.M.setSPPoint(t.magPoint,e)}},{key:"addedFore",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"addedFore",this).call(this)}},{key:"added",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.lr0&&this.lr1&&(this.removeChild(this.lr0),this.removeChild(this.lr1),this.addLR01(this._leftMagNum,this._rightMagNum))}},{key:"addedEnd",value:function(){var t=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"addedEnd",this).call(this),setTimeout(function(){t.hadDestory||t.endFore()})}},{key:"removed",value:function(){u.ArrayUtil.removeValueFromArray(this.allCompArr,this),u.ArrayUtil.removeValueFromArray(this.staCompArr,this),this.allCompArr=null,this.staCompArr=null,this.left&&this.left.removed(),this.right&&this.right.removed(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"caculateBegin",value:function(){}},{key:"caculateOver",value:function(){var t=this;this.zuheCompArrMag.length>0&&$.each(this.zuheCompArrMag,function(e,i){t._shifang(i)})}},{key:"_shifang",value:function(t){var e=this,i=Math.floor(Math.abs(t.magNum)/this.QU_DUI_NUM);if(t.xiItemArr.length()>i){var n=t.xiItemArr.length()-i,r=t.xiItemArr.getKeyValyeArray(),o=r.splice(t.xiItemArr.length()-n,n);t.xiItemArr.clear(),$.each(r,function(e,i){t.xiItemArr.put(i.key,i.value)}),$.each(o,function(t,i){var n=i.value,r=u.M.getSPPoint(n.parent),o=r.clone();o.x+=e._shiDis;var a=2*Math.PI*Math.random(),s=u.M.rotaPointFromP(o,r,a);u.M.setSPPoint(n.parent,s)})}}},{key:"addLR01",value:function(t,i){var n=e.zhClassMap.BaseMagLR;t=t||0,i=i||0,this.left=new n(this.paramObj),this.left.initLRData(t,this.lr0.width,this.lr0.height),this.left.x=this.lr0.x,this.left.y=this.lr0.y,this.left.lrname="left",this.left.thisObj=this,this.right=new n(this.paramObj),this.right.initLRData(i,this.lr1.width,this.lr1.height),this.right.x=this.lr1.x,this.right.y=this.lr1.y,this.right.lrname="right",this.right.thisObj=this,this.isZuHeMag=!0,this.zuheCompArrMag.push(this.left),this.zuheCompArrMag.push(this.right),this.add2component(this.left),this.add2component(this.right)}},{key:"rotateChange",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rotateChange",this).call(this,t),this.rotate_xiItem_change(t),this.move_xiItem_change(),this.fresh_magPoint(),this.diyChangedMag()}},{key:"updateMagnet",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateMagnet",this).call(this),this.updateMagNum()}},{key:"updateMagNum",value:function(){this.hasMagReversal?(this.left&&(this.left.magNum=this._rightMagNum),this.right&&(this.right.magNum=this._leftMagNum)):(this.left&&(this.left.magNum=this._leftMagNum),this.right&&(this.right.magNum=this._rightMagNum)),this.diyChangedMag(),this.diyChanged()}},{key:"isFull",value:function(){var t=Math.floor(Math.abs(this.magNum)/this.QU_DUI_NUM);return this.xiItemArr.length()>=t}},{key:"toXiItem",value:function(t){this.xiPareObj=t,this.xiPareObj.xiItemArr.put(this.UID,this)}},{key:"removeXi",value:function(t){this.xiItemArr.remove(t.UID)}},{key:"clearXi",value:function(t){this.xiItemArr.clear()}},{key:"hasXi",value:function(t){return this.xiItemArr.containsKey(t.UID)}},{key:"fresh_xiItem_move_Arr",value:function(){this.left.xiItemArr.forEach(function(t,e){this.fresh_xiItem_move_A_Item(t,e)},this),this.right.xiItemArr.forEach(function(t,e){this.fresh_xiItem_move_A_Item(t,e)},this)}},{key:"fresh_xiItem_move_A_Item",value:function(t,e){if(t.parent&&t.parent.parent){t.parent.parent.updateTransform();var i=t.parent.parent.toLocal(t.xiPareP,t.xiPareObj);u.M.setSPPoint(t.parent,i),t.fresh_magPoint()}}},{key:"fresh_xiItem_rotate_Arr",value:function(t){this.left.xiItemArr.forEach(function(e,i){e.componentBox.rotation+=t},this),this.right.xiItemArr.forEach(function(e,i){e.componentBox.rotation+=t},this)}},{key:"rotate_xiItem_change",value:function(t){this.left&&this.right&&0!==t&&this.fresh_xiItem_rotate_Arr(t)}},{key:"move_xiItem_change",value:function(){this.left&&this.right&&this.fresh_xiItem_move_Arr()}},{key:"beginFore",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"beginFore",this).call(this,t)}},{key:"moveFore",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"moveFore",this).call(this,t),this.fresh_magPoint(),this.move_xiItem_change(),this.diyChangedMag()}},{key:"endFore",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"endFore",this).call(this,t),this.fresh_magPoint(),this.move_xiItem_change(),this.diyChangedMag()}},{key:"setWorkPower",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setWorkPower",this).call(this,t)}},{key:"setWorkElec",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setWorkElec",this).call(this,t)}},{key:"showMagLineCallBack",value:function(t){this.showMagLine=t.checked}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.showMagLine=this.showMagLine,t.hasIronCore=this.hasIronCore,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.hasIronCore=!!t.hasIronCore,this.showMagLine=!!t.showMagLine}},{key:"getConf",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return this.hasMagLine&&t.confArr.push(this.ComponentProperty.getSwitch(this.language.getLocaleStr("magnetic_field"),this.showMagLine,this.showMagLineCallBack,this)),t}},{key:"getElecs",value:function(){if(!this.lr0||!this.lr1)return[];var t=new u.Point(this.lr0.x+this.lr0.width/2,this.lr0.y+this.lr0.height/2);t=this.toGlobalView(t,this.componentBox);var e=new u.Point(this.lr1.x+this.lr1.width/2,this.lr1.y+this.lr1.height/2);return e=this.toGlobalView(e,this.componentBox),[{elecNum:this.left.magNum,elecPoint:t},{elecNum:this.right.magNum,elecPoint:e}]}},{key:"getComps",value:function(){if(!this.lr0||!this.lr1)return[];var t=new u.Point(this.lr0.x+this.lr0.width/2,this.lr0.y+this.lr0.height/2);t=this.toGlobalView(t,this.componentBox);var e=new u.Point(this.lr1.x+this.lr1.width/2,this.lr1.y+this.lr1.height/2);e=this.toGlobalView(e,this.componentBox);var i=this._magDotRadius||20,n=this.getMagLineStartAngle(),r=y["default"].getTotalElecLineNum(this.left.magNum,2),o=y["default"].getTotalElecLineNum(this.right.magNum,2);return[this.pointComp(this.left.magNum,r,t,i,p["default"].TYPE_NORMAL,n),this.pointComp(this.right.magNum,o,e,i,p["default"].TYPE_NORMAL,n+Math.PI)]}},{key:"createMagComp3D",value:function(t,e,i,n){return{p:{x:t,y:e},dir:i,I:n}}},{key:"getMagComps3D",value:function(){if(!this.showMagLine)return[];for(var t=[],e=this.hasIronCore?1.6:1,i=this.hasMagReversal?-1:1,n=this.I*i*e,r=0;this.coilArr.length>r;r++){var o=this.coilArr[r],a=this.toParentP(new PIXI.Point(o.x,o.y));t.push(this.createMagComp3D(a.x,a.y,o.dir,n))}return t}},{key:"getBarArr",value:function(t,e,i,n,r,o){o=o||0;for(var a=[],s=t/(e-1),h=(e-1)/2,u=0;e>u;u++){var c=void 0,l=void 0,f=void 0,p=void 0;0===o?(f=c=(u-h)*s+n,l=r+i,p=r-i):(c=n+i,f=n-i,p=l=(u-h)*s+r),a.push({x:c,y:l,dir:1},{x:f,y:p,dir:-1})}return a}},{key:"getUArr",value:function(t,e,i,n,r,o,a,s){a=a||0,s=s||0,o=o||0;for(var h=[],u=2*e/n,c=0;n>=c;c++){var l=s-e+u*c,f=a+t,p=a-t;h.push({x:f+i,y:l,dir:-1},{x:f-i,y:l,dir:1},{x:p+i,y:l,dir:1},{x:p-i,y:l,dir:-1})}for(var g=Math.PI/(r+1),y=t-i,d=t+i,m=1;r>=m;m++){var v=g*m,_=Math.cos(v),P=Math.sin(v);h.push({x:a+y*_,y:s+e+y*P,dir:1},{x:a+d*_,y:s+e+d*P,dir:-1})}var b=Math.cos(o),x=Math.sin(o);return h.forEach(function(t){var e=t.x*b+t.y*x,i=-t.x*x+t.y*b;t.x=e,t.y=i}),h}},{key:"toParentP",value:function(t){var e=this.parent.x,i=this.parent.y,n=-this.componentBox.rotation,r=Math.cos(n),o=Math.sin(n);return new PIXI.Point(e+t.x*r+t.y*o,i-t.x*o+t.y*r)}},{key:"getMagLineStartAngle",value:function(){return this.componentBox.rotation}},{key:"getDefaultSetting",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getDefaultSetting",this).call(this);return this.hasMagLine&&(t.showMagLine=this.showMagLine),t}},{key:"setDefaultOrigin",value:function(){this.hasMagLine&&(this.showMagLine=!0)}},{key:"ganNum",get:function(){return this.canCreateGanYingMag?this._ganNum:0},set:function(t){this._ganNum=this.isLock?0:this.canCreateGanYingMag?t:0}},{key:"magNum",get:function(){return this._magNum},set:function(t){this._magNum=t,this._magNum=Math.max(-100,this._magNum),this._magNum=Math.min(100,this._magNum),this.freshDotFrom_magNum()}}]),e}(l["default"]);!function(){Promise.all([i.e(11).then(i.bind(null,587))]).then(function(t){d.zhClassMap={BaseMagLR:t[0]["default"]}})}(),e["default"]=d},469:function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(1);e["default"]=new(function(){function t(){n(this,t),this.k=1,this.ki=1,this.type=1,this.currentArr=[],this.elecArr=[],this.magArr=[],this.wireArr=[],this.elecArr3D=[],this.magArr3D=[],this.eleLineNumSca=1.1,this.magLineNumSca=1.1,this.gridE={sx:0,ex:100,stepx:1,sy:0,ey:100,stepy:1,mm:100,nn:100,data:[]},this.gridU={sx:0,ex:100,stepx:1,sy:0,ey:100,stepy:1,mm:100,nn:100,data:[]},this.useMag3D=!1}return r(t,[{key:"setType",value:function(t){1==t?(this.type=1,this.currentArr=this.elecArr):2==t&&(this.type=2,this.currentArr=this.magArr)}},{key:"getTotalElecLineNum",value:function(t,e){var i=e||this.type,n=5;return n=1==i?Math.round(5*this.eleLineNumSca*Math.sqrt(Math.abs(t/10))):Math.abs(Math.round(this.magLineNumSca*this.k*t*.6)),n>30&&(n=30),n}},{key:"getTotalElecNum",value:function(){var t=0;return this.currentArr.forEach(function(e){t+=e.elecNum},this),t}},{key:"removeEmptyObject",value:function(t,e){for(var i=t.length,n=i-1;n>=0;n--){0==t[n][e]&&t.splice(n,1)}}},{key:"getTotalU",value:function(t){for(var e=this.elecArr.length,i=0,n=0;e>n;n++){var r=this.elecArr[n],a=r.elecPoint,s=o.Point.distance(a,t);if(0==s)return Infinity;i+=this.k*r.elecNum/s}return i}},{key:"getWireTotalForce",value:function(t){for(var e=this.wireArr.length,i=new o.Point(0,0),n=0;e>n;n++){var r=this.wireArr[n],a=r.p1,s=r.p2,h=this.getDistanceToLine(t,a,s),u=this.getVerticalVec(t,a,s);if(0>=h.x){var c=-this.ki*r.I/h.y;i.x+=c*u.x,i.y+=c*u.y}}return i}},{key:"getTotalForce",value:function(t){for(var e=this.currentArr.length,i=new o.Point(0,0),n=0;e>n;n++){var r=this.currentArr[n],a=r.elecPoint,s=o.Point.distance(a,t);if(0==s){i.x=i.y=0;break}var h=this.k*r.elecNum/(s*s*s),u=(t.x-a.x)*h,c=(t.y-a.y)*h;i.x+=u,i.y+=c}var l=this.getWireTotalForce(t);return i.x+=l.x,i.y+=l.y,i}},{key:"getZeroEPoint",value:function(t,e){var i=t.elecPoint,n=e.elecPoint,r=t.elecNum,a=e.elecNum,s=o.Point.distance(i,n),h=r+a,u=2*s*r,c=s*s*r,l=u*u-4*h*c,f=void 0;if(l>=0&&0!=h){var p=(-u+Math.sqrt(l))/(2*h),g=(-u-Math.sqrt(l))/(2*h),y=void 0;y=(s+p)*p>0?p:g;var d=i.sub(n);d.normalize(y),f=i.add(d)}return f}},{key:"getMagTotalForce",value:function(t){return this.useMag3D?this.getMagTotalForce3D(t):this.getTotalForce(t)}},{key:"getMagTotalForce3D",value:function(t){for(var e=this.magArr3D,i=e.length,n=new o.Point(0,0),r=0;i>r;r++){var a=e[r],s=a.p,h=a.I,u=a.dir,c=o.Point.distance(s,t),l=u*h/(c*c*c),f=(t.x-s.x)*l;n.x+=-((t.y-s.y)*l),n.y+=f}return n}},{key:"getDir",value:function(t){var e=t.elecNum;return e>0?1:0>e?-1:0}},{key:"isEqualU",value:function(t,e,i){return Math.abs(t-e)<Math.abs(i)}},{key:"getTotalForceByGrid",value:function(t){var e=this.gridE.sx,i=this.gridE.stepx,n=this.gridE.sy,r=this.gridE.stepy,a=this.gridE.mm,s=this.gridE.nn,h=this.gridE.data,u=(t.x-e)/i,c=(t.y-n)/r,l=parseInt(u),f=parseInt(c);if(0>l||0>f||l>=a||f>=s)return{x:0,y:0};var p=l==a-1?l:l+1,g=f==s-1?f:f+1,y=h[l][f],d=h[p][f],m=h[l][g],v=h[p][g],_=u-l,P=c-f,b=o.Point.interpolate(y,d,_),x=o.Point.interpolate(m,v,_);return o.Point.interpolate(b,x,P)}},{key:"updateGridE",value:function(t,e){this.gridE.sx=t.left,this.gridE.ex=t.right,this.gridE.stepx=e,this.gridE.sy=t.top,this.gridE.ey=t.bottom,this.gridE.stepy=e,this.gridE.mm=parseInt((this.gridE.ex-this.gridE.sx)/this.gridE.stepx),this.gridE.nn=parseInt((this.gridE.ey-this.gridE.sy)/this.gridE.stepy),this.gridE.data=this.getMeshGridE(this.gridE.sx,this.gridE.ex,this.gridE.stepx,this.gridE.sy,this.gridE.ey,this.gridE.stepy)}},{key:"getMeshGridE",value:function(t,e,i,n,r,a){for(var s=[];e>=t;){for(var h=n,u=[];r>=h;){u.push(this.getTotalForce(new o.Point(t,h))),h+=a}s.push(u),t+=i}return s}},{key:"updateGridU",value:function(t,e){this.gridU.sx=t.left,this.gridU.ex=t.right,this.gridU.stepx=e,this.gridU.sy=t.top,this.gridU.ey=t.bottom,this.gridU.stepy=e,this.gridU.mm=parseInt((this.gridU.ex-this.gridU.sx)/this.gridU.stepx),this.gridU.nn=parseInt((this.gridU.ey-this.gridU.sy)/this.gridU.stepy),this.gridU.data=this.getMeshGridU(this.gridU.sx,this.gridU.ex,this.gridU.stepx,this.gridU.sy,this.gridU.ey,this.gridU.stepy)}},{key:"getMeshGridU",value:function(t,e,i,n,r,a){for(var s=[];e>=t;){for(var h=n,u=[];r>=h;){u.push(this.getTotalU(new o.Point(t,h))),h+=a}s.push(u),t+=i}return s}},{key:"getPointInLineByU",value:function(t,e,i,n,r,a){if(this.isEqualU(r,i,n))return t.clone();if(this.isEqualU(a,i,n))return e.clone();var s=(i-r)/(a-r);if(0>s||s>1)return null;var h=o.Point.interpolate(t,e,s);if(1>o.Point.distance(t,e))return h.clone();var u=this.getTotalU(h);return(u-i)*(a-i)>0?this.getPointInLineByU.call(this,t,h,i,n,r,u):this.getPointInLineByU.call(this,e,h,i,n,a,u)}},{key:"getpInEdge",value:function(t,e,i,n,r,o){if(0>=(t-r)*(e-r)){return this.getPointInLineByU(i,n,r,o,t,e)}return null}},{key:"getForce",value:function(t,e,i){var n=o.Point.distance(e,t);if(0==n)return 0;var r=this.k*i/(n*n*n);return new o.Point((t.x-e.x)*r,(t.y-e.y)*r)}},{key:"identity",value:function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y);return new o.Point(t.x/e,t.y/e)}},{key:"getAngle",value:function(t){return Math.atan2(t.y,t.x)}},{key:"getAngle2",value:function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}},{key:"checkBiheTo",value:function(t,e,i){return i>=o.Point.distance(t,e)}},{key:"distance",value:function(t,e){return Math.sqrt(t*t+e*e)}},{key:"getDistanceToLine",value:function(t,e,i){var n=new o.Point(i.x-e.x,i.y-e.y);n.normalize(1);var r=new o.Point(-n.y,n.x),a=new o.Point(t.x-e.x,t.y-e.y),s=new o.Point(t.x-i.x,t.y-i.y),h=a.x*r.x+a.y*r.y;return new o.Point(0>(a.x*n.x+a.y*n.y)*(s.x*n.x+s.y*n.y)?-1:1,h)}},{key:"getVerticalLine",value:function(t,e,i){var n=new o.Point(i.x-e.x,i.y-e.y);n.normalize(1);var r=new o.Point(-n.y,n.x),a=new o.Point(t.x-e.x,t.y-e.y),s=a.x*r.x+a.y*r.y;return{p:new o.Point(t.x-r.x*s,t.y-r.y*s),len:s,dir:r}}},{key:"getVerticalVec",value:function(t,e,i){var n=new o.Point(i.x-e.x,i.y-e.y);n.normalize(1);var r=new o.Point(-n.y,n.x),a=new o.Point(t.x-e.x,t.y-e.y);return 0>a.x*r.x+a.y*r.y&&(r.x*=-1,r.y*=-1),r}},{key:"dotProduct",value:function(t,e){return t.x*e.x+t.y+e.y}},{key:"gradient",value:function(t,e,i){for(var n=[],r=0;e>r;r++){n[r]=[];for(var a=0;i>a;a++){var s=new o.Point;s.x=0==r?t[1][a]-t[0][a]:r==e-1?t[r][a]-t[r-1][a]:(t[r+1][a]-t[r-1][a])/2,s.y=0==a?t[r][1]-t[r][0]:a==i-1?t[r][a]-t[r][a-1]:(t[r][a+1]-t[r][a-1])/2,n[r][a]=s}}return n}},{key:"getIntCountableSet",value:function(t,e){if(t=t||0,0==(t=parseInt(t)))return[];if(1==t)return[0];e=e||-1;for(var i=[0],n=1,r=1,o=0;t>n;)i[n]=e*r,n++,o++,2==o&&(o=0,r++),e=-e;return i}},{key:"interpolate",value:function(t,e,i,n,r){var a=new o.Point(t,e),s=new o.Point(i,n);return o.Point.interpolate(a,s,(r-t)/(i-t)).y}}]),t}())},481:function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(1),a=i(469),s=function(t){return t&&t.__esModule?t:{"default":t}}(a),h=function(){function t(e){n(this,t);i(458);this.classname="MagElecPoint",this.points=[],this.angles=[],this.startAngle=0,this.r=20,this.symmetric=!1,this.showFlag=e,this.oppsite=null}return r(t,[{key:"init",value:function(e,i){var n=(this.id=e.id||0,this.elecNum=e.elecNum,this.elecPoint=new o.Point(e.elecPoint.x,e.elecPoint.y),this.type=e.type||t.TYPE_NORMAL),r=(this.n=e.n,e.angle||0);this.r=e.r||20,this.symmetric=i||!1,this.dir=s["default"].getDir(this),this.angles=[],(i&&this.n%2!=0&&n==t.TYPE_LEFT||n==t.TYPE_RIGHT)&&(this.n+=1),this.step=2*Math.PI/this.n,this.startAngle=r-Math.PI/2+this.step/2,e.notHalfStep&&(this.startAngle-=this.step/2);for(var a=0;this.n>a;a++)this.angles.push({angle:this.startAngle+a*this.step,flag:!1});switch(n){case t.TYPE_NORMAL:break;case t.TYPE_LEFT:for(var h=parseInt(this.n/2),u=0;h>u;u++)this.angles[u].flag=!0;break;case t.TYPE_RIGHT:for(var c=parseInt(this.n/2),l=c;this.n>l;l++)this.angles[l].flag=!0;break;default:this.type=t.TYPE_NORMAL}}},{key:"getPoints",value:function(){for(var t=[],e=0;this.n>e;e++){var i=this.angles[e];if(!i.flag){var n=new o.Point;n.x=this.elecPoint.x+this.r*Math.cos(i.angle),n.y=this.elecPoint.y+this.r*Math.sin(i.angle),n.index=e,t.push(n)}}return t}},{key:"closeByIndex",value:function(t){var e=this.angles[t];e&&(e.flag=!0)}},{key:"getOppositeIndex",value:function(t){var e=parseInt(this.n/2);return e>t?e-1-t:this.n-1+e-t}},{key:"checkSimpleClose",value:function(t,e){return e=Math.max(this.r,e),!!new o.Rectangle(this.elecPoint.x-e,this.elecPoint.y-e,2*e,2*e).containsPoint(t)}},{key:"checkClose",value:function(t,e,i){if(o.Point.distance(this.elecPoint,t)<this.r){var n=this.n,r=s["default"].getAngle(e)+Math.PI,a=Math.round((r-this.startAngle)/this.step);for(a%=n;0>a;)a+=n;for(var h=s["default"].getIntCountableSet(n,-1),u=0;n>u;u++){var c=a+h[u];c=(c+n)%n;var l=this.angles[c];if(!l.flag)return l.flag=!0,1}return 2}return 0}}]),t}();h.TYPE_NORMAL=1,h.TYPE_LEFT=2,h.TYPE_RIGHT=3,e["default"]=h},498:function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var s=function(){function t(t,e){for(var i=0;e.length>i;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),h=i(1),u=i(481),c=n(u),l=i(469),f=n(l),p=i(448),g=n(p);e["default"]=function(t){function e(t){r(this,e);var i=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.magType=t.magType,i.startPRadius=20,i.showElecMagLine=0,i}return a(e,t),s(e,[{key:"getElecs",value:function(){return[]}},{key:"getComps",value:function(){return[]}},{key:"getComps3D",value:function(){return[]}},{key:"getComp01",value:function(t,e,i,n){var r=this.startPRadius,o=new h.Point(e.x-i/2+r,e.y);o=this.toGlobalView(o,this.componentBox);var a=new h.Point(e.x+i/2-r,e.y);a=this.toGlobalView(a,this.componentBox);var s=f["default"].getTotalElecLineNum(t,1),u=this.getPointCompStartAngle()+n;return[this.pointComp(t/2,Math.ceil(s/2),o,r,c["default"].TYPE_LEFT,u),this.rodComp(t/2,Math.ceil(s/2),o,a,r),this.pointComp(t/2,Math.ceil(s/2),a,r,c["default"].TYPE_RIGHT,u)]}},{key:"getComp3D",value:function(t,e,i,n){return{type:2,name:this.classname,UID:this.UID,elecNum:t,angle:n,elecPoint:this.toGlobalView(e,this.componentBox),length:i}}},{key:"getPointCompStartAngle",value:function(){return this.componentBox.rotation}},{key:"rodComp",value:function(t,e,i,n,r,o){return{type:2,data:{id:o||0,elecNum:t,n:e,p1:i.clone(),p2:n.clone(),d:r}}}},{key:"pointComp",value:function(t,e,i,n,r,o,a){return{type:1,data:{id:a||0,elecNum:t,n:e,elecPoint:i.clone(),r:n,type:r,angle:o}}}},{key:"createElecs",value:function(t,e,i,n,r,o,a){for(var s=[],u=(e-2*n)/(i-1),c=0;i>c;c++){var l=void 0;l=1===a?new h.Point(r+n+u*c,o):new h.Point(r,o+n+u*c),l=this.toGlobalView(l,this.componentBox);s.push({elecNum:t/i,elecPoint:l,showFlag:this.showElecMagLine})}return s}},{key:"selectRenderChild",value:function(){return this.bg?this.bg.getBounds():null}}]),e}(g["default"])},522:function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var s=i(448),h=n(s),u=i(450),c=n(u);e["default"]=function(t){function e(t){r(this,e),t.iElecInter=6;var i=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.name=t.name,i.zuheBox=t.zuheBox,i.Resistance=t.resistance||c["default"].MIN_RESISTANCE,i.classname="BaseElecResistance",i.bposter0.bindinger.set_myroad(i.bposter1.bindinger,i.Resistance),i}return a(e,t),e}(h["default"])},585:function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function c(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(n===undefined){var r=Object.getPrototypeOf(t);return null===r?undefined:c(r,e,i)}if("value"in n)return n.value;var o=n.get;return o===undefined?undefined:o.call(i)},h=(i(1),i(453)),u=function(t){return t&&t.__esModule?t:{"default":t}}(h);e["default"]=function(t){function e(t){n(this,e),t.iElecInter=10;var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.capacitance=5e-5,i.current=0,i.cacuResiscance(),i.name=t.name,i.zuheBox=t.zuheBox,i.classname="BaseCapacitance",i.bposter0.bindinger.set_myroad(i.bposter1.bindinger,i.Resistance),i.isTrapezoidal=!1,i}return o(e,t),a(e,[{key:"getData",value:function(){var t=s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.capacitance=this.capacitance,t}},{key:"setData",value:function(t){s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.capacitance=t.capacitance}},{key:"added",value:function(){this.add2component(this.bg),s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.bposter0.bindinger.linkWireType=1,this.bposter1.bindinger.linkWireType=2,this.drawDis=40,this.bposter0.dp.setTo(10,-8),this.bposter1.dp.setTo(-10,-8)}},{key:"cacuResiscance",value:function(){this.compResistance=this.isTrapezoidal?this.elecUtil.getTimeStep()/(2*this.capacitance):this.elecUtil.getTimeStep()/this.capacitance}},{key:"setCapacitance",value:function(t){this.capacitance=t,this.current=0,this.Source=0,this.cacuResiscance(),this.branchChange=!0}},{key:"reLoop",value:function(){return!1}},{key:"overStep",value:function(){if(this.checkIsInOneHui()){if(this.elecUtil.checkIsDuan(this))return this.Source=0,this.current=0,void(this.branchChange=!0);var t=this.bposter0.bindinger.Un-this.bposter1.bindinger.Un;Math.abs(t/this.compResistance+this.Source)>1e-10&&(this.isTrapezoidal?(this.current=t/this.compResistance+this.Source,this.Source=-t/this.compResistance-this.current):(this.current=t/this.compResistance,this.Source=-this.current),this.branchChange=!0)}}}]),e}(u["default"])},586:function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function l(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(n===undefined){var r=Object.getPrototypeOf(t);return null===r?undefined:l(r,e,i)}if("value"in n)return n.value;var o=n.get;return o===undefined?undefined:o.call(i)},h=i(1),u=i(448),c=function(t){return t&&t.__esModule?t:{"default":t}}(u);e["default"]=function(t){function e(t){n(this,e),t.iElecInter=9;var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.inductanceArr=["0.000001H","0.00001H","0.0001H","0.001H","0.01H","0.05H"],i.inductance=1e-4,i.name=t.name,i.zuheBox=t.zuheBox,i.classname="BaseInductor",i.cacuResiscance(),i.current=0,i.oriElec=0,i.chaElec=0,i.bposter0.bindinger.set_myroad(i.bposter1.bindinger,i.Resistance),i.isTrapezoidal=!1,i.ganVolt=0,i}return o(e,t),a(e,[{key:"cacuResiscance",value:function(){this.compResistance=this.isTrapezoidal?2*this.inductance/this.elecUtil.getTimeStep():this.inductance/this.elecUtil.getTimeStep()}},{key:"overStep",value:function(){if(this.checkIsInOneHui()){if(this.elecUtil.checkIsDuan(this))return this.Source=0,this.current=0,void(this.branchChange=!0);if(this.ganVolt){var t=this.bposter0.bindinger.Un-this.bposter1.bindinger.Un;Math.abs(t-this.ganVolt)>1e-10&&(this.current=(t-this.ganVolt)/this.compResistance+this.Source,this.Source=this.current,this.branchChange=!0)}else{var e=this.bposter0.bindinger.Un-this.bposter1.bindinger.Un;if(Math.abs(e)>1e-10){var i=e/this.compResistance;this.chaElec=i-this.oriElec,this.oriElec=i,this.isTrapezoidal?(this.current=e/this.compResistance+this.Source,this.Source=e/this.compResistance+this.current):(this.current=e/this.compResistance+this.Source,this.Source=this.current),this.branchChange=!0}}}}},{key:"setInductance",value:function(t){this.inductance=t,this.current=0,this.Source=0,this.cacuResiscance(),this.branchChange=!0}},{key:"getInductorConfObj",value:function(){var t=this;return{type:this.ComponentProperty.SELECT,name:this.language.getLocaleStr("inductance"),canEnter:!0,enterUnit:"H",maxValue:1e7,minValue:0,showValue:this.inductance+"H",value:this.inductanceArr,callBack:function(e){var i=h.M.getNumStr(e.showValue);t.setInductance(i)}}}},{key:"getConf",value:function(){var t=s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push(this.getInductorConfObj()),t}}]),e}(c["default"])},587:function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function l(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(n===undefined){var r=Object.getPrototypeOf(t);return null===r?undefined:l(r,e,i)}if("value"in n)return n.value;var o=n.get;return o===undefined?undefined:o.call(i)},h=i(1),u=i(453),c=function(t){return t&&t.__esModule?t:{"default":t}}(u);e["default"]=function(t){function e(t){n(this,e),t.iElecInter=-1;var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.thisObj=null,i}return o(e,t),a(e,[{key:"initLRData",value:function(t,e,i,n,r){this.init([new h.Point(0,0),new h.Point(0+e,0),new h.Point(0+e,0+i),new h.Point(0,0+i)],t,!1,null,new h.Point(n,r))}},{key:"removed",value:function(){this.thisObj=null,this.xiItemArr.clear(),s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}}]),e}(c["default"])}});