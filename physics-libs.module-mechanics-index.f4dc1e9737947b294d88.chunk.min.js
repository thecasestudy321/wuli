/*!
 * Copyright (c) 2017 Nobook inc.
 * 
 * (TBD)
 * 
 * Version: 0.6.57
 * Date: Mon Apr 27 2020 08:22:33 GMT+0800 (CST)
 */
webpackJsonpPhysicsCanvas([0],Array(442).concat([function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var n=i(664),s=o(n),a=i(557),r=o(a),h=i(558),l=o(h),u=i(451),c=o(u),d=i(559),p=o(d),y=i(227),f=o(y),g=i(560),b=o(g),v=i(556),_=o(v),m=i(540),x=o(m),w=i(543),k=o(w),P=i(665),O=o(P),T=i(542),C=o(T),B=i(506),S=o(B),M=i(564),L=o(M),D=i(452),I=o(D),E=i(562),j=o(E),A=i(508),R=o(A),F=i(566),N=o(F),H=i(563),U=o(H),J=i(561),V=o(J),G=i(569),W=o(G),X=i(570),q=o(X),z=i(565),Y=o(z),K=i(567),Q=o(K),Z=i(509),$=o(Z),tt=i(568),et=o(tt),it=i(573),ot=o(it),nt=i(574),st=o(nt),at=i(575),rt=o(at),ht=i(516),lt=o(ht),ut=i(449),ct=o(ut),dt=i(454),pt=o(dt),yt=i(511),ft=o(yt),gt=i(510),bt=o(gt),vt=i(512),_t=o(vt),mt=i(571),xt=o(mt),wt=i(1033),kt=o(wt),Pt=i(1040),Ot=o(Pt),Tt=i(666),Ct=o(Tt),Bt=i(982),St=o(Bt),Mt=i(1054),Lt=o(Mt),Dt=i(1e3),It=o(Dt),Et=i(1001),jt=o(Et),At=i(668),Rt=o(At),Ft=i(609),Nt=o(Ft),Ht=i(513),Ut=o(Ht),Jt=i(670),Vt=o(Jt),Gt=i(1034),Wt=o(Gt),Xt=i(1017),qt=o(Xt),zt=i(1047),Yt=o(zt),Kt=i(999),Qt=o(Kt),Zt=i(1023),$t=o(Zt),te=i(1045),ee=o(te),ie=i(1039),oe=o(ie),ne=i(545),se=o(ne),ae=i(1048),re=o(ae),he=i(1036),le=o(he),ue=i(988),ce=o(ue),de=i(1038),pe=o(de),ye=i(610),fe=o(ye),ge=i(1041),be=o(ge),ve=i(1011),_e=o(ve),me=i(1009),xe=o(me),we=i(991),ke=o(we),Pe=i(992),Oe=o(Pe),Te=i(1035),Ce=o(Te),Be=i(1016),Se=o(Be),Me=i(1008),Le=o(Me),De=i(986),Ie=o(De),Ee=i(1037),je=o(Ee),Ae=i(1025),Re=o(Ae),Fe=i(1022),Ne=o(Fe),He=i(546),Ue=o(He),Je=i(1020),Ve=o(Je),Ge=i(669),We=o(Ge),Xe=i(1043),qe=o(Xe),ze=i(1015),Ye=o(ze),Ke=i(995),Qe=o(Ke),Ze=i(1007),$e=o(Ze),ti=i(1028),ei=o(ti),ii=i(1013),oi=o(ii),ni=i(1057),si=o(ni),ai=i(1068),ri=o(ai),hi=i(1032),li=o(hi),ui=i(1052),ci=o(ui),di=i(1021),pi=o(di),yi=i(1003),fi=o(yi),gi=i(1046),bi=o(gi),vi=i(667),_i=o(vi),mi=i(1006),xi=o(mi),wi=i(1049),ki=o(wi),Pi=i(1018),Oi=o(Pi),Ti=i(1056),Ci=o(Ti),Bi=i(1029),Si=o(Bi),Mi=i(1014),Li=o(Mi),Di=i(1042),Ii=o(Di),Ei=i(514),ji=o(Ei),Ai=i(1060),Ri=o(Ai),Fi=i(1010),Ni=o(Fi),Hi=i(1050),Ui=o(Hi),Ji=i(1002),Vi=o(Ji),Gi=i(980),Wi=o(Gi),Xi=i(671),qi=o(Xi),zi=i(998),Yi=o(zi),Ki=i(1004),Qi=o(Ki),Zi=i(1030),$i=o(Zi),to=i(994),eo=o(to),io=i(984),oo=o(io),no=i(989),so=o(no),ao=i(985),ro=o(ao),ho=i(1005),lo=o(ho),uo=i(996),co=o(uo),po=i(993),yo=o(po),fo=i(987),go=o(fo),bo=i(1019),vo=o(bo),_o=i(997),mo=o(_o),xo=i(1051),wo=o(xo),ko=i(983),Po=o(ko),Oo=i(1026),To=o(Oo),Co=i(1044),Bo=o(Co),So=i(1031),Mo=o(So),Lo=i(1065),Do=o(Lo),Io=i(674),Eo=o(Io),jo=i(1063),Ao=o(jo),Ro=i(675),Fo=o(Ro),No=i(1062),Ho=o(No),Uo=i(1064),Jo=o(Uo),Vo=i(673),Go=o(Vo),Wo=i(1061),Xo=o(Wo),qo=i(990),zo=o(qo),Yo=i(1027),Ko=o(Yo),Qo=i(1053),Zo=o(Qo),$o=i(1024),tn=o($o),en=i(1012),on=o(en),nn=i(981),sn=o(nn),an=i(1090),rn=o(an),hn=i(1084),ln=o(hn);s["default"].classList={NapeConst:r["default"],NapeEngine:l["default"],MechanicsBase:c["default"],NapeViewSyncManager:p["default"],ToolStatusStr:f["default"],Rotable:b["default"],GraphicsContainer:_["default"],CbTypeStr:x["default"],WaterContainer:k["default"],FluidBase:O["default"],InteractionFilterManager:C["default"],NewComponentBase:S["default"],NapeTouchManager:L["default"],BaseToolManager:I["default"],DragToolManager:j["default"],MoveToolManager:R["default"],RectToolManager:N["default"],GearToolManager:U["default"],BearingToolManager:V["default"],SpringToolManager:W["default"],ThrusterToolManager:q["default"],PolyToolManager:Y["default"],RopeToolManager:Q["default"],RotaToolManager:$["default"],SliceToolManager:et["default"],BodyUtil:ot["default"],JointUtil:st["default"],RayUtil:rt["default"],Vec2Util:lt["default"],DragEvent:ct["default"],EqumentEvent:pt["default"],Circle:ft["default"],Box:bt["default"],Gear:_t["default"],Platform:xt["default"],Ruler:kt["default"],Stonesg:Ot["default"],Egg:Ct["default"],Balance:St["default"],WeightBox:Lt["default"],FurredCeiling:It["default"],FurredCeilingB:jt["default"],IrregularPlasticplate:Rt["default"],TenLublock:Nt["default"],Hockcode:Ut["default"],Secondaryball:Vt["default"],SmallBall:Wt["default"],NbCar:qt["default"],VernierCaliper:Yt["default"],FreeFallMotion:Qt["default"],PhasePosition:$t["default"],TwoPendulum:ee["default"],SpringVibrator:oe["default"],ComTimerNew:se["default"],VerticalDrop:re["default"],SpiralMicrometer:le["default"],ConicalPendulum:ce["default"],SpringTension:pe["default"],WaterBeaker:fe["default"],Submarine:be["default"],LeverRule:_e["default"],JianXieYDY:xe["default"],Crownblockboard:ke["default"],CurvilinearMotion:Oe["default"],SmallDeformation:Ce["default"],MotionComposition:Se["default"],HorizontalMotion:Le["default"],CavendishBalance:Ie["default"],SpringSystem:je["default"],PingpaoExp:Re["default"],PascalToolNew:Ne["default"],Graduate:Ue["default"],OverflowCup:Ve["default"],LittlePail:We["default"],Torricelli:qe["default"],MomentumExp:Ye["default"],EnergyAndPotential:Qe["default"],HookWood:$e["default"],PullComp:ei["default"],LongBoard:oi["default"],WoodSlopesPlane:si["default"],GalileoExp:ri["default"],RollingPendulum:li["default"],Wave3Btn:ci["default"],ParallelogramRule:pi["default"],GouSpringBottom:fi["default"],VTickerTimer:bi["default"],HpaperTicker:_i["default"],HTickerTimer:xi["default"],VpaperTicker:ki["default"],NbDesk:Oi["default"],WoodPad:Ci["default"],PulleyLongBoard:Si["default"],LongBoardTM:Li["default"],TanJQLQY:Ii["default"],RopeView:ji["default"],PlatformBalance:Ri["default"],LeverDiao:Ni["default"],WaterBeakerSmall:Ui["default"],Galloon:Vi["default"],AirTrack:Wi["default"],SlideBlock:qi["default"],ForcedVibration:Yi["default"],GraduateBig:Qi["default"],ReagentBottle:$i["default"],DropperBottle:eo["default"],Bunker:oo["default"],ConnectingVessel:so["default"],Buoyancy:ro["default"],GravityEffect:lo["default"],FixedPulley:co["default"],Densimeter:yo["default"],CentripetalForce:go["default"],NewtonsCradle:vo["default"],ForceSynthesisAndDecomposition:mo["default"],WaterWaveInterference:wo["default"],BottleMicroDeformation:Po["default"],PistonPump:To["default"],TransverseWaveFormation:Bo["default"],Recoil:Mo["default"],WorkAndSpeed:Do["default"],NewtonSecondLaw:Eo["default"],InstantaneousVelocity:Ao["default"],VerifyMechanicalEnergy:Fo["default"],FreeFallingMovement:Ho["default"],SpringElasAndvarRelationship:Jo["default"],DynamicFrictionAndStaticFriction:Go["default"],FactorsAreRelatedFriction:Xo["default"],CrossTestLevel:zo["default"],PlumbLine:Ko["default"],WaxBlock:Zo["default"],PingPong:tn["default"],LiquidPressureDemonstrator:on["default"],AluminumBlock:sn["default"],SensorForce:rn["default"],SensorCollector:o(i(1088))["default"],DisplacementReceive:ln["default"],DisplacementLaunch:o(i(1083))["default"],SensorCar:o(i(1087))["default"],ShelterLight:o(i(1092))["default"],PhotoelectricGate:o(i(1085))["default"],SensorPressure:o(i(1091))["default"],SensorEnergy:o(i(1089))["default"],SensorBoard:o(i(1086))["default"],WingModel:o(i(1055))["default"]},e["default"]=s["default"]},,,,function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function u(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:u(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(451),l=function(t){return t&&t.__esModule?t:{"default":t}}(h);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.iscomponent=!1,i}return s(e,t),a(e,[{key:"setComponent",value:function(t){}},{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.isnbequ=!0}}]),e}(l["default"])},,,function(t,e,i){"use strict";e.__esModule=!0;var o={};o.BEGIN="bodyDragBegin",o.MOVE="bodyDragMove",o.END="bodyDragEnd",o.CLICK="bodyClick",e["default"]=o},,function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function k(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:k(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(560),c=o(u),d=i(487),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0,m=void 0,x=void 0,w=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=t.main?t.main.phy.nape:i.phy.nape,x=y.phys.BodyType,w=y.geom.Mat23,g=y.NbBody,f=y.NbCircle,b=y.geom.Vec2,v=y.shape.Polygon,_=y.shape.Circle,m=y.geom.GeomPoly,(i.napeEngine=t.moduleMain.napeEngine)?(i.CbTypeStr=t.moduleMain.CbTypeStr,i.BodyUtil=t.moduleMain.BodyUtil,i.Vec2Util=t.moduleMain.Vec2Util,i.JointUtil=t.moduleMain.JointUtil,i.NapeConst=t.moduleMain.NapeConst,i.ToolStatusStr=t.moduleMain.ToolStatusStr,i.InteractionFilterManager=t.moduleMain.InteractionFilterManager,i.RayUtil=t.moduleMain.RayUtil,i.NBOpticsStr=t.moduleMain.NBOpticsStr,i.cateid=5,i.level=15,i.isFreeMec=!1,i.isMechanics=!0,i.classType="MechanicsBase",i.material=new y.phys.Material(.3,.5,.6,2.7,.001),i.body=null,i.geomPoly=null,i.points=null,i._shape=null,i.radius=0,i._width=30,i._height=30,i.roteVec2=null,i.verticesArr=[],i._bodyType=x.get_DYNAMIC(),i.rotaAng=null,i.touchEnabled=!0,i.linstenerArr=[],i.space=i.napeEngine.space,i.openF_analysis=!1,i.istoolMove=!1,i.istool=!1,i.ismecJoint=!1,i.isOpendefRot=!0,i.limitForceDrag=!1,i.maxDragForce=1e5,i.dragFAry=[],i.nosetbodyxy=!1,i.useDragSetCurElec=!1,i.culprit=!1,i.translateRect=null,i.currentScale=new l.Point(1,1),i.lastScale=new l.Point(1,1),i.skinCon=new PIXI.Container,i.addChild(i.skinCon),i._selected=!1,i.transformN=new w,i.equlock=!1,i.updatecallback=null,i.alignAfterScale=!1,i.transformManager=null,i.selfDragManager=!1,i):s(i)}return a(e,t),r(e,[{key:"init",value:function(){this.createBody(),this.createShape(),this.napeEngine.space.add(this.body),this.rotaSP&&(this.rotaAng=new c["default"](this.paramObj,this,this._rotateHandleFunc)),this.setScale(this.currentScale.x,this.currentScale.y),this.setRotation(this.rotation)}},{key:"getGlobalScale",value:function(){return this.globalConfig.main.view.scale.x}},{key:"changeSelfSize",value:function(){}},{key:"addCbType",value:function(t){this.body.cbTypes.add(t)}},{key:"getSelected",value:function(){return this._selected}},{key:"setSelected",value:function(t){this._selected=t}},{key:"setScale",value:function(t,e){if(this.body){this.lastScale.x=this.currentScale.x,this.lastScale.y=this.currentScale.y,this.currentScale.x=t,this.currentScale.y=e;var i=this.getTransform();this.body.transformShapes(i),this.transformN=this.transformN.concat(i),this.alignAfterScale&&this.body.align(),this.BodyUtil.setMaterial(this.material,"density",this.material.get_density())}else this.currentScale.x=t,this.currentScale.y=e}},{key:"setLocalScale",value:function(t,e){var i=w.scale(t,e),o=i;this.body.transformShapes(o),this.transformN=this.transformN.concat(o),o=this.transformN,this.lastScale.x=this.currentScale.x,this.lastScale.y=this.currentScale.y,this.currentScale.x=Math.sqrt(o.get_a()*o.get_a()+o.get_b()*o.get_b()),this.currentScale.y=Math.sqrt(o.get_c()*o.get_c()+o.get_d()*o.get_d()),this.BodyUtil.setMaterial(this.material,"density",this.material.get_density())}},{key:"getTransform",value:function(){var t=w.rotation(-this.body.rotation);return w.rotation(this.body.rotation).concat(w.scale(this.currentScale.x/this.lastScale.x,this.currentScale.y/this.lastScale.y).concat(t))}},{key:"setRotation",value:function(t){if(this.roteVec2){var e=t-this.body.rotation;this.body.rotate(this.body.localPointToWorld(this.roteVec2),e)}else this.rotation=t,this.body&&(this.body.rotation=t)}},{key:"getRotation",value:function(){return this.body.rotation}},{key:"resetUserView",value:function(t,e,i,o){this.body.userData.view=t,o&&(this.body.userData.classType=o),e&&(this.body.userData.coordinateField=e),!0===i&&(this.body.userData.bindupdate={func:this.update,field:this})}},{key:"addBodyToSpace",value:function(t,e,i){e&&(t.userData.coordinateField=e),i&&t.userData.view&&(t.userData.bindupdate={func:t.userData.view.update,field:t.userData.view}),t.set_space(this.napeEngine.space)}},{key:"removeBodyFromSpace",value:function(t){t&&t.set_space(null)}},{key:"added",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.cannotSystemDrag=!0,this.init(),this.parent.addChild(this.componentBox)}},{key:"_this_stopDrag",value:function(t){}},{key:"_addRotateControl",value:function(){}},{key:"findRotaShape",value:function(t){var e=this.body.get_shapes(),i=e.get_length(),o=void 0;for(o=0;i>o;o++){var n=e.at(o);if(n.get_userData().isRotation&&n.contains(b.weak(t.x,t.y)))return!0}return!1}},{key:"addOneRoteShape",value:function(t,e,i){var o=new f(i);return this.body.add(o),o.get_userData().isRotation=!0,o.translate(b.weak(t,e)),o.set_sensorEnabled(!0),o}},{key:"_rotateHandleFunc",value:function(t,e,i){if(this.componentBox.rotation=e,this.body.rotation=e,null===t&&this.rotaChange(),this.canShowAngleShape&&i){var o=this.toGlobalView(new l.Point(0,0),this),n=this.componentBox.rotation,s=this.globalConfig.main.arcShape;s.clear(),s.lineStyle(2,this.globalConfig.DEFAULT_TXT_COLOR,.5),s.drawCircle(o.x,o.y,150),s.beginFill(16711935,.2),s.lineStyle(1,16777215,0);var a=i,r=l.M.getPointLen(a,this._cenP);n%=2*Math.PI;var h=n;s.moveTo(o.x,o.y),s.arc(o.x,o.y,r,0,h,!0),s.endFill(),this.freshAngleTxt(),this._oriA=h}}},{key:"rotateA",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rotateA",this).call(this,t),this.body.rotation=this.componentBox.rotation}},{key:"freshAngleTxt",value:function(){var t=l.M.toAngle(this.componentBox.rotation);t%=360,t*=-1,0>t&&(t+=360),this.globalConfig.main.arcTxt.text=l.M.getNumJie(t,1)+"°",this.globalConfig.main.arcTxt.style.fill=l.M.getDomColor(this.globalConfig.DEFAULT_TXT_COLOR),this.globalConfig.main.arcTxt.updateText()}},{key:"startDragRect",value:function(t,i){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"startDragRect",this).call(this),!t&&this.canShowAngleShape){this._cenP=this.toGlobalView(new l.Point(0,0),this),this._startDragAngle=this.componentBox.rotation+Math.PI/2,this._addAngle=0,this._oriA=this._startDragAngle,this.globalConfig.main.arcTxt.visible=!0,this.freshAngleTxt(),l.M.setSPPoint(this.globalConfig.main.arcTxt,this._cenP)}else if(t&&this.canShowAngleShape){var o=new l.Point(this.body.posx,this.body.posy);this._cenP=o,this._startDragAngle=this.body.get_rotation(),this._addAngle=0,this.globalConfig.main.arcTxt.visible=!0,this.freshAngleTxt(),l.M.setSPPoint(this.globalConfig.main.arcTxt,this._cenP)}}},{key:"endDragRect",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"endDragRect",this).call(this),this.globalConfig.main.arcShape.clear(),this.globalConfig.main.arcTxt.visible=!1}},{key:"rotaChange",value:function(){}},{key:"removed",value:function(){this.getSelected()&&this.setSelected(!1),this.transformManager=null,this.removeForceAnalysis(),this.deleteMapeUid(this.UID),this.rotaAng&&(this.rotaAng.dispose(),this.rotaAng=null);var t=void 0;for(t=0;this.linstenerArr.length>t;t++)this.removeNapeListeners(this.linstenerArr[t]);this.linstenerArr.length=0,this.componentBox&&this.componentBox.parent&&this.componentBox.parent.removeChild(this.componentBox),this.componentBox=null,this.body&&(this.body.cbTypes.clear(),this.BodyUtil.destoryBody(this.body),this.body=null),delete this.cateid,this.material=null,this._shape=null,this.napeEngine=null,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){this.openF_analysis&&this.drawForceAnalysis(),this.updatecallback&&this.updatecallback(),this.updatePosition()}},{key:"getTopGrc",value:function(){return this.napeEngine?this.napeEngine.grC:null}},{key:"removeForceAnalysis",value:function(){var t=this.getTopGrc();t&&t.dispatchEvent("Dispose_Graphics",this.UID)}},{key:"drawForceAnalysis",value:function(t){var e=[];t||(t=this.body),e.push({option:"Force",target:t}),this.getTopGrc().dispatchEvent("Start_Graphic",e,this.UID)}},{key:"drawForceArrow",value:function(t){var e=[{option:"ForceArrow",data:t}];this.getTopGrc().dispatchEvent("Start_Graphic",e,this.UID)}},{key:"touchManager",value:function(t){this.touchEnabled&&t&&t.target.UID===this.UID&&this.refreshDragRectXY()}},{key:"refreshDragRectXY",value:function(){this.componentBox.x=this.x,this.componentBox.y=this.y}},{key:"createBody",value:function(){this.body=new g(x.get_DYNAMIC()),this.body.userData.view=this,this.body.userData.classType=this.classType,this.body.posx=this.x,this.body.posy=this.y,this.bindUidToBody(this.body,this.UID)}},{key:"removeFromFramework",value:function(t){this.body.isdestory=!0,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removeFromFramework",this).call(this,t)}},{key:"bodyErrCallBack",value:function(){this instanceof nb.mec.base.FluidBase?this.parent.removeFromFramework(this):this.removeFromFramework(this)}},{key:"inWaterUpdate",value:function(t,e){this.BodyUtil.dampingBodyVelocity(this.body,1,e.getCoefficientViscosity())}},{key:"createShape",value:function(){var t=this;if(this.verticesArr&&0<this.verticesArr.length)for(var e=0;this.verticesArr.length>e;e++){var i=this.verticesArr[e];t.body.add(new v(new m(i),t.material))}else{if(null!==this.geomPoly)return void this.body.add(new v(this.geomPoly,this.material));if(this.points&&this.points.length>1){for(var o=new y.geom.Vec2List,n=0;this.points.length>n;n++){var s=this.points[n];o.push(b.get(s.x,s.y))}var a=new v(o,this.material),r=""+a.validity();if("VALID"!==r){if("DEGENERATE"===r)return;var h=new m(o);if(h.isDegenerate())return;var l=null;try{l=h.simpleDecomposition()}catch(c){return}var u=new y.geom.GeomPolyList;l.foreach(function(t){u.merge(t.convexDecomposition())});return void u.foreach(function(e){t.body.add(new v(e,t.material))})}this._shape=a}else this._shape=0!==this.radius?new _(this.radius,null,this.material):new v(y.shape.Polygon.box(this._width,this._height),this.material);this.body.add(this._shape)}}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.ismecJoint=this.ismecJoint,t.isMechanics=this.isMechanics,t.thisX=this.x,t.thisY=this.y,t.fromEquTools=this.fromEquTools,t.uid=this.UID,t.material=this.getMaterialData(),t.transform={a:this.transformN.get_a(),b:this.transformN.get_b(),c:this.transformN.get_c(),d:this.transformN.get_d(),tx:this.transformN.get_tx(),ty:this.transformN.get_ty()},t.currentScale=this.currentScale,this.body&&(t.posx=this.body.posx,t.posy=this.body.posy,t.rotation=l.M.getValidHu(this.body.rotation)),t}},{key:"getMaterialData",value:function(){var t={};return this.material&&(t.density=this.material.get_density(),t.elasticity=this.material.get_elasticity(),t.dynamicFriction=this.material.get_dynamicFriction(),t.staticFriction=this.material.get_staticFriction(),t.rollingFriction=this.material.get_rollingFriction()),t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.uid&&(this.bindUidToBody(this.body,this.UID,t.uid),this.UID=t.uid),this.body&&t.hasOwnProperty("posx")&&!this.nosetbodyxy&&(this.body.posx=t.posx,this.body.posy=t.posy),this.body.rotation=t.rotation,this.material&&t.material&&this.BodyUtil.setMaterialFromObject(this.material,t.material),t.currentScale&&(this.currentScale.x=t.currentScale.x,this.currentScale.y=t.currentScale.y),t.transform&&(this.transformN=new w(t.transform.a,t.transform.b,t.transform.c,t.transform.d,t.transform.tx,t.transform.ty))}},{key:"getScaleDragRect",value:function(){var t=this.body.get_bounds(),e=this.body.get_position();return new PIXI.Rectangle(t.get_x()-e.get_x(),t.get_y()-e.get_y(),t.get_width(),t.get_height())}},{key:"getDragRect",value:function(){return{x:.5*-this.bg.width,y:.5*-this.bg.height,width:this.bg.width,height:this.bg.height}}},{key:"addNapeListeners",value:function(t){return this.linstenerArr.push(t),this.napeEngine.space.listeners.add(t)}},{key:"removeNapeListeners",value:function(t,e){if(t){var i=this.linstenerArr.indexOf(t);return i>-1&&this.linstenerArr.splice(i,1),this.napeEngine.space.listeners.remove(t)}}},{key:"getWorldBody",value:function(){return this.napeEngine.space.world}},{key:"getEngineTouchManager",value:function(){return this.napeEngine.getTouchManager()}},{key:"groupManager",value:function(){return this.napeEngine.groupManager()}},{key:"getGravity",value:function(){return this.napeEngine.getGravity()}},{key:"getForce",value:function(t){return t/this.NapeConst.FORCE_RATIO}},{key:"getBodyElasticity",value:function(){return this.material.zpp_inner.elasticity}},{key:"getBodyDensity",value:function(){return 1e3*this.material.zpp_inner.density}},{key:"getDynamicFriction",value:function(){return this.material.zpp_inner.dynamicFriction}},{key:"func_testDraw",value:function(t,e){this.getTopGrc().testDraw(t,e)}},{key:"getBodyFromUid",value:function(t){return this.napeEngine.uidMap[t]}},{key:"deleteMapeUid",value:function(t){this.napeEngine&&this.napeEngine.uidMap&&delete this.napeEngine.uidMap[t]}},{key:"bindUidToBody",value:function(t,e,i){this.napeEngine&&(this.napeEngine.uidMap[e]&&delete this.napeEngine.uidMap[e],i?this.napeEngine.uidMap[i]=t:this.napeEngine.uidMap[e]=t)}},{key:"systemPlayStatus",value:function(){return this.napeEngine.play}},{key:"changeLock",value:function(t){this.equlock=t.checked,this.equlock?(this.body.set_type(x.get_KINEMATIC()),this.BodyUtil.frezzBody(this.body)):this.body.set_type(x.get_DYNAMIC())}},{key:"removeDragManager",value:function(){var t=void 0;this.body&&this.body.userData&&(t=this.body.userData.dragManager),t&&t.func_touchEnd(new PIXI.Point)}},{key:"getLocalBoundsElecs",value:function(){return[this]}},{key:"addTweenQuan",value:function(t){var e=this.main;t.showHitCircle=function(){e.view.tipTopLayer.mec_showHitCircle.call(e.view.tipTopLayer,this)}.bind(t),t.hideHitCircle=function(){e.view.tipTopLayer.mec_hideHitCircle.call(e.view.tipTopLayer,this)}.bind(t)}},{key:"dragToolBegin",value:function(t){}},{key:"dragToolMove",value:function(t){}},{key:"dragToolEnd",value:function(t){}},{key:"checkDrag",value:function(t){return!0}}]),e}(p["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var n=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),s=i(1),a=void 0,r=void 0;e["default"]=function(){function t(e){o(this,t),this.config=e,this.globalConfig=e.globalConfig,this.BodyUtil=e.moduleMain.BodyUtil,this.Vec2Util=e.moduleMain.Vec2Util,this.JointUtil=e.moduleMain.JointUtil,this.NapeConst=e.moduleMain.NapeConst,this.napeEngine=e.moduleMain.napeEngine,this.NBCommand=e.NBCommand,a=e.moduleMain.phy.nape,r=a.geom.Vec2,this.space=null,this.UID=null,this.touchUid=null,this.main=e.moduleMain.main,this.canvas=e.moduleMain.main.canvas,this.stage=e.moduleMain.main.stage,this.view=e.moduleMain.main.view,this.var_vo={},this.superObj={},this.active=!1}return n(t,[{key:"setActive",value:function(t){this.active=t}},{key:"adsorbToCom",value:function(t,e,i){var o=this.getGlobalScale(),n=t.get_worldCOM(),a=s.Point.vec2ToPoint(n);i/o>s.Point.distance(a,e)&&(e.x=a.x,e.y=a.y)}},{key:"dispose",value:function(){this.main=null,this.stage=null,this.config=null,this.space=null,this.canvas=null,this.globalConfig=null,this.BodyUtil=null,this.Vec2Util=null,this.JointUtil=null,this.NapeConst=null,this.napeEngine=null,this.NBCommand=null}},{key:"init",value:function(t,e){this.space=e,this.canvas=t}},{key:"setBodyStatus",value:function(t,e){t.statusMap||(t.statusMap=[]),t.statusMap.push(this.BodyUtil.getBodyStatus(t)),this.BodyUtil.setBodyStatus(t,e)}},{key:"restoreBodyStatus",value:function(t){if(t&&t.statusMap&&0!==t.statusMap.length)for(;t.statusMap.length;){var e=t.statusMap.pop();this.BodyUtil.setBodyStatus(t,e)}}},{key:"func_getP",value:function(t){var e=new s.Point(0,0);return this.globalConfig.main.mapPositionToPoint(e,t.clientX,t.clientY),e=this.view.toLocal(e,this.stage)}},{key:"onDomClick",value:function(t){}},{key:"stateChange",value:function(){}},{key:"initScale",value:function(t){var e=2/this.getGlobalScale();t.setScale(e,e)}},{key:"func_touchBegin",value:function(t){var e=t,i=this.space.bodiesUnderPoint(new r(e.x,e.y));i.filter(function(t){return!t.userData||!t.userData.isnbequ});var o=this.BodyUtil.getTopBodyFormBodyList(i);this.var_vo={},this.var_vo.beginBody=o,this.var_vo.beginVec2=this.Vec2Util.pointToVec2(e)}},{key:"func_touchMove",value:function(t){}},{key:"func_touchEnd",value:function(t,e){}},{key:"touchTab",value:function(t){}},{key:"doubleTab",value:function(t){}},{key:"getTopBodyUnderPoint",value:function(t){return this.BodyUtil.getTopBodyFormBodyList(this.space.bodiesUnderPoint(this.Vec2Util.pointToVec2(t)))}},{key:"getGlobalScale",value:function(){return this.globalConfig.main.view.scale.x}},{key:"addEquipmentChild",value:function(t,e){this.globalConfig.main.addEquipmentChild(t,e)}},{key:"func_dispose",value:function(){this.napeEngine.grC.dispatchEvent("Dispose_Graphics",this.UID),this.UID=null}},{key:"func_dispatchGraphic",value:function(t){null===this.UID&&(this.UID=s.M.getUniqueID()),this.napeEngine.grC.dispatchEvent("Start_Graphic",t,this.UID)}},{key:"cancelMecSelected",value:function(t){var e=this.BodyUtil.getSelectBodyUnderPoint(this.space,t);if(e){e.userData.view.setSelected(!1)}}}]),t}()},,function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var n=function s(){o(this,s)};n.OVERFLOW_WATER="overflow_water",n.NEI_BU_LINEJOINT_BREAK="neiBuLineJointBreak",n.WORLD_TIME_CHANGE="worldTimeChange",n.WORLD_UPDATE="world_update",n.TICKER_PAPER_MENU_CHANGE="ticker_paper_menu_change",n.TICKER_PAPER_AUTOMATIC_BREAK="ticker_paper_automatic_Break",n.TICKER_POWER_CHANGE="ticker_power_change",n.SCALE_BIG_PAPER="scale_big_paper",n.CAN_GET_SPEEDDATA="can_get_speedData",n.SET_BODY_STATE="set_body_state",e["default"]=n},,,,function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),a=i(50),r=o(a),h=i(472),l=o(h),u=void 0,c=function(){function t(e){n(this,t),this.config=Object.assign({},e),this.config.moduleMain=this,u=this,this.moduleType=-1,this.active=!1,this.hasInit=!1,this.cachePool=new l["default"],this.looplist=[]}return s(t,[{key:"getModuleType",value:function(){return this.constructor.MODULE_TYPE}},{key:"init",value:function(){this.hasInit=!0}},{key:"addPhysicsCanvasListeners",value:function(){var t=this.config.main;this.onRemoveEquipmentProx||(this.onRemoveEquipmentProx=this.onRemoveEquipment.bind(this),this.onCanvasDomClickProx=this.onCanvasDomClick.bind(this),this.onSetDataCompleteProx=this.onSetDataComplete.bind(this)),t.addEventListener(r["default"].REMOVE_EQUIPMENT,this.onRemoveEquipmentProx),t.addEventListener(r["default"].CANVAS_DOM_CLICK,this.onCanvasDomClickProx),t.addEventListener(r["default"].SET_DATA_COMPLETE,this.onSetDataCompleteProx)}},{key:"removePhysicsCanvasListeners",value:function(){var t=this.config.main;t.removeEventListener(r["default"].REMOVE_EQUIPMENT,this.onRemoveEquipmentProx),t.removeEventListener(r["default"].CANVAS_DOM_CLICK,this.onCanvasDomClickProx),t.removeEventListener(r["default"].SET_DATA_COMPLETE,this.onSetDataCompleteProx)}},{key:"canvasLock",value:function(t){}},{key:"onRemoveEquipment",value:function(){}},{key:"onCanvasDomClick",value:function(t){}},{key:"onSetDataComplete",value:function(){}},{key:"onShowAllEquip",value:function(){}},{key:"setActive",value:function(t){this.active=t,8===this.moduleType?t?(PIXI.settings.RESOLUTION=1,this.forceAndMotion.resize()):PIXI.settings.RESOLUTION=this.globalConfig.RESOLUTION:PIXI.settings.RESOLUTION!==this.globalConfig.RESOLUTION&&(PIXI.settings.RESOLUTION=this.globalConfig.RESOLUTION),t?this.addPhysicsCanvasListeners():this.removePhysicsCanvasListeners()}},{key:"enterModule",value:function(t){return Promise.resolve()}},{key:"destroy",value:function(){this.removePhysicsCanvasListeners(),this.config.moduleMain=null,this.config=null,this.onRemoveEquipmentProx=null,this.onCanvasDomClickProx=null,this.onSetDataCompleteProx=null,this.hasInit=null,this.active=null}},{key:"updateEqu",value:function(){for(var t=this.main.getEquipmentArr(!0),e=0;t.length>e;e++){var i=t[e];if(i.update)try{i.update()}catch(o){}}}},{key:"getData",value:function(){return{}}},{key:"setData",value:function(t){}},{key:"startRecoverEqu",value:function(){}},{key:"completeRecoverEqu",value:function(){}},{key:"setDataBefore",value:function(){return Promise.resolve()}},{key:"requestAnimationLoop",value:function(){this.updateEqu(),this.main&&this.main.disComp&&this.main.disComp.update(),this.foreachLooplist()}},{key:"foreachLooplist",value:function(){for(var t=0;this.looplist.length>t;t++){var e=this.looplist[t];e.update&&e.update()}}},{key:"main",get:function(){return this.config?this.config.main:null}},{key:"equipmentUtil",get:function(){return this.main.equipmentUtil}},{key:"globalConfig",get:function(){return this.main.globalConfig}},{key:"language",get:function(){return this.main.language}},{key:"SoundTool",get:function(){return this.main.globalConfig.SoundTool}},{key:"phy",get:function(){return this.main.phy}},{key:"ParticleUtil",get:function(){return this.config.ParticleUtil}},{key:"SoundStr",get:function(){return this.config.SoundStr}},{key:"Button",get:function(){return this.config.Button}},{key:"HoverButton",get:function(){return this.config.HoverButton}},{key:"ComponentProperty",get:function(){return this.config.ComponentProperty}},{key:"NBCommand",get:function(){return this.config.NBCommand}},{key:"MouseManager",get:function(){return this.config.MouseManager}},{key:"NBDrag",get:function(){return this.config.NBDrag}},{key:"UploadSkinTool",get:function(){return this.config.UploadSkinTool}},{key:"NBEvent",get:function(){return this.config.NBEvent}}],[{key:"getInstance",value:function(){return u}}]),t}();window.each=function(t,e,i){var o=void 0;for(o=0;t&&t.length>o;o++){if(!1===(i?e.call(i,o,t[o]):e.call(t[o],o,t[o])))break}},e["default"]=c},,,,,function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var n=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();e["default"]=function(){function t(e,i,n){o(this,t),this.var_canReflection=null==e||e,this.var_canRefraction=null==i||i,this.n=null==n?1:n,this.rate=n,this.var_whiteNotReflect=!1,this.var_constantLight=!1,this.var_copyReflection=this.var_canReflection,this.var_guangdao=!1,this.var_gdtopbton="top",this.var_open_angle=!0,this.var_show_reflect=!0,this.var_show_direction=!0,this.sensor=!1,this.sensorObj={},this.bodyIsMultiShape=!1,this.multiN=!1,this.view=null,this.id=-1}return n(t,[{key:"clone",value:function(){var e=new t;for(var i in this)e[i]=this[i];return e}}]),t}()},,,,,,,,function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function p(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:p(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(541),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0;e["default"]=function(t){function e(t,i,s){o(this,e);var a=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=t.moduleMain.phy.nape,d=c.geom.Vec2,a.classname="PolygonView",a.verticesArr=i||[],s&&(a.skinColor=s),a.bg=a,a.skinGra=null,a.drawTest=new PIXI.Graphics,a.alignAfterScale=!0,a}return s(e,t),a(e,[{key:"fixReset",value:function(t){var e={x:this.body.posx,y:this.body.posy};this.body.align();var i=this.body.position;t?t():(this.bg.x-=i.get_x()-e.x,this.bg.y-=i.get_y()-e.y)}},{key:"setScale",value:function(t,i){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setScale",this).call(this,t,i),this.skinCon.scale.x=1,this.skinCon.scale.y=1,this.changeSkin()}},{key:"setLocalScale",value:function(t,i){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setLocalScale",this).call(this,t,i),this.skinCon.scale.x=1,this.skinCon.scale.y=1,this.changeSkin()}},{key:"offsetXY",value:function(){return{x:this.bg.x,y:this.bg.y}}},{key:"getFillSkin",value:function(){var t=new PIXI.Graphics;this.skinGra=t;for(var e=this.body.shapes,i=e.get_length(),o=0;i>o;o++){var n=e.at(o),s=n.get_localVerts();t.lineStyle(1,this.skinColor,1),t.beginFill(this.skinColor,1);for(var a=s.get_length(),r=0;a>r;r++){var h=s.at(r),l=h.get_x(),u=h.get_y();0===r?t.moveTo(l,u):t.lineTo(l,u)}t.endFill()}return t}},{key:"getTextureSkin",value:function(t){var e=new PIXI.Container;return this.body.shapes.foreach(function(i){var o=[];i.get_localVerts().foreach(function(t){var e=t.get_x(),i=t.get_y();o.push(new h.Point(e,i))});var n=new h.GraphicsTexture(t,h.GraphicsTexture.POLYGON,{points:o,notlight:!0});e.addChild(n)}),e}},{key:"getEdge",value:function(){var t=this.Vec2Util.getBodyEdge(this.body),i=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getEdge",this).call(this);if(i.lineStyle(this.lineThin,this.lineColor,1),t.compound)for(var o=t.list,n=0;o.length>n;n++){var s=o[n],a=s.v1,h=s.v2;a=this.body.worldPointToLocal(a),h=this.body.worldPointToLocal(h),i.moveTo(a.get_x(),a.get_y()),i.lineTo(h.get_x(),h.get_y())}else for(var l=void 0,u=void 0,c=t.get_length(),d=0;c>d;d++){var p=t.at(d);p=this.body.worldPointToLocal(p),0===d?(l=p.get_x(),u=p.get_y(),i.moveTo(l,u)):i.lineTo(p.get_x(),p.get_y()),d===c-1&&i.lineTo(l,u)}return i}},{key:"drawFunc",value:function(t,e,i){this.drawTest.beginFill(i),this.drawTest.drawCircle(t,e,5),this.drawTest.endFill(),this.addChild(this.drawTest)}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.verticesArr=this.Vec2Util.vec2ArrArrToPointArrArr(this.verticesArr),t.bgxy={x:this.bg.x,y:this.bg.y},t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.verticesArr&&(this.verticesArr=this.Vec2Util.pointArrArrToVec2ArrArr(t.verticesArr)),this.body.shapes.clear(),this.createShape(),this.body.align(),this.body.transformShapes(this.transformN),this.changeSkin()}},{key:"sliceSetData",value:function(t){var e=this;t.material&&this.BodyUtil.setMaterialFromObject(this.material,t.material),this.skinIndex=t.skinIndex,this.skinColor=t.skinColor,this.skinType=t.skinType,isNaN(t.skinIndex)||(this.skinName=this.originlist[this.skinIndex]),this.groupIndex=t.groupIndex,this.body.align();for(var i=this.verticesArr.length,o=0;i>o;o++)for(var n=this.verticesArr[o],s=n.length,a=0;s>a;a++){var r=n[a];n[a]=this.body.worldPointToLocal(r)}this.changeSkin(),t.lightprototype&&setTimeout(function(){e.hadDestory||(e.vo.n=t.rateN,e.lightprototype=t.lightprototype,e.gotoOpticsMc())},10),setTimeout(function(){e.hadDestory||e.changeGroup({showValue:e.groupMap[e.groupIndex]})},0)}},{key:"selectRenderChild",value:function(){this.updateTransform();var t=this.body.get_bounds(),e=this.getMain().view.toGlobal({x:t.get_x(),y:t.get_y()}),i=this.getBounds();i.x=e.x,i.y=e.y;var o=this.getGlobalScale();return i.width=t.get_width()*o,i.height=t.get_height()*o,i}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var n=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();e["default"]=function(){function t(){o(this,t),this.graphicsList=[],this.textList=[],this.elecWiredots=[],this.threeList={}}return n(t,[{key:"disposeAll",value:function(){this.graphicsList.length=0,this.textList.length=0,this.elecWiredots.length=0;for(var t=Object.keys(this.threeList),e=0;t.length>e;e++)for(var i=this.threeList[t[e]],o=0;i.length>o;o++)try{var n=i[o];n.removed&&n.removed()}catch(s){}this.threeList={}}},{key:"resetAll",value:function(t){t.x=0,t.y=0,t.pivot.x=0,t.pivot.y=0,t.scale.x=1,t.scale.y=1,t.rotation=0}},{key:"pushGraphic",value:function(t){t.clear(),this.resetAll(t),this.graphicsList.push(t)}},{key:"popGraphic",value:function(){var t=this.graphicsList.pop();return t&&t.transform||(t=new PIXI.Graphics),t}},{key:"pushText",value:function(t){t.text="",this.resetAll(t),this.textList.push(t)}},{key:"popText",value:function(t,e){var i=this.textList.pop();return i||(t=t||"",e=e||"",i=new PIXI.Text(t,e)),i}},{key:"pushElecDot",value:function(t){this.elecWiredots.push(t)}},{key:"popElecDot",value:function(){return this.elecWiredots.pop()}},{key:"pushThreeClass",value:function(t,e){var i=this.threeList[t];i||(i=[],this.threeList[t]=i),this.resetAll(e),i.push(e)}},{key:"popThreeClass",value:function(t,e,i){var o=this.threeList[t],n=null;return o&&(n=o.pop()),n||(n=new e(i)),n}}]),t}()},,function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var n=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();e["default"]=new(function(){function t(){o(this,t),this.index=0,this.colorArr=[15684432,15753874,12144851,8280002,5467646,240116,5227511,1960374,7697781,12531212,16088855,16758605,16771899,11730777,6610199,4431943],this.totalColors=this.colorArr.length}return n(t,[{key:"getColor",value:function(){return this.index+=1,this.totalColors>this.index||(this.index-=this.totalColors),this.colorArr[this.index]}}]),t}())},,,,,,,,,,,,,function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function u(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:u(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(226),l=function(t){return t&&t.__esModule?t:{"default":t}}(h);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.useBottom=!1,i.useTop=!1,i.bottomCon=null,i.topCon=null,i.pinP={x:0,y:0},i}return s(e,t),a(e,[{key:"added",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.useBottom&&(this.bottomCon=this._addCon(this.main.view.viewBottomStack)),this.useTop&&(this.topCon=this._addCon(this.main.view.viewTopStack)),this.updatePosition()}},{key:"removed",value:function(){this._removeCon(this.bottomCon),this._removeCon(this.topCon),this.bottomCon=null,this.topCon=null,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"updatePosition",value:function(){this.getPinView();var t=this.pinP,e=this.getRotInView();this.bottomCon&&(this.bottomCon.x=t.x,this.bottomCon.y=t.y,this.bottomCon.rotation=e),this.topCon&&(this.topCon.x=t.x,this.topCon.y=t.y,this.topCon.rotation=e)}},{key:"getRotInView",value:function(){return this.rotation}},{key:"getPinView",value:function(){this.pinP.x=this.x,this.pinP.y=this.y}},{key:"moveEnd",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"moveEnd",this).call(this,t),this.updatePosition()}},{key:"_addCon",value:function(t){var e=new PIXI.Container;return t.addChild(e),e.interactive=!1,e.interactiveChildren=!1,e}},{key:"_removeCon",value:function(t){t&&t.parent&&t.parent.removeChild(t)}}]),e}(l["default"])},,function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function k(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:k(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(49),u=i(1),c=i(226),d=o(c),p=i(452),y=o(p),f=i(228),g=o(f),b=void 0,v=void 0,_=void 0,m=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.SCALE_NORMAL=e.SCALE_NORMAL,i.SCALE_ONLY_X=e.SCALE_ONLY_X,i.SCALE_ONLY_Y=e.SCALE_ONLY_Y,i.SCALE_UNIFORM=e.SCALE_UNIFORM,i.MouseManager=t.MouseManager,b=t.main.phy.nape,v=b.geom.Vec2,_=b.phys.GravMassMode,i.globalConfig=t.globalConfig,i.freeMec=null,i.body=null,i.handleBox=new x(t),i.active=!1,i}return a(e,t),r(e,[{key:"dispose",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"dispose",this).call(this)}},{key:"setRotateEnabled",value:function(t){this.handleBox&&this.handleBox.setRotateEnabled(t)}},{key:"setScaleMode",value:function(t){if(this.handleBox)switch(t){case e.SCALE_NORMAL:this.handleBox.showHandles(),this.handleBox.uniform=!1;break;case e.SCALE_ONLY_X:this.handleBox.hideHandles(),this.handleBox.showHandlesX();break;case e.SCALE_ONLY_Y:this.handleBox.hideHandles(),this.handleBox.showHandlesY();break;case e.SCALE_UNIFORM:this.handleBox.hideHandles(),this.handleBox.showHandlesCorner(),this.handleBox.uniform=!0}}},{key:"show",value:function(t,i){var o=this;this.freeMec&&this.freeMec!==t&&this.freeMec.setSelected(!1),this.freeMec=t,this.body=t.body,this.callback=i,t&&(t.updatecallback=function(){o.render()}),t.transformManager=this,this.handleBox.setRotation(this.body.rotation);var n=this.freeMec.getDragRect();this.handleBox.initBoundBox(n.x,n.y,n.width,n.height),this.lastScaleX=1,this.lastScaleY=1,this.handleBox.x=this.freeMec.x,this.handleBox.y=this.freeMec.y,this.handleBox.displayScale=2/this.getGlobalScale(),this.originScale=new u.Point(this.freeMec.currentScale.x,this.freeMec.currentScale.y),this.handleBox.listen(!0),this.handleBox.callBackObj=this,this.BodyUtil.frezzBody(this.body),!t||t.isOpticsEqu||t.isMechaTool||this.setBodyStatus(this.body,0);var s=[];s.push({option:"addElement",target:this.handleBox,params:{x:0,y:0}}),this.func_dispatchGraphic(s),this.handleBox.parent=this.globalConfig.main.viewStack,this.setScaleMode(e.SCALE_NORMAL),this.setRotateEnabled(!0),this.freeMec.body.set_gravMass(0),this.handleBox.scaleing=!1,this.active=!0,this.handleBox.setRotation(this.body.rotation)}},{key:"render",value:function(){if(this.active&&!this.handleBox.scaleing){if(this.freeMec.hadDestory)return void this.hide();var t=this.freeMec.getDragRect();this.handleBox.initBoundBox(t.x,t.y,t.width,t.height),this.lastScaleX=1,this.lastScaleY=1,this.handleBox.x=this.freeMec.x,this.handleBox.y=this.freeMec.y,this.originScale=new u.Point(this.freeMec.currentScale.x,this.freeMec.currentScale.y),this.handleBox.displayScale=2/this.getGlobalScale()}}},{key:"hide",value:function(){if(this.body&&this.body.set_gravMassMode(_.get_DEFAULT()),this.handleBox){if(this.active=!1,this.handleBox.listen(!1),this.func_dispose(),this.handleBox.parent&&this.handleBox.parent.removeChild(this.handleBox),this.freeMec){this.body&&!this.freeMec.isOpticsEqu&&this.restoreBodyStatus(this.body);var t=this.freeMec;this.freeMec=null,t.updatecallback=null,t.transformManager=null,t.setSelected(!1)}this.boStatus=null,this.body=null,this.handleBox.callBackObj=null}}},{key:"changeCallBack",value:function(t){if(t.end){this.globalConfig.main.execute(this.NBCommand.interactive.MOUSE_CURSOR_ENABLED,{code:0,obj:null});for(var e=this.body.constraints,i=0;i<e.get_length();i++){var o=e.at(i),n=o.userData.toolView;n&&(n.bodyChanged?n.bodyChanged(this.body):this.body.contains(v.get(n.x,n.y))||n.removeFromFramework(n))}}else{if(t.scale){this.freeMec.setLocalScale(t.scale.x/this.lastScaleX,t.scale.y/this.lastScaleY),this.lastScaleX=t.scale.x,this.lastScaleY=t.scale.y;var s=this.handleBox.getGlobalCentroidP();this.freeMec.body.set_position(v.get(s.x,s.y)),this.BodyUtil.frezzBody(this.freeMec.body)}t.rotation&&this.freeMec.setRotation(t.rotation),this.callback&&this.callback.call(this.freeMec,{bounds:this.getSkinBounds(),rot:t.rotation})}}},{key:"getSkinBounds",value:function(){var t=this.freeMec.skinCon.getLocalBounds();return t.x*=this.freeMec.skinCon.scale.x,t.width*=this.freeMec.skinCon.scale.x,t.y*=this.freeMec.skinCon.scale.y,t.height*=this.freeMec.skinCon.scale.y,t}}]),e}(y["default"]);m.SCALE_NORMAL=1,m.SCALE_ONLY_X=2,m.SCALE_ONLY_Y=3,m.SCALE_UNIFORM=4,e["default"]=m;var x=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));i.scaleing=!1,i.globalConfig=t.globalConfig,i.container=new PIXI.Container,i.addChild(i.container),i.lineColor=5198164,i.lineThin=2,i.hh=50,i.minW=10,i.maxW=1e5,i.minH=10,i.maxH=1e5,i.lockCenter=!0,i.graphics=new PIXI.Graphics,i.container.addChild(i.graphics),i.handle=g["default"].createBtn(["skin/operate_icon_turn_default","skin/operate_icon_turn_pre"]),i.handle.name="rot",i.handle.cursorType="rotate",i.handle.cursorRotation=0,i.handle.flipRotation=0,i.handle.oppositeName="",i.p0=new w("t","shangxia",90,0,"b"),i.p1=new w("r","zuoyou",0,0,"l"),i.p2=new w("b","shangxia",-90,0,"t"),i.p3=new w("l","zuoyou",180,0,"r"),i.p4=new w("tl","qingxie",-135,-90,"br"),i.p5=new w("tr","qingxie",-45,90,"bl"),i.p6=new w("br","qingxie",45,-90,"tl"),i.p7=new w("bl","qingxie",135,90,"tr"),i._handles=[i.handle,i.p0,i.p1,i.p2,i.p3,i.p4,i.p5,i.p6,i.p7],i._rect=new u.Rectangle,i._originRect=new u.Rectangle,i._curHandle=null,i._originP=new u.Point,i._displayScale=1,i._rotation=0,i._cRotation=0,i.stage=i.globalConfig.main,i.uniform=!1,i.p8=new w("c","center",0,0,""),i.container.addChild(i.p8),i.p8.visible=!1,i.centroidP=new u.Point(0,0),i.c=0,i.p9=new PIXI.Graphics,i.container.addChild(i.p9),i.p9.lineStyle(2,16711935,1),i.p9.drawCircle(0,0,10),i.p9.visible=!1,i.bg=new PIXI.Graphics,i.bg.name="bg",i.bg.interactive=!1,i.container.addChild(i.bg);for(var o=0;9>o;o++){var a=i._handles[o];i.container.addChild(a),a.oppositeHandle=i.getChildByName(a.oppositeName)}i.dotG=new PIXI.Graphics,i.addChild(i.dotG),i.PointStyle={dark:{color:5723995,alpha:.8,size:2},light:{color:16777215,alpha:.8,size:3}},i.rotateAngleArr=[],i.rotateNum=60;for(var r=0;i.rotateNum>r;r++)i.rotateAngleArr.push(2*Math.PI*r/60);i.rotateText=new PIXI.Text(""),i.rotateBox=new PIXI.Sprite,i.bgH=40,i.bgW=80;var h=new PIXI.Graphics;return h.beginFill(0,.6),h.drawRoundedRect(0,0,i.bgW,i.bgH,10),h.endFill(),i.rotateBox.addChild(h),i.rotateBox.addChild(i.rotateText),i.addChild(i.rotateBox),i.rotateBox.pivot.y=i.bgH,i.rotateBox.pivot.x=i.bgW/2,i.rotateBox.visible=!1,i}return a(e,t),r(e,[{key:"drawDotCir",value:function(){var t=u.M.getSPPoint(this.p8);u.M.getCenP(this.p0,this.handle);this.rotateText.text=Math.round(u.M.toAngle(this.container.rotation))+"°";var e=u.M.getPointLen(t,this.handle);this.rotateBox.scale.x=2/this.main.view.scale.x,this.rotateBox.scale.y=2/this.main.view.scale.y,this.rotateBox.x=this.p8.x,this.rotateBox.y=this.p8.y-e-120/this.main.view.scale.x,this.rotateText.x=(this.bgW-this.rotateText.width)/2,this.rotateText.y=(this.bgH-this.rotateText.height)/2}},{key:"showDotCir",value:function(t){this.dotG.visible=t,this.rotateBox.visible=t,t&&this.rotateText.setStyle({font:'28px "Microsoft Yahei"',align:"left",fill:16777215})}},{key:"hideHandles",value:function(t){t=t||["p0","p1","p2","p3","p4","p5","p6","p7"];for(var e=0;t.length>e;e++){var i=this[t[e]];i&&(i.visible=!1)}}},{key:"showHandles",value:function(t){t=t||["p0","p1","p2","p3","p4","p5","p6","p7"];for(var e=0;t.length>e;e++){var i=this[t[e]];i&&(i.visible=!0)}}},{key:"showHandlesX",value:function(){this.showHandles(["p1","p3"])}},{key:"showHandlesY",value:function(){this.showHandles(["p0","p2"])}},{key:"showHandlesCorner",value:function(){this.showHandles(["p4","p5","p6","p7"])}},{key:"setRotateEnabled",value:function(t){this.handle.visible=t,this.__updateLine()}},{key:"initBoundBox",value:function(t,e,i,o){this._originRect=new u.Rectangle(t,e,i,o),this.__setBoundBox(t,e,i,o),this.centroidP=new u.Point(0,0),this.c=new u.Point((this.p3.x-this.centroidP.x)/(this.p3.x-this.p1.x),(this.p0.y-this.centroidP.y)/(this.p0.y-this.p2.y))}},{key:"setRotation",value:function(t){this.container.rotation=t,this._rotation=t}},{key:"__setBoundBox",value:function(t,e,i,o){this.p0.x=t+i/2,this.p0.y=e,this.p1.x=t+i,this.p1.y=e+o/2,this.p2.x=t+i/2,this.p2.y=e+o,this.p3.x=t,this.p3.y=e+o/2,this.p4.x=t,this.p4.y=e,this.p5.x=t+i,this.p5.y=e,this.p6.x=t+i,this.p6.y=e+o,this.p7.x=t,this.p7.y=e+o,this.handle.x=this.p0.x,this.handle.y=this.p0.y-this.hh*this._displayScale,this.p8.x=t+i/2,this.p8.y=e+o/2,this._rect.x=t,this._rect.y=e,this._rect.width=i,this._rect.height=o,this.__updateLine(),this.__updateBg()}},{key:"getBoundBox",value:function(){return this._rect.clone()}},{key:"__updateLine",value:function(){this.graphics.clear(),this.graphics.lineStyle(this.lineThin*this._displayScale,this.lineColor),this.graphics.drawRect(this._rect.x,this._rect.y,this._rect.width,this._rect.height),this.graphics.moveTo(this.p0.x,this.p0.y),this.handle.visible&&this.graphics.lineTo(this.handle.x,this.handle.y)}},{key:"__updateBg",value:function(){this.bg.clear(),this.bg.beginFill(16777215,.1),this.bg.drawRect(this._rect.x,this._rect.y,this._rect.width,this._rect.height),this.bg.endFill()}},{key:"listen",value:function(t){for(var e=0;9>e;e++){var i=this._handles[e];t?(i.touchBeginUid||(i.touchBeginUid=u.M.addTouch(i,{begin:this.__mouseDownHandler,isAddDB:!1},this)),this.addCursor(i,i.cursorType)):(i.touchBeginUid&&u.M.removeTouch(i,i.touchBeginUid),i.touchBeginUid=null,this.removedCursor(i))}}},{key:"__mouseDownHandler",value:function(t){this.paramObj.moduleMain.napeEngine.touchManager.enAbled=!1,this._cRotation=0;var e=this._curHandle=t.target;this._originP=this.container.toLocal(this.getMouseXY(t).clone(),this.globalConfig.main.view),"rotate"===e.cursorType&&(this.drawDotCir(),this.showDotCir(!0)),e.touchMoveUid||(e.touchMoveUid=u.M.addTouch(e,{move:this.__mouseMoveHandler,isAddDB:!1},this)),e.touchUpUid||(e.touchUpUid=u.M.addTouch(e,{end:this.__mouseUpHandler,isAddDB:!1},this))}},{key:"__mouseUpHandler",value:function(t){var e=this._curHandle;e.touchMoveUid&&u.M.removeTouch(e,e.touchMoveUid),e.touchUpUid&&u.M.removeTouch(e,e.touchUpUid),e.touchMoveUid=e.touchUpUid=null,this.callBackObj&&this.callBackObj.changeCallBack&&this.callBackObj.changeCallBack({end:1}),this.scaleing=!1,"rotate"===e.cursorType&&this.showDotCir(!1),t.stopImmediatePropagation()}},{key:"__mouseMoveHandler",value:function(t){function e(t){switch(t){case"t":r.y+=a,r.height-=a;break;case"b":r.height+=a;break;case"l":r.x+=s,r.width-=s;break;case"r":r.width+=s;break;case"tl":r.y+=a,r.height-=a,r.x+=s,r.width-=s;break;case"br":r.height+=a,r.width+=s;break;case"tr":r.y+=a,r.height-=a,r.width+=s;break;case"bl":r.height+=a,r.x+=s,r.width-=s;break;case"rot":var e=i.toLocal(i._originP,i.container),n=i.callBackObj.freeMec,h={x:0,y:0};n.roteVec2&&(h=new u.Point(n.roteVec2.get_x(),n.roteVec2.get_y()),h=i.toLocal(h,n));var l=Math.atan2(e.y-h.y,e.x-h.x)+Math.PI/2;i._rotation=i._rotation+l-i._cRotation,i._cRotation=l,i.container.rotation=l,i._originP=i.container.toLocal(o,i.globalConfig.main.view),i.callBackObj&&i.callBackObj.changeCallBack&&i.callBackObj.changeCallBack({rotation:i.container.rotation}),i.drawDotCir.call(i)}}var i=this,o=this.getMouseXY(t).clone(),n=this.container.toLocal(o,this.globalConfig.main.view),s=n.x-this._originP.x,a=n.y-this._originP.y;this._originP=n;var r=this._rect.clone(),h={tl:1,br:1,tr:-1,bl:-1},c=(0,l.get)(t,"data.originalEvent.shiftKey");(0,l.get)(t,"data.originalEvent.altKey"),(0,l.get)(t,"data.originalEvent.ctrlKey");if(this.uniform||c){var d=h[this._curHandle.name];if(d){var p=r.width/r.height;Math.abs(s/a)>p?a=d*s/p:s=d*a*p}}e(this._curHandle.name),this.lockCenter&&this._curHandle.oppositeName&&""!=this._curHandle.oppositeName&&(s*=-1,a*=-1,e(this._curHandle.oppositeName)),(this.minW>r.width||r.width>this.maxW)&&(r.width=this._rect.width,r.x=this._rect.x),(this.minH>r.height||r.height>this.maxH)&&(r.height=this._rect.height,r.y=this._rect.y),this.__setBoundBox(r.x,r.y,r.width,r.height),this.__updateCentroidP();var y=r.width/this._originRect.width,f=r.height/this._originRect.height;1==y&&1==f||(this.scaleing=!0,this.callBackObj&&this.callBackObj.changeCallBack&&this.callBackObj.changeCallBack({scale:{x:y,y:f}}))}},{key:"__updateCentroidP",value:function(){this.centroidP.x=this.p3.x-this.c.x*(this.p3.x-this.p1.x),this.centroidP.y=this.p0.y-this.c.y*(this.p0.y-this.p2.y),this.p9.x=this.centroidP.x,this.p9.y=this.centroidP.y}},{key:"getGlobalCentroidP",value:function(){return this.globalConfig.main.view.toLocal(this.centroidP,this.container)}},{key:"displayScale",set:function(t){this._displayScale=t;for(var e=0;9>e;e++){var i=this._handles[e];i.scale.x=i.scale.y=this._displayScale}this.__updateLine()}}]),e}(d["default"]),w=function(t){function e(t,i,o,a,r){n(this,e);var h=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return h.name=t,h.cursorType=i,h.cursorRotation=o,h.flipRotation=a,h.oppositeName=r,h.oppositeHandle=null,h._displayScale=1,h.lineColor=5198164,h.fillColor=2369322,h.hitSp=new PIXI.Graphics,h.addChild(h.hitSp),h.freshScale(),h.refresh(),h}return a(e,t),r(e,[{key:"freshScale",value:function(){var t=this._displayScale;this.sideLen=9*t,this.dragRadius=20*t,this.lineThin=2*t,this.roundRadius=3*t}},{key:"refresh",value:function(){this.clear(),this.lineStyle(this.lineThin,this.lineColor),this.beginFill(this.fillColor),this.drawRoundedRect(-this.sideLen/2,-this.sideLen/2,this.sideLen,this.sideLen,this.roundRadius),this.endFill(),this.lineStyle(null),this.beginFill(16711680,0),this.drawCircle(0,0,this.dragRadius),this.endFill()}},{key:"displayScale",set:function(t){this._displayScale=t,this.freshScale(),this.refresh()}}]),e}(PIXI.Graphics)},,,function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function _(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:_(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(226),c=o(u),d=i(618),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0,v=function(t){function e(t,i,o,a){n(this,e);var r=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,a));return y=r.phy.nape,b=y.geom.LDMath,f=y.geom.Vec2,g=y.geom.Ray,r.RayUtil=a.moduleMain.RayUtil,r.NBOpticsStr=a.moduleMain.NBOpticsStr,r.body=t,r.space=a.moduleMain.napeEngine.space,r.lineThin=5,r.col=null===o?16777215:o,r.threshold=.1,r.lineStart=[117,0],r.lightStartOffset=f.get(),r.closeLight=!1,r.var_offsetY=0,r.var_offsetX=0,r.lineN=null===i?1:i,r.isWhiteLight=!1,r.autoUpdate=!0,r.tt=0,r.rootRay=null,r.maxLevel=20,r.I=1,r.rayView=new PIXI.Graphics,r.anlgeView=new PIXI.Graphics,r.lineView=new PIXI.Graphics,r.tfView=new PIXI.Container,r.rayView.addChild(r.lineView),r.rayView.addChild(r.anlgeView),r.rayView.addChild(r.tfView),r.isPolar=!1,r.polarAngle=0,r.tfArr=[],r.lineArr=[],r}return a(e,t),r(e,[{key:"init",value:function(){var t=[];t.push({option:"addElement",target:this.rayView,params:{x:0,y:0}}),this.paramObj.moduleMain.napeEngine.grC.dispatchEvent("Start_Graphic",t,this.UID)}},{key:"removed",value:function(){this.body=null,this.space=null,this.RayUtil=null,this.NBOpticsStr=null,this.paramObj.moduleMain.napeEngine.grC.dispatchEvent("Dispose_Graphics",this.UID),this.paramObj=null,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(t){if(this.clearLines(),(this.autoUpdate||t)&&!this.closeLight){var e=void 0,i=void 0,o=void 0;this.parent.updateTransform(),e=this.body.localPointToWorld(f.get(this.lineStart[0],this.lineStart[1]));for(var n=this.space.shapesUnderPoint(e),s=null,a=0;a<n.get_length();a++){var r=n.at(a);if(r.get_body().userData.nolight)return;!s&&this.RayUtil.underFilter(r)&&(s=r)}i=e.sub(this.body.localPointToWorld(this.lightStartOffset)),i.set_x(i.get_x()-this.var_offsetX),i.set_y(i.get_y()-this.var_offsetY),o=new g(e,i),this.rootRay=new p["default"](o),this.rootRay.from=s,this.rootRay.level=0,this.rootRay.isPolar=this.isPolar,this.rootRay.color=this.col,this.rootRay.I=this.I,this.RayUtil.space=this.space,this.isPolar&&(this.rootRay.setPolar(this.polarAngle),this.rootRay.I=this.I),this.rayScanning(this.rootRay),this.updateRaySkin3()}}},{key:"clearLines",value:function(){for(;this.tfView.children.length;)this.tfArr.push(this.tfView.removeChildAt(0));this.lineView.clear(),this.anlgeView.clear()}},{key:"updateRaySkin3",value:function(){if(this.isVisibleLight()){var t=this.rootRay,e=[];for(this.isWhiteLight&&(this.lineView.blendMode=PIXI.BLEND_MODES.SCREEN);t;){if(t.updateEndP(),t.path){var i=t.path.length;this.lineView.lineStyle(this.lineThin,this.col,t.I);for(var o=0;i>o;o++){var n=t.path[o];0===o?this.lineView.moveTo(n.x,n.y):this.lineView.lineTo(n.x,n.y)}this.lineView.lineTo(t.endP.x,t.endP.y)}else this.isWhiteLight?this.drawWhiteLight(t):(t.inAir&&!this.globalConfig.OPEN_LIGHTALPHA?this.lineView.lineStyle(this.lineThin,this.col,.1):this.lineView.lineStyle(this.lineThin,this.col,t.I),this.lineView.moveTo(t.startP.x,t.startP.y),this.lineView.lineTo(t.endP.x,t.endP.y));this.anlgeView.lineStyle(this.lineThin,this.col,t.I),this.isWhiteLight||t.nofline||((this.globalConfig.OPEN_NORMAL||this.globalConfig.OPEN_ANGLE)&&t.showGuideLine&&this.drawNormal(t),this.globalConfig.OPEN_ANGLE&&t.showGuideLine&&this.drawAngle(t),this.globalConfig.SHOW_DIRECTION&&t.showGuideLine&&this.drawLightDirection(t)),t.fsNbRay&&e.push(t.fsNbRay),t.zsNbRay&&e.push(t.zsNbRay),t=e.pop()}}}},{key:"updateRaySkin2",value:function(){if(this.isVisibleLight())for(var t=this.rootRay,e=[];t;)t.updateEndP(),this.isWhiteLight?(this.lineView.blendMode=PIXI.BLEND_MODES.SCREEN,this.drawWhiteLight(t)):(this.lineView.lineStyle(this.lineThin,this.col,t.I),this.lineView.moveTo(t.startP.x,t.startP.y),this.lineView.lineTo(t.endP.x,t.endP.y),this.anlgeView.lineStyle(this.lineThin,this.col,t.I),this.globalConfig.OPEN_ANGLE&&this.drawAngle(t),this.globalConfig.SHOW_DIRECTION&&this.drawLightDirection(t)),t.fsNbRay&&e.push(t.fsNbRay),t.zsNbRay&&e.push(t.zsNbRay),t=e.pop()}},{key:"updateRaySkin",value:function(){this.drawRay(this.rootRay)}},{key:"drawRay",value:function(t){t&&this.isVisibleLight()&&(t.updateEndP(),this.isWhiteLight?(this.lineView.blendMode=PIXI.BLEND_MODES.SCREEN,this.drawWhiteLight(t)):(this.lineView.lineStyle(this.lineThin,this.col,t.I),this.lineView.moveTo(t.startP.x,t.startP.y),this.lineView.lineTo(t.endP.x,t.endP.y),this.anlgeView.lineStyle(this.lineThin,this.col,t.I),this.globalConfig.OPEN_ANGLE&&t.showGuideLine&&this.drawAngle(t),this.globalConfig.SHOW_DIRECTION&&t.showGuideLine&&this.drawLightDirection(t)),this.drawRay(t.fsNbRay),this.drawRay(t.zsNbRay))}},{key:"drawWhiteLight",value:function(t){var e=new l.Point(t.dir.x,t.dir.y);t.rsNbRay&&(e=t.rsNbRay.normal);var i=t.normal;i||(i=new l.Point(t.dir.x,t.dir.y));var o=t.startP,n=t.endP,s=new l.Point(-e.y,e.x),a=new l.Point(-i.y,i.x);s.normalize(.5*this.lineThin),a.normalize(.5*this.lineThin);var r=new l.Point(-t.dir.y,t.dir.x);0>this.dot(s,r)*this.dot(a,r)&&(s=new l.Point(-s.x,-s.y));var h=o.add(s),u=o.sub(s),c=n.sub(a),d=n.add(a);t.inAir&&!this.globalConfig.OPEN_LIGHTALPHA?(this.lineView.lineStyle(1,this.col,.1),this.lineView.beginFill(this.col,.1)):(this.lineView.lineStyle(1,this.col,t.I),this.lineView.beginFill(this.col,t.I)),this.lineView.moveTo(h.x,h.y),this.lineView.lineTo(u.x,u.y),this.lineView.lineTo(c.x,c.y),this.lineView.lineTo(d.x,d.y),this.lineView.endFill()}},{key:"vec2point",value:function(t){return new l.Point(t.get_x(),t.get_y())}},{key:"rayScanning",value:function(t){if(t&&t.I>=.05&&this.maxLevel>=t.level){var e=this.RayUtil.rayFindBodyResult(t,this.NBOpticsStr.filters,this.lineN);t.dis=e.get_distance();var i=t.from?t.from.get_body():null,o=e.get_shape().get_body();t.inAir=!i||i!=o;try{var n=i?i.userData.view||null:null,s=o?o.userData.view||null:null;n&&"FoldPaperboard"==n.classname&&(t.nofline=!0,t.owner=n),s&&"FoldPaperboard"==s.classname&&(t.nofline=!0,t.owner=s)}catch(l){}var a=e.get_shape(),r=this.getVo(a);if(r){var h=this.RayUtil.getViewByShape(a);h&&h.preHandleLight(t,e,r,this),this.rayReflect(t,e,r),this.rayRefraction(t,e,r),h&&h.handleLight(t,e,r,this),this.rayScanning(t.fsNbRay),this.rayScanning(t.zsNbRay)}}}},{key:"rayRefraction",value:function(t,e,i){if(i.var_canRefraction){var o=t.ray.get_direction().unit(),n=e.get_normal(),s=e.rate,a=-n.dot(o),r=Math.sqrt(1-1/(s*s)*(1-a*a)),h=t.ray.at(e.get_distance()),l=isNaN(r),u=void 0;if(l)u=b.symmetric(o,n);else{u=o.add(n.mul(a)).mul(1/s).add(n.mul(-r))}var c=this.getNewNbRay(h,u);c.level=t.level+1,c.isPolar=t.isPolar,t.normal=this.vec2point(n),p["default"].cloneI(c,t),l?(c.from=e.from,t.fsNbRay=c,c.rsNbRay=t,c.isQfs=!0):(c.from=e.to,c.I*=this.getTsI(a,r),t.zsNbRay=c,c.rsNbRay=t)}}},{key:"getNewNbRay",value:function(t,e){var i=new g(t,e);i.set_origin(i.at(this.threshold));var o=new p["default"](i);return o.color=this.col,o}},{key:"rayReflect",value:function(t,e,i){if(i.var_canReflection&&(!this.isWhiteLight||!i.var_whiteNotReflect)){var o=t.ray.get_direction().unit(),n=e.get_normal(),s=t.ray.at(e.get_distance()),a=o.sub(n.mul(2*n.dot(o))),r=this.getNewNbRay(s,a);if(r.level=t.level+1,r.from=e.from,r.isPolar=t.isPolar,t.normal=this.vec2point(n),p["default"].cloneI(r,t),i.var_canRefraction){var h=Math.acos(o.dot(n));h=h>.5*Math.PI?Math.PI-h:h;r.I*=this.getRsI(h,e.rate)}else;t.fsNbRay=r,r.rsNbRay=t}}},{key:"getVo",value:function(t){var e=t.get_userData();return e?e.vo:null}},{key:"getTsI",value:function(t,e){return 1===Math.abs(t)?1:this.getTs(Math.acos(t),Math.acos(e))}},{key:"getRsI",value:function(t,e){var i=t;if(0===i)return 0;var o=Math.sin(i)/e;return 1>Math.abs(o)?this.getRs(i,Math.asin(o)):0}},{key:"getRs",value:function(t,e){var i=Math.sin(e-t)/Math.sin(e+t),o=i*i;return i=Math.sqrt(o)}},{key:"getTs",value:function(t,e){var i=2*Math.sin(e)*Math.cos(t)/Math.sin(e+t),o=Math.sin(t)/Math.sin(e)*(Math.cos(e)/Math.cos(t))*i*i;return i=Math.sqrt(o)}},{key:"drawLightDirection",value:function(t){var e=t.startP,i=t.endP,o=t.dir,n=l.Point.distance(e,i),s=.5*n;s>300&&(s=300);var a=new l.Point(e.x+o.x*s,e.y+o.y*s),r=new l.Point(o.y,-o.x),h=new l.Point(10*(1.732*-o.x+r.x),10*(1.732*-o.y+r.y)),u=new l.Point(10*(1.732*-o.x-r.x),10*(1.732*-o.y-r.y));this.lineView.moveTo(a.x+h.x,a.y+h.y),this.lineView.lineTo(a.x,a.y),this.lineView.lineTo(a.x+u.x,a.y+u.y)}},{key:"drawNormal",value:function(t){if(t.normal){var e=t.endP,i=t.normal,o=new l.Point(120*i.x,120*i.y),n=e.add(o),s=e.sub(o);this.anlgeView.lineWidth=.5*this.lineThin,l.M.drawDashed(this.anlgeView,n,s,10,10)}}},{key:"drawAngle",value:function(t){if(t.normal){var e=t.endP,i=t.normal;this.drawAngleByVec(this.normalize(t.dir,-1),i,e,t.I),t.fsNbRay&&t.fsNbRay.I>0&&this.drawAngleByVec(t.fsNbRay.dir,i,e,t.fsNbRay.I),t.zsNbRay&&t.zsNbRay.I&&this.drawAngleByVec(t.zsNbRay.dir,this.normalize(i,-1),e,t.zsNbRay.I)}}},{key:"normalize",value:function(t,e){var i=t.clone();return i.normalize(e),i}},{key:"drawAngleByVec",value:function(t,e,i,o){var n=this.getAngle(t,e),s=t.add(e);s.normalize(50),s=s.add(i),this.drawText(s.x,s.y,n+"°",o);var a=20,r=new l.Point(i.x+t.x*a,i.y+t.y*a),h=new l.Point(i.x+e.x*a,i.y+e.y*a),u=new l.Point((t.x+e.x)*a*.8+i.x,(t.y+e.y)*a*.8+i.y);this.anlgeView.moveTo(r.x,r.y),this.anlgeView.quadraticCurveTo(u.x,u.y,h.x,h.y)}},{key:"getAngle",value:function(t,e){var i=this.dot(t,e)/(t.length*e.length),o=180*Math.acos(i)/Math.PI;return o=Math.round(o)}},{key:"dot",value:function(t,e){return t.x*e.x+t.y*e.y}},{key:"drawText",value:function(t,e,i,o){var n=this.getTf();n.style={font:"20px Arial",fill:this.col,alpha:o},n.text=i,this.tfView.addChild(n),n.x=t-n.width/2,n.y=e-n.height/2}},{key:"getTf",value:function(){var t=this.tfArr.pop();return t||(t=new PIXI.Text("",{font:"20px Arial",fill:this.col})),t}},{key:"isVisibleLight",value:function(){return!!this.globalConfig.DEBUG||this.lineN>1.508&&1.58>this.lineN}},{key:"getRectPoint",value:function(t,e,i,o){return l.M.checkJPIsInABCD(t,e,i,o)?[t,i,e,o]:l.M.checkJPIsInABCD(t,i,e,o)?[t,e,i,o]:l.M.checkJPIsInABCD(t,o,e,i)?[t,e,o,i]:[t,e,i,o]}}]),e}(c["default"]);v.OPEN_LIGHT_DIRECTION=!1,e["default"]=v},,function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();e["default"]=function(t){function e(t,i){o(this,e);var s=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),a=s.__createCanvas(t,i),r=a.getContext("2d"),h=PIXI.Texture.fromCanvas(a,PIXI.SCALE_MODES.DEFAULT);return s.texture=h,s.context=r,s.canvas=a,s.W=t,s.H=i,s.defaulColor="black",h.baseTexture.resolution=1,h.baseTexture.mipmap=!1,s}return s(e,t),a(e,[{key:"setFrame",value:function(t,e,i){var o=PIXI.Texture.fromFrame(e),n=new PIXI.Sprite(o),s=t.extract.canvas(n,1);i&&this.clearCanvas(),this.context.drawImage(s,0,0,s.width,s.height,0,0,this.W,this.H),this.updateTexture()}},{key:"clearCanvas",value:function(){this.context.fillStyle=this.defaulColor,this.context.fillRect(0,0,this.W,this.H)}},{key:"setImg",value:function(t,e){e&&this.clearCanvas(),this.context.drawImage(t,0,0,t.width,t.height,0,0,this.W,this.H),this.updateTexture()}},{key:"destroy",value:function(){}},{key:"updateTexture",value:function(){this.texture.update()}},{key:"__createCanvas",value:function(t,e){var i=document.createElement("div");return i.innerHTML="<canvas width='"+t+"px' height='"+e+"px' style='width:"+t+"px;height:"+e+"px;background:#cc0000;'></canvas>",i.childNodes[0]}}]),e}(PIXI.Sprite)},,,,,function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(446),u=o(l),c=i(489),d=o(c),p=i(1);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.isMechaTool=!0,i}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.istoolMove=!0,this.body.userData.dragLevel=3,this.hasAddCompComplete=!0}},{key:"setScale",value:function(t,i){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setScale",this).call(this,t,i),this.skinCon.scale.x=this.currentScale.x,this.skinCon.scale.y=this.currentScale.y}},{key:"setLocalScale",value:function(t,i){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setLocalScale",this).call(this,t,i),this.skinCon.scale.x=this.currentScale.x,this.skinCon.scale.y=this.currentScale.y}},{key:"getDragRect",value:function(){var t=this.bg.width*this.skinCon.scale.x,e=this.bg.height*this.skinCon.scale.y;return{x:.5*-t,y:.5*-e,width:t,height:e}}},{key:"addSelectTrigger",value:function(){this.tigid=p.M.addTouch(this,{tab:function(){this.getMain().view.selectionLayer.selectOneToReadyMove(this.parent)}},this)}},{key:"setSelected",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setSelected",this).call(this,t),t?(this.paramObj.moduleMain.napeEngine.transformManager.show(this),this.paramObj.moduleMain.napeEngine.transformManager.setRotateEnabled(!1),this.paramObj.moduleMain.napeEngine.transformManager.setScaleMode(d["default"].SCALE_UNIFORM)):this.paramObj.moduleMain.napeEngine.transformManager.hide()}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function g(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:g(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(499),c=o(u),d=i(454),p=o(d),y=void 0,f=void 0;e["default"]=function(t){function e(t,i,o){n(this,e);var a=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=a.phy.nape,f=y.geom.Vec2,a.classname="BearingJointView",a.level=20,a.body01=i,a.body02=o,a.dirBg=new PIXI.Graphics,a.skinCon.addChild(a.dirBg),a.dirBg.visible=!1,l.M.alignPivot(a.dirBg,"center","center"),a.bg=PIXI.Sprite.fromFrame("mechSkin/bear"),a.skinCon.addChild(a.bg),l.M.alignPivot(a.bg,"center","center"),a.ismecJoint=!0,a.var_joint=null,a.var_openMotor=!1,a.istool=!0,a.var_isreverse=1,a.var_speed=15,a.var_torque=1,a.var_isBind=!1,a.owner=a,a.isFreeMec=!0,a}return a(e,t),r(e,[{key:"init",value:function(){this.radius=this.width/2,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.dragLevel=3,this.body.sensorEnabled(!0),this.body.noallowRotation=!0;var t=this;this.addEventListener(p["default"].SET_BODY_STATE,function(e){t.func_setBodyStateHandler.call(t,e)}),this.body01&&this.body02&&this.fixedBodies(this.body01,this.body02)}},{key:"bodyContainsConstraint",value:function(t,e){return!!t.contains(new f(this.x,this.y))}},{key:"changeBody",value:function(t,e){if(t==this.body01)this.body01=e;else{if(t!=this.body02)return;this.body02=e}this.fixedBodies(this.body01,this.body02)}},{key:"fixedBodies",value:function(t,e){if(this.var_joint&&this.var_joint.get_space()){var i=t.worldPointToLocal(this.body.position),o=e.worldPointToLocal(this.body.position);this.var_joint.set_body1(t),this.var_joint.set_body2(e),this.var_joint.anchor1=i,this.var_joint.anchor2=o}else this.var_joint=this.JointUtil.createPivotJoint(t,e,this.body.position,this.body.position),this.var_joint.userData.bindBody=this.body,this.var_joint.userData.toolView=this;this.body01=this.var_joint.body1=t,this.body02=this.var_joint.body2=e,this.var_joint.set_active(!0)}},{key:"updateAfterMove",value:function(){var t=this.var_joint.body1,e=this.var_joint.body2,i=t.worldPointToLocal(this.body.position),o=e.worldPointToLocal(this.body.position);this.var_joint.anchor1=i,this.var_joint.anchor2=o}},{key:"fixed",value:function(){var t=new f(this.x,this.y),e=this.space.bodiesUnderPoint(t);e.filter(function(t){return!t.userData||!t.userData.isnbequ});var i=this.BodyUtil.getTopBodyFormBodyList(e,[this.body]);if(!i)return void this.removeFromFramework(this);var o=this.BodyUtil.getTopBodyFormBodyList(e,[this.body,i]);o||(o=this.getWorldBody()),this.fixedBodies(i,o)}},{key:"func_setBodyStateHandler",value:function(t){this.var_isMove=!1,t&this.BodyUtil.ALLOW_MOVE?(this.var_joint.userData.bindBody=this.body,this.fixed()):(this.var_isMove=!0,this.var_joint.userData.bindBody=null)}},{key:"func_bindVo",value:function(t){var e=void 0;if(null==t.beginBody){if(!t.endBody.isDynamic())return void this.removeFromFramework(this);e=this.getWorldBody()}else e=t.beginBody;var i=void 0;if(null==t.endBody){if(!t.beginBody.isDynamic())return void this.removeFromFramework(this);i=this.getWorldBody()}else i=t.endBody;var o=e.userData.view;if(o instanceof nb.mec.Box||o instanceof nb.mec.Circle){20>f.distance(t.beginVec2,e.position)&&(t.beginVec2=f.get(e.posx,e.posy),t.endVec2=f.get(e.posx,e.posy))}this.var_joint=t.beginBody?this.JointUtil.createPivotJoint(e,i,t.beginVec2,t.endVec2):this.JointUtil.createPivotJoint(i,e,t.endVec2,t.beginVec2),this.var_joint.userData.bindBody=this.body,this.var_joint.userData.toolView=this}},{key:"removed",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this),this.var_joint&&this.BodyUtil.destoryJoint(this.var_joint)}},{key:"func_refresh",value:function(){if(this.var_openMotor&&0!=this.var_speed&&0!=this.var_torque){var t=new f(0,this.NapeConst.NB_WORLD_GRAVITY_PER_N*this.var_torque),e=this.var_joint.anchor1.add(f.get(1e3*this.NapeConst.SCALE_SPACE,0)),i=this.var_speed/60,o=this.var_joint.body1,n=this.var_joint.body2,s=0;if(n!=this.getWorldBody()){s=n.angularVel/Math.PI/2;var a=(-i*this.var_isreverse-s)/i;Math.abs(a)>1&&(a/=Math.abs(a)),n.applyImpulse(t.mul(a),e)}s=o.angularVel/Math.PI/2,a=(i*this.var_isreverse-s)/i,Math.abs(a)>1&&(a/=Math.abs(a)),o.applyImpulse(t.mul(a),e)}}},{key:"update",value:function(){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.var_joint&&!this.var_isMove&&this.var_joint.body1){this.body.set_position(this.var_joint.body1.localPointToWorld(this.var_joint.anchor1)),this.body.rotation=this.var_joint.body1.rotation,this.BodyUtil.frezzBody(this.body),this.func_refresh()}this.dirBg.visible=this.var_openMotor,this.dirBg.scale.x=this.var_isreverse}},{key:"func_openMotorPower",value:function(t){this.var_openMotor=t.checked,this.owner&&this.owner.showToolDatas()}},{key:"func_changeSpeed",value:function(t){this.var_speed=l.M.getNumStr(t.showValue)-0}},{key:"func_changeTorque",value:function(t){this.var_torque=l.M.getNumStr(t.showValue)-0}},{key:"func_changeReverse",value:function(t){this.var_isreverse=t.checked?1:-1}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this),i=this.var_joint.body1.userData.view,o=this.var_joint.body2.userData?this.var_joint.body2.userData.view:{};return t.body1={uid:i.UID,anchorX:this.var_joint.anchor1.get_x(),anchorY:this.var_joint.anchor1.get_y()},t.body2={uid:o.UID,anchorX:this.var_joint.anchor2.get_x(),anchorY:this.var_joint.anchor2.get_y()},t.openMotor=this.var_openMotor,t.speed=this.var_speed,t.torque=this.var_torque,t.isreverse=1==this.var_isreverse,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.body.transformShapes(this.transformN),this.setScale(this.currentScale.x,this.currentScale.y);var i=void 0,o=void 0,n=void 0,s=void 0;t.body1&&(i=this.getBodyFromUid(t.body1.uid),n=i.localPointToWorld(f.get(t.body1.anchorX,t.body1.anchorY)),t.body2.uid?(o=this.getBodyFromUid(t.body2.uid),s=o.localPointToWorld(f.get(t.body2.anchorX,t.body2.anchorY))):(o=this.getWorldBody(),s=f.get(t.body2.anchorX,t.body2.anchorY)),this.var_joint||(this.var_joint=this.JointUtil.createPivotJoint(i,o,n,s),this.var_joint.userData.bindBody=this.body,this.var_joint.userData.toolView=this),1==(this.var_openMotor=t.openMotor)&&(this.func_changeSpeed({showValue:t.speed}),this.func_changeTorque({showValue:t.torque}),this.func_changeReverse({checked:t.isreverse})))}},{key:"getConf",value:function(){var t={};return this.elecLable=this.language.getLocaleStr("bearing"),t.confArr=[],this.ComponentProperty&&t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("ratio"),!0,"",300,0,this.var_speed,1,this.func_changeSpeed,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("coefficient"),!0,"",20,0,this.var_torque,.1,this.func_changeTorque,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("reverse_roll"),1==this.var_isreverse,this.func_changeReverse,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("open_motor"),this.var_openMotor,this.func_openMotorPower,this)),t}},{key:"getTipMess",value:function(){var t='    <font class="pre-tipmess-title">'+this.elecLable+"</font>";return t+="\n    "+this.language.getLocaleStr("ratio")+": "+this.var_speed+"\n    "+this.language.getLocaleStr("coefficient")+": "+this.var_torque+"\n    "}}]),e}(c["default"])},,,,,,function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function p(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:p(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(226),u=o(l),c=i(454),d=o(c);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.isMechanics=!0,i.napeEngine=t.moduleMain.napeEngine,i.napeEngine=t.moduleMain.napeEngine,i.CbTypeStr=t.moduleMain.CbTypeStr,i.BodyUtil=t.moduleMain.BodyUtil,i.Vec2Util=t.moduleMain.Vec2Util,i.JointUtil=t.moduleMain.JointUtil,i.NapeConst=t.moduleMain.NapeConst,i.ToolStatusStr=t.moduleMain.ToolStatusStr,i.InteractionFilterManager=t.moduleMain.InteractionFilterManager,i.RayUtil=t.moduleMain.RayUtil,i.NBOpticsStr=t.moduleMain.NBOpticsStr,i.noRenderSelected=!0,i.initComplete=!1,i}return a(e,t),r(e,[{key:"added",value:function(){var t=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.cannotSystemDrag=!0,this.init(function(){t.addOthers(),t.updateFunc=function(){t.update()},t.napeEngine.addEventListener(d["default"].WORLD_UPDATE,t.updateFunc)})}},{key:"testdraw",value:function(){var t=new PIXI.Graphics;t.beginFill(16711680),t.drawCircle(0,0,10),t.endFill(),this.addChild(t)}},{key:"removed",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this),this.napeEngine.removeEventListener(d["default"].WORLD_UPDATE,this.updateFunc)}},{key:"init",value:function(t){}},{key:"addOthers",value:function(){}},{key:"update",value:function(){}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.thisX=this.x,t.thisY=this.y,t}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(226),h=function(t){return t&&t.__esModule?t:{"default":t}}(r);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.NapeConst=t.moduleMain.NapeConst,i.graphics=new PIXI.Graphics,i.curtLength=0,i.division="1mm",i}return s(e,t),a(e,[{key:"added",value:function(){this.addChild(this.graphics)}},{key:"changeLongBoardDivision",value:function(t){this.division=t,this.initLongBoard(this.curtLength)}},{key:"initLongBoard",value:function(t){this.curtLength=t,this.removeChildren(),this.addChild(this.graphics),this.graphics.clear(),this.graphics.lineStyle(1.3,0);var e=t*this.NapeConst.SCALE_SPACE*10,i=void 0;t*=10;var o=e/t;for(i=0;t>=i;i++){var n=i*o;if(this.graphics.moveTo(n,0),i%10==0){this.graphics.lineTo(n,8);var s=new PIXI.Text(i/10+"",{font:"12px Arial",fill:0});this.addChild(s),s.x=n-s.width/2,s.y=6}else i%5==0?"5mm"!==this.division&&"1mm"!==this.division||this.graphics.lineTo(n,6):"1mm"===this.division&&this.graphics.lineTo(n,4)}}},{key:"initRuler",value:function(t){this.curtLength=t,this.graphics.clear(),this.graphics.lineStyle(1);var e=0;for(e=0;t>=e;e++)if(this.graphics.moveTo(e*this.NapeConst.SCALE_SPACE,0),e%10==0){this.graphics.lineTo(e*this.NapeConst.SCALE_SPACE,15);var i=new PIXI.Text(e/10+"",{font:"25px Arial",fill:0});i.touchable=!1,i.x=e*this.NapeConst.SCALE_SPACE-25,i.y=10,e%50==0&&(this.graphics.lineTo(e*this.NapeConst.SCALE_SPACE,20),i.y=15),this.addChild(i)}else e%5==0?this.graphics.lineTo(e*this.NapeConst.SCALE_SPACE,10):this.graphics.lineTo(e*this.NapeConst.SCALE_SPACE,5)}},{key:"initWaterBeaker2",value:function(t,e,i){this.graphics.clear(),this.graphics.lineStyle(2);var o=0;for(o=0;t>=o;o++)if(this.graphics.moveTo(0,-o*e),o%10==0){this.graphics.lineTo(15,-o*e);var n=new PIXI.Text(o+"",{font:"25px Arial",fill:0});n.touchable=!1,n.y=-o*e-17,n.x=10,i&&(n.x=15),o%50==0&&(this.graphics.lineTo(20,-o*e),n.x=15),this.addChild(n)}else o%5==0?this.graphics.lineTo(10,-o*e):i&&this.graphics.lineTo(5,-o*e);this.graphics.moveTo(0,-o*e),this.graphics.lineTo(0,0)}},{key:"initWaterBeaker",value:function(t){this.curtLength=t,this.graphics.clear(),this.graphics.lineStyle(1);var e=void 0,i=0;for(i=0;t>=i;i++)this.graphics.moveTo(0,-i*this.NapeConst.SCALE_SPACE),i%10==0?(this.graphics.lineTo(40,-i*this.NapeConst.SCALE_SPACE),e=new PIXI.Text(Math.round(.065*(10*i+100))+"",{font:"15px Arial",fill:0}),this.addChild(e),e.x=-45,e.y=-i*this.NapeConst.SCALE_SPACE-10):i%5==0?(this.graphics.lineTo(20,-i*this.NapeConst.SCALE_SPACE),e=new PIXI.Text(Math.round(.065*(10*i+100))+"",{font:"10px Arial",fill:0}),this.addChild(e),e.x=-40,e.y=-i*this.NapeConst.SCALE_SPACE-10):this.graphics.lineTo(10,-i*this.NapeConst.SCALE_SPACE);this.graphics.moveTo(0,-(i-1)*this.NapeConst.SCALE_SPACE),this.graphics.lineTo(0,0)}},{key:"init_woodSlopesPlane",value:function(t){this.curtLength=t,this.graphics.clear(),this.graphics.lineStyle(1);var e=0;for(e=0;t>=e;e++)if(this.graphics.moveTo(e*this.NapeConst.SCALE_SPACE,0),e%10==0){this.graphics.lineTo(e*this.NapeConst.SCALE_SPACE,10);var i=new PIXI.Text(e/10+"",{font:"25px Arial",fill:0});i.touchable=!1,i.x=e*this.NapeConst.SCALE_SPACE-25,i.y=0,this.addChild(i)}else e%5==0?this.graphics.lineTo(e*this.NapeConst.SCALE_SPACE,8):this.graphics.lineTo(e*this.NapeConst.SCALE_SPACE,5)}},{key:"initMicrometerH",value:function(){this.graphics.clear(),this.graphics.lineStyle(1,0);for(var t=0,t=0;41>t;t++){var e=void 0;if(e=t%2==0?10:-5,t%20==0){e=15;var i=new PIXI.Text(5*t/10+"",{font:"15px Arial",fill:0});this.addChild(i),i.x=t*this.NapeConst.SCALE_SPACE/2-i.width/2,i.y=15,"20"==i.text&&(i.x-=3)}this.graphics.moveTo(t*this.NapeConst.SCALE_SPACE/2,0),this.graphics.lineTo(t*this.NapeConst.SCALE_SPACE/2,e)}this.graphics.moveTo(0,0),this.graphics.lineTo(t*this.NapeConst.SCALE_SPACE/2,0)}}]),e}(h["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function p(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:p(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(452),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=t.moduleMain.phy.nape,d=c.geom.Vec2,i.touchID=-1,i.vo=null,i.selectBodyList=null,i.jointList=null,i.bodyTypeMap={},i.addList=new c.phys.BodyList,i.drawUID=null,i.startP=null,i.oldP=null,i.isstart=!1,i.isTool=!1,i}return s(e,t),a(e,[{key:"setActive",value:function(t){if(r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setActive",this).call(this,t),this.active){var i=this;this.touchBeginUid||(this.touchBeginUid=h.M.addTouch(this.var_dis,{begin:i.func_touchBegin,isAddDB:!1},this)),this.touchMoveUid||(this.touchMoveUid=h.M.addTouch(this.var_dis,{move:i.func_touchMove,isAddDB:!1},this)),this.touchEndUid||(this.touchEndUid=h.M.addTouch(this.var_dis,{end:i.func_touchEnd,isAddDB:!1},this))}else this.touchBeginUid&&h.M.removeTouch(this.var_dis,this.touchBeginUid),this.touchMoveUid&&h.M.removeTouch(this.var_dis,this.touchMoveUid),this.touchEndUid&&h.M.removeTouch(this.var_dis,this.touchEndUid),this.touchBeginUid=this.touchMoveUid=this.touchEndUid=null}},{key:"moveBody",value:function(t,e){var i=this;this.oldP=e;var o=t;if((!o.userData||!o.userData.iswall)&&o){this.config.moduleMain.napeEngine.transformManager.body!==o&&this.config.moduleMain.napeEngine.transformManager.hide(),this.isstart=!0,this.selectBodyList=new c.phys.BodyList;var n=this.BodyUtil.getView(o);this.config.moduleMain.napeEngine.transformManager.body===o?"Gear"==n.classname&&this.selectBodyList.add(n.bear.body):n&&n.isMechaTool?(this.isTool=!0,n.var_isBind&&(o=n.owner.body,o.connectedBodies(-1,this.addList),this.isTool=!1)):(this.isTool=!1,this.getConnectedBodies(o,this.addList)),this.selectBodyList.merge(this.addList),this.selectBodyList.has(o)||this.selectBodyList.add(o);var s=this.func_getJointBody(!0);this.jointList=this.func_getJointBody(!1),this.selectBodyList.merge(s),this.filterCompoundBody(),this.selectBodyList.filter(function(t){return!t.isStatic()&&!(t.userData&&!t.userData.allowMove)}),this.selectBodyList.foreach(function(t){var e=i.BodyUtil.getView(t);if("Gear"==e.classname){var o=e.bear.body;i.selectBodyList.has(o)||i.selectBodyList.add(o)}}),this.saveStatus(this.selectBodyList),this.saveStatus(this.jointList)}}},{key:"saveStatus",value:function(t){for(var e=0;e<t.get_length();e++){var i=t.at(e);i.userData&&i.userData.moveCompo||(this.BodyUtil.frezzBody(i),this.setBodyStatus(i,0))}}},{key:"filterBodies",value:function(t,e){for(var i=new c.phys.BodyList,o=this.BodyUtil.getDisplayIndex(t),n=e.get_length(),s=0;n>s;s++){var a=e.at(s);o>this.BodyUtil.getDisplayIndex(a)||i.add(a)}return i}},{key:"getConnectedBodies",value:function(t,e){var i=this,o=this.BodyUtil.getDisplayIndex(t);if(-1!==o){var n=this.BodyUtil.getView(t);"Gear"==n.classname&&e.add(n.bear.body);for(var s=t.get_constraints(),a=0;a<s.get_length();a++){var r=s.at(a);r.userData&&r.userData.toolView&&"ToolSpring"==r.userData.toolView.classname||r.visitBodies(function(n){if(t!==n&&!e.has(n)&&n!==i.space){var s=i.BodyUtil.getDisplayIndex(n);-1!==s&&(o>s||(e.add(n),i.getConnectedBodies(n,e)))}})}}}},{key:"filterCompoundBody",value:function(){this.selectBodyList.filter(function(t){return!t.userData||1!=t.userData.nomoveTool})}},{key:"func_touchBegin",value:function(t){this.oldP=t;var e=this.Vec2Util.pointToVec2(t),i=this.space.bodiesUnderPoint(e),o=this.BodyUtil.getTopBodyFormBodyList(i);if(o){var n=this.globalConfig.main.view.selectionLayer.selectedObj;if(n&&o.userData){var s=o.userData.view;if(s&&n.indexOf(s)>=0)return;if(s&&s.parent&&n.indexOf(s.parent)>=0)return}}o&&o.userData&&o.userData.allowMove&&this.moveBody(o,t)}},{key:"func_touchMove",value:function(t){if(this.isstart){for(var e=this.selectBodyList.get_length(),i=0;e>i;i++){var o=this.selectBodyList.at(i),n=t.x-this.oldP.x,s=t.y-this.oldP.y;if(!Math.abs(s>1e3)){if(!o)return;if(o.userData&&o.userData.moveCompo){o.userData.view.translateMove(n,s)}else{var a=d.get(o.posx+n,o.posy+s);if(o.set_position(a),this.isTool){var r=this.space.bodiesUnderPoint(a),h=this.BodyUtil.getView(o);h&&(h.alpha=r.get_length()>1?1:.5)}}}}this.oldP=t}}},{key:"func_touchEnd",value:function(t,e){this.isstart&&(this.isstart=!1,e||(this.func_restoreBodyType(this.selectBodyList),this.func_restoreBodyType(this.jointList),this.bodyTypeMap={},this.addList.clear(),this.selectBodyList.clear()))}},{key:"func_getJointBody",value:function(t){var e=[],i=new c.phys.BodyList,o=this.space.world,n=0,s=0,a=this.selectBodyList.get_length();for(n=0;a>n;n++){var r=this.selectBodyList.at(n);if(r==o)return;var h=r.constraints,l=h.get_length();for(s=0;l>s;s++){var u=h.at(s);if(u.userData){if(t){if(!this.isTopBodyOfConstraint(r,u))continue}var d=u.userData.bindBody;d&&-1==e.indexOf(d)&&(e.push(d),i.add(d))}}}return i}},{key:"isTopBodyOfConstraint",value:function(t,e){var i=this,o=!0;if(!this.isSpringConstr(e)){var n=this.BodyUtil.getDisplayIndex(t);e.visitBodies(function(e){if(t!==e&&e!==i.space){var s=i.BodyUtil.getDisplayIndex(e);-1!==s&&(n>s||(o=!1))}})}return o}},{key:"isSpringConstr",value:function(t){return!(!t.userData||!t.userData.toolView||"ToolSpring"!=t.userData.toolView.classname)}},{key:"updateAfterMove",value:function(){for(var t=this.selectBodyList.get_length(),e=0;t>e;e++){var i=this.selectBodyList.at(e),o=i.userData.view;o&&o.updateAfterMove&&o.updateAfterMove()}}},{key:"func_restoreBodyType",value:function(t){if(null!=t){var e=void 0;for(e=0;e<t.get_length();e++){this.restoreBodyStatus(t.at(e))}}}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function p(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:p(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(452),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=t.main.phy.nape,d=c.geom.Vec2,i.rotMc=null,i.var_bodystatus=null,i.downRota=0,i.downAng=0,i.curBody=null,i}return s(e,t),a(e,[{key:"setActive",value:function(t){if(r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setActive",this).call(this,t),this.active){var i=this;this.touchBeginUid||(this.touchBeginUid=h.M.addTouch(this.var_dis,{begin:i.func_touchBegin,isAddDB:!1},this)),this.touchMoveUid||(this.touchMoveUid=h.M.addTouch(this.var_dis,{move:i.func_touchMove,isAddDB:!1},this)),this.touchEndUid||(this.touchEndUid=h.M.addTouch(this.var_dis,{end:i.func_touchEnd,isAddDB:!1},this))}else this.touchBeginUid&&h.M.removeTouch(this.var_dis,this.touchBeginUid),this.touchMoveUid&&h.M.removeTouch(this.var_dis,this.touchMoveUid),this.touchEndUid&&h.M.removeTouch(this.var_dis,this.touchEndUid),this.touchBeginUid=this.touchMoveUid=this.touchEndUid=null}},{key:"func_touchBegin",value:function(t){this.isstart=!0;var e=this.space.bodiesUnderPoint(new d(t.x,t.y));e.filter(function(t){return!!t.userData&&!!t.userData.view});var i=this.BodyUtil.getTopBodyFormBodyList(e);i&&(i.userData.cannotToolRot||this.bindStartBody(i,t))}},{key:"bindStartBody",value:function(t,e){if(this.isstart=!0,this.rotMc=t.userData.view){if(!this.rotMc.startDragRect)return void(this.rotMc=null);this.curBody=t;var i=t.get_position();this.downRota=t.get_rotation(),this.downAng=Math.atan2(e.y-i.get_y(),e.x-i.get_x()),this.var_bodystatus=this.BodyUtil.getBodyStatus(t),this.BodyUtil.frezzBody(t),this.BodyUtil.setBodyStatus(t,0),this.rotMc.startDragRect(!0,e)}}},{key:"func_touchMove",value:function(t){if(this.isstart&&this.rotMc){var e=this.curBody.get_position(),i=Math.atan2(t.y-e.get_y(),t.x-e.get_x()),o=i-this.downAng+this.downRota,n=180*o/Math.PI;n=Math.round(n),o=n*Math.PI/180,this.rotMc._rotateHandleFunc(this.rotMc,o,t),this.curBody.set_rotation(o)}}},{key:"func_touchEnd",value:function(t,e){this.isstart&&(this.isstart=!1,this.rotMc&&(this.rotMc.endDragRect(),this.BodyUtil.setBodyStatus(this.rotMc.body,this.var_bodystatus),this.rotMc=null),this.curBody=null,this.globalConfig.main.execute(this.NBCommand.ANALYTICS,{type:"mecTool",name:"rota"}))}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function d(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:d(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(471),l=function(t){return t&&t.__esModule?t:{"default":t}}(h),u=void 0,c=void 0;e["default"]=function(t){function e(t,i){o(this,e);var s=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return u=s.phy.nape,c=u.geom.Vec2,s.classname="Box",i&&(s._width=i[0],s._height=i[1],s.skinColor=i[2],s.verticesArr=s.getVerticesArr()),s}return s(e,t),a(e,[{key:"getVerticesArr",value:function(){var t=[],e=this._width/2,i=this._height/2;return t.push(new c(-e,-i)),t.push(new c(e,-i)),t.push(new c(e,i)),t.push(new c(-e,i)),[t]}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.width=this._width,t.height=this._height,t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.skin&&(this._width=t.width,this._height=t.height,this.verticesArr=this.getVerticesArr(),this.body.shapes.clear(),this.createShape(),this.body.align(),this.body.transformShapes(this.transformN),this.changeSkin(),t.groupName&&this.changeGroup({showValue:t.groupName}))}},{key:"getConf",value:function(){return r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this)}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function d(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:d(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(471),l=function(t){return t&&t.__esModule?t:{"default":t}}(h),u=void 0,c=void 0;e["default"]=function(t){function e(t,i){o(this,e);var s=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return u=s.phy.nape,c=u.geom.Vec2,s.classname="Circle",s.lineColor=11184810,s.var_arcColor=4605510,s.var_edgeColor=11184810,s.lineThin=2,i&&(s.radius=i[0],s.verticesArr=s.getVerticesArr(s.radius),s.skinColor=i[1],s.angle=i[2]),s}return s(e,t),a(e,[{key:"getVerticesArr",value:function(t){for(var e=[],i=0;360>i;i+=1){var o=Math.PI*i/180;e.push(new c(t*Math.cos(o),t*Math.sin(o)))}return[e]}},{key:"func_getLineShape",value:function(){var t=new PIXI.Graphics;return t.lineStyle(this.lineThin,this.var_edgeColor,1),t.drawCircle(0,0,this.radius),this.currentScale.x==this.currentScale.y&&(t.lineStyle(this.lineThin,this.var_edgeColor,1),t.beginFill(this.var_arcColor,.6),t.moveTo(0,0),t.arc(0,0,this.radius*this.currentScale.x,this.angle-.1,this.angle+.1),t.endFill()),t}},{key:"getEdge",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getEdge",this).call(this);return 1==this.currentScale.x&&1==this.currentScale.y&&(t.lineStyle(this.lineThin,this.var_edgeColor,1),t.beginFill(this.var_arcColor,.6),t.moveTo(0,0),t.arc(0,0,this.radius,this.angle-.1,this.angle+.1),t.endFill()),t}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.radius=this.radius,t.angle=this.angle,t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.skin&&(this.radius=t.radius,this.verticesArr=this.getVerticesArr(this.radius),this.angle=t.angle,this.body.shapes.clear(),this.createShape(),this.body.align(),this.body.transformShapes(this.transformN),this.changeSkin(),t.groupName&&this.changeGroup({showValue:t.groupName}))}},{key:"getConf",value:function(){return r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this)}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function m(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:m(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(500),c=o(u),d=i(454),p=o(d),y=i(489),f=o(y),g=i(471),b=o(g),v=void 0,_=void 0;e["default"]=function(t){function e(t,i,o,a,r){n(this,e);var h=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));v=h.phy.nape,_=v.geom.Vec2,h.elecLable="齿轮",h.classname="Gear",h.level=19,h.ismecJoint=!0,h.bg=h,h.r=i||0,h.angle=o||0,h.num=a||0,h.verticesArr=h.func_getVerticesArr(h.r,h.angle,h.num),r&&(h.skinColor=r),h.lineColor=16777215,h.var_edgeColor=11184810,h.lineThin=2,h.bear=null,h.var_isMove=!1,h.edgeArr=[];var l=2/h.getGlobalScale();return h.bearInitScale={x:l,y:l},h}return a(e,t),r(e,[{key:"init",value:function(){var t=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.stopFindConnectBodies=!0;var i=this.body,o=this.func_getFixedBody();this.bear=new c["default"](this.paramObj,i,o),this.bear.x=this.x,this.bear.y=this.y,this.main.addEquipmentChild(this.bear,new l.Point(this.x,this.y)),this.bear.allowSave=!1,this.bear.var_isBind=!0,this.bear.body.userData.allowMove=!1,this.bear.owner=this,this.bear.setScale(this.bearInitScale.x*this.currentScale.x,this.bearInitScale.y*this.currentScale.y),this.addEventListener(p["default"].SET_BODY_STATE,function(e){t.func_setBodyStateHandler(e)})}},{key:"setScale",value:function(t,i){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setScale",this).call(this,t,i),this.bear&&this.bear.setScale(this.bearInitScale.x*this.currentScale.x,this.bearInitScale.y*this.currentScale.y)}},{key:"func_getFixedBody",value:function(){var t=l.Point.vec2ToPoint(this.body.position),e=new _(t.x,t.y),i=this.space.bodiesUnderPoint(e);i.filter(function(t){return(!t.userData||!t.userData.isnbequ)&&!t.userData.view.isMechaTool});var o=this.BodyUtil.getTopBodyFormBodyList(i,[this.body]);return o||(o=this.getWorldBody()),o}},{key:"func_createInit",value:function(){var t=this.getTextureFromName(this.skinMap[this.skinName],this.func_createInit,this);t&&(this.bg=new l.GraphicsTexture(t,l.GraphicsTexture.POLYGON,{points:this.points}),this.addChildAt(this.bg,0))}},{key:"func_setBodyStateHandler",value:function(t){if(this.var_isMove=!1,t&this.BodyUtil.ALLOW_MOVE){this.bear.fixedBodies(this.body,this.func_getFixedBody()),this.var_isMove=!1}else this.var_isMove=!0}},{key:"reFixed",value:function(){if(this.main){this.bear.fixedBodies(this.body,this.func_getFixedBody())}}},{key:"func_create",value:function(){var t={};t.beginBody=this.body,t.beginVec2=this.body.position,t.endBody=this.BodyUtil.getTopBodyFormBodyList(this.napeEngine.space.bodiesUnderPoint(this.body.position),[this.body,this.bear.body]),t.endVec2=this.body.position,this.bear.func_bindVo(t)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.r=this.r,t.angle=this.angle,t.num=this.num,t.bear=this.bear.getData(),t}},{key:"setData",value:function(t){this.r=t.r,this.angle=t.angle,this.num=t.num,this.verticesArr=this.func_getVerticesArr(this.r,this.angle,this.num),t.verticesArr=null,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.bear.setData(t.bear)}},{key:"getConf",value:function(){var t=this.bear.getConf();return t.elecLable=this.language.getLocaleStr("gear"),t.confArr.push(this.ComponentProperty.getDropMenu(this.language.getLocaleStr("custom_graphics"),!1,"",this.namelist[this.skinIndex],this.namelist,this,this.changeMatrialSkin,1,0),this.ComponentProperty.getDropMenu(this.language.getLocaleStr("grouping"),!1,"",this.groupMap[this.groupIndex],this.groupMap,this,this.changeGroup,1,0),this.ComponentProperty.getSwitch(this.language.getLocaleStr("force_analysis"),this.openF_analysis,this.changeForceAnalysis,this)),t}},{key:"func_getVerticesArr",value:function(t,e,i){var o=[];if(5>t)return o;var n=void 0;3>(n=i&&i>=3?i:this.func_getNum(t))&&(n=3);var s=5*n,a=18;n>6||(a=11+n);var r=s+a,h=[{f:1/8,rad:s},{f:.4,rad:r},{f:.6,rad:r},{f:7/8,rad:s}],l=[];this.edgeArr=[],o.push(l);for(var u=0;n>u;u++){var c=2*Math.PI/n,d=e+c*u,p=new _(Math.cos(d)*s,Math.sin(d)*s);l.push(p),this.edgeArr.push(p);for(var y=[],f=0;h.length>f;f++){var g=d+c*h[f].f,b=h[f].rad,v=new _(Math.cos(g)*b,Math.sin(g)*b);y.push(v),this.edgeArr.push(v)}o.push(y)}return o}},{key:"func_getNum",value:function(t){return Math.ceil((t-5)/5)+2}},{key:"getEdge",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getEdge",this).call(this);t.lineStyle(this.lineThin,this.lineColor,1);for(var i=0;this.edgeArr.length>i;i++){var o=this.edgeArr[i];0===i?t.moveTo(o.get_x()*this.currentScale.x,o.get_y()*this.currentScale.y):t.lineTo(o.get_x()*this.currentScale.x,o.get_y()*this.currentScale.y)}return t}},{key:"selfShowSelect",value:function(){this.paramObj.moduleMain.napeEngine.transformManager.show(this),this.paramObj.moduleMain.napeEngine.transformManager.setRotateEnabled(!1),this.paramObj.moduleMain.napeEngine.transformManager.setScaleMode(f["default"].SCALE_UNIFORM)}},{key:"getTipMess",value:function(){var t='    <font class="pre-tipmess-title">'+this.elecLable+"</font>";return t+="\n    "+this.language.getLocaleStr("ratio")+": "+this.bear.var_speed+"\n    "+this.language.getLocaleStr("coefficient")+": "+this.bear.var_torque+"\n    "}}]),e}(b["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.geom.Vec2,p=c.shape.HockShapeBase,i.topHock=null,i.bottomHock=null,i.material=new c.phys.Material(0,.5,.6,2.7,.001),i}return s(e,t),a(e,[{key:"init",value:function(){this._width=78,this._height=44,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.noallowRotation=!0,this.topHock=new p(15),this.topHock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.topHock),this.topHock.translate(d.get(0,-36)),this.topHock.addCbtype(this.CbTypeStr.HOOK_TOP_GOU,!0),this.topHock.connectVec=d.get(0,-10),this.bottomHock=new p(15),this.bottomHock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.bottomHock),this.bottomHock.translate(d.get(0,36)),this.bottomHock.addCbtype(this.CbTypeStr.HOOK_BOTTOM_GOU),this.bottomHock.createListener(this.CbTypeStr.HOOK_TOP_GOU,this.CbTypeStr.HOOK_BOTTOM_GOU),this.bottomHock.connectVec=d.get(0,10),this.changeMass({showValue:"50"}),this.addTweenQuan(this.topHock),this.addTweenQuan(this.bottomHock)}},{key:"removed",value:function(){this.topHock.dragToolClick(),this.bottomHock.dragToolClick(),this.topHock.dispose(),this.bottomHock.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"changeMass",value:function(t){switch(h.M.getNumStr(t.showValue)+""){case"10":this.bg.gotoAndStop(0),this.body.set_mass(10);break;case"20":this.bg.gotoAndStop(1),this.body.set_mass(20);break;case"50":this.bg.gotoAndStop(2),this.body.set_mass(50);break;case"100":this.bg.gotoAndStop(3),this.body.set_mass(100)}}},{key:"sameCodelist",value:function(t,i){i.push(t);var o=t.bottomHock.get_userData();if(o.useing){var n=o.bind;if(n instanceof p){var s=n.get_body().userData.view;s instanceof e&&this.sameCodelist(s,i)}}}},{key:"bottomHockBreak",value:function(){this.bottomHock.get_userData().useing&&this.bottomHock.dragToolClick()}},{key:"getThisMass",value:function(){return this.body.get_mass()}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.mass=this.body.get_mass()+"g",t}},{key:"setData",value:function(t){t.thisY-=20,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.changeMass({showValue:t.mass})}},{key:"update",value:function(){if(r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.topHock&&!this.topHock.get_userData().useing){this.body.get_allowRotation()&&(this.body.set_rotation(0),this.body.set_allowRotation(!1),this.BodyUtil.frezzBody(this.body)),0!=this.body.get_rotation()&&this.body.set_rotation(0)}}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getDropMenu(this.language.getLocaleStr("mass"),!1,"g",this.body.get_mass()+"g",["10g","20g","50g","100g"],this,this.changeMass,360,0)),t}},{key:"showGlowSP",value:function(t){if(t){var e=this.topHock.get_userData().useing,i=this.bottomHock.get_userData().useing;this.showGlowIndex(e||i?e&&!i?1:!e&&i?2:3:0)}else this.hideGlow()}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function P(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:P(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(550),c=o(u),d=i(454),p=o(d),y=i(446),f=o(y),g=i(226),b=o(g),v=void 0,_=void 0,m=void 0,x=void 0,w=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return v=i.phy.nape,_=v.geom.Vec2,i.JointUtil=t.moduleMain.JointUtil,i.BodyUtil=t.moduleMain.BodyUtil,m=v.dynamics.InteractionGroup,x=v.phys.Material,w=v.phys.Compound,i.cateid=5,i.classname="RopeView",i.elecLable="绳子",i.bg=i,i.compound=new w,i.level=20,i.onelen=45,i.trueLen=50,i.firstBox=null,i.firstJoint=null,i.firstBody=null,i.secBox=null,i.secJoint=null,i.secBody=null,i.spring=null,i.spring_view=null,i.flagP=null,i.nodeCon=[],i.last=null,i.ismecJoint=!0,i.isMechanics=!0,i.fromEquTools=!1,i.ropeGroup=new m(!0),i.noRenderSelected=!0,i}return a(e,t),r(e,[{key:"added",value:function(){this.hasAddCompComplete=!0,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);if(!this.firstBox||!this.secBox)return t;t.thisX=this.x,t.thisY=this.y,t.uid=this.UID,t.ismecJoint=this.ismecJoint,t.fromEquTools=this.fromEquTools,t.firstBox={x:this.firstBox.body.posx,y:this.firstBox.body.posy},t.secBox={x:this.secBox.body.posx,y:this.secBox.body.posy},t.b1={uid:(this.firstBody.userData?this.firstBody.userData.view:{}).UID},t.b2={uid:(this.secBody.userData?this.secBody.userData.view:{}).UID},t.nodes=[];var i=0;for(i=0;this.nodeCon.length>i;i++){t.nodes.push(this.nodeCon[i].getData())}return t}},{key:"setData",value:function(t){var i=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t);var o=new c["default"](this.paramObj),n=void 0,s=void 0;n=o.getBodyFromUid(t.b1.uid),this.fixFirstBox(n,_.get(t.firstBox.x,t.firstBox.y));var a=t.nodes,r=void 0;for(r=0;a.length>r;r++){var l=new k(this.paramObj,this.trueLen);l.var_gap=(this.trueLen-this.onelen)/2,this.addChild(l),l.init(),l.resetUserView(l,this,!0),l.body.setGroup(this.ropeGroup),l.setData(a[r]),this.nodeCon.push(l);var u=void 0,d=void 0;this.last.getrightVec2?u=this.last.getrightVec2():(this.firstBox.node=l.body,u=this.last.body.position),d=l.getleftVec2(),this.JointUtil.createPivotJoint(this.last.body,l.body,u,d),this.last=l}s=o.getBodyFromUid(t.b2.uid),s?s.setGroup(this.ropeGroup):s=o.getWorldBody(),this.secBox=new c["default"](this.paramObj),this.addChild(this.secBox),this.secBox.init(),this.secBox.addBodyToSpace(this.secBox.body,this),this.secBox.addEventListener(p["default"].SET_BODY_STATE,function(t){i.setBodyStateHandler(t,i.secBox)}),this.secBody=s;var y=_.get(t.secBox.x,t.secBox.y);this.secBox.body.set_position(y),this.secJoint=this.JointUtil.createWeldJoint(this.secBox.body,s,y,y),this.secJoint.userData.toolView=this;var f=this.last.getrightVec2();this.secBox.node=this.last.body,this.JointUtil.createPivotJoint(this.last.body,this.secBox.body,f,f)}},{key:"bodyContainsConstraint",value:function(t,e){return!!t.contains(this.firstBody.localPointToWorld(this.firstJoint.anchor2))||!!t.contains(this.secBody.localPointToWorld(this.secJoint.anchor2))}},{key:"changeBody",value:function(t,e){t==this.firstBody?(this.__changeJointSecondBody(this.firstJoint,t,e),this.firstBody=e):t==this.secBody&&(this.__changeJointSecondBody(this.secJoint,t,e),this.secBody=e)}},{key:"__changeJointSecondBody",value:function(t,e,i){var o=e.localPointToWorld(this.firstJoint.anchor2),n=i.worldPointToLocal(o),s=t.get_body1().rotation-i.rotation;t.anchor2=n,t.set_body2(i),t.set_phase(s)}},{key:"bodyChanged",value:function(t){this.firstBody===t?t.contains(_.weak(this.firstBox.x,this.firstBox.y))||(this.firstBody=this.getWorld()):this.secBody===t&&(t.contains(_.weak(this.secBox.x,this.secBox.y))||(this.secBody=this.getWorld()))}},{key:"getWorld",value:function(){return this.firstBox.getWorldBody()}},{key:"checkRemove",value:function(){this.firstBody===this.getWorld()&&this.secBody===this.getWorld()&&setTimeout(this.removeFromFramework.bind(this),0,this)}},{key:"fixFirstBox",value:function(t,e){var i=this;this.flagP=l.Point.vec2ToPoint(e),this.firstBox=new c["default"](this.paramObj),this.addChild(this.firstBox),this.firstBox.init(),this.firstBox.addBodyToSpace(this.firstBox.body,this),this.firstBox.body.set_position(e),this.compound.set_space(this.firstBox.body.get_space()),this.firstBox.body.set_compound(this.compound),null==t?t=this.firstBox.getWorldBody():t.setGroup(this.ropeGroup),this.last=this.firstBox,this.firstBody=t,this.firstJoint=this.JointUtil.createWeldJoint(this.firstBox.body,this.firstBody,e,e),this.firstJoint.userData.toolView=this,this.firstBox.addEventListener(p["default"].SET_BODY_STATE,function(t){i.setBodyStateHandler(t,i.firstBox)})}},{key:"drawRope",value:function(t){var e=l.Point.distance(this.flagP,t);if(e>this.onelen){this.createNode(e/Math.floor(this.onelen),t)}}},{key:"createNode",value:function(t,e,i){var o=0,n=Math.atan2(e.y-this.flagP.y,e.x-this.flagP.x);for(o=0;t>o;o++){var s=this.onelen*Math.cos(n),a=this.onelen*Math.sin(n),r=new k(this.paramObj,this.trueLen);r.var_gap=(this.trueLen-this.onelen)/2,this.addChildAt(r,0),r.init(),r.resetUserView(r,this,!0),r.body.set_position(_.get(this.flagP.x+s/2,this.flagP.y+a/2)),r.body.rotation=n,r.body.setGroup(this.ropeGroup),r.body.set_compound(this.compound),this.flagP.x+=s,this.flagP.y+=a,this.nodeCon.push(r);var h=void 0,l=void 0;this.last.getrightVec2?h=this.last.getrightVec2():(this.firstBox.node=r.body,h=this.last.body.position),l=r.getleftVec2();this.JointUtil.createPivotJoint(this.last.body,r.body,h,l).set_compound(this.compound),this.last=r,this.BodyUtil.setBodyStatus(r.body,0),r.body.sensorEnabled(!0),i&&(h=r.getrightVec2(),l=_.get(this.flagP.x,this.flagP.y),this.secBox.node=r.body,this.secBox.body.set_position(l),this.JointUtil.createPivotJoint(r.body,this.secBox.body,h,l))}}},{key:"ropeNodeSensor",value:function(t){var e=0;for(e=0;this.nodeCon.length>e;e++)this.nodeCon[e].body.sensorEnabled(t)}},{key:"setBodyStateHandler",value:function(t,e){if(t&this.BodyUtil.ALLOW_MOVE){var i=e.napeEngine.space.bodiesUnderPoint(e.body.position);i.filter(function(t){return!t.userData||!t.userData.isnbequ});var o=this.BodyUtil.getTopBodyFormBodyList(i,[e.body,e.node]),n=void 0;o?(n=o.worldPointToLocal(e.body.position),o.setGroup(this.ropeGroup)):(o=e.getWorldBody(),n=e.body.position),e==this.firstBox?(this.firstBody!=o&&(this.firstBody!=this.secBox.getWorldBody()&&this.firstBody.setGroup(null),this.firstBody=o),this.firstJoint.anchor2=n,this.firstJoint.set_body2(o)):(this.secBody!=o&&(this.secBody!=this.secBox.getWorldBody()&&this.secBody.setGroup(null),this.secBody=o),this.secJoint.anchor2=n,this.secJoint.set_body2(o)),this.secJoint.active=!0,this.firstJoint.active=!0,this.ropeNodeSensor(!1)}else e==this.firstBox?this.firstJoint.active=!1:this.secJoint.active=!1,this.ropeNodeSensor(!0)}},{key:"ropeCreateComplete",value:function(t,e){var i=this;this.secBox=new c["default"](this.paramObj),this.addChild(this.secBox),this.secBox.init(),this.secBox.addBodyToSpace(this.secBox.body,this),this.secBox.body.set_compound(this.compound),this.secBox.addEventListener(p["default"].SET_BODY_STATE,function(t){i.setBodyStateHandler(t,i.secBox)}),this.createNode(1,l.Point.vec2ToPoint(e),!0),null==t?t=this.secBox.getWorldBody():t.setGroup(this.ropeGroup),this.secBody=t,this.secJoint=this.JointUtil.createWeldJoint(this.secBox.body,t,e,e),this.secJoint.userData.toolView=this;var o=0;for(o=0;this.nodeCon.length>o;o++)this.BodyUtil.setBodyStatus(this.nodeCon[o].body,3);this.addChild(this.firstBox),this.ropeNodeSensor(!1)}},{key:"removed",value:function(){this.firstJoint.userData.toolView=null,this.secJoint&&(this.secJoint.userData.toolView=null),this.compound&&this.compound.breakApart();var t=0;for(t=0;this.nodeCon.length>t;t++)this.nodeCon[t].removed();this.firstBox.removed(),this.firstBox=null,this.firstJoint=null,this.firstBody=null,this.secBox&&(this.secBox.removed(),this.secBox=null,this.secJoint=null,this.secBody=null),this.bg=null,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}}]),e}(b["default"]);var k=function(t){function e(t,i){n(this,e);var o=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.material=new x(0,.1,.2,10,.02),o.gap=2,o.bg=PIXI.Sprite.fromFrame("mechSkin/rope"),o.addChild(o.bg),l.M.alignPivot(o.bg,"center","center"),o.sw=i||50,o.sh=o.sw/o.bg.width*o.bg.height,o.bg.width=o.sw,o.bg.height=o.sh,o}return a(e,t),r(e,[{key:"init",value:function(){this._width=this.sw,this._height=this.sh,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.classType="ropeNode"}},{key:"getleftVec2",value:function(){return this.body.localPointToWorld(_.weak(-this.sw/2+this.gap,0))}},{key:"getrightVec2",value:function(){return this.body.localPointToWorld(_.weak(this.sw/2-this.gap,0))}}]),e}(f["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function c(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:c(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(608),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.leftV=null,i.rightV=null,i.qianBanArr=[],i.qianArr=[],i.banIndex=0,i.qianIndex=0,i.p4Arr=[new h.Point(0,0),new h.Point(0,0),new h.Point(0,0),new h.Point],i.con=new PIXI.Container,i.addChild(i.con),i.var_g_=new PIXI.Graphics,i.addChild(i.var_g_),i.ss=new PIXI.Graphics,i.addChild(i.ss),i.selected=!1,i}return s(e,t),a(e,[{key:"overrideFunc",value:function(){this.removeChild(this.var_line),this.var_line=null}},{key:"removed",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){if(this.parent&&this.joint){var t=this.getMain(),e=h.Point.vec2ToPoint(this.joint.body1.localPointToWorld(this.joint.anchor1)),i=h.Point.vec2ToPoint(this.joint.body2.localPointToWorld(this.joint.anchor2));e=this.toLocal(e,t.view),i=this.toLocal(i,t.view),this.drawSJ(e,i)}}},{key:"drawSJ",value:function(t,e){if(0!=this.count){this.banIndex=0,this.qianIndex=0;var i=new h.Point(t.x,t.y),o=new h.Point(e.x,e.y);this.leftV=i.clone(),this.rightV=o.clone();var n=h.M.getPointLen(i,o),s=n/this.count,a=[],r=void 0;r=56>s?Math.sqrt(h.M.sq(28)-h.M.sq(s/2)):0;var l=h.M.getXianDuanGaoXianDian(i,o,r,!0),u=h.M.getXianDuanGaoXianDian(i,o,r,!1),c=h.M.getXianDuanGaoXianDian(o,i,r,!0),d=h.M.getXianDuanGaoXianDian(o,i,r,!1);this.p4Arr[0]=new h.Point(l.x,l.y),this.p4Arr[1]=new h.Point(u.x,u.y),this.p4Arr[2]=new h.Point(c.x,c.y),this.p4Arr[3]=new h.Point(d.x,d.y);var p=void 0;for(p=0;this.count>=p;p++){var y=h.M.getXianDianByDis(s*p-s/2,!0,i,o);a.push(h.M.getXianDuanGaoXianDian(y,i,r-6,p%2!=0))}if(this.var_g_.clear(),26>r){var f=0;for(f=15>r?.8:.8*(1-(r-15)/11),this.var_g_.lineStyle(10,16711680,f),this.var_g_.moveTo(i.x,i.y),b=1;a.length>b;b++){var g=a[b];this.var_g_.lineTo(g.x,g.y)}this.var_g_.lineTo(o.x,o.y)}this.var_g_.lineStyle(2,16777215,this.selected?.3:0),this.var_g_.beginFill(16777215,0),this.var_g_.moveTo(l.x,l.y),this.var_g_.lineTo(u.x,u.y),this.var_g_.lineTo(c.x,c.y),this.var_g_.lineTo(d.x,d.y),this.var_g_.endFill();var b=void 0,v=void 0,_=void 0;for(b=2;a.length-1>b;b+=2)v=a[b],_=a[b+1],this.add_quadBatch_data("qian",_,v);for(this.add_quadBatch_data("qianban",i,a[1]),this.add_quadBatch_data("qianban",o,a[a.length-1]),b=1;a.length-1>b;b+=2){for(v=a[b],_=a[b+1],this.add_quadBatch_data("qian",_,v),this.ss.clear(),this.ss.beginFill(16711697,0),this.ss.drawRect(-25,20,50,e.y-40),this.ss.endFill(),p=this.qianIndex;this.qianBanArr.length>p;p++)this.qianBanArr[p].parent&&this.con.removeChild(this.qianBanArr[p]);for(p=this.banIndex;this.qianArr.length>p;p++)this.qianArr[p].parent&&this.con.removeChild(this.qianArr[p])}}}},{key:"add_quadBatch_data",value:function(t,e,i){var o=void 0;"qianban"==t?this.qianBanArr.length>this.qianIndex?(o=this.qianBanArr[this.qianIndex],this.qianIndex++):(o=PIXI.Sprite.fromFrame("mechSkin/"+t),this.qianBanArr.push(o)):"qian"==t&&(this.qianArr.length>this.banIndex?(o=this.qianArr[this.banIndex],this.banIndex++):(o=PIXI.Sprite.fromFrame("mechSkin/"+t),this.qianArr.push(o))),o.pivot.x=o.width/2,o.pivot.y=o.height/2,o.x=(e.x+i.x)/2,o.y=(e.y+i.y)/2;var n=h.M.getAngleP(i,e)-90;o.rotation=h.M.toHu(n),this.con.addChild(o)}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var n=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),s=i(1),a=void 0,r=void 0,h=void 0,l=void 0;e["default"]=function(){function t(e){o(this,t),a=e.geom.AABB,r=e.geom.Vec2,h=e.geom.Vec2List,l=e.shape.EdgeList}return n(t,[{key:"angle",value:function(t,e){var i=t.get_length(),o=e.get_length(),n=t.cross(e),s=n/(i*o);return Math.acos(s)}},{key:"vec3ToVec2",value:function(t){return t&&t.get_x&&t.get_y?r.get(t.get_x(),t.get_y()):r.get(0,0)}},{key:"vec2ToPoint",value:function(t){return t&&t.get_x&&t.get_y?new s.Point(t.get_x(),t.get_y()):new s.Point(0,0)}},{key:"pointToVec2",value:function(t){return new r(t.x,t.y)}},{key:"getAABBFromVec",value:function(t,e){var i=new a(Math.min(t.get_x(),e.get_x()),Math.min(t.get_y(),e.get_y()),Math.abs(t.get_x()-e.get_x()),Math.abs(t.get_y()-e.get_y()));return 0==i.zpp_inner.width()&&(i.zpp_inner.minx=1,i.zpp_inner.validate()),0==i.zpp_inner.height()&&(i.zpp_inner.miny=1,i.zpp_inner.validate()),i}},{key:"getWorldVec2ListFromCircle",value:function(t,e){var i=6/180*Math.PI,o=t.get_radius();20>o&&(i=30/180*Math.PI);for(var n=[],s=e.get_x?e.get_x():e.x,a=e.get_y?e.get_y():e.y,l=0;l<=2*Math.PI;l+=i)n.push(r.get(s+Math.cos(l)*o,a+Math.sin(l)*o));return h.fromArray(n)}},{key:"getPointsFromGeomPoly",value:function(t,e,i){var o=t.zpp_inner.vertices;e||(e=0),i||(i=0);for(var n=o,s=[];o;)s.push({x:o.x-e,y:o.y-i}),o=o.next==n?null:o.next;return s}},{key:"getBodyEdge",value:function(t){var e=t.get_shapes();if(1!=e.get_length()){var i=(new l,[]);return e.foreach(function(t){t.get_edges().foreach(function(t){var e=t.get_worldVertex1(),o=t.get_worldVertex2(),n=void 0,s=!1;for(n=0;i.length>n;n++){var a=i[n],r=a.v1.get_x()==e.get_x()&&a.v1.get_y()==e.get_y()&&a.v2.get_x()==o.get_x()&&a.v2.get_y()==o.get_y(),h=a.v1.get_x()==o.get_x()&&a.v1.get_y()==o.get_y()&&a.v2.get_x()==e.get_x()&&a.v2.get_y()==e.get_y();if(r||h){i.splice(n,1),s=!0;break}}s||i.push({v1:e,v2:o})})}),{compound:!0,list:i}}var o=e.at(0);return o.isPolygon()?o.get_worldVerts():o.isCircle()?{radius:o.get_radius(),pos:o.get_worldCOM()}:void 0}},{key:"vec2ArrArrToPointArrArr",value:function(t){for(var e=t.length,i=[],o=0;e>o;o++){i.push(this.vec2ArrToPointArr(t[o]))}return i}},{key:"vec2ArrToPointArr",value:function(t){for(var e=[],i=t.length,o=0;i>o;o++){e.push(this.vec2ToPoint(t[o]))}return e}},{key:"pointArrArrToVec2ArrArr",value:function(t){for(var e=t.length,i=[],o=0;e>o;o++){i.push(this.pointArrToVec2Arr(t[o]))}return i}},{key:"pointArrToVec2Arr",value:function(t){for(var e=[],i=t.length,o=0;i>o;o++){e.push(this.pointToVec2(t[o]))}return e}}]),t}()},,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var n=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),s=function(){function t(){o(this,t)}return n(t,null,[{key:"injectionClass",value:function(e){t.nape=e.phy.nape,t.MouseManager=e.MouseManager,t.NBCommand=e.NBCommand,t.MechanicsPopTool=e.MechanicsPopTool}}]),t}();s.napeEngine=null,e["default"]=s},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e["default"]=function n(t){o(this,n);var e=t.callbacks.CbType;this.CEIL_HOOK=new e,this.PLASTICPLATE_HOOK=new e,this.HOOK_TOP_GOU=new e,this.HOOK_BOTTOM_GOU=new e,this.SPRING_HOCK=new e,this.FIXED_PULLEY_UP_HOCK=new e,this.FIXED_PULLEY_BOTTOM_HOCK=new e,this.FIXED_PULLEY_LEFT_HOCK=new e,this.FIXED_PULLEY_RIGHT_HOCK=new e,this.SUBMARINE=new e,this.WATER_BEAKER=new e,this.LEVER_HOOK_GOU=new e,this.LITTLE_PAIL=new e,this.OVERFLOW_CUP=new e,this.HOOKWOOD_HOCK=new e,this.FIXED_PULLEY_HOCK=new e,this.PULL_LA_HOCK=new e,this.PULL_WU_HOCK=new e,this.PARALL_R_HOCK=new e,this.SPRINGSPRING_HOCK=new e,this.H_PAPER_TICKER=new e,this.V_PAPER_HOCK=new e,this.TICKER_CARBON=new e,this.PULLEY_BOARD_HOCK=new e,this.PULLEY_TICK_CAR=new e,this.ALUMINUM_BLOCK=new e,this.NB_CAR=new e,this.PULL_LONG_BOARD=new e,this.PULL_LONG_DANG=new e,this.BOARD_CAR=new e,this.LONG_BOARD_TM=new e,this.GALLOON_HOCK=new e,this.STONE_HOCK=new e,this.WAX_BLOCK_HOCK=new e,this.SPRING_HEAD_HOCK=new e,this.LEVER_DIAO_HOCK=new e,this.OPTICA_LGLASS=new e,this.ONEPART_GLASS=new e,this.LASER_DEMONSTRATOR=new e,this.FLUIDBASE=new e,this.GLOBAL_WALL=new e,this.PERISCOPE=new e,this.AIR_TRACK=new e,this.AIR_SLIDEBLOCK=new e,this.AIR_SLIDEBLOCK_HOCK=new e,this.AIR_SLIDEBLOCK_LEFT_HOCK=new e,this.AIR_SLIDEBLOCK_SHADE=new e,this.POUR_POS_SHAPE=new e,this.LIQUID_SHAPE=new e,this.CONTAINER_BOTTOM=new e,this.BALANCE_PAN=new e,this.SHELTER_LIGHT=new e,this.LITTLEPAIL_HPCK=new e,this.SENSOR_CAR=new e,this.SENSOR_BOARD_DANG=new e,this.ALL_HOOK_ARY=[this.SPRING_HOCK,this.HOOK_TOP_GOU,this.CEIL_HOOK,this.SPRINGSPRING_HOCK],this.SENSOR_ALL=[this.HOOK_TOP_GOU]}},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function _(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:_(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(451),c=o(u),d=i(474),p=o(d),y=i(463),f=o(y),g=i(492),b=o(g),v=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.useDragSetCurElec=!0,i.skinType=1,i.lineColor=11184810,i.lineThin=2,i.skinColor=i.randomColor(),i.skinIndex=0,i.namelist=[i.language.getLocaleStr("default"),i.language.getLocaleStr("mat_aluminum"),i.language.getLocaleStr("wood"),i.language.getLocaleStr("glass"),i.language.getLocaleStr("ice_block")],i.originlist=["默认","铝","木材","玻璃","冰块"],i.skinName=i.originlist[i.skinIndex],i.skinProto={"默认":[1.5,.7,.4],"铝":[2.7,.7,.4],"大理石":[3.6,.5,.3],"木材":[.5,.4,.2],"玻璃":[2.5,.2,.5],"冰块":[.9,.1,.1]},i.isFreeMec=!0,i.selectEdge=!1,i.skinP=new l.Point(0,0),i.vo=new f["default"](!0,!0,1.5),i.lightprototype=!1,i.groupIndex=0,i.groupMap=[i.language.getLocaleStr("default"),"A","B","C","D"],i.meltFlag=!1,i.inWater=!1,i.edgeLine=null,i}return a(e,t),r(e,[{key:"removed",value:function(){this.cacheLine(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.freeMec=!0,this.componentBox.visible=!1,this.body.align(),this.changeSkin(),this.openAngleFunc(this.globalConfig.OPEN_ANGLE),this.showDirectionFunc(this.globalConfig.SHOW_DIRECTION),this.showReflectFunc(this.globalConfig.SHOW_REFLECT),this.body.userData.dragLevel=3,this.hasAddCompComplete=!0}},{key:"getDragRect",value:function(){var t=this.bg.getLocalBounds();return{x:t.x*this.skinCon.scale.x,y:t.y*this.skinCon.scale.y,width:t.width*this.skinCon.scale.x,height:t.height*this.skinCon.scale.y}}},{key:"confType",value:function(t,i){e.OPEN_ANGLE==t?this.openAngleFunc(i):e.SHOW_REFLECT==t?this.showReflectFunc(i):e.SHOW_DIRECTION==t&&(this.showDirectionFunc(i),b["default"].OPEN_LIGHT_DIRECTION=i)}},{key:"openAngleFunc",value:function(t){this.vo&&(this.vo.var_open_angle=t)}},{key:"showReflectFunc",value:function(t){this.vo&&this.vo.var_canRefraction&&(this.vo.var_canReflection=t?this.vo.var_copyReflection:t)}},{key:"showDirectionFunc",value:function(t){this.vo&&(this.vo.var_show_direction=t)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.freeMechanics=!0,t.analysis=this.openF_analysis,t.skinIndex=this.skinIndex,t.skinType=this.skinType,t.skinColor=this.skinColor,t.lightprototype=this.lightprototype,t.rateN=this.vo.n,t.groupIndex=this.groupIndex,t.meltFlag=this.meltFlag,t}},{key:"setData",value:function(t){var i=this;this.disposeEdge(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.skinIndex=t.skinIndex||0,this.skinName=this.originlist[this.skinIndex],this.skinType=t.skinType||1,this.skinColor=t.skinColor||this.randomColor(),this.groupIndex=t.groupIndex||0,this.changeGroup({showValue:this.groupMap[this.groupIndex]}),t.analysis&&1==t.analysis&&this.changeForceAnalysis({checked:!0}),t.lightprototype&&setTimeout(function(){i.hadDestory||(i.vo.n=t.rateN,i.lightprototype=t.lightprototype,i.gotoOpticsMc())},10),this.meltFlag=t.meltFlag}},{key:"copyFunc",value:function(){var t=this.globalConfig.main.curElec.getData();t.uid=null,this.globalConfig.main.copyEqu(t)}},{key:"randomColor",value:function(){return p["default"].getColor()}},{key:"gotoOpticsMc",value:function(){var t=this;this.body.get_shapes().foreach(function(e){e.get_userData().vo=t.lightprototype?t.vo:null})}},{key:"changeMatrialSkin",value:function(t){if(t){var e=this.namelist.indexOf(t.showValue);0>e&&(e=0),this.skinIndex=e,this.skinName=this.originlist[e],this.skinType="默认"==this.skinName?1:2;var i=this.skinProto[this.skinName];this.BodyUtil.setMaterialFromObject(this.material,{density:i[0],dynamicFriction:i[1],elasticity:i[2]});var o=this.body.get_shapes(),n=this.material.get_density();o.foreach(function(t){t.set_density(n)}),"玻璃"==this.skinName||"冰块"==this.skinName?(this.vo.n=this.vo.rate="玻璃"==this.skinName?1.5:1.3,this.lightprototype?this.showToolDatas():(this.lightprototype=!0,this.gotoOpticsMc(),this.showToolDatas())):this.lightprototype?(this.lightprototype=!1,this.gotoOpticsMc(),this.showToolDatas()):this.showToolDatas(),this.freshLibPan()}this.bg&&this.changeSkin()}},{key:"changeSkin",value:function(){if(this.lineThin=2/this.getGlobalScale(),this.cacheLine(),1==this.skinType)this.replaceBg(this.bg,this.getFillSkin());else{var t=this.getTextureFromName(this.skinMap[this.skinName],this.changeSkin,this);t&&(0===t.width&&(t.width=512),0===t.height&&(t.height=512),this.replaceBg(this.bg,this.getTextureSkin(t)))}}},{key:"replaceBg",value:function(t,e){this.bg=e,this.skinCon.removeChild(t),this.updateSkinP(),this.skinCon.addChild(this.bg),this.bg.x=this.skinP.x,this.bg.y=this.skinP.y,this.edgeLine=this.getEdge(),this.bg.addChild(this.edgeLine);var i=this.body.get_position();this.x=i.get_x(),this.y=i.get_y()}},{key:"cacheLine",value:function(){this.edgeLine&&(this.globalConfig.main.cachePool.pushGraphic(this.edgeLine),this.bg.removeChild(this.edgeLine),this.edgeLine=null)}},{key:"getGlobalScale",value:function(){return this.globalConfig.main.view.scale.x}},{key:"updateSkinP",value:function(){this.skinP.x=0,this.skinP.y=0}},{key:"getTextureSkin",value:function(t){return new PIXI.Sprite}},{key:"getFillSkin",value:function(){return new PIXI.Container}},{key:"getEdge",value:function(){return this.globalConfig.main.cachePool.popGraphic()}},{key:"changeForceAnalysis",value:function(t){(this.openF_analysis=t.checked)||this.removeForceAnalysis()}},{key:"changeDensity",value:function(t){this.BodyUtil.setMaterial(this.material,"density",l.M.getNumStr(t.showValue)-0)}},{key:"changeMass",value:function(t){this.BodyUtil.setMaterial(this.material,"density",(l.M.getNumStr(t.showValue)-0)/this.BodyUtil.getBodyArea(this.body)*1e3)}},{key:"changeDfriction",value:function(t){var e=l.M.getNumStr(t.showValue)-0;this.BodyUtil.setMaterial(this.material,"dynamicFriction",e),this.BodyUtil.setMaterial(this.material,"staticFriction",e)}},{key:"showEdge",value:function(){var t=Ver2Util.getBodyEdge(this.body),e=[];e.push({option:"BodyEdges"}),e.push({color:16777215,alpha:1,thin:3,data:t}),this.getTopGrc().dispatchEvent("Start_Graphic",e,this.UID),this.selectEdge=!0}},{key:"setSelected",value:function(t){var i=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setSelected",this).call(this,t),this.interval&&(clearTimeout(this.interval),this.interval=null),t?this.interval=setTimeout(function(){i.hadDestory||(i.interval=null,i.paramObj.moduleMain.napeEngine.transformManager.show(i),i.selfShowSelect())},0):this.paramObj.moduleMain.napeEngine.transformManager.hide()}},{key:"selfShowSelect",value:function(){}},{key:"disposeEdge",value:function(){this.getTopGrc().dispatchEvent("Dispose_Graphics",this.UID),this.selectEdge=!1}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.selectEdge&&this.showEdge()}},{key:"updateEnd",value:function(){this.iceMelt2()}},{key:"iceMelt2",value:function(){if(this.inWater)return void(this.inWater=!1);if(this.meltFlag&&this.isIce()&&this.body){var t=this.body.getArea();if(.1>this.currentScale.x&&400>t)this.removeEquipment(this);else{var e=1;e=1-(t>3e3?.001:.001*(3200-t)/200)*e*.25,this.setScale(this.currentScale.x*e,this.currentScale.y*e)}}}},{key:"inWaterUpdate",value:function(t,i){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"inWaterUpdate",this).call(this,t,i),this.iceMelt(t,i)}},{key:"iceMelt",value:function(t,e){if(this.meltFlag&&this.isIce()){var i=t.get_overlap(),o=this.body.getArea(),n=0;if(.1>this.currentScale.x&&400>o)n=o,this.removeEquipment(this);else{var s=i/o;s=1-(o>3e3?.001:.001*(3200-o)/200)*s*.25-25e-5,this.setScale(this.currentScale.x*s,this.currentScale.y*s),n=o-this.body.getArea()}var a=e.liquid.density;e.liquidArea+=this.material.get_density()*n/a,this.inWater=!0}}},{key:"getWaterContainerByLiquidShape",value:function(t){if(!t)return null;var e=t.get_body();return e&&e.userData?e.userData.view:null}},{key:"isIce",value:function(){return"冰块"===this.skinName}},{key:"removeEquipment",value:function(t){t.body&&t.body.userData&&(t.body.userData.dragManager&&t.body.userData.dragManager.func_touchEnd(new l.Point),this.main.removeEquipment(t))}},{key:"changeElec",value:function(t){this.BodyUtil.setMaterial(this.material,"elasticity",l.M.getNumStr(t.showValue)-0)}},{key:"getMaxMass",value:function(){var t=this.body.getArea();return l.M.getNumJie(13.6*t*.001,1)}},{key:"getMinMass",value:function(){var t=this.body.getArea();return l.M.getNumJie(.7*t*.001,1)}},{key:"changeRate",value:function(t){this.vo.n=l.M.getNumStr(t.showValue)-0}},{key:"changeGroup",value:function(t){if(this.body)if(0==(this.groupIndex=this.groupMap.indexOf(t.showValue)))this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.GROUP_DEFAULT);else{var e=["default","A","B","C","D"];this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager["GROUP_"+e[this.groupIndex]])}}},{key:"changeMelt",value:function(t){this.meltFlag=t.checked}},{key:"getConf",value:function(){this.elecLable=this.language.getLocaleStr("body");var t={};t.confArr=[];var e=this;return t.confArr.push(this.ComponentProperty.getDropMenu(this.language.getLocaleStr("custom_graphics"),!1,"",this.namelist[this.skinIndex],this.namelist,this,this.changeMatrialSkin,1,0),this.ComponentProperty.getDropMenu(this.language.getLocaleStr("grouping"),!1,"",this.groupMap[this.groupIndex],this.groupMap,this,this.changeGroup,1,0),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("density"),!0,"g/cm³",13.6,.7,{get value(){return e.body?l.M.getNumJie(e.getBodyDensity(),1):null},set value(t){e.material.set_density(t),e.showToolDatas()}},.1,this.changeDensity,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("mass"),!0,"g",this.getMaxMass(),this.getMinMass(),{get value(){return e.body?l.M.getNumJie(e.body.mass,1):null},set value(t){e.body.mass=t,e.showToolDatas()}},.1,this.changeMass,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("roughness"),!0,"",1,0,this.getDynamicFriction(),.1,this.changeDfriction,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("elastic_coefficient"),!0,"",1,0,this.getBodyElasticity(),.1,this.changeElec,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("force_analysis"),this.openF_analysis,this.changeForceAnalysis,this)),this.isIce()&&t.confArr.push(this.ComponentProperty.getSwitch(this.language.getLocaleStr("melt"),this.meltFlag,this.changeMelt,this)),t}},{key:"getTipMess",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.language.getLocaleStr("density")+": "+l.M.getNumJie(this.getBodyDensity(),1)+"g/cm³\n    "+this.language.getLocaleStr("mass")+": "+l.M.getNumJie(this.body.mass,1)+"g\n    "+this.language.getLocaleStr("roughness")+": "+this.getDynamicFriction()+"\n    "+this.language.getLocaleStr("elastic_coefficient")+": "+this.getBodyElasticity()+"\n    "}},{key:"skinMap",get:function(){var t=this.globalConfig.cdn_static;return{"默认":t+"mechanics/diydefault.jpg","铝":t+"mechanics/diyaluminium.jpg","大理石":t+"mechanics/diydls.jpg","木材":t+"mechanics/diywood.jpg","玻璃":t+"mechanics/diyglass.jpg","冰块":t+"mechanics/diyice.jpg"}}},{key:"rootData",get:function(){return this._rootData||(this._rootData={isLock:!1}),this._rootData}}]),e}(c["default"]);v.OPEN_ANGLE=1,v.SHOW_REFLECT=2,v.SHOW_DIRECTION=3,e["default"]=v},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e["default"]=function n(t){o(this,n),this.MEC_FLOOR_FILTER=t.getShapeGroup([0],[0,1,2,3,4,10,13]),this.GROUP_DEFAULT=t.getShapeGroup([0],[-1]),this.GROUP_A=t.getShapeGroup([1],[0,10,13]),this.GROUP_B=t.getShapeGroup([2],[0,10,13]),this.GROUP_C=t.getShapeGroup([3],[0,10,13]),this.GROUP_D=t.getShapeGroup([4],[0,10,13]),this.LIGHT_SELF_FILTER=t.getShapeGroup([10],[0,1,2,3,4,11,16,17]),this.OPTICS_LENS_FILTER=t.getShapeGroup([11],[10,16]),this.DRAG_FIELD_FILTER=t.getShapeGroup([12],[15]),this.PERISCOPE=t.getShapeGroup([16],[11,10]),this.PERISCOPE_MIRROR=t.getShapeGroup([17],[10]),this.PERISCOPE_HIT=t.getShapeGroup([18],[18]),this.MEC_COMPONENT_FILTER=t.getLiquidGroup([13],[0,1,2,3,4],[2],[2]),this.LIQUID_ONLY_GROUP=t.getShapeGroup([14],[13]),this.LIQUID_GROUP=t.getLiquidGroup([13],[14,15],[1],[0]),this.LIQUID_IGNORE_GROUP=t.getLiquidGroup([0],[-1],[2],[3])}},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function B(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:B(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(449),p=o(d),y=i(1104),f=o(y),g=i(666),b=o(g),v=void 0,_=void 0,m=void 0,x=void 0,w=void 0,k=void 0,P=void 0,O=void 0,T=void 0,C=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return v=i.phy.nape,_=v.dynamics.ArbiterType,m=v.geom.Vec2,x=v.shape.Polygon,w=v.phys.BodyType,k=v.shape.LiquidShape,P=v.shape.PourPosShape,O=v.shape.PourShape,T=v.phys.Compound,C=v.phys.Material,i.liquidW=100,i.totalRange=50,i.fullH=550,i.unitMl=null,i.liquid=null,i.curtH=null,i.kdLine=null,i.boty=330,i.leftbotP={x:0,y:0},i.rightbotP={x:0,y:0},i.overArea=0,i.liquidArea=10,i.valueTxtxy={x:0,y:0},i.pouringY=0,i.pourSpeed=.1,i.barxy={x:50,y:0},i.poshapexy={x:47,y:-387},i.pourxy={x:-71,y:-359},i.liquidShape=new PIXI.Graphics,i.liqAlpha=.3,i.pourPosShape=null,i.poshape=null,i.canPour=!0,i.selfmass=50,i.lineColor=0,i.liquidColor=0,i.islock=!1,i.hasAo=!1,i.mlArr=[],i.compo=new T,i.handmoving=!1,i.handShape=null,i.canIgnoreBuoyancy=!1,i.posMaterial=new C(0,1,2,0,.001),i.firstDrawFace=!1,i.onlyDynamic=!1,i}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.get_shapes().clear(),this.body.userData.cannotToolRot=!0,this.leftbotP.x=.5*-this.liquidW,this.leftbotP.y=this.boty,this.rightbotP.x=.5*this.liquidW,this.rightbotP.y=this.boty,this.body.userData.dragtranslate=!0,this.kdLine=new PIXI.Graphics,this.addChild(this.kdLine),this.addChildAt(this.liquidShape,0),this.unitMl=this.fullH/this.totalRange,this.drawScale(),this.createBodyShape(),this.createLiquid(x.box(10,10)),this.createpourshape(),this.initPourPosiiton(),this.initPourBar(),this.freshTxtColor()}},{key:"removed",value:function(){this.bar.removed(),this.bar.bindBody=null,this.bar.centresp=null,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"translateMove",value:function(t,e){var i=this;this.compo.translate(m.get(t,e));var o=this.napeEngine.space;if(this.handShape){var n=o.bodiesInShape(this.handShape);this.compo.visitBodies(function(t){n.has(t)||(t.set_compound(null),t.set_space(i.napeEngine.space))})}}},{key:"dropperInlet",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:2,e=t,i=this.getAreaFromMl(e);return this.liquidArea>i?this.liquidArea-=i:(e=this.getCurtMl(this.liquidArea),this.liquidArea=0),{density:this.liquid.density,alpha:this.liqAlpha,ml:e}}},{key:"initPourPosiiton",value:function(){this.pourPosShape=new P(40,null,this.posMaterial),this.body.add(this.pourPosShape),this.pourPosShape.translate(m.get(this.poshapexy.x,this.poshapexy.y))}},{key:"createpourshape",value:function(){this.poshape=new O(40,null,this.posMaterial),this.body.add(this.poshape),this.poshape.translate(m.get(this.pourxy.x,this.pourxy.y)),this.poshape.initInfo(!0),this.pouringY=this.pourxy.y}},{key:"bindToCompound",value:function(){var t=this;if(this.body.userData.dragtranslate&&(this.compo=new T,this.compo.set_space(this.napeEngine.space),this.body.set_compound(this.compo),this.handmoving=!0,this.bar.visible&&this.dragBegin(null),this.islock||this.onlyDynamic||(this.body.set_type(w.get_KINEMATIC()),this.BodyUtil.frezzBody(this.body)),this.handShape&&0>=this.liquidArea)){this.napeEngine.space.bodiesInShape(this.handShape).foreach(function(e){var i=e.userData.view;i&&(i instanceof Stonesg||i instanceof b["default"]||i instanceof Submarine||i instanceof FreeMechanics)&&e.set_compound(t.compo)})}}},{key:"unbindToCompound",value:function(){var t=this;this.body.userData.dragtranslate&&(this.handmoving=!1,this.body.set_compound(null),this.body.set_space(this.napeEngine.space),this.compo.visitBodies(function(e){e.set_compound(null),e.set_space(t.napeEngine.space)}),this.compo.breakApart(),this.islock||this.body.set_type(w.get_DYNAMIC()))}},{key:"initPourBar",value:function(){var t=this;this.bar=new f["default"](this.paramObj),this.parent.addChild(this.bar),this.bar.hideIt(),this.bar.bindBody=this.body,this.bar.centresp=this.poshape,this.addEventListener(p["default"].BEGIN,function(e){t.bindToCompound(),t.canPour&&t.dragBegin(e)}),this.addEventListener(p["default"].END,function(e){t.unbindToCompound(),t.canPour&&t.liquidArea>0&&t.dragEnd(e)})}},{key:"dragBegin",value:function(){this.body.set_rotation(0),this.poshape.disadhesive(),this.bar.hideIt()}},{key:"dragEnd",value:function(){this.poshape.adhesive()?(this.BodyUtil.frezzBody(this.body),this.bar.showIt(),this.bar.x=this.x+this.barxy.x,this.bar.y=this.y+this.barxy.y):this.body.set_allowRotation(!1)}},{key:"createLiquid",value:function(t){var e=1,i=!1,o=!1;this.liquid&&(i=this.liquid.tmpviscosity,e=this.liquid.density,o=this.liquid.haveEgg,this.body.remove(this.liquid)),this.liquid=new k(t),this.body.add(this.liquid),this.liquid.viscosity=o?40:i?0:2*e,this.liquid.classname="LiquidShape",this.liquid.density=e,this.liquid.addCbtype(this.CbTypeStr.LIQUID_SHAPE),this.liquid.set_filter(this.InteractionFilterManager.LIQUID_GROUP),this.liquid.translate(m.get(0,2))}},{key:"createLingLiquid",value:function(){this.liquid&&this.body.remove(this.liquid),this.liquid=new k(x.box(this.liquidW,2)),this.body.add(this.liquid),this.liquid.addCbtype(this.CbTypeStr.LIQUID_SHAPE),this.liquid.translate(m.get(0,this.boty+2))}},{key:"changeLiquidVolume",value:function(t){this.liquidArea=this.unitMl*l.M.getNumStr(t.showValue)*this.liquidW}},{key:"drawScale",value:function(){}},{key:"createBodyShape",value:function(){this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER)}},{key:"backgroundColorChange",value:function(t){"#"===t.charAt(0)&&(this.liquidColor="0x + "+t.slice(1)),this.lineColor=t,this.valueTxt&&(this.valueTxt.style.fill=t,this.valueTxt.updateText()),this.drawScale()}},{key:"getAreaFromMl",value:function(t){return t*this.unitMl*this.liquidW}},{key:"getCurtMl",value:function(t){var e=void 0;if(t)e=t/this.liquidW;else{if(0===this.liquidArea)return 0;e=(this.liquidArea+this.overArea)/this.liquidW}return e/this.unitMl}},{key:"waterFlooding",value:function(t,e){var i=t*this.unitMl*this.liquidW,o=this.liquidArea;this.liquidArea+=i,e&&this.refreshDensity(e,o,i)}},{key:"refreshDensity",value:function(t,e,i){this.liquid.density=l.M.getNumJie((t.density*i+this.liquid.density*e)/this.liquidArea,1)}},{key:"waterPouring",value:function(t){}},{key:"checkMecInWater",value:function(){var t=this;this.body.get_arbiters().foreach(function(e){if(_.get_FLUID()===e.get_type()){var i=e.get_body1(),o=e.get_body2(),n=t.BodyUtil.getBodyArea(i);if(e.get_overlap()>=n)return;var s=i.userData?i.userData.view:null,a=o.userData?o.userData.view:null;s&&s.inWaterUpdate&&s.inWaterUpdate(e,t),a&&a.inWaterUpdate&&a.inWaterUpdate(e,t)}})}},{key:"getCoefficientViscosity",value:function(){return 12/(this.liquid.density+24)+.5}},{key:"calculation",value:function(){var t=this,e=this.body.get_arbiters(),i=0,o={};e.foreach(function(e){if(!t.ignoreBuoyancy(e)&&_.get_FLUID()==e.get_type()){if(e.get_shape2()!==t.liquid)return;var i=e.get_overlap(),n=e.get_body1().userData.view;if(n&&n instanceof b["default"]&&(t.liquid.haveEgg=!0),o[n.UID]){o[n.UID].value+=i}else o[n.UID]={mc:n,value:i}}});var n=!1;for(var s in o){var a=o[s],r=a.mc;r&&r.body&&r.body.userData.dragManager&&(n=!0),r&&r.body&&this.handmoving&&r.body.set_compound(this.compo),i+=a.value}this.liquid.tmpviscosity=!!n,i*=.001,i=this.getAreaFromMl(i),this.overArea=i}},{key:"ignoreBuoyancy",value:function(t){if(!this.canIgnoreBuoyancy)return!1;if(""+t.get_type()=="FLUID"){var e=t.get_body1(),i=t.get_body2(),o=null;if(e.userData&&e.userData.view!==this?o=e:i.userData&&i.userData.view!==this&&(o=i),o){var n=t.get_position(),s=this.body.worldPointToLocal(n);if(!this.hasBuoyancyAtPoint(new l.Point(s.get_x(),s.get_y())))return!0}}return!1}},{key:"hasBuoyancyAtPoint",value:function(t){return!0}},{key:"calcuMass",value:function(){if(this.liquidArea>0){var t=this.getCurtMl(this.liquidArea),e=this.liquid.density,i=e*t;i+=this.selfmass,this.body.get_mass()!=i&&this.body.set_mass(i)}else this.body.get_mass()!=this.selfmass&&this.body.set_mass(this.selfmass)}},{key:"bottomAddCbtype",value:function(){0>=arguments.length||undefined}},{key:"update",value:function(){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),!this.firstDrawFace||this.moduleMain.napeEngine.play){if(this.compo&&!this.compo.first){if(0===this.body.get_arbiters().get_length())return void(this.compo.first=!0)}if(this.calcuMass(),0>=this.liquidArea)return this.liquid.get_body()&&(this.body.remove(this.liquid),this.bottomAddCbtype()),void this.liquidShape.clear();this.liquid.get_body()||this.bottomAddCbtype(!1),this.checkMecInWater(),this.calculation();var t=this.liquidArea+this.overArea,i=0,o=this.body.get_rotation(),n=[],s=!1;if(0==o){var a=t/this.liquidW,r=this.leftbotP.y-a;if(this.pouringY>r){i=(this.pouringY-r)*this.liquidW,r=this.pouringY}n=[m.get(this.leftbotP.x,this.leftbotP.y),m.get(this.rightbotP.x,this.rightbotP.y),m.get(this.rightbotP.x,r),m.get(this.leftbotP.x,r)]}else{s=!0;var l=Math.abs(o),u=this.liquidW*Math.tan(l),c=.5*u*this.liquidW,d=this.liquidW/Math.cos(l);if(c<t){n=[m.get(this.leftbotP.x,this.leftbotP.y),m.get(this.rightbotP.x,this.rightbotP.y)];var p=t-c,y=p/d,f=y/Math.cos(l),g=m.get(this.leftbotP.x,this.leftbotP.y-u-f);if(g.get_y()<this.pouringY){i=d*((this.pouringY-g.get_y())*Math.cos(l))*this.pourSpeed,g.set_y(this.pouringY)}n.push(m.get(this.rightbotP.x,this.rightbotP.y-f)),n.push(g)}else{var b=Math.sqrt(t/(.5*Math.tan(l))),v=t/(.5*b),_=m.get(this.leftbotP.x,this.leftbotP.y-v);if(_.get_y()<this.pouringY){i=d*((this.pouringY-_.get_y())*Math.cos(l))*this.pourSpeed,_.set_y(this.pouringY)}n=[m.get(this.leftbotP.x,this.leftbotP.y)],n.push(m.get(this.leftbotP.x+b,this.leftbotP.y)),n.push(_)}}if(this.createLiquid(n),this.drawLiquid(n),i>this.liquidArea&&(i=this.liquidArea),this.liquidArea-=i,i>0){var x=i/this.liquidW,w=x/this.unitMl;if(this.waterPouring(w),s&&this.poshape.getPourToView()){this.poshape.getPourToView().waterFlooding(w,{density:this.liquid.density,alpha:this.liqAlpha})}}}}},{key:"drawLiquid",value:function(t){this.liquidShape.clear(),this.liquidShape.lineStyle(1,this.liquidColor,0),this.liquidShape.beginFill(this.liquidColor,this.liqAlpha);for(var e=0;t.length>e;e++)if(0===e)this.liquidShape.moveTo(t[e].get_x(),t[e].get_y());else{var i=t[e].get_x(),o=t[e].get_y();this.hasAo&&0===this.body.get_rotation()?2===e?(this.liquidShape.lineTo(i,o-10),this.liquidShape.quadraticCurveTo(i,o,i-15,o)):3===e?(this.liquidShape.lineTo(i+15,o),this.liquidShape.quadraticCurveTo(i,o,i,o-10)):this.liquidShape.lineTo(i,o):this.liquidShape.lineTo(i,o)}this.liquidShape.lineTo(t[0].get_x(),t[0].get_y()),this.firstDrawFace||(this.firstDrawFace=!0)}},{key:"changeLock",value:function(t){this.islock=t.checked,this.bar.visible&&(this.islock=!1),this.islock?(this.body.set_type(w.get_KINEMATIC()),this.BodyUtil.frezzBody(this.body)):(this.body.set_type(w.get_DYNAMIC()),this.body.set_allowRotation(!1))}},{key:"fieldWidth",value:function(){return Infinity}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.rotation=0,t.islock=this.islock,t}},{key:"setData",value:function(t){this.islock=t.islock!==undefined&&null!==t.islock&&t.islock,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t)}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.getSwitch([this.getLocaleStr("lock","锁定"),this.islock,this.changeLock,this])),t}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function _(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:_(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(452),c=o(u),d=i(471),p=o(d),y=i(474),f=o(y),g=void 0,b=void 0,v=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return g=t.main.phy.nape,b=g.geom.Vec2,i.var_r=10,i.lineColor=16777215,i.lineThin=2,i.body=null,i.skinColor=null,i.lineColor=null,i.singlePoint=!0,i.func_dispose(),i.func_init(),i.completefunc=null,i.lastPoint=null,i}return a(e,t),r(e,[{key:"setActive",value:function(t){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setActive",this).call(this,t),this.active){var i=this;this.touchTabUid||(this.touchTabUid=l.M.addTouch(this.var_dis,{tab:i.touchTab,isAddDB:!0},this,{canTab:!0}))}else this.touchTabUid&&(l.M.removeTouch(this.var_dis,this.touchTabUid),this.touchTabUid=null,this.func_dispose(),this.func_init())}},{key:"func_init",value:function(){this.var_startP=null,this.var_points=[],this.n=-1,this.lastPoint=null}},{key:"onDomClick",value:function(t){this.func_dispose(),this.func_init()}},{key:"getMaxDis",value:function(){for(var t=0,e=this.var_points.length,i=1;e>i;i++)for(var o=0;i>o;o++){var n=this.var_points[i],s=this.var_points[o],a=l.Point.distance(n,s);a>t&&(t=a)}return t}},{key:"touchTab",value:function(t){if(0>this.n){var e=this.globalConfig.main.view.scale.x;this.lineThin=4/e,this.var_r=15/e,this.skinColor=f["default"].getColor()}this.func_checkEnd(t)||this.func_addPoint(t)}},{key:"func_touchTab",value:function(t){this.touchTab(t)}},{key:"func_addPoint",value:function(t){this.n++;var e=new l.Point(t.x,t.y);if(0==this.n)this.var_startP=e;else{if(1>l.Point.distance(e,this.lastPoint))return void this.n--}this.lastPoint=e,this.var_points[this.n]=e,this.func_refreshGrc()}},{key:"func_checkEnd",value:function(t){return this.n>=2&&l.Point.distance(t,this.var_startP)<2*this.var_r&&(this.func_dispose(),this.createBody(),this.func_init(),this.completefunc&&this.completefunc(),this.globalConfig.main.dispatchEvent("phy.addEquipment"),!0)}},{key:"createBody",value:function(){for(var t=[],e=this.body.shapes,i=e.get_length(),o=0;i>o;o++)!function(i){var o=e.at(i),n=o.get_localVerts(),s=[];n.foreach(function(t){s.push(t)}),t.push(s)}(o);var n=new p["default"](this.config,t,this.skinColor);this.addEquipmentChild(n,this.var_startP),this.globalConfig.main.execute(this.NBCommand.ANALYTICS,{type:"mecTool",name:"penTool"}),this.globalConfig.main.isPlay||n.setSelected(!0)}},{key:"func_refreshGrc",value:function(){this.func_dispose();var t=[],e=this.var_points[0];this.var_points.forEach(function(i){t.push(new l.Point(i.x-e.x,i.y-e.y))},this);var i=this.BodyUtil.BodyFromArray(t,null,null);this.body=i;var o=new PIXI.Graphics;if(i){o.addChild(this.func_getFillShape(i))}(o.addChild(this.func_getLineShape()),this.var_r>0)&&o.addChild(this.func_getPointsShape());var n=[];n.push({option:"addElement",target:o,params:{x:0,y:0}}),this.func_dispatchGraphic(n)}},{key:"func_getPointsShape",value:function(){for(var t=new PIXI.Graphics,e=this.var_points.length,i=0;e>i;i++){var o=this.var_points[i];0===i?(t.lineStyle(this.lineThin,16777215,0),t.beginFill(16777215,.5),t.drawCircle(o.x,o.y,3*this.var_r),t.endFill(),t.beginFill(16777215,1),t.drawCircle(o.x,o.y,1.5*this.var_r),t.endFill()):(t.lineStyle(this.lineThin,16777215,2),t.beginFill(16721687,1),t.drawCircle(o.x,o.y,this.var_r),t.endFill())}return t}},{key:"func_getLineShape",value:function(){var t=new PIXI.Graphics;t.lineStyle(this.lineThin,16777215,1);for(var e=this.var_points.length,i=0;e>i;i++){var o=this.var_points[i];0==i?t.moveTo(o.x,o.y):t.lineTo(o.x,o.y)}return t}},{key:"func_getFillShape",value:function(t){for(var e=this.var_points[0],i=new PIXI.Graphics,o=t.shapes,n=o.get_length(),s=0;n>s;s++){var a=o.at(s);if(a.isPolygon()){var r=a.get_localVerts();i.lineStyle(0,16777215,0),i.beginFill(this.skinColor,1);for(var h=r.get_length(),l=0;h>l;l++){var u=r.at(l),c=e.x+u.get_x(),d=e.y+u.get_y();0==l?i.moveTo(c,d):i.lineTo(c,d)}i.endFill()}}return i}}]),e}(c["default"]);v.preventDraw=!0,e["default"]=v},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function c(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:c(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(226),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.txt=i.globalConfig.main.cachePool.popText("",{font:"25px Arial",fill:16750848}),i.cateid=5,i.var_now_T=0,i.is_animation_playing=!1,i.isStart=!1,i.start_time=null,i.my_time=0,i.lineSP=null,i.pauseTime=null,i.isshowlabel=!0,i.tic=null,i.sound=null,i.topTouchId=null,i.rightTouchId=null,i.jd=1,i.timeRate=isNaN(i.main.globalConfig.TIME_RATE)?1:i.main.globalConfig.TIME_RATE,i.preT=0,i.runT=0,i}return s(e,t),a(e,[{key:"added",value:function(){var t=this;r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this);var i=this.language.getLocaleStr("wei");this.jdArr=["1"+i,"2"+i],this.timeType=0,this.timeTypeArr=[this.language.getLocaleStr("virtual_time"),this.language.getLocaleStr("standard_time")],this.parent.dragArea=this.bg,this.componentBox.visible=!1,this.removeChild(this.componentBox),this.addChild(this.txt),this.tline.visible=!1,this.txt.x=-240,this.txt.y=-220,this.topOriY=this.top.y,this.topTouchId=h.M.addTouch(this.top,{tab:this.topBtnClick,begin:function(e){t.top.y=t.topOriY+10,t.cannotSystemDrag=!0},end:function(e){t.top.y=t.topOriY,t.cannotSystemDrag=!1}},this);var o=h.M.getSPPoint(this.right);this.rightTouchId=h.M.addTouch(this.right,{tab:this.rightBtnClick,begin:function(e){h.M.setSPPointXY(t.right,o.x+5,o.y+5),t.cannotSystemDrag=!0},end:function(e){h.M.setSPPoint(t.right,o),t.cannotSystemDrag=!1}},this,{time:300,dis:15}),this.freshEquipShows(this.globalConfig.SHOWEQUVALUE),this.addCursor(this.top,"hand"),this.addCursor(this.right,"hand")}},{key:"rightBtnClick",value:function(t){this.playStop()}},{key:"topBtnClick",value:function(t){this.isStart?this.playToggle():(this.playGo(),this.playSound(!0))}},{key:"removed",value:function(){this.globalConfig.main.cachePool.pushText(this.txt),this.removeChild(this.txt),this.txt=null,this.removedCursor(this.top),this.removedCursor(this.right),h.M.removeTouch(this.top,this.topTouchId),h.M.removeTouch(this.right,this.rightTouchId),this.tic&&this.tic.stop(),this.sound&&(this.globalConfig.SoundTool.stopT(this.sound),this.sound=null),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"freshVolume",value:function(){this.globalConfig.VOLUME&&this.isStart&&this.is_animation_playing?this.sound||(this.sound=this.globalConfig.SoundTool.play(this.SoundStr.COMTIMER,!0)):this.sound&&(this.globalConfig.SoundTool.stopT(this.sound),this.sound=null)}},{key:"playSound",value:function(t){t?this.freshVolume():this.sound&&(this.globalConfig.SoundTool.stopT(this.sound),this.sound=null)}},{key:"playGo",value:function(){this.isStart=!0,this.is_animation_playing=!0,this.start_time=this.getCurrentTime(),this.preT=(new Date).getTime(),this.runT=0,this.isshowlabel&&(this.tline.visible=!0)}},{key:"playStop",value:function(){this.isStart=!1,this.is_animation_playing=!1,this.my_time=0,this.runT=0,this.preT=0,this.tic&&this.tic.stop(),this.freshShow(0),this.playSound(!1),this.tline.visible=!1,this.txt.text=""}},{key:"update",value:function(){if(this.is_animation_playing){if(this.globalConfig.isMec()&&!this.moduleMain.napeEngine.play)return void this.playSound(!1);this.sound||this.playSound(!0);this.freshShow(this.my_time+this.getTimeD())}}},{key:"playToggle",value:function(){this.is_animation_playing=!this.is_animation_playing,this.is_animation_playing?(this.start_time=this.getCurrentTime(),this.preT=(new Date).getTime(),this.runT=0,this.playSound(!0)):(this.my_time+=this.getTimeD(),this.playSound(!1))}},{key:"getTimeD",value:function(){var t=0;if(this.globalConfig.isMec()&&!this.timeType){if(null===this.start_time)return 0;t=this.getCurrentTime()-this.start_time}else{if(null===this.start_time)return 0;var e=(new Date).getTime(),i=e-this.preT;this.preT=e,this.runT+=i*this.timeRate,t=this.runT+this.start_time}return t}},{key:"getCurrentTime",value:function(){return this.globalConfig.isMec()&&!this.timeType?r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getCurrentTime",this).call(this):0}},{key:"freshShow",value:function(t){this.miao.rotation=t/3e4*Math.PI*2,this.fen.rotation=t/9e5*Math.PI*2;var e=""+h.M.getNumJie(t/1e3,this.jd);this.contains(e,".")||(e+=".");for(var i=e.slice(e.indexOf(".")).length-1;this.jd>i;)e+="0",i++;this.txt.text=e+"s"}},{key:"contains",value:function(t,e){return t.indexOf(e)>-1}},{key:"freshEquipShows",value:function(t){this.isshowlabel=t,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"freshEquipShows",this).call(this,t),this.txt.visible=t,this.isStart&&!t?this.tline.visible=!1:this.isStart&&t&&(this.tline.visible=!0)}},{key:"changeJd",value:function(t){this.jd=h.M.getNumStr(this.jdArr[t.checked])-0}},{key:"timeChanged",value:function(t){this.timeType=t.checked,this.playStop()}},{key:"selectRenderChild",value:function(){return this.bg.getBounds()}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.timeType=this.timeType,t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.timeType=t.timeType||0}},{key:"setTimeValue",value:function(t){this.playStop(),this.playGo();var i=1e3*t.showValue;this.freshShow(i);var o=(new Date).getTime();this.runT=0,this.globalConfig.isMec()&&!this.timeType?this.start_time=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getCurrentTime",this).call(this)-i:(this.start_time=0,this.preT=o-i/this.timeRate),this.playToggle()}},{key:"toRandomValue",value:function(){this.setTimeValue({showValue:(600*Math.random()).toFixed(1)-0})}},{key:"getConf",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);t.confArr=[];var i=this.language.getLocaleStr("wei");return t.confArr.push(this.ComponentProperty.getTextInput("指定示数",0,"",this.setTimeValue,this)),t.confArr.push(this.ComponentProperty.getButton("","随机示数",this.toRandomValue,this)),t.confArr.push(this.ComponentProperty.getRadio(this.language.getLocaleStr("accuracy"),h.ArrayUtil.getIndexFromValue(this.jdArr,this.jd+i),this.jdArr,this.changeJd.bind(this))),this.globalConfig.isMec()&&t.confArr.push(this.ComponentProperty.getRadio(this.language.getLocaleStr("type"),this.timeType,this.timeTypeArr,this.timeChanged.bind(this))),t}},{key:"getTipMess",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.language.getLocaleStr("accuracy")+": "+(this.jd+this.language.getLocaleStr("wei"))+"\n    "+this.language.getLocaleStr("type")+": "+this.timeTypeArr[this.timeType]+"\n    "}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(543),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.geom.Vec2,p=c.shape.Polygon,i.level=17,i.liquidW=105,i.halfW=i.liquidW/2,i.wallW=20,i.wallH=733,i.wallOfy=0,i.botH=38,i.boty=330,i.fullH=550,i.totalRange=50,i.barxy={x:50,y:0},i.poshapexy={x:47,y:-387},i.pourxy={x:-71,y:-359},i.canPour=!0,i.valueTxtxy={x:86,y:-390},i.valueTxt=null,i.bar=null,i.totaltxtY=100,i.hasAo=!0,i.botB=null,i.mlArr=["0mL","20mL","30mL","40mL","50mL"],i}return s(e,t),a(e,[{key:"init",value:function(){this.material=new c.phys.Material(0,.5,.6,2.4,.001),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_isBullet(!0),this.body.noallowRotation=!0,this.body.userData.dragLevel=-1,this.body.userData.handJointFrequency=100,this.valueTxt=new PIXI.Text("",{font:"25px Arial",fill:this.lineColor}),this.addChild(this.valueTxt),this.valueTxt.x=this.valueTxtxy.x,this.valueTxt.y=this.valueTxtxy.y,this.changeLiquidVolume({showValue:"30mL"}),this.valueTxt.visible=this.globalConfig.SHOWEQUVALUE,this.freshTxtColor()}},{key:"createBodyShape",value:function(){var t=new p(p.box(this.wallW,this.wallH),this.material);this.body.add(t),t.translate(d.get(-this.halfW-this.wallW/2,this.wallOfy));var i=new p(p.box(this.wallW,this.wallH),this.material);this.body.add(i),i.translate(d.get(this.halfW+this.wallW/2,this.wallOfy)),this.botB=new p(p.box(2*(this.halfW+this.wallW),this.botH),this.material),this.body.add(this.botB),this.botB.translate(d.get(0,this.boty+this.botH/2)),this.handShape=new p(p.box(2*this.halfW,this.wallH),this.material),this.body.add(this.handShape),this.handShape.set_sensorEnabled(!0),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createBodyShape",this).call(this)}},{key:"bottomAddCbtype",value:function(){var t=0>=arguments.length||arguments[0]===undefined||arguments[0];this.botB&&(t?this.botB.get_cbTypes().add(this.CbTypeStr.CONTAINER_BOTTOM):this.botB.get_cbTypes().remove(this.CbTypeStr.CONTAINER_BOTTOM))}},{key:"getCoefficientViscosity",value:function(){return.8*r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getCoefficientViscosity",this).call(this)}},{key:"drawScale",value:function(){var t=this,e=function(e,i){return new PIXI.Text(e,{font:i+"px Arial",fill:t.lineColor})};this.kdLine.removeChildren(),this.kdLine.clear();var i=this.fullH,o=this.totalRange/1,n=i/o;this.kdLine.lineStyle(2,this.lineColor);var s=this.boty,a=void 0;for(a=5;o>=a;a++)if(a%10==0){var r=s-a*n;if(this.kdLine.moveTo(-33,r),this.kdLine.lineTo(33,r),0!=a){var h=e(1*a,22);this.kdLine.addChild(h),h.x=23,h.y=r-22}}else a%5==0?(this.kdLine.moveTo(-25,s-a*n),this.kdLine.lineTo(25,s-a*n)):(this.kdLine.moveTo(-15,s-a*n),this.kdLine.lineTo(15,s-a*n));var l=e(this.totalRange+"mL",26);this.kdLine.addChild(l),l.y=s-o*n-this.totaltxtY,l.x=-l.width/2;var u=e("20℃",20);this.kdLine.addChild(u),u.x=-u.width/2,u.y=l.y+30}},{key:"update",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this);var t=h.M.getNumJie(this.getCurtMl(),1);89.9>t||"OverflowCup"!==this.classname||(t=90),this.valueTxt.text=t+"mL"}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.density=this.liquid.density,t.alpha=this.liqAlpha,t.ml=this.getCurtMl(this.liquidArea),t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t);try{this.changeDensity({showValue:t.density}),this.changeWaterAlpha({showValue:t.alpha}),this.changeLiquidVolume({showValue:t.ml})}catch(i){}}},{key:"changeWaterAlpha",value:function(t){var e=h.M.getNumStr(t.showValue)-0;this.liqAlpha=h.M.getNumJie(e,1)}},{key:"changeDensity",value:function(t){var e=h.M.getNumStr(t.showValue)-0;this.liquid.density=h.M.getNumJie(e,1)}},{key:"freshEquipShows",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"freshEquipShows",this).call(this,t),this.valueTxt.visible=t}},{key:"freshTxtColor",value:function(){var t=this.globalConfig.TXT_COLOR;this.valueTxt&&(this.valueTxt.style.fill=t,this.valueTxt.updateText())}},{key:"getConf",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this),i=t.confArr;return i.push(this.getScrollBar([this.getLocaleStr("liquid_density","液体密度"),!0,"g/cm³",13.6,.7,this.liquid.density,.1,this.changeDensity,this]),this.getScrollBar([this.getLocaleStr("alpha","透明度"),!0,"",.5,.1,this.liqAlpha,.1,this.changeWaterAlpha,this]),this.getDropMenu([this.getLocaleStr("water_yield","液体位置"),!0,"mL",h.M.getNumJie(this.getCurtMl(),1)+"mL",this.mlArr,this,this.changeLiquidVolume,this.totalRange,0])),i.push(i[0]),i.shift(),t}},{key:"getTipMess",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.getLocaleStr("liquid_density")+": "+this.liquid.density+"g/cm³\n    "+this.getLocaleStr("water_yield")+": "+h.M.getNumJie(this.getCurtMl(),1)+"mL\n    "}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function m(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:m(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(454),c=o(u),d=i(499),p=o(d),y=i(581),f=o(y),g=void 0,b=void 0,v=function(t){function e(t,i){n(this,e);var o=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return g=t.moduleMain.phy.nape,b=g.geom.Vec2,o.classname="ThrusterToolView",o.level=20,o.skinCon=new PIXI.Container,o.addChild(o.skinCon),o.drawForce=new _,o.addChild(o.drawForce),o.drawForce.visible=!1,o.bg=PIXI.Sprite.fromFrame("mechSkin/thurF"),o.skinCon.addChild(o.bg),l.M.alignPivot(o.bg,"center","center"),o.ismecJoint=!0,o.bindbody=i,o.forcejoint=null,o.force=.5,o.vec2Force=null,o.offRo=null,o.dirfollow=!1,o.forceisMove=!1,o.forceT=null,o.active=!0,o.minForce=.1,o.maxForce=10,o}return a(e,t),r(e,[{key:"init",value:function(){var t=this;this._width=this.bg.width,this._height=this.bg.height,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.cannotSystemDrag=!0,this.body.userData.dragLevel=3,this.body.userData.stopFindConnectBodies=!0,this.body.mass=.001,this.body.sensorEnabled(!0),this.body.noallowRotation=!0,this.addEventListener(c["default"].SET_BODY_STATE,function(e){t.func_setBodyStateHandler(e)}),this.bindbody&&this.fixedBody(this.bindbody)}},{key:"setActive",value:function(t){this.active=t}},{key:"setSelected",value:function(t){var i=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setSelected",this).call(this,t),this.drawForce.visible=t,this.updateDraw(t),this.drawForce.dragId&&(l.M.removeTouch(this.drawForce.dragArea,this.drawForce.dragId),this.drawForce.dragId=null,this.removedCursor(this.drawForce.dragArea)),t&&(this.addCursor(this.drawForce.dragArea,"hand"),this.drawForce.dragId=l.M.addTouch(this.drawForce.dragArea,{begin:function(t){i.drawForce.op=i.getMain().view.toLocal(new l.Point(0,0),i),i.paramObj.moduleMain.napeEngine.touchManager.enAbled=!1},move:function(t){var o=i.getMouseXY(t),n=new l.Point(o.x-i.drawForce.op.x,o.y-i.drawForce.op.y);n.x/=e.pxPerN,n.y/=e.pxPerN,i.setForce(n),i.updateDraw(),i.showToolDatas()},end:function(t){i.drawForce.op=null},isAddDB:!0},this))}},{key:"bodyContainsConstraint",value:function(t,e){return!!t.contains(new b(this.x,this.y))}},{key:"changeBody",value:function(t,e){this.fixedBody(e)}},{key:"fixedBody",value:function(t){this.bindbody=t,this.forcejoint?(this.forcejoint.set_body2(this.bindbody),this.forcejoint.set_anchor2(this.bindbody.worldPointToLocal(this.body.position))):this.forcejoint=this.JointUtil.createPivotJoint(this.body,this.bindbody,this.body.position,this.body.position),this.offRo=this.bindbody.rotation-this.body.rotation,this.forcejoint.userData.isThruster=!0,this.forcejoint.userData.view=this,this.forcejoint.userData.toolView=this,this.forcejoint.userData.bindBody=this.body}},{key:"func_setBodyStateHandler",value:function(t){var e=this;this.forceisMove=!1,t&this.BodyUtil.ALLOW_MOVE?(this.forceT&&clearTimeout(this.forceT),this.forceT=setTimeout(function(){if(!e.hadDestory){e.body.zpp_inner.invalidate_pos(),e.body.zpp_inner.validate_aabb();var t=e.napeEngine.space.bodiesUnderPoint(e.body.position);t.filter(function(t){return!t.userData||!t.userData.isnbequ});var i=e.BodyUtil.getTopBodyFormBodyList(t,[e.body]),o=!1;i&&(e.forcejoint.set_body2(i),e.forcejoint.anchor2=i.worldPointToLocal(e.body.position),e.forcejoint.body2=i,e.bindbody=i,o=!0,e.forcejoint.set_active(!0)),o||e.removeFromFramework(e)}},0)):(this.forceisMove=!0,this.forcejoint.set_active(!1))}},{key:"func_bindVo",value:function(t){this.bindbody=t.beginBody?t.beginBody:this.getWorldBody(),this.forcejoint=this.JointUtil.createPivotJoint(this.body,this.bindbody,this.body.position,this.body.position),this.offRo=this.bindbody.rotation-this.body.rotation,this.forcejoint.userData.isThruster=!0,this.forcejoint.userData.view=this,this.forcejoint.userData.toolView=this,this.forcejoint.userData.bindBody=this.body}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.active&&this.systemPlayStatus()&&(this.forceisMove||(this.bindbody&&this.bindbody.applyImpulse(this.forceValue(),this.body.position),this.dirfollow&&(this.body.rotation=this.bindbody.rotation-this.offRo)))}},{key:"removed",value:function(){this.forcejoint.userData&&this.forcejoint.userData.view&&(this.forcejoint.userData.view=null,this.forcejoint.userData.toolView=null,this.forcejoint.userData.bindBody=null),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"updateDraw",value:function(t){if(this.drawForce.visible=t,this.drawForce.clear(),t){var i=4/this.getGlobalScale(),o=this.force*e.pxPerN;if(this.drawForce.sca=i,2>this.force){var n=15*Math.PI/180;this.body.rotation=Math.round(this.body.rotation/n)*n}this.drawForce.draw(o,this.body.rotation,this.force)}}},{key:"setForce",value:function(t){this.body.rotation=Math.atan2(t.y,t.x),this.force=Math.sqrt(t.x*t.x+t.y*t.y),this.force=parseFloat(this.force.toFixed(2)),this.minForce>this.force&&(this.force=this.minForce),this.force>this.maxForce&&(this.force=this.maxForce)}},{key:"forceValue",value:function(){var t=this.getForce(this.force*e.kf);return this.vec2Force=new b(Math.cos(this.body.rotation)*t,Math.sin(this.body.rotation)*t)}},{key:"origForceValue",value:function(){var t=this.getForce(this.force);return this.vec2Force=new b(Math.cos(this.body.rotation)*t,Math.sin(this.body.rotation)*t)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.body2={uid:(this.forcejoint.body2.userData?this.forcejoint.body2.userData.view:{}).UID,anchorX:this.forcejoint.anchor2.get_x(),anchorY:this.forcejoint.anchor2.get_y()},t.offRo=this.offRo,t.force=this.force+"N",t.follow=this.dirfollow,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.body.transformShapes(this.transformN),this.setScale(this.currentScale.x,this.currentScale.y);var i=void 0,o=void 0;t.body2&&(i=this.getBodyFromUid(t.body2.uid),o=i.localPointToWorld(b.get(t.body2.anchorX,t.body2.anchorY)),this.forcejoint=this.JointUtil.createPivotJoint(this.body,i,o,o),this.offRo=t.offRo,this.bindbody=i,this.forcejoint.userData.isThruster=!0,this.forcejoint.userData.view=this,this.forcejoint.userData.bindBody=this.body,this.changeForce({showValue:t.force}),this.func_changeFollow({checked:t.follow}))}},{key:"changeForce",value:function(t){this.force=l.M.getNumStr(t.showValue)-0,this.drawForce.visible&&this.updateDraw(!0)}},{key:"func_changeFollow",value:function(t){this.dirfollow=t.checked}},{key:"rotatedConf",value:function(t){this.body.rotation=l.M.toHu(-t.value),this.updateDraw(!0)}},{key:"getConf",value:function(){var t=l.M.toAngle(this.body.rotation);t=t||0,t=l.M.getValidAngle(-t);var e={};return this.elecLable=this.language.getLocaleStr("thrust"),e.confArr=[],e.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("thrust_size"),!0,"N",10,.1,this.force+"N",.1,this.changeForce,this),this.ComponentProperty.getAngle(this.language.getLocaleStr("angle"),t,this.rotatedConf,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("follow"),this.dirfollow,this.func_changeFollow,this)),e}}]),e}(p["default"]);v.kf=.495,v.pxPerN=200,e["default"]=v;var _=function(t){function e(){n(this,e);var t=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.thin=2,t.sca=2,t.text01=new f["default"]("",{font:"16px Microsoft YaHei",fill:16777215}),t.text02=new f["default"]("",{font:"16px Microsoft YaHei",fill:16777215}),t.addChild(t.text01),t.addChild(t.text02),t.fontSize=16,t.dragArea=new PIXI.Graphics,t.addChild(t.dragArea),t}return a(e,t),r(e,[{key:"draw",value:function(t,e,i){for(e=-e;0>e;)e+=2*Math.PI;e=(e+Math.PI)%(2*Math.PI)-Math.PI,80*this.sca>t&&(t=80*this.sca),t>200*this.sca&&(t=200*this.sca),this.clear(),this.lineStyle(this.thin*this.sca,16777215,1),this.moveTo(0,0),this.lineTo(t,0);var o=5*this.sca;this.beginFill(16777215,1),this.moveTo(t+o,0),this.lineTo(t,-o),this.lineTo(t,o),this.endFill();var n=.6*t;this.beginFill(16777215,.6),this.moveTo(0,0),e>0?this.arc(0,0,n,0,e,!1):this.arc(0,0,n,0,e,!0),this.endFill();new l.Point(Math.cos(-e),Math.sin(-e));this.text01.scale.x=this.text01.scale.y=this.sca,this.text01.text=Math.round(180*e/Math.PI)+"°",this.text01.x=30*this.sca,this.text01.y=-(e>0?this.fontSize*this.sca*1.5:0),this.text02.scale.x=this.text02.scale.y=this.sca,this.text02.text=i.toFixed(2)+"N",this.text02.x=t+30,this.text02.y=-this.fontSize*this.sca/2,this.dragArea.clear(),this.dragArea.beginFill(0,0),this.dragArea.drawCircle(t,0,30*this.sca),this.dragArea.endFill()}}]),e}(PIXI.Graphics)},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=i(539),l=o(h),u=i(541),c=(o(u),i(1),i(516)),d=(o(c),i(471)),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0;e["default"]=function(t){function e(t,i){n(this,e);var o=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return y=o.ComponentProperty,e.injectionClass(),o.classname="Triangle",o.verticesArr=t||[],o.skinColor=i||0,o.bg=o,o}return a(e,t),r(e,null,[{key:"injectionClass",value:function(){e.injected||(e.injected=!0,f=l["default"].nape,g=f.shape.Polygon,b=f.geom.Vec2)}}]),e}(p["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function v(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:v(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(499),c=o(u),d=i(454),p=o(d),y=i(489),f=o(y),g=void 0,b=void 0;e["default"]=function(t){function e(t,i,o){n(this,e);var a=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return g=a.phy.nape,b=g.geom.Vec2,a.classname="WeldJointView",a.level=20,a.body01=i,a.body02=o,a.ismecJoint=!0,a.bg=PIXI.Sprite.fromFrame("mechSkin/fix"),a.skinCon=new PIXI.Container,a.skinCon.addChild(a.bg),a.addChild(a.skinCon),l.M.alignPivot(a.bg,"center","center"),a.var_joint=null,a.var_isMove=!1,a}return a(e,t),r(e,[{key:"init",value:function(){var t=this;this.radius=this.bg.width/2,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.elecLable="钉子",this.body.userData.dragLevel=3,this.body.sensorEnabled(!0),this.body.noallowRotation=!0,this.addEventListener(p["default"].SET_BODY_STATE,function(e){t.func_setBodyStateHandler(e)}),this.body01&&this.body02&&this.fixedBodies(this.body01,this.body02)}},{key:"setScale",value:function(t,i){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setScale",this).call(this,t,i),this.skinCon.scale.x=this.currentScale.x,this.skinCon.scale.y=this.currentScale.y}},{key:"setSelected",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setSelected",this).call(this,t),t?(this.paramObj.moduleMain.napeEngine.transformManager.show(this),this.paramObj.moduleMain.napeEngine.transformManager.setRotateEnabled(!1),this.paramObj.moduleMain.napeEngine.transformManager.setScaleMode(f["default"].SCALE_UNIFORM)):this.paramObj.moduleMain.napeEngine.transformManager.hide()}},{key:"bodyContainsConstraint",value:function(t,e){return!!t.contains(new b(this.x,this.y))}},{key:"changeBody",value:function(t,e){if(t===this.body01)this.body01=e;else{if(t!==this.body02)return;this.body02=e}this.fixedBodies(this.body01,this.body02)}},{key:"fixedBodies",value:function(t,e){if(t.userData&&t.userData.view){var i=t.userData.view;i.weldFix&&i.weldFix()}var o=e.rotation-t.rotation||0;if(this.var_joint){var n=t.worldPointToLocal(this.body.position),s=e.worldPointToLocal(this.body.position);this.var_joint.set_body1(t),this.var_joint.set_body2(e),this.var_joint.anchor1=n,this.var_joint.anchor2=s}else this.var_joint=this.JointUtil.createWeldJoint(t,e,this.body.position,this.body.position,o),this.var_joint.userData.bindBody=this.body,this.var_joint.userData.toolView=this;this.body01=this.var_joint.body1=t,this.body02=this.var_joint.body2=e,this.var_joint.set_phase(o),this.var_joint.set_active(!0)}},{key:"updateAfterMove",value:function(){var t=this.var_joint.body1,e=this.var_joint.body2,i=t.worldPointToLocal(this.body.position),o=e.worldPointToLocal(this.body.position);this.var_joint.anchor1=i,this.var_joint.anchor2=o}},{key:"fixed",value:function(){var t=new b(this.x,this.y),e=this.space.bodiesUnderPoint(t);e.filter(function(t){return!!t.userData.canfixtool||(!t.userData||!t.userData.isnbequ)});var i=this.BodyUtil.getTopBodyFormBodyList(e,[this.body]);if(!i)return void this.removeFromFramework(this);var o=this.BodyUtil.getTopBodyFormBodyList(e,[this.body,i]);o||(o=this.getWorldBody()),this.fixedBodies(i,o)}},{key:"removed",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this),this.var_joint&&(this.var_joint.userData.bindBody=null,this.var_joint.userData.toolView=null,this.BodyUtil.destoryJoint(this.var_joint))}},{key:"func_setBodyStateHandler",value:function(t){this.var_isMove=!1,t&this.BodyUtil.ALLOW_MOVE?(this.var_joint.userData.bindBody=this.body,this.fixed()):(this.var_isMove=!0,this.var_joint.userData.bindBody=null)}},{key:"func_bindVo",value:function(t){var e=void 0;if(null==t.beginBody){if(!t.endBody.isDynamic())return void this.removeFromFramework(this);e=this.getWorldBody()}else e=t.beginBody;var i=void 0;if(null==t.endBody){if(!t.beginBody.isDynamic())return void this.removeFromFramework(this);i=this.getWorldBody()}else i=t.endBody;var o=e.userData.view;if(o instanceof nb.mec.Box||o instanceof nb.mec.Circle){20>b.distance(t.beginVec2,e.position)&&(t.beginVec2=b.get(e.posx,e.posy),t.endVec2=b.get(e.posx,e.posy))}this.var_joint=t.beginBody?this.JointUtil.createWeldJoint(e,i,t.beginVec2,t.endVec2):this.JointUtil.createWeldJoint(i,e,t.endVec2,t.beginVec2),this.var_joint.userData.bindBody=this.body,this.var_joint.userData.toolView=this}},{key:"update",value:function(){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.var_joint)try{if(this.var_isMove)return;this.body.set_position(this.var_joint.body1.localPointToWorld(this.var_joint.anchor1)),this.body.rotation=this.var_joint.body1.rotation,this.BodyUtil.frezzBody(this.body)}catch(t){this.removeFromFramework(this)}}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);if(!this.var_joint)return null;t.phase=this.var_joint.get_phase();var i=this.var_joint.body1.userData.view,o=this.var_joint.body2.userData?this.var_joint.body2.userData.view:{};return t.body1={uid:i.UID,anchorX:this.var_joint.anchor1.get_x(),anchorY:this.var_joint.anchor1.get_y()},t.body2={uid:o.UID,anchorX:this.var_joint.anchor2.get_x(),anchorY:this.var_joint.anchor2.get_y()},t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.body.transformShapes(this.transformN),this.setScale(this.currentScale.x,this.currentScale.y),this.revert(t)}},{key:"revert",value:function(t){var e=this,i=void 0,o=void 0,n=void 0,s=void 0;if(this.body.set_type(g.phys.BodyType.get_DYNAMIC()),t.body1){if(!(i=this.getBodyFromUid(t.body1.uid)))return clearTimeout(this.tt),this.tt=setTimeout(function(){e.hadDestory||e.revert(t)},10),void this.body.set_type(g.phys.BodyType.get_KINEMATIC());n=i.localPointToWorld(b.get(t.body1.anchorX,t.body1.anchorY)),t.body2.uid?(o=this.getBodyFromUid(t.body2.uid),s=o.localPointToWorld(b.get(t.body2.anchorX,t.body2.anchorY))):(o=this.getWorldBody(),s=b.get(t.body2.anchorX,t.body2.anchorY)),this.var_joint=this.JointUtil.createWeldJoint(i,o,n,s,t.phase),this.var_joint.userData.bindBody=this.body,this.var_joint.userData.toolView=this}}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function d(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:d(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,i.material=new c.phys.Material(0,.1,.2,2,.02),i.bg=new PIXI.Graphics,i.bg.beginFill(16711680,0),i.bg.drawRect(-25,-25,50,50),i.bg.endFill(),i.addChild(i.bg),i}return s(e,t),a(e,[{key:"init",value:function(){this._width=50,this._height=50,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.sensorEnabled(!0),this.body.userData.dragLevel=3,this.body.userData.classType="DragBox",this.addSelectTrigger(),this.hasAddCompComplete=!0}},{key:"removed",value:function(){this.removeChild(this.bg),this.tigid&&h.M.removeTouch(this,this.tigid),this.bg=null,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"addSelectTrigger",value:function(){var t=this;this.tigid=h.M.addTouch(this,{end:function(){t.getMain().view.selectionLayer.selectOneBodyToReadyMove(t,{bodylist:[t.body]})}},this)}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function w(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:w(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(515),c=o(u),d=i(550),p=o(d),y=i(454),f=o(y),g=i(226),b=o(g),v=void 0,_=void 0,m=void 0,x=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return v=i.phy.nape,_=v.geom.Vec2,m=v.NbBody,x=v.phys.BodyType,i.JointUtil=t.moduleMain.JointUtil,i.BodyUtil=t.moduleMain.BodyUtil,i.ToolStatusStr=t.moduleMain.ToolStatusStr,i.cateid=5,i.classname="ToolSpring",i.ismecJoint=!0,i.isMechanics=!0,i.fromEquTools=!1,i.isMechaTool=!0,i.istool=!0,i.bg=i,i.level=20,i.onelen=10,i.firstBox=null,i.firstJoint=null,i.firstBody=null,i.secBox=null,i.secJoint=null,i.secBody=null,i.spring=null,i.spring_view=null,i.k=1,i.springLen=0,i.noRenderSelected=!0,i.elecLable="弹簧",i.hasAddCompComplete=!0,i}return a(e,t),r(e,[{key:"fixFirstBox",value:function(t,e){var i=this;this.firstBox=new p["default"](this.paramObj),this.addChild(this.firstBox),this.firstBox.init(),this.firstBox.addBodyToSpace(this.firstBox.body,this),this.firstBox.body.set_position(e),null==t&&(t=this.firstBox.getWorldBody()),this.firstBody=t,this.firstJoint=this.JointUtil.createWeldJoint(this.firstBox.body,this.firstBody,e,e),this.firstJoint.userData.toolView=this,this.firstJoint.userData.bindBody=this.firstBox.body,this.firstBox.addEventListener(f["default"].SET_BODY_STATE,function(t){i.setBodyStateHandler(t,i.firstBox)})}},{key:"initDrag",value:function(){var t=this,e=void 0;this.touchid=l.M.addTouch(this.spring_view,{begin:function(i){var o=t.firstBox.getEngineTouchManager();if(o.getCurrentToolStatus()==t.ToolStatusStr.MOVE){e=new o.currentTool(t.paramObj),e.cannotStart=!0,e.init(o.dis,o.space);var n=t.getMouseXY(i);e.moveBody(t.firstBox.body,n)}},move:function(i){if(e){var o=t.getMouseXY(i);e.func_touchMove(o)}},end:function(i){if(e){var o=t.getMouseXY(i);e.func_touchEnd(o),e.dispose()}}},this)}},{key:"setSelected",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setSelected",this).call(this,t),this.spring_view.selected=t}},{key:"setBodyStateHandler",value:function(t,e){if(t&this.BodyUtil.ALLOW_MOVE){var i=e.napeEngine.space.bodiesUnderPoint(e.body.position);i.filter(function(t){return!t.userData||!t.userData.isnbequ});var o=this.BodyUtil.getTopBodyFormBodyList(i,[e.body]),n=void 0;!o||o&&o.userData&&o.userData.view instanceof p["default"]?(o=e.getWorldBody(),n=e.body.position):n=o.worldPointToLocal(e.body.position),e==this.firstBox?(this.firstBody=o,this.firstJoint.anchor2=n,this.firstJoint.set_body2(o)):(this.secBody=o,this.secJoint.anchor2=n,this.secJoint.set_body2(o)),this.secJoint.active=!0,this.firstJoint.active=!0}else e==this.firstBox?this.firstJoint.active=!1:this.secJoint.active=!1}},{key:"initSecondBox",value:function(t){var e=this;this.secBox=new p["default"](this.paramObj),this.addChild(this.secBox),this.secBox.init(),this.secBox.addBodyToSpace(this.secBox.body,this),this.secBox.body.set_position(t),this.secBox.body.set_type(x.get_KINEMATIC()),this.secBox.addEventListener(f["default"].SET_BODY_STATE,function(t){e.setBodyStateHandler(t,e.secBox)});var i=l.M.vec2Length(this.secBox.body.position.sub(this.firstBox.body.position));this.springLen=i,this.spring=this.JointUtil.createSpringJoint(this.firstBox.body,this.secBox.body,this.firstBox.body.position,this.secBox.body.position,i),this.spring.damping=.15,this.spring.frequency=this.k,this.spring_view=new c["default"](this.paramObj),this.spring_view.joint=this.spring,this.spring_view.count=0,this.spring.userData.view=this.spring_view,this.addChildAt(this.spring_view,0),this.spring.active=!1,this.initDrag(),this.firstBox.on("moveEnd",function(t){e.checkRemove()}),this.secBox.on("moveEnd",function(t){e.checkRemove()})}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.spring&&this.spring.update()}},{key:"bodyContainsConstraint",value:function(t,e){return!!t.contains(this.firstBody.localPointToWorld(this.firstJoint.anchor2))||!!t.contains(this.secBody.localPointToWorld(this.secJoint.anchor2))}},{key:"changeBody",value:function(t,e){t==this.firstBody?(this.__changeJointSecondBody(this.firstJoint,t,e),this.firstBody=e):t==this.secBody&&(this.__changeJointSecondBody(this.secJoint,t,e),this.secBody=e)}},{key:"__changeJointSecondBody",value:function(t,e,i){var o=e.localPointToWorld(this.firstJoint.anchor2),n=i.worldPointToLocal(o),s=t.get_body1().rotation-i.rotation;t.anchor2=n,t.set_body2(i),t.set_phase(s)}},{key:"bodyChanged",value:function(t){this.firstBody===t?t.contains(new _(this.firstBox.x,this.firstBox.y))||(this.firstBody=this.getWorld()):this.secBody===t&&(t.contains(new _(this.secBox.x,this.secBox.y))||(this.secBody=this.getWorld())),this.checkRemove()}},{key:"getWorld",value:function(){return this.firstBox.getWorldBody()}},{key:"checkRemove",value:function(){this.firstBody===this.getWorld()&&this.secBody===this.getWorld()&&setTimeout(this.removeFromFramework.bind(this),0,this)}},{key:"upateSpring",value:function(t){this.secBox||this.initSecondBox(t),this.secBox.body.set_position(t);var e=l.M.vec2Length(this.secBox.body.position.sub(this.firstBox.body.position));this.springLen=e,this.spring.springLength=e,this.spring_view.count=Math.floor(e/this.onelen)}},{key:"setSpringLen",value:function(t){this.springLen=t,this.spring.springLength=t,this.spring_view.count=Math.floor(t/this.onelen)}},{key:"fixSecondBox",value:function(t,e){if(null===t&&(t=this.secBox.getWorldBody(),this.firstBody===t))return void this.removeFromFramework(this);this.secBody=t,this.secJoint=this.JointUtil.createWeldJoint(this.secBox.body,this.secBody,e,e),this.secJoint.userData.toolView=this,this.secJoint.userData.bindBody=this.secBox.body,this.secBox.body.set_type(x.get_DYNAMIC()),this.spring.active=!0}},{key:"removed",value:function(){this.firstJoint.userData.toolView=null,this.secJoint&&(this.secJoint.userData.toolView=null),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this),this.touchid&&(l.M.removeTouch(this.spring_view,this.touchid),this.touchid=null),this.firstBox&&(this.firstBox.removed(),this.firstBox=null,this.firstJoint=null,this.firstBody=null),this.secBox&&(this.secBox.removed(),this.secBox=null,this.secJoint=null,this.secBody=null,this.BodyUtil.destoryJoint(this.spring))}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);if(t.thisX=this.x,t.thisY=this.y,t.uid=this.UID,t.fromEquTools=this.fromEquTools,t.ismecJoint=this.ismecJoint,t.springLen=this.springLen,this.secJoint){if(t.firstBox={x:this.firstBox.body.posx,y:this.firstBox.body.posy},t.secBox={x:this.secBox.body.posx,y:this.secBox.body.posy},this.firstJoint.body2){t.b1={uid:(this.firstJoint.body2.userData?this.firstJoint.body2.userData.view:{}).UID}}if(this.secJoint.body2){t.b2={uid:(this.secJoint.body2.userData?this.secJoint.body2.userData.view:{}).UID}}}return t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t);var i=new p["default"](this.paramObj);if(t.firstBox){var o=void 0,n=void 0;o=i.getBodyFromUid(t.b1.uid),o||(o=i.getWorldBody()),this.fixFirstBox(o,_.get(t.firstBox.x,t.firstBox.y)),this.upateSpring(_.get(t.secBox.x,t.secBox.y)),n=i.getBodyFromUid(t.b2.uid),n||(n=i.getWorldBody()),this.fixSecondBox(n,_.get(t.secBox.x,t.secBox.y)),t.springLen&&this.setSpringLen(t.springLen)}}},{key:"getElecGlobalBounds",value:function(){var t=this.firstBox.toGlobal({x:0,y:0}),e=this.secBox.toGlobal({x:0,y:0});return l.M.getPArrRect([t,e])}}]),e}(b["default"])},,,,,function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(1),h=i(49),l=i(602),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0;e["default"]=function(t){function e(t,i){o(this,e);var s=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return s.globalConfig=t.globalConfig,c=t.main.phy.nape,d=c.geom.Vec2,s.NapeConst=i.NapeConst,s.Vec2Util=i.Vec2Util,s.config=t,s.map={},s.initListener(),s}return s(e,t),a(e,[{key:"initListener",value:function(){this.addEventListener("Start_Graphic",this.startGraphicHandler),this.addEventListener("Dispose_Graphics",this.disposeGraphicsHandler)}},{key:"clearLine",value:function(t){var e=this,i=1>=arguments.length||arguments[1]===undefined||arguments[1];t.clear(),t.children.map(function(t){t instanceof PIXI.Text&&e.config.main.cachePool.pushText(t)}),i&&t.removeChildren()}},{key:"disposeGraphicsHandler",value:function(t){var e=this.map[t];e&&(this.clearLine(e,!0),this.config.main.cachePool.pushGraphic(e),this.removeChild(e),this.map[t]=null)}},{key:"startGraphicHandler",value:function(t,e){var i=this.map[e];switch(i||(i=this.config.main.cachePool.popGraphic(),this.map[e]=i,this.addChild(i)),t[0].option){case"line":this.graphicsLine(i,t);break;case"whitePenLight":this.graphicsWhitePenLight(i,t);break;case"Circle":this.graphicsCircle(i,t);break;case"Rect":this.graphicsRect(i,t);break;case"text":this.addText(i,t);break;case"Force":this.graphicsForceAnalysis(i,t[0].target);break;case"ForceArrow":this.graphicsForceArrow(i,t[0].data);break;case"addElement":this.addElement(i,t);break;case"BodyEdges":this.drawEdges(i,t[1])}}},{key:"drawEdges",value:function(t,e){t.clear(),t.lineStyle(e.thin,e.color,e.alpha);var i=e.data;if(e.data.radius){var o=e.data.pos.get_x(),n=e.data.pos.get_y();return void t.drawCircle(o,n,e.data.radius)}if(e.data.compound){return void e.data.list.map(function(e){var i=e.v1,o=e.v2;t.moveTo(i.get_x(),i.get_y()),t.lineTo(o.get_x(),o.get_y())})}var s=0,a=void 0,r=void 0,h=i.get_length();i.foreach(function(e){0===s?(a=e.get_x(),r=e.get_y(),t.moveTo(a,r)):t.lineTo(e.get_x(),e.get_y()),++s===h&&t.lineTo(a,r)})}},{key:"addElement",value:function(t,e){t.removeChildren();var i=0;for(i=0;e.length>i;i++)!function(){var o=e[i].target;t.addChild(o),e[i].params&&(0,h.forEach)(e[i].params,function(t,e){o[t]=e})}()}},{key:"graphicsForceArrow",value:function(t,e){for(;t.children.length>0;){var i=t.removeChildAt(0);i.classType&&"ForceArrow"===i.classType&&(i.disposed(),this.config.main.cachePool.pushThreeClass("ForceArrow",i))}if(e){var o=1,n=null,s=0;for(s=0;e.length>s;s++){if(1==e[s].xu){n=e[s];break}var a=this.getArrowView();a.var_txt.style.fontSize="30px",t.addChild(a);var h=e[s],l="";h.symbol?l=h.symbol:(l="F"+o,o++),a.draw(h.force,h.pos,h.angle,l,e.color)}if(n)try{var u=n.list,c=new PIXI.Graphics;for(c.lineStyle(3,16777215),s=0;u.length>s;s++){var d=u[s],p=t.getChildAt(d.head).headPointTo(t),y=t.getChildAt(d.f1).headPointTo(t),f=t.getChildAt(d.f2).headPointTo(t);r.M.drawDashed(c,y,p,10),r.M.drawDashed(c,f,p,10)}t.addChild(c)}catch(g){}}}},{key:"graphicsForceAnalysis",value:function(t,e){for(;t.children.length>0;){var i=t.removeChildAt(0);i.classType&&"ForceArrow"===i.classType&&(i.disposed(),this.config.main.cachePool.pushThreeClass("ForceArrow",i))}var o=this.Vec2Util.vec3ToVec2(e.buoyancyImpulse()),n=this.config.moduleMain.napeEngine.getGravity(),s=n*e.mass*.001,a=this.getArrowView();t.addChild(a),a.draw(s,e.position,d.get(0,1),"G");var h=void 0,l=r.M.vec2Length(o);if(l>5){h=o.unit(),l*=this.NapeConst.FORCE_RATIO;var u=this.getArrowView();t.addChild(u),u.draw(l,e.position,h,"F浮")}var c=void 0,p=e.constraints;for(c=0;c<p.get_length();c++){var y=p.at(c);if(y.userData&&y.userData.isThruster){var f=y.userData.view.origForceValue(),g=r.M.vec2Length(f),b=f.unit();g*=this.NapeConst.FORCE_RATIO;var v=this.getArrowView();t.addChild(v),v.draw(g,e.position,b,"F")}}var _=e.get_arbiters(),m={},x={};for(c=0;c<_.get_length();c++){var w=_.at(c);if(w&&w.normalImpulse){var k=w.get_body1(),P=w.get_body2(),O=k.get_id()+P.get_id(),T=this.Vec2Util.vec3ToVec2(w.normalImpulse(e)),C=this.Vec2Util.vec3ToVec2(w.tangentImpulse(e));m[O]?m[O].addeq(T):m[O]=T,x[O]?x[O].addeq(C):x[O]=C}}for(var B in m){var S=m[B],M=S.get_length();if(M>0){if(h=S.unit(),.005>(M*=this.NapeConst.FORCE_RATIO))continue;var L=this.getArrowView();t.addChild(L),L.draw(M,e.position,h,"F")}}var D=e.rollingImpulse();for(var I in x){var E=x[I],j=E.get_length()+Math.abs(D);if(j>0){if(0===(h=E.get_length()>0?E.unit():0))continue;if(.005>(j*=this.NapeConst.FORCE_RATIO))continue;var A=this.getArrowView();t.addChild(A),A.draw(j,e.position,h,"f")}}var R=new PIXI.Graphics;R.beginFill(16711680),R.drawCircle(e.posx,e.posy,3),R.endFill(),t.addChild(R)}},{key:"getArrowView",value:function(){return this.config.main.cachePool.popThreeClass("ForceArrow",u["default"],this.config)}},{key:"graphicsRect",value:function(t,e){"start"==e[0].step&&this.clearLine(t),t.beginFill(e[1].color,e[1].alpha),t.drawRect(e[2].x,e[2].y,e[2].width,e[2].height),t.endFill()}},{key:"addText",value:function(t,e){var i=this.config.main.cachePool.popText(e[1].text+"");t.addChild(i),(0,h.forEach)(e[1],function(t,e){i[e]=t}),i.pivot.x=.5*i.width,i.pivot.y=.5*i.height}},{key:"graphicsCircle",value:function(t,e){"start"==e[0].step&&this.clearLine(t),t.beginFill(e[1].color,e[1].alpha),t.drawCircle(e[2].x,e[2].y,e[2].radius),t.endFill()}},{key:"graphicsWhitePenLight",value:function(t,e){for(var i=e[0].list;t.children.length>0;){this.config.main.cachePool.pushGraphic(t.removeChildAt(0))}if(i.length>0){var o=i[0][1];if("0x000000"!==o.color&&!this.globalConfig.LIGHT_DIS_VISIBLE){var n=this.config.main.cachePool.popGraphic();n.lineStyle(o.thin,o.color,0),n.beginFill(o.color,o.alpha);for(var s=0;i.length>s;s++){var a=i[s];n.moveTo(a[2].p1.x,a[2].p1.y),n.lineTo(a[2].p2.x,a[2].p2.y),n.lineTo(a[2].p3.x,a[2].p3.y),n.lineTo(a[2].p4.x,a[2].p4.y),n.lineTo(a[2].p1.x,a[2].p1.y)}n.alpha=o.alpha>.9?.9:osytleobj.alpha,n.blendMode=PIXI.BLEND_MODES.SCREEN,t.addChild(n)}}}},{key:"graphicsLine",value:function(t,e){"start"==e[0].step&&this.clearLine(t);var i=0;for(i=1;e.length>i;i++)"lineStyle"==e[i].type?t.lineStyle(e[i].thin,e[i].color,e[i].alpha):"beginFill"==e[i].type?t.beginFill(e[i].color,e[i].alpha):"endFill"==e[i].type?t.endFill():"moveTo"==e[i].type?t.moveTo(e[i].line_x,e[i].line_y):"lineTo"==e[i].type?t.lineTo(e[i].line_x,e[i].line_y):"curveTo"==e[i].type&&t.quadraticCurveTo(e[i].cpX,e[i].cpY,e[i].toX,e[i].toY)}},{key:"getShader",value:function(){return new PIXI.AbstractFilter(null,"precision mediump float;\n\n            void main(void){\n            gl_FragColor = vec4(1,1,1,1.0);\n            }",{})}}]),e}(PIXI.Container)},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e["default"]=function n(){o(this,n),this.EARTH_GRAVITY=9.8,this.NB_WORLD_GRAVITY_PER_N=2e3/this.EARTH_GRAVITY,this.DEFAULT_GRAVITY=this.NB_WORLD_GRAVITY_PER_N*this.EARTH_GRAVITY,this.FORCE_SCLAE=.03*this.EARTH_GRAVITY,this.MASS_SCALE=.001,this.k5n=1/33.3333321566,this.FORCE_RATIO=.00029409801384184414,this.K_VELOCITY=1833/10.78,this.STATICFRICTION_SCALE=.5,this.BODY_COLOR=52479,this.MIN_DISTANCE=10,this.LITTLE_RADIUS=20,this.WORLD_ANGULAR_DRAG=.1,this.WORLD_LINEAR_DRAG=.1,this.ROPE_LENGTH=50,this.ROPE_LENGTH_SCLAE=.85,this.RECT_MIN_WIDTH=4*this.SCALE_SPACE,this.RECT_MAX_WIDTH=300*this.SCALE_SPACE,this.DRAG_MAX_FORCE=1e7,this.DRAG_FORCE_PER_PIXEL=this.DRAG_MAX_FORCE/250,this.SCALE_SPACE=3,this.SCALE_PAPER_SPACE=3.342,this.PAPER_VALUE_FACTOR=.953,this.SCALE_VELOCITY=.031806615776081744,this.handJoint=null}},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=i(1),l=i(559),u=o(l),c=i(571),d=o(c),p=i(564),y=o(p),f=i(556),g=o(f),b=i(454),v=o(b),_=i(601),m=o(_),x=i(604),w=o(x),k=i(489),P=o(k),O=i(603),T=o(O),C=void 0,B=void 0,S=void 0,M=function(t){function e(t,i){n(this,e);var o=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o.config=t,o.mecMain=i,C=t.main.phy.nape,B=C.NbSpace,S=C.geom.Vec2,o.MechanicsPopTool=t.MechanicsPopTool,o.MouseManager=t.MouseManager,o.globalConfig=t.globalConfig,o.diyClass=new m["default"],o.NapeConst=i.NapeConst,o.ToolStatusStr=i.ToolStatusStr,o.loadstart=!1,o.isactive=!0,o.timeStep=1/60,o.velocityIterations=40,o.positionIterations=40,o.floorDat=null,o.floor=null,o.tmpMechData=[],o.space=null,o.touchManager=null,o.groupManager=new w["default"](C),o.gravity=new S(0,o.NapeConst.DEFAULT_GRAVITY),o.viewSync=null,o.uidMap={},o.enabledDeviceGravity=!1,o.timerInd=0,o.openAirRes=!1,o.grC=new g["default"](t,i),o.coor=null,o._play=!0,o.wallArr=[],o.hockCtrol=new T["default"](t),o}return a(e,t),r(e,[{key:"init",value:function(){this.transformManager=new P["default"](this.config),this.space=new B(this.gravity),this.space.get_userData().napeEngine=this,this.space.get_userData().handbodys=new C.constraint.ConstraintList,this.mecMain.JointUtil.space=this.space,this.changeAirResistance(this.openAirRes),this.hockCtrol.body.set_space(this.space),this.viewSync=new u["default"](this.config,this.mecMain),this.touchManager=new y["default"](this.config,this.mecMain),this.touchManager.registerManager(),this.globalConfig.main.drawStack.addChild(this.grC),this.createWall(),this.globalConfig.DEBUG&&(C.nbdebug=!0)}},{key:"dispose",value:function(){this.space.get_userData().napeEngine=null,this.floor.removed(),this.viewSync.dispose(),this.touchManager.dispose(),this.transformManager.dispose(),this.mecMain.JointUtil.space=null,this.config=null,this.mecMain=null,this.MechanicsPopTool=null,this.MouseManager=null,this.globalConfig=null,this.NapeConst=null,this.ToolStatusStr=null}},{key:"setActive",value:function(t){t?(this.isactive||this.touchManager.initTouch(),this.isactive=!0):(this.isactive=!1,this.touchManager.removeTouch(),C.util.Debug.clearObjectPools()),this.setTouchManager(this.config.MechanicsPopTool.DRAG)}},{key:"getAllMechData",value:function(){var t=this.globalConfig.main.viewStack,e=t.children.length,i=void 0;for(this.tmpMechData=[],i=0;e>i;i++){var o=t.getChildAt(i),n=o.component;n&&n.isMechanics&&this.tmpMechData.push({tar:n,dat:n.getData()})}}},{key:"changeAirResistance",value:function(t){this.openAirRes=t,t?(this.space.set_worldAngularDrag(.1),this.space.set_worldLinearDrag(.1)):(this.space.set_worldAngularDrag(0),this.space.set_worldLinearDrag(0))}},{key:"update",value:function(){if(this.dispatchEvent(v["default"].WORLD_UPDATE),this._play){this.space.get_userData().handbodys.foreach(function(t){if(!t.userData.notdragslow){var e=t.get_angularVel();.01>Math.abs(e)&&(e=0),t.set_angularVel(.2*e)}}),this.hockCtrol.updateShapes(),this.space.step(this.timeStep,this.velocityIterations,this.positionIterations),this.timerInd++,this.dispatchEvent(v["default"].WORLD_TIME_CHANGE)}}},{key:"sensorEnabledWall",value:function(){this.floor.body.sensorEnabled(0>=arguments.length||arguments[0]===undefined||arguments[0])}},{key:"moveWall",value:function(t,e){this.floor.body.set_position(S.get(t,e))}},{key:"createWall",value:function(){var t=new d["default"](this.config);this.floor=t,this.globalConfig.main.otherContainer.addChild(t),t.initWall(),this.floorDat=[t.boxWidth,t.wallWidth],this.wallArr=[t.body]}},{key:"resetWall",value:function(){this.globalConfig.main.otherContainer.removeChild(this.floor);var t=new d["default"](this.config);this.floor=t,this.globalConfig.main.otherContainer.addChild(t),t.initWall(),this.floorDat=[t.boxWidth,t.wallWidth],this.wallArr=[t.body]}},{key:"hideFloor",value:function(t){this.floor.floor.visible=!t}},{key:"groupManager",value:function(){return this.groupManager}},{key:"getGravity",value:function(){return this.gravity.get_y()/this.NapeConst.DEFAULT_GRAVITY*this.NapeConst.EARTH_GRAVITY}},{key:"setGravity",value:function(t){var e=t*this.NapeConst.DEFAULT_GRAVITY/this.NapeConst.EARTH_GRAVITY;this.gravity.set_y(e),this.space.get_gravity().set_y(e)}},{key:"getNapeTimer",value:function(){return Math.floor(this.timerInd*this.timeStep*1e3*1.2)}},{key:"getTouchManager",value:function(){return this.touchManager}},{key:"keyBoardChangeTouchState",value:function(t){var e={68:this.ToolStatusStr.DRAG,67:this.ToolStatusStr.CIRCLE,82:this.ToolStatusStr.RECT,83:this.ToolStatusStr.SLICE,80:this.ToolStatusStr.SPRING,77:this.ToolStatusStr.MOVE,70:this.ToolStatusStr.FIXED,66:this.ToolStatusStr.BEARING,79:this.ToolStatusStr.ROPE,84:this.ToolStatusStr.THRUSTER,81:this.ToolStatusStr.ROTA,76:this.ToolStatusStr.POLY,71:this.ToolStatusStr.GEAR};if(112===t)this.globalConfig.DEBUG=!this.globalConfig.DEBUG;else if(e[t]){var i=this.setTouchManager(e[t]);i&&this.globalConfig.main.keyboardChangeStatus(this.touchManager.getCurrentToolStatus())}}},{key:"changeMouseCur",value:function(t){var e={};e[this.MechanicsPopTool.DRAG]="tuozhuai",e[this.MechanicsPopTool.MOVE]="yidong",e[this.MechanicsPopTool.DRAW_RECT]="rect",e[this.MechanicsPopTool.DRAW_CIRCLE]="circle",e[this.MechanicsPopTool.DRAW_GEAR]="chilun",e[this.MechanicsPopTool.DRAW_ZIDINGYI]="ziyouhuizhi",e[this.MechanicsPopTool.TOOL_SPRING]="spring",e[this.MechanicsPopTool.TOOL_ZHOUCHENG]="motor",e[this.MechanicsPopTool.TOOL_GUDING]="guding",e[this.MechanicsPopTool.TOOL_PUSH]="force",e[this.MechanicsPopTool.TOOL_KNIFE]="cutting",e[this.MechanicsPopTool.TOOL_ROTATE]="rotatebtn",e[this.MechanicsPopTool.DRAW_LAND]="shengzi",t&&e[t]&&(this.globalConfig.main.mouseManager.changeMouseStatusName(e[t],!0,this.globalConfig.main.view,!1),t===this.MechanicsPopTool.MOVE||t===this.MechanicsPopTool.DRAG?(this.MouseManager.lockMouse(!1),this.mecMain._isInToolState=!1):(this.MouseManager.lockMouse(!0),this.mecMain._isInToolState=!0))}},{key:"setTouchManager",value:function(t){return t!==this.touchManager.getCurrentToolStatus()&&(this.touchManager.changeTouchState(t),this.globalConfig.main.view.selectionLayer.cannotSelect(this.touchManager.getCurrentToolStatus()===this.ToolStatusStr.DRAG||this.touchManager.getCurrentToolStatus()===this.ToolStatusStr.MOVE?!1:!0),this.changeMouseCur(t),!0)}},{key:"getFloorY",value:function(){var t=this.floor.getfloorY();return this.globalConfig.main.viewStack.toLocal(new h.Point(0,t),this.globalConfig.main.view).y}},{key:"play",get:function(){return this._play},set:function(t){this._play=t}}]),e}(PIXI.EventEmitter);M.prototype.addEventListener=M.prototype.on,M.prototype.removeEventListener=M.prototype.off,M.prototype.dispatchEvent=M.prototype.emit,e["default"]=M},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),a=i(1),r=i(617),h=o(r),l=i(451),u=o(l);e["default"]=function(){function t(e,i){n(this,t),this.globalConfig=e.globalConfig,this.napeEngine=i.napeEngine,this.debugDraw=new h["default"](e,this.napeEngine),this.globalConfig.main.view.addChild(this.debugDraw)}return s(t,[{key:"dispose",value:function(){this.debugDraw.removed(),this.globalConfig=null,this.napeEngine=null}},{key:"update",value:function(){for(var t=this.globalConfig.main.getEquipmentArr(!0),e=0;t.length>e;e++){var i=t[e];!(i instanceof u["default"])&&i.update&&i.update()}this.napeEngine.update(),this.globalConfig.DEBUG?this.debugDraw.draw():this.debugDraw.clear();var o=this.napeEngine.space.constraints,n=this.napeEngine.space.bodies,s=this.napeEngine.space.get_compounds();this.everyOneBody(n);for(var a=0;a<s.get_length();a++){var r=s.at(a);this.everyOneBody(r.get_bodies()),this.updateJoint(r.get_constraints())}this.updateJoint(o),this.updateEnd(n)}},{key:"updateEnd",value:function(t){for(var e=0;e<t.get_length();e++){var i=t.at(e);if(i){var o=i.userData.view;o&&o.updateEnd&&o.updateEnd()}}}},{key:"updateJoint",value:function(t){for(var e=0;e<t.get_length();e++){var i=t.at(e);if(i.userData){var o=i.userData.hockshape;if(o){var n=1;isNaN(i.userData.hocknum)||(n=i.userData.hocknum);o.set_localCOM(i["get_body"+n]().localPointToWorld(i["get_anchor"+n]()))}i.userData.view&&i.userData.view.update&&i.userData.view.update()}i.updateStep&&i.updateStep()}}},{key:"everyOneBody",value:function(t){for(var e=0;e<t.get_length();e++){this.updateBody(t.at(e))}}},{key:"updateBody",value:function(t){if(t){var e=t.userData.view;if(e)if(t.userData.coordinateField){var i=t.userData.coordinateField,o=void 0;try{if(!(o=i.toLocal(new a.Point(t.posx,t.posy),this.globalConfig.main.view)))return}catch(s){return}if(e.x=o.x,e.y=o.y,e.rotation=t.rotation,t.userData.bindupdate){var n=t.userData.bindupdate.field;t.userData.bindupdate.func.call(n)}}else e.x=t.posx,e.y=t.posy,e.rotation=t.rotation,e.update&&e.update()}}}]),t}()},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var n=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),s=i(1);e["default"]=function(){function t(e,i,n){o(this,t),this.globalConfig=e.globalConfig,this.rotarget=i,this.mcTrigger=i.rotaSP,this.body=i.body,this.updatefunc=n,this.downRota=0,this.downAng=0,this.init()}return n(t,[{key:"init",value:function(){this.mcTrigger.addEventListener(TouchEvent.TOUCH_BEGIN,this.addRotateTool_touchHandle),this.mcTrigger._this=this}},{key:"dispose",value:function(){this.rotarget=null,this.mcTrigger&&(this.mcTrigger.removeEventListener(TouchEvent.TOUCH_BEGIN,this.addRotateTool_touchHandle),this.mcTrigger.removeEventListener(TouchEvent.TOUCH_MOVE,this.addRotateTool_touchHandle),this.mcTrigger.removeEventListener(TouchEvent.TOUCH_END,this.addRotateTool_touchHandle),this.mcTrigger.removeEventListener(TouchEvent.TOUCH_END_OUTSIDE,this.addRotateTool_touchHandle),this.mcTrigger._this=null),this.mcTrigger=null,this.body=null,this.updatefunc=null}},{key:"addRotateTool_touchHandle",value:function(t,e){var i=this._this||e,o=new s.Point(t.data.global.x,t.data.global.y),n=new s.Point(i.body.posx,i.body.posy);if(s.M.touchIsType(t.type,TouchEvent.TOUCH_BEGIN))downRota=i.body.rotation,i.rotation=downRota,downAng=Math.atan2(o.y-n.y,o.x-n.x),i.mcTrigger.addEventListener(TouchEvent.TOUCH_MOVE,i.addRotateTool_touchHandle),i.mcTrigger.addEventListener(TouchEvent.TOUCH_END,i.addRotateTool_touchHandle),i.mcTrigger.addEventListener(TouchEvent.TOUCH_END_OUTSIDE,i.addRotateTool_touchHandle),this.globalConfig.hData.clearTimeHide.call(this.globalConfig.hData);else if(s.M.touchIsType(t.type,TouchEvent.TOUCH_MOVE)){var a=void 0;a=e?Math.atan2(o.y-n.y,o.x-n.x):Math.atan2(o.y-n.y,o.x-n.x)+.5*Math.PI;var r=a-i.downRota+i.downAng;i.updatefunc.call(i.rotarget,null,r,t)}else(s.M.touchIsType(t.type,TouchEvent.TOUCH_END)||s.M.touchIsType(t.type,TouchEvent.TOUCH_END_OUTSIDE))&&(i.rotarget.cannotSystemDrag=!0,i.mcTrigger.removeEventListener(TouchEvent.TOUCH_MOVE,i.addRotateTool_touchHandle),i.mcTrigger.removeEventListener(TouchEvent.TOUCH_END,i.addRotateTool_touchHandle),i.mcTrigger.removeEventListener(TouchEvent.TOUCH_END_OUTSIDE,i.addRotateTool_touchHandle))}}]),t}()},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function g(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:g(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(452),c=o(u),d=i(500),p=o(d),y=void 0,f=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=t.moduleMain.phy.nape,f=y.geom.Vec2,i.singlePoint=!0,i}return a(e,t),r(e,[{key:"setActive",value:function(t){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setActive",this).call(this,t),this.active){var i=this;this.touchTabUid||(this.touchTabUid=l.M.addTouch(this.var_dis,{tab:i.touchTab,isAddDB:!1},this))}else this.touchTabUid&&l.M.removeTouch(this.var_dis,this.touchTabUid),this.touchTabUid=null}},{key:"touchTab",value:function(t){var e=new f(t.x,t.y),i=this.space.bodiesUnderPoint(e);if(i.filter(function(t){return!t.userData||!t.userData.isnbequ}),0!=i.length){var o=this.BodyUtil.getTopBodyFormBodyList(i);if(o&&o.userData.view&&!o.userData.view.isMechaTool){this.cancelMecSelected(t);var n=this.BodyUtil.getTopBodyFormBodyList(i,[o]);n||(n=this.space.world),n!=this.space.world&&this.adsorbToCom(n,t,50),this.adsorbToCom(o,t,50);var s=new p["default"](this.config,o,n);this.addEquipmentChild(s,t),this.initScale(s),this.globalConfig.main.dispatchEvent("phy.addEquipment"),this.config.moduleMain.napeEngine.transformManager.hide(),this.globalConfig.main.execute(this.NBCommand.ANALYTICS,{type:"mecTool",name:"bearing"}),this.globalConfig.main.isPlay||(s.setSelected(!0),s.freshLibPan())}}}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function P(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:P(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(452),c=o(u),d=i(449),p=o(d),y=i(509),f=o(y),g=i(508),b=o(g),v=i(13),_=void 0,m=void 0,x=void 0,w=void 0,k=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return _=t.moduleMain.phy.nape,w=_.NbPivotJoint,m=_.geom.Vec2,x=_.phys.BodyType,k=_.phys.InertiaMode,i.seBody=null,i.handJoint=null,i.var_originDat=null,i.isClick=!1,i.hithockCtrl=null,i.oldP=null,i.cannotStart=!1,i.rotaTool=null,i.moveTool=null,i.dragtranslate=!1,i.prevP=null,i.offsetP=new l.Point,i.multiMove=!1,i.selfDragManager=!1,i}return a(e,t),r(e,[{key:"setActive",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setActive",this).call(this,t),this.active?(this.touchBeginUid||(this.touchBeginUid=l.M.addTouch(this.var_dis,{begin:this.func_touchBegin,isAddDB:!1},this)),this.touchMoveUid||(this.touchMoveUid=l.M.addTouch(this.var_dis,{move:this.func_touchMove,isAddDB:!1},this)),this.touchEndUid||(this.touchEndUid=l.M.addTouch(this.var_dis,{end:this.func_touchEnd,isAddDB:!1},this))):(this.touchBeginUid&&l.M.removeTouch(this.var_dis,this.touchBeginUid),this.touchMoveUid&&l.M.removeTouch(this.var_dis,this.touchMoveUid),this.touchEndUid&&l.M.removeTouch(this.var_dis,this.touchEndUid),this.touchBeginUid=null,this.touchMoveUid=null,this.touchEndUid=null)}},{key:"func_touchBegin",value:function(t){if(this.main.activeModule&&this.main.activeModule.napeEngine.play){if(this.hithockCtrl=null,this.prevP=t,this.oldP=t,this.cannotStart)return void(this.cannotStart=!1);if(this.seBody=this.getDragBodyUnderPoit(t)){if(this.seBody.userData.dragManager)return void(this.seBody=null);var e=this.seBody.userData.view;if(e&&!0===e.selfDragManager&&!0===e.checkDrag(t))return e.dragToolBegin(t),void(this.selfDragManager=!0);if(this.seBody.userData.view&&this.seBody.userData.view.findRotaShape){if(this.seBody.userData.view.findRotaShape(t))return this.rotaTool=new f["default"](this.config),void this.rotaTool.bindStartBody(this.seBody,t)}if(this.seBody&&this.seBody.userData&&this.seBody.userData.dragTomoveTool)return this.moveTool=new b["default"](this.config),this.moveTool.init(this.var_dis,this.space),void this.moveTool.moveBody(this.seBody,t);if(this.seBody&&this.seBody.userData&&this.seBody.userData.dragtranslate){if(this.dragtranslate=!0,this.seBody.userData.dragManager=this,e){var i={data:{global:t}};e.dispatchEvent(p["default"].BEGIN,i)}}else{this.checknotDragInnerShape(t)?this.seBody=null:(this.toDragJoint(this.seBody,t),this.main.dispatchEvent(v.PHY_EVENTS.BLACK_TOUCH_STOP))}}}}},{key:"checknotDragInnerShape",value:function(t){var e=this.seBody.get_shapes(),i=!1;return e.foreach(function(e){if(!i){var o=e.get_userData();o&&!0===o.noDrag&&e.contains(m.get(t.x,t.y))&&(i=!0)}}),i}},{key:"getDragBodyUnderPoit",value:function(t){for(var e=m.get(t.x,t.y),i=this.space.shapesUnderPoint(e),o=i.get_length(),n=0;o>n;n++){var s=i.at(n);if(1==s.get_userData().firstDrag)return s.get_body()}var a=this.space.bodiesUnderPoint(e),r=[];return a.filter(function(t){if(t.isStatic())return!1;if(t.userData.noDrag)return!1;var e=t.userData.view;return!!e&&(!(!e.touchEnabled&&!t.userData.coordinateField)&&(r.push(t),!0))}),0===r.length?null:(r.sort(function(t,e){return e.userData.dragLevel-t.userData.dragLevel}),r[0])}},{key:"toDragJoint",value:function(t,e){if(this.seBody=t,t){t.isKinematic()&&(this.var_originDat={},t.noallowRotation=!0),this.oldP=e,this.isClick=!0;var i=t.worldPointToLocal(m.get(e.x,e.y));t.set_type(x.get_DYNAMIC());var o=!1,n=!1;t.userData&&1==t.userData.weldDrag&&(o=!0),t.userData&&1==t.userData.pivotDrag&&(n=!0);var s=t.get_inertia();n||!o&&!this.var_originDat?(this.handJoint=new w(this.space.world,t,m.get(e.x,e.y),i),this.seBody.userData.handJointStiff?this.handJoint.stiff=!0:(this.handJoint.stiff=!1,this.seBody.userData.handJointFrequency&&(this.handJoint.frequency=this.seBody.userData.handJointFrequency)),this.seBody.userData.coerceAB&&(this.handJoint.coerceAB=!0,this.handJoint.aTob=!1),this.handJoint.damping=0,this.handJoint.ignore=!0):this.handJoint=this.JointUtil.createWeldJoint(this.space.world,t,m.get(e.x,e.y),m.get(e.x,e.y)),t.set_inertia(10*s),this.space.constraints.add(this.handJoint);if(this.space.get_userData().handbodys.add(t),this.hithockCtrl=this.hitHockshape(e))return void this.handJoint.set_active(!1);t.userData.dragManager=this;var a=t.userData.view;if(a){a.ismecJoint&&a.istoolMove&&(this.handJoint.active=!1);a.dispatchEvent(p["default"].BEGIN,{data:{global:e}})}}}},{key:"func_touchMove",value:function(t){if(this.seBody&&this.seBody.userData&&!this.seBody.isdestory){var e=this.seBody.userData.view;if(e&&!0===this.selfDragManager)return void e.dragToolMove(t);if(this.rotaTool)return void this.rotaTool.func_touchMove(t);if(this.moveTool)return void this.moveTool.func_touchMove(t);if(this.seBody.userData.noDrag)return void this.func_touchEnd(t);var i=l.Point.distance(this.oldP,t);if(this.hithockCtrl&&50<i){var o=this.hithockCtrl,n=o.get_worldCOM().copy();this.func_touchEnd(t);var s=this.napeEngine.hockCtrol.breakJointToDrag(o);if(s){var a=s.get_position();s.set_position(m.get(a.get_x()+t.x-n.get_x(),a.get_y()+t.y-n.get_y())),this.toDragJoint(s,t)}}else{if(this.isClick&&i>20&&(this.isClick=!1),e&&e.hasOwnProperty("propertyChange")?e.propertyChange=!0:e&&e.root&&e.root.hasOwnProperty("propertyChange")&&(e.root.propertyChange=!0),this.dragtranslate){var r=t.x-this.prevP.x,h=t.y-this.prevP.y;if(Math.abs(h>1e3))return;e.translateMove(r,h),this.prevP=t;return void e.dispatchEvent(p["default"].MOVE,{data:{global:t}})}if(this.handJoint.anchor1.set(m.get(t.x,t.y)),e){e.dispatchEvent(p["default"].MOVE,{data:{global:t}})}}}}},{key:"func_touchEnd",value:function(t,e){if(this.hithockCtrl=null,this.seBody&&this.seBody.userData){var i=this.seBody.userData.view;if(i&&!0===this.selfDragManager)return void i.dragToolEnd(t);if(this.seBody.userData&&delete this.seBody.userData.dragManager,this.rotaTool)return this.rotaTool.func_touchEnd(t),this.rotaTool=null,void(this.seBody=null);if(this.moveTool)return this.moveTool.func_touchEnd(t),this.moveTool.dispose(),this.moveTool=null,void(this.seBody=null);if(this.dragtranslate){i.translateMove(t.x-this.prevP.x,t.y-this.prevP.y,!0);return void i.dispatchEvent(p["default"].END,{data:{global:t}})}if(this.handJoint&&(this.space.constraints.remove(this.handJoint),this.handJoint=null),null!=this.var_originDat&&(this.seBody.noallowRotation=!1,this.seBody.set_type(x.get_KINEMATIC()),this.BodyUtil.frezzBody(this.seBody),this.var_originDat=null),this.seBody){var o=this.space.get_userData();if(o.handbodys.has(this.seBody)&&o.handbodys.remove(this.seBody),this.seBody.isdestory)return;this.seBody.set_inertiaMode(k.get_DEFAULT());var n=!1;if(this.isClick&&(n=this.clickHock(t)),this.seBody.userData&&i&&t){var s={data:{global:t}};this.isClick&&(i.dispatchEvent(p["default"].CLICK,s),!0===i.useDragSetCurElec&&this.main.setCurElec(i,!0)),!1===n&&i.dispatchEvent(p["default"].END,s)}this.isClick=!1,this.seBody=null}}}},{key:"hitHockshape",value:function(t){var e=this.napeEngine.hockCtrol.body,i=e.get_shapes(),o=null;return i.foreach(function(e){var i=e.get_userData().hock;!o&&i&&e.contains(m.get(t.x,t.y))&&(o=e)}),o}},{key:"clickHock",value:function(t){var e=this,i=this.napeEngine.hockCtrol.body,o=i.get_shapes(),n=!1;return o.foreach(function(i){var o=i.get_userData().hock;!n&&o&&i.contains(m.get(t.x,t.y))&&(e.napeEngine.hockCtrol.removeJointShape(i),o.dragToolClick(),n=!0)}),n}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function b(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:b(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(452),c=o(u),d=i(512),p=o(d),y=i(474),f=o(y),g=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.angle=0,i.num=0,i.lineColor=11184810,i.var_edgeColor=11184810,i.lineThin=2,i.var_pointArr=[],i.graphics=new PIXI.Graphics,i}return a(e,t),r(e,[{key:"setActive",value:function(t){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setActive",this).call(this,t),this.active){var i=this;this.touchBeginUid||(this.touchBeginUid=l.M.addTouch(this.var_dis,{begin:i.func_touchBegin,isAddDB:!1},this)),this.touchMoveUid||(this.touchMoveUid=l.M.addTouch(this.var_dis,{move:i.func_touchMove,isAddDB:!1},this)),this.touchEndUid||(this.touchEndUid=l.M.addTouch(this.var_dis,{end:i.func_touchEnd,isAddDB:!1},this))}else this.touchBeginUid&&l.M.removeTouch(this.var_dis,this.touchBeginUid),this.touchMoveUid&&l.M.removeTouch(this.var_dis,this.touchMoveUid),this.touchEndUid&&l.M.removeTouch(this.var_dis,this.touchEndUid),this.touchBeginUid=this.touchMoveUid=this.touchEndUid=null}},{key:"func_touchBegin",value:function(t){this.func_dispose(),this.isstart=!0,this.var_center=new l.Point(t.x,t.y),this.thin=6/this.getGlobalScale(),this.skinColor=f["default"].getColor();var e=[];e.push({option:"addElement",target:this.graphics,params:{x:0,y:0}}),this.func_dispatchGraphic(e),this.config.moduleMain.napeEngine.transformManager.hide()}},{key:"func_touchMove",value:function(t){this.isstart&&(this.r=l.Point.distance(this.var_center,t),this.angle=Math.atan2(t.y-this.var_center.y,t.x-this.var_center.x),this.func_refreshGrc())}},{key:"func_refreshGrc",value:function(){this.graphics.clear(),this.num=this.func_getNum(this.r),this.var_pointArr=this.func_getGearPoints(this.r,this.angle,this.num);var t=this.var_pointArr.length;if(t>0){this.graphics.lineStyle(this.thin,this.lineColor,1),this.graphics.beginFill(this.skinColor,1);for(var e=0;t>e;e++){var i=this.var_pointArr[e];0==e?this.graphics.moveTo(this.var_center.x+i.x,this.var_center.y+i.y):this.graphics.lineTo(this.var_center.x+i.x,this.var_center.y+i.y)}this.graphics.endFill()}}},{key:"func_getGearPoints",value:function(t,e,i){var o=[];if(t>=5){var n=i;3>n&&(n=3);var s=5*n,a=18;n>6||(a=11+n);for(var r=void 0,h=s+a,u=[{f:1/8,rad:s},{f:.4,rad:h},{f:.6,rad:h},{f:7/8,rad:s}],c=0;n>c;c++)for(var d=2*Math.PI/n,p=d*c,y=0;u.length>y;y++){var f=e+p+d*u[y].f,g=u[y].rad;r=new l.Point(Math.cos(f)*g,Math.sin(f)*g),o.push(r)}}return o}},{key:"func_getNum",value:function(t){return Math.ceil((t-5)/5)+2}},{key:"func_touchEnd",value:function(t,e){if(this.isstart&&(this.isstart=!1,this.func_dispose(),this.graphics.clear(),!e)){if(this.var_pointArr.length>3){var i=new p["default"](this.config,this.r,this.angle,0,this.skinColor);this.addEquipmentChild(i,this.var_center),this.globalConfig.main.dispatchEvent("phy.addEquipment"),this.globalConfig.main.execute(this.NBCommand.ANALYTICS,{type:"mecTool",name:"gear"}),this.config.moduleMain.napeEngine.play||(i.setSelected(!0),i.freshLibPan())}this.r=0}}}]),e}(c["default"]);g.preventDraw=!0,e["default"]=g},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),a=i(1),r=i(562),h=o(r),l=i(605),u=o(l),c=i(566),d=o(c),p=i(607),y=o(p),f=i(563),g=o(f),b=i(508),v=o(b),_=i(606),m=o(_),x=i(561),w=o(x),k=i(569),P=o(k),O=i(570),T=o(O),C=i(565),B=(o(C),i(544)),S=o(B),M=i(567),L=o(M),D=i(509),I=o(D),E=i(568),j=o(E),A=void 0,R=void 0;e["default"]=function(){function t(e,i){n(this,t),this.config=e,A=e.main.phy.nape,R=A.geom.Vec2,this.BodyUtil=i.BodyUtil,this.globalConfig=e.globalConfig,this.ToolStatusStr=i.ToolStatusStr,this.space=i.napeEngine.space,this.currentType=null,this.toolType=null,this.currentTool=null,this.map={},this.dis=this.globalConfig.main.canvas,this.stage=this.globalConfig.main.stage,this.view=this.globalConfig.main.view,this.toolMap={},this.penpolygon=null,this.enAbled=!0,this.ngZone=i.main.ngZone}return s(t,[{key:"dispose",value:function(){this.removeTouch(),this.config=null,this.BodyUtil=null,this.globalConfig=null,this.ToolStatusStr=null,this.space=null,this.currentTool=null,this.dis=null,this.stage=null,this.view=null,this.penpolygon=null}},{key:"registerManager",value:function(){this.map[this.ToolStatusStr.DRAG]=h["default"],this.map[this.ToolStatusStr.CIRCLE]=u["default"],this.map[this.ToolStatusStr.RECT]=d["default"],this.map[this.ToolStatusStr.TRIANGLE]=y["default"],this.map[this.ToolStatusStr.GEAR]=g["default"],this.map[this.ToolStatusStr.MOVE]=v["default"],this.map[this.ToolStatusStr.FIXED]=m["default"],this.map[this.ToolStatusStr.BEARING]=w["default"],this.map[this.ToolStatusStr.SPRING]=P["default"],this.map[this.ToolStatusStr.THRUSTER]=T["default"],this.map[this.ToolStatusStr.POLY]=S["default"],this.map[this.ToolStatusStr.ROPE]=L["default"],this.map[this.ToolStatusStr.ROTA]=I["default"],this.map[this.ToolStatusStr.SLICE]=j["default"],this.initTouch(),this.changeTouchState(this.ToolStatusStr.MOVE)}},{key:"removeTouch",value:function(){this.var_touchUid&&(a.M.removeDomTouch(this._$dis,this.var_touchUid),this.var_touchUid=null)}},{key:"initTouch",value:function(){var t=this;this.ngZone?this.ngZone.runOutsideAngular(function(){t._$dis=$(t.dis),t.var_touchUid=a.M.addDomTouch(t._$dis,{begin:t.touchBegin,move:t.touchMove,end:t.touchEnd,tab:t.touchTab,isAddDB:!0},t,{canTab:!0})}):(this._$dis=$(this.dis),this.var_touchUid=a.M.addDomTouch(this._$dis,{begin:this.touchBegin,move:this.touchMove,end:this.touchEnd,tab:this.touchTab,isAddDB:!0},this,{canTab:!0}))}},{key:"doubleTab",value:function(){(evt.touches||0===evt.button)&&this.toolMap[0]&&this.toolMap[0].func_touchTab()}},{key:"touchTab",value:function(t){var e=new a.Point(0,0),i=void 0,o=void 0;if(t.touches){var n=t.changedTouches[0];i=n.clientX,o=n.clientY}else i=t.clientX,o=t.clientY;if(this.globalConfig.main.renderer.plugins.interaction.mapPositionToPoint(e,i,o),e=this.view.toLocal(e,this.stage),t.touches||0===t.button)if(this.toolType===this.ToolStatusStr.POLY){if(this.toolType!==this.ToolStatusStr.POLY)return;this.penpolygon||(this.penpolygon=new S["default"](this.config),this.penpolygon.init(this.dis,this.space)),this.penpolygon.touchTab(e);var s=this.BodyUtil.getSelectBodyUnderPoint(this.space,e);if(s){var r=s.userData.view;r.setSelected(!1)}}else for(var h in this.toolMap){var l=this.toolMap[h];l.touchTab&&l.touchTab(e)}}},{key:"touchEnd",value:function(t,e){if(t.touches||0===t.button)if(t&&t.changedTouches)for(var i=0;t.changedTouches.length>i;i++){var o=t.changedTouches[i],n=o.identifier;if(this.toolMap[n]){var s=new a.Point(0,0);this.globalConfig.main.renderer.plugins.interaction.mapPositionToPoint(s,o.clientX,o.clientY),s=this.view.toLocal(s,this.stage),this.toolMap[n].func_touchEnd(s),this.toolMap[n].dispose(),delete this.toolMap[n]}}else if(this.toolMap&&this.toolMap[0]){var r=new a.Point(0,0);this.globalConfig.main.renderer.plugins.interaction.mapPositionToPoint(r,t.clientX,t.clientY),r=this.view.toLocal(r,this.stage),this.toolMap[0].func_touchEnd(r),this.toolMap[0].singlePoint||(this.toolMap[0].dispose(),delete this.toolMap[0])}}},{key:"touchMove",value:function(t){if((t.touches||0==t.button)&&!this.config.main.multiMove){var e=new a.Point(0,0);if(t.touches){var i=void 0;for(i=0;t.changedTouches.length>i;i++){var o=t.changedTouches[i],n=o.identifier;if(this.toolMap[n]){this.globalConfig.main.renderer.plugins.interaction.mapPositionToPoint(e,o.clientX,o.clientY);this.toolMap[n].func_touchMove(this.view.toLocal(e,this.stage))}}}else this.toolMap&&this.toolMap[0]&&(this.globalConfig.main.renderer.plugins.interaction.mapPositionToPoint(e,t.clientX,t.clientY),e=this.view.toLocal(e,this.stage),this.toolMap[0].func_touchMove(e))}}},{key:"touchBegin",value:function(t){if(t.touches||0==t.button){var e=this.currentTool;if(t.touches){var i=void 0;for(i=0;t.touches.length>i;i++){var o=t.touches[i],n=o.identifier;if(!this.toolMap[n]){var s=new a.Point(0,0);this.globalConfig.main.renderer.plugins.interaction.mapPositionToPoint(s,o.clientX,o.clientY);var r=this.view.toLocal(s,this.stage);if(this.moveSelectedBody(n,r))continue;this.createToolManager(t,e,n,r)}}}else{if(!this.toolMap)return;var h=new a.Point(0,0);if(this.globalConfig.main.renderer.plugins.interaction.mapPositionToPoint(h,t.clientX,t.clientY),h=this.view.toLocal(h,this.stage),this.toolMap[0]&&this.touchEnd.call(this,t,!0),this.toolMap[0]&&this.toolMap[0].singlePoint&&(this.toolMap[0]instanceof e||(this.toolMap[0].func_touchEnd&&this.toolMap[0].func_touchEnd(),delete this.toolMap[0])),this.moveSelectedBody(0,h))return;this.toolMap[0]&&this.toolMap[0].singlePoint||this.createToolManager(t,e,0,h)}}}},{key:"moveSelectedBody",value:function(t,e){var i=this.BodyUtil.getSelectBodyUnderPoint(this.space,e);return!!i&&(this.toolMap[t]=new v["default"](this.config),this.toolMap[t].init(this.dis,this.space),this.toolMap[t].moveBody(i,e),!0)}},{key:"createToolManager",value:function(t,e,i,o){if(!this.enAbled)return void(this.enAbled=!0);this.toolType!==this.ToolStatusStr.POLY&&(this.toolMap[i]=new e(this.config),this.toolMap[i].init(this.dis,this.space),this.toolMap[i].func_touchBegin(o))}},{key:"findDeleteTouch",value:function(t,e){var i=void 0;for(i=0;e.length>i;i++){if(function(e){var i=void 0;for(i=0;t.length>i;i++)if(t[i].identifier==e)return!1;return!0}(e[i].identifier))return e[i].identifier}}},{key:"onDomClick",value:function(t){for(var e in this.map){var i=this.map[e];i.onDomClick&&i.onDomClick(t)}for(var o in this.toolMap){var n=this.toolMap[o];n.onDomClick&&n.onDomClick(t)}this.penpolygon&&this.penpolygon.onDomClick(t)}},{key:"reset",value:function(){this.changeTouchState(this.ToolStatusStr.MOVE)}},{key:"getCurrentToolStatus",value:function(){return this.toolType}},{key:"getCurrentStatus",value:function(){return this.currentType}},{key:"changeTouchState",value:function(t){this.map[t]&&(this.currentType=this.toolType=t,this.currentTool=this.map[t],this.penpolygon&&this.penpolygon.onDomClick(null),this.config.main.freshShowHelpVideo.call(this.config.main))}}]),t}()},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function v(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:v(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(458),u=(o(l),i(452)),c=(o(u),i(544)),d=o(c),p=i(471),y=(o(p),i(474)),f=o(y),g=i(1),b=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.lineColor=16777215,i.lineThin=2,i.isstart=!1,i}return a(e,t),r(e,[{key:"setActive",value:function(t){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setActive",this).call(this,t),this.active){var i=this;this.touchBeginUid||(this.touchBeginUid=g.M.addTouch(this.var_dis,{begin:i.func_touchBegin,isAddDB:!1},this)),this.touchMoveUid||(this.touchMoveUid=g.M.addTouch(this.var_dis,{move:i.func_touchMove,isAddDB:!1},this)),this.touchEndUid||(this.touchEndUid=g.M.addTouch(this.var_dis,{end:i.func_touchEnd,isAddDB:!1},this))}else this.touchBeginUid&&g.M.removeTouch(this.var_dis,this.touchBeginUid),this.touchMoveUid&&g.M.removeTouch(this.var_dis,this.touchMoveUid),this.touchEndUid&&g.M.removeTouch(this.var_dis,this.touchEndUid),this.touchBeginUid=this.touchMoveUid=this.touchEndUid=null}},{key:"func_init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"func_init",this).call(this),this.var_lastPoint=null,this.isstart=!1}},{key:"func_touchBegin",value:function(t){this.lineThin=2/this.globalConfig.main.view.scale.x,this.var_r=0,this.skinColor=f["default"].getColor(),this.func_addPoint(t),this.isstart=!0}},{key:"func_touchMove",value:function(t){this.isstart&&(this.var_lastPoint&&10>=g.Point.distance(this.var_lastPoint,t)||(this.var_lastPoint=t,this.func_addPoint(t)))}},{key:"func_touchEnd",value:function(t,e){this.isstart&&(e||(this.n>3&&this.getMaxDis()>80&&(this.createBody(),this.globalConfig.main.dispatchEvent("phy.addEquipment")),this.func_dispose(),this.func_init()))}}]),e}(d["default"]);b.preventDraw=!0,e["default"]=b},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function b(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:b(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(452),c=o(u),d=i(474),p=o(d),y=i(510),f=o(y),g=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.isstart=!1,i.topLeft=null,i.skinColor=null,i.lineColor=16777215,i.var_arcColor=4605510,i.var_edgeColor=11184810,i.lineThin=2,i.shapeView=new PIXI.Graphics,i}return a(e,t),r(e,[{key:"setActive",value:function(t){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setActive",this).call(this,t),this.active){var i=this;this.touchBeginUid||(this.touchBeginUid=l.M.addTouch(this.var_dis,{begin:i.func_touchBegin,isAddDB:!1},this)),this.touchMoveUid||(this.touchMoveUid=l.M.addTouch(this.var_dis,{move:i.func_touchMove,isAddDB:!1},this)),this.touchEndUid||(this.touchEndUid=l.M.addTouch(this.var_dis,{end:i.func_touchEnd,isAddDB:!1},this))}else this.touchBeginUid&&l.M.removeTouch(this.var_dis,this.touchBeginUid),this.touchMoveUid&&l.M.removeTouch(this.var_dis,this.touchMoveUid),this.touchEndUid&&l.M.removeTouch(this.var_dis,this.touchEndUid),this.touchBeginUid=this.touchMoveUid=this.touchEndUid=null}},{key:"func_touchBegin",value:function(t){this.lineThin=2/this.globalConfig.main.view.scale.x,this.skinColor=p["default"].getColor(),this.func_dispose(),this.isstart=!0,this.topLeft=new l.Point(t.x,t.y);var e=[];e.push({option:"addElement",target:this.shapeView,params:{x:0,y:0}}),this.func_dispatchGraphic(e),this.config.moduleMain.napeEngine.transformManager.hide()}},{key:"func_touchMove",value:function(t){if(this.isstart){var e=t.x-this.topLeft.x,i=t.y-this.topLeft.y;0!=e&&0!=i&&(this.shapeView.clear(),this.shapeView.lineStyle(this.lineThin,this.lineColor,1),this.shapeView.beginFill(this.skinColor,1),this.shapeView.drawRect(this.topLeft.x,this.topLeft.y,e,i),this.shapeView.endFill())}}},{key:"func_touchEnd",value:function(t,e){if(this.isstart&&(this.isstart=!1,this.func_dispose(),this.shapeView.clear(),!e)){var i=Math.min(t.x,this.topLeft.x),o=Math.max(t.x,this.topLeft.x),n=Math.min(t.y,this.topLeft.y),s=Math.max(t.y,this.topLeft.y),a=o-i,r=s-n;if(a>=10&&r>=10){var h=new f["default"](this.config,[a,r,this.skinColor]);this.addEquipmentChild(h,new l.Point(i+a/2,n+r/2)),this.globalConfig.main.execute(this.NBCommand.ANALYTICS,{type:"mecTool",name:"rect"}),this.globalConfig.main.dispatchEvent("phy.addEquipment"),this.globalConfig.main.isPlay||h.setSelected(!0)}}}}]),e}(c["default"]);g.preventDraw=!0,e["default"]=g},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function g(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:g(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(452),c=o(u),d=i(514),p=o(d),y=void 0,f=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=t.moduleMain.phy.nape,f=y.geom.Vec2,i.view=null,i}return a(e,t),r(e,[{key:"func_touchBegin",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"func_touchBegin",this).call(this,t),this.view=new p["default"](this.config),this.addEquipmentChild(this.view,new l.Point),this.view.fixFirstBox(this.var_vo.beginBody,this.var_vo.beginVec2)}},{key:"func_touchMove",value:function(t){this.view&&this.view.drawRope(t)}},{key:"func_touchEnd",value:function(t,e){if(!e){var i=t,o=this.space.bodiesUnderPoint(new f(i.x,i.y));o.filter(function(t){return(!t.userData||"ropeNode"!=t.userData.classType)&&(!t.userData||!t.userData.isnbequ)});var n=this.BodyUtil.getTopBodyFormBodyList(o);this.var_vo.endBody=n;var s=this.Vec2Util.pointToVec2(i);this.var_vo.endVec2=s,this.view.ropeCreateComplete(n,s),this.var_vo={},this.globalConfig.main.dispatchEvent("phy.addEquipment"),this.globalConfig.main.execute(this.NBCommand.ANALYTICS,{type:"mecTool",name:"rope"}),this.view.setSelected(!0)}}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function v(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:v(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(452),c=o(u),d=i(471),p=o(d),y=void 0,f=void 0,g=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=t.moduleMain.phy.nape,f=y.geom.GeomPoly,g=y.geom.Vec2,i.angle_view=new b(t),i.isstart=!1,i.selectedBody=null,i}return a(e,t),r(e,[{key:"dispose",value:function(){this.angle_view.dispose(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"dispose",this).call(this)}},{key:"setActive",value:function(t){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setActive",this).call(this,t),this.active){var i=this;this.touchBeginUid||(this.touchBeginUid=l.M.addTouch(this.var_dis,{begin:i.func_touchBegin,isAddDB:!1},this)),this.touchMoveUid||(this.touchMoveUid=l.M.addTouch(this.var_dis,{move:i.func_touchMove,isAddDB:!1},this)),this.touchEndUid||(this.touchEndUid=l.M.addTouch(this.var_dis,{end:i.func_touchEnd,isAddDB:!1},this))}else this.touchBeginUid&&l.M.removeTouch(this.var_dis,this.touchBeginUid),this.touchMoveUid&&l.M.removeTouch(this.var_dis,this.touchMoveUid),this.touchEndUid&&l.M.removeTouch(this.var_dis,this.touchEndUid),this.touchBeginUid=this.touchMoveUid=this.touchEndUid=null}},{key:"func_touchBegin",value:function(t){this.isstart=!0;var e=[];e.push({option:"addElement",target:this.angle_view,params:{x:0,y:0}}),this.func_dispatchGraphic(e),this.angle_view.startDraw(t.clone()),this.selectedBody=this.config.moduleMain.napeEngine.transformManager.body}},{key:"func_touchMove",value:function(t){this.isstart&&this.angle_view.func_draw(t)}},{key:"func_touchEnd",value:function(t,e){if(this.isstart&&(this.isstart=!1,!e)){this.cutAtoB(this.angle_view.var_startP.clone(),t),this.selectedBody=null,this.globalConfig.main.execute(this.NBCommand.ANALYTICS,{type:"mecTool",name:"slice"})}}},{key:"cutAtoB",value:function(t,e){var i=this,o=this.Vec2Util.pointToVec2(t),n=this.Vec2Util.pointToVec2(e);this.angle_view.func_reset(),this.func_dispose();var s=y.geom.Ray.fromSegment(o,n);if(0!=s.get_direction().get_length()){var a=this.space.rayMultiCast(s,!1),r=[],h=[];a.foreach(function(t){if(null!=t)try{var e=t.get_shape().get_body();if(!e.userData.freeMec)return;if(e.contains(o)||e.contains(n))return;var i=r.indexOf(e);-1==i?(r.push(e),h.push([t.get_shape()])):h[i].push(t.get_shape())}catch(s){}});var l=[],u=[],c=0;for(c=0;r.length>c;c++){var d=r[c];this.selectedBody&&d===this.selectedBody&&l.push(c),u[c]=c}var p=l.length>0?l:u;for(c=0;p.length>c;c++){(function(){var t=p[c],e=r[t],s=h[t],a=i.func_sliceBody(e,o,n,s);if(0>=a.length)return"continue";var l=e.constraints,u=new y.constraint.ConstraintList;l.foreach(function(t){u.push(t)});for(var d=0;a.length>d;d++){i.createEquView(a[d],e,u)}})()}for(c=0;p.length>c;c++){var f=p[c],g=r[f];if(g.userData){var b=g.userData.view;b.removeFromFramework(b)}else this.BodyUtil.destoryBody(g)}}}},{key:"sliceShape",value:function(t,e,i,o){var n=void 0;if(t.contains(e)||t.contains(i))return null;if(t.isCircle()){var s={x:0,y:0};o=o||t.body,o&&(s.x=o.posx,s.y=o.posy),n=new f(this.Vec2Util.getWorldVec2ListFromCircle(t,s)),n.pop()}else n=new f(t.get_worldVerts());return n.cut(e,i,!0,!0)}},{key:"func_sliceGeomPoly",value:function(t,e,i){return contains.contains(e)||contains.contains(i)?[]:t.cut(e,i,!0,!0)}},{key:"func_sliceBody",value:function(t,e,i,o){var n=this.list2Arr(t.shapes),s=n.length;if(1==s){var a=n[0],r=this.sliceShape(a,e,i,t),h=[];return r&&r.foreach(function(t){h.push([t])}),h}var l=[],u=[];if(o)for(var c=0;s>c;c++){var d=n[c];if(-1==this.func_indexof(o,d)){var p=new f(d.get_worldVerts());0>this.getSideOfLine(p,e,i)?u.push(p):l.push(p)}}var y=o||n;s=y.length;for(var g=0;s>g;g++){var b=y[g],v=new f(b.get_worldVerts()),_=v.cut(e,i,!0,!0),m=this.geomPolyListGroupByLine(_,e,i);l=l.concat(m[0]),u=u.concat(m[1])}return this.func_optionMerge(l).concat(this.func_optionMerge(u))}},{key:"geomPolyListGroupByLine",value:function(t,e,i){for(var o=[],n=[],s=t.get_length(),a=0;s>a;a++){var r=t.at(a);r.cutDat=1==s?1:2,0>this.getSideOfLine(r,e,i)?n.push(r):o.push(r)}return[o,n]}},{key:"func_optionMerge",value:function(t){var e=t.length,i=void 0,o=void 0,n=void 0;if(1==e){return[[t[0]]]}var s=[];for(i=0;e>i;i++){s[i]=[];var a=t[i];for(o=0;i>o;o++){s[o][i]=s[i][o]=this.isConnected(a,t[o])}s[i][i]=!0}var r=[];for(i=0;e>i;i++)for(r[i]=[],o=0;e>o;o++)r[i][o]=s[i][o];for(n=0;e>n;n++)for(i=0;e>i;i++)for(o=0;e>o;o++)r[i][n]&&r[n][o]&&(r[i][o]=!0);var h=0,l=[];for(i=0;e>i;i++)if(l[i]===undefined||0>l[i]){for(o=0;e>o;o++)r[i][o]&&(l[o]=h);h++}var u=[];for(i=0;e>i;i++){var c=l[i],d=t[i];u[c]||(u[c]=[]),u[c].push(d)}return u}},{key:"getSideOfLine",value:function(t,e,i){var o=l.Point.vec2ToPoint(t.left()),n=l.Point.vec2ToPoint(t.right()),s=l.Point.vec2ToPoint(t.top()),a=l.M.getPoint_NeiXin(o,n,s);return l.M.checkPointOnLineLeftOrRight(a,l.Point.vec2ToPoint(e),l.Point.vec2ToPoint(i))}},{key:"isConnected",value:function(t,e){for(var i=t.backwardsIterator();i.hasNext();)for(var o=i.next(),n=e.backwardsIterator();n.hasNext();){var s=n.next();if(o.get_x()==s.get_x()&&o.get_y()==s.get_y())return!0}return!1}},{key:"poly2vecArr",value:function(t){for(var e=[],i=t.iterator();i.hasNext();){var o=i.next();e.push(new g(o.get_x(),o.get_y()))}return e}},{key:"list2Arr",value:function(t){var e=[];return t.foreach(function(t){e.push(t)}),e}},{key:"func_indexof",value:function(t,e){for(var i=t.length,o=0;i>o;o++)if(t[o]==e)return o;return-1}},{key:"createEquView",value:function(t,e,i){for(var o=[],n=t.length,s=0;n>s;s++){o.push(this.poly2vecArr(t[s]))}var a=new p["default"](this.config,o);if(a.notAnalytics=!0,this.addEquipmentChild(a,new l.Point(0,0)),a.x=a.body.posx,a.y=a.body.posy,e.userData){var r=e.userData.view,h=r.getData();a.sliceSetData({material:h.material,skinIndex:h.skinIndex,skinType:h.skinType,skinColor:h.skinColor,lightprototype:h.lightprototype,rateN:h.rateN,groupIndex:h.groupIndex})}for(var u=0;u<i.get_length();u++){var c=i.at(u),d=c.userData.toolView;d&&d.bodyContainsConstraint(a.body,c)&&d.changeBody&&d.changeBody(e,a.body)}return a}}]),e}(c["default"]);var b=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.globalConfig=t.globalConfig,i.line=new PIXI.Graphics,i.txt=new PIXI.Text("",{font:"16px Microsoft YaHei",fill:16777215}),i.txt2=new PIXI.Text("",{font:"16px Microsoft YaHei",fill:16777215}),i.addChild(i.line),i.addChild(i.txt),i.addChild(i.txt2),i.lineThin=4,i.lineColor=16777215,i.var_dashLen=150,i.var_r=74,i.var_fontSize=16,i}return a(e,t),r(e,[{key:"dispose",value:function(){this.globalConfig=null}},{key:"startDraw",value:function(t){var e=this.globalConfig.main.view.scale.x;this.lineThin=4/e,this.var_dashLen=150/e,this.var_r=74/e,this.line.lineStyle(this.lineThin,this.lineColor,1),this.var_startP=t,this.txt.scale.x=this.txt.scale.y=2/e,this.txt2.scale.x=this.txt2.scale.y=2/e}},{key:"func_draw",value:function(t){this.line.clear();var e=new l.Point(this.var_startP.x+this.var_dashLen,this.var_startP.y),i=new l.Point(this.var_startP.x-this.var_dashLen,this.var_startP.y),o=Math.atan2(t.y-this.var_startP.y,t.x-this.var_startP.x);o=180*o/Math.PI;var n=void 0,s=void 0;o>0?(n=0,s=o*Math.PI/180):(n=o*Math.PI/180,s=0),this.line.beginFill(16777215,.3),this.line.moveTo(this.var_startP.x,this.var_startP.y),this.line.arc(this.var_startP.x,this.var_startP.y,this.var_r,n,s),this.line.endFill(),o>0?(n=0,s=Math.PI):(n=-Math.PI,s=0),this.line.lineStyle(this.lineThin/2,this.lineColor),this.line.moveTo(this.var_startP.x,this.var_startP.y),this.line.arc(this.var_startP.x,this.var_startP.y,this.var_r,n,s),this.line.lineStyle(this.lineThin,this.lineColor),l.M.drawDashed(this.line,e,i),this.line.lineStyle(this.lineThin,this.lineColor),this.line.moveTo(this.var_startP.x,this.var_startP.y),this.line.lineTo(t.x,t.y);var a=o;0>a&&(a=-a),this.txt.text=l.M.getNumJie(a,1)+"°",this.txt2.text=l.M.getNumJie(180-a,1)+"°",this.txt.x=e.x,this.txt2.x=i.x-2*this.var_fontSize,this.txt.y=this.txt2.y=e.y-this.var_fontSize/2}},{key:"func_reset",value:function(){this.txt.text="",this.line.clear()}}]),e}(PIXI.Sprite)},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function g(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:g(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(452),c=o(u),d=i(551),p=o(d),y=void 0,f=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=t.moduleMain.phy.nape,f=y.geom.Vec2,i.isstart=!1,i}return a(e,t),r(e,[{key:"setActive",value:function(t){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setActive",this).call(this,t),this.active){var i=this;this.touchBeginUid||(this.touchBeginUid=l.M.addTouch(this.var_dis,{begin:i.func_touchBegin,isAddDB:!1},this)),this.touchMoveUid||(this.touchMoveUid=l.M.addTouch(this.var_dis,{move:i.func_touchMove,isAddDB:!1},this)),this.touchEndUid||(this.touchEndUid=l.M.addTouch(this.var_dis,{end:i.func_touchEnd,isAddDB:!1},this))}else this.touchBeginUid&&l.M.removeTouch(this.var_dis,this.touchBeginUid),this.touchMoveUid&&l.M.removeTouch(this.var_dis,this.touchMoveUid),this.touchEndUid&&l.M.removeTouch(this.var_dis,this.touchEndUid),this.touchBeginUid=this.touchMoveUid=this.touchEndUid=null}},{key:"func_touchBegin",value:function(t){this.isstart=!0,this.view=new p["default"](this.config);for(var e=this.BodyUtil.getMechanicsBodiesUnderPoint(this.space,t),i=0;e.length>i;i++){var o=e[i];o.userData&&o.userData.isnbequ&&(e.splice(i,1),i--)}e=this.BodyUtil.filterMechaTool(e);var n=e[0]||this.space.world;this.addEquipmentChild(this.view,new l.Point),this.view.fixFirstBox(n,this.Vec2Util.pointToVec2(t))}},{key:"func_touchMove",value:function(t){if(this.isstart){this.view.upateSpring(this.Vec2Util.pointToVec2(t))}}},{key:"func_touchEnd",value:function(t,e){if(this.isstart&&(this.isstart=!1,!e)){if(!this.view.secBox)return this.view.removeFromFramework(this.view),void(this.view=null);var i=this.space.bodiesUnderPoint(new f(t.x,t.y));i.filter(function(t){return!t.userData||!t.userData.isnbequ});var o=this.BodyUtil.getTopBodyFormBodyList(i,[this.view.secBox.body]),n=this.Vec2Util.pointToVec2(t);this.view.upateSpring(n),100>this.view.springLen?this.view.removeFromFramework(this.view):this.view.fixSecondBox(o,n),this.view.setSelected(!0),this.view=null,this.globalConfig.main.dispatchEvent("phy.addEquipment"),this.globalConfig.main.execute(this.NBCommand.ANALYTICS,{type:"mecTool",name:"spring"})}}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(452),c=o(u),d=i(547),p=o(d);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.isstart=!1,i.tar_body=null,i.thrusterView=null,i.f=null,i.op=null,i}return a(e,t),r(e,[{key:"setActive",value:function(t){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setActive",this).call(this,t),this.active){var i=this;this.touchBeginUid||(this.touchBeginUid=l.M.addTouch(this.var_dis,{begin:i.func_touchBegin,isAddDB:!1},this)),this.touchMoveUid||(this.touchMoveUid=l.M.addTouch(this.var_dis,{move:i.func_touchMove,isAddDB:!1},this)),this.touchEndUid||(this.touchEndUid=l.M.addTouch(this.var_dis,{end:i.func_touchEnd,isAddDB:!1},this))}else this.touchBeginUid&&l.M.removeTouch(this.var_dis,this.touchBeginUid),this.touchMoveUid&&l.M.removeTouch(this.var_dis,this.touchMoveUid),this.touchEndUid&&l.M.removeTouch(this.var_dis,this.touchEndUid),this.touchBeginUid=this.touchMoveUid=this.touchEndUid=null}},{key:"func_touchBegin",value:function(t){var e=this.func_getTarBody(t);e&&(this.adsorbToCom(e,t,50),this.isstart=!0,this.f=new l.Point(0,0),this.op=new l.Point(t.x,t.y),this.tar_body=e,this.thrusterView=new p["default"](this.config,this.tar_body),this.thrusterView.setActive(!1),this.addEquipmentChild(this.thrusterView,t),this.initScale(this.thrusterView))}},{key:"func_touchMove",value:function(t){if(this.isstart){var e=new l.Point(t.x-this.op.x,t.y-this.op.y);e.x/=p["default"].pxPerN,e.y/=p["default"].pxPerN,this.thrusterView.setForce(e),this.thrusterView.updateDraw(!0)}}},{key:"func_touchEnd",value:function(t,e){this.isstart&&(this.isstart=!1,this.tar_body=null,this.thrusterView.setActive(!0),this.thrusterView.setSelected(!1),this.globalConfig.main.execute(this.NBCommand.ANALYTICS,{type:"mecTool",name:"thruster"}),this.globalConfig.main.isPlay||(this.thrusterView.setSelected(!0),this.thrusterView.freshLibPan()))}},{key:"func_getTarBody",value:function(t){for(var e=this.BodyUtil.getMechanicsBodiesUnderPoint(this.space,t),i=0;e.length>i;i++){var o=e[i];o.userData&&o.userData.isnbequ&&(e.splice(i,1),i--)}var n=e[0];return!n||n.userData.view.isMechaTool?null:n}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){var i=[],o=!0,n=!1,s=undefined;try{for(var a,r=t[Symbol.iterator]();!(o=(a=r.next()).done)&&(i.push(a.value),!e||i.length!==e);o=!0);}catch(h){n=!0,s=h}finally{try{!o&&r["return"]&&r["return"]()}finally{if(n)throw s}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function g(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:g(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(451),c=function(t){return t&&t.__esModule?t:{"default":t}}(u),d=void 0,p=void 0,y=void 0,f=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.globalConfig=t.globalConfig,d=t.main.phy.nape,p=d.phys.BodyType,y=d.shape.Polygon,f=d.geom.Vec2,i.BodyUtil=t.moduleMain.BodyUtil,i.Vec2Util=t.moduleMain.Vec2Util,i.InteractionFilterManager=t.moduleMain.InteractionFilterManager,i.boxWidth=1e4,i.wallWidth=1e4,i.lefts=null,i.rights=null,i.tops=null,i.bottoms=null,i.wallColor=1842208,i.seeW=500,i.seeH=200,i.leftSeeW=0,i.leftSeeH=0,i.topSeeW=0,i.topSeeH=0,i.rightSeeW=0,i.rightSeeH=0,i.canvasStyleWH=null,i.nochange=!1,i.step=0,i.floor=new PIXI.Graphics,i.leftDraw=new PIXI.Graphics,i.topDraw=new PIXI.Graphics,i.rightDraw=new PIXI.Graphics,i}return s(e,t),r(e,[{key:"initWall",value:function(){this.material=new d.phys.Material(0,2,2,5,1),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.boxWidth=this.globalConfig.napeWallW,this.body.get_shapes().clear(),this.lefts=new y(y.box(this.wallWidth,2*(this.boxWidth+this.wallWidth)),this.material),this.rights=new y(y.box(this.wallWidth,2*(this.boxWidth+this.wallWidth)),this.material),this.tops=new y(y.box(2*(this.boxWidth+this.wallWidth),this.wallWidth),this.material),this.bottoms=new y(y.box(2*(this.boxWidth+this.wallWidth),this.wallWidth),this.material),this.body.get_shapes().add(this.lefts),this.body.get_shapes().add(this.rights),this.body.get_shapes().add(this.tops),this.body.get_shapes().add(this.bottoms),this.lefts.set_localCOM(f.get(-this.boxWidth-this.wallWidth/2,0)),this.rights.set_localCOM(f.get(this.boxWidth+this.wallWidth/2,0)),this.tops.set_localCOM(f.get(0,-this.boxWidth-this.wallWidth/2)),this.bottoms.set_localCOM(f.get(0,this.boxWidth+this.wallWidth/2)),this.body.set_type(p.get_KINEMATIC()),this.body.userData.noDrag=!0,this.body.userData.nolight=!0,this.body.userData.isnbequ=!0,this.globalConfig.main.addChildAt(this.floor,0),this.globalConfig.main.addChildAt(this.leftDraw,0),this.globalConfig.main.addChildAt(this.topDraw,0),this.globalConfig.main.addChildAt(this.rightDraw,0),this.drawFloor(),this.body.addCbType(this.CbTypeStr.GLOBAL_WALL),this.body.userData.iswall=!0,this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_FLOOR_FILTER),this.changeCC(.5),this.changeElastic(.5)}},{key:"setVisible",value:function(t){this.floor.visible=t,this.leftDraw.visible=t,this.topDraw.visible=t,this.rightDraw.visible=t}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.drawFloor()}},{key:"getfloorY",value:function(){var t=this.bottoms.get_worldCOM(),e=this.Vec2Util.vec2ToPoint(t);return e.y-=.5*this.wallWidth}},{key:"drawFloor",value:function(){var t=this.getMain(),e=0,i=0;if(this.nochange?this.step++:this.step=0,this.canvasStyleWH&&t.ismobileApp){if(this.nochange&&this.step>100)return}else this.canvasStyleWH={W:l.M.getNumStr(t.canvas.style.width),H:l.M.getNumStr(t.canvas.style.height)};e=this.canvasStyleWH.W,i=this.canvasStyleWH.H;var o=t.W/e,n=t.H/i,s=t.getWindowDoorSize(),r=a(s,2),h=r[0],u=r[1],c=this.bottoms.get_localCOM();c=this.body.localPointToWorld(c);var d=this.Vec2Util.vec2ToPoint(c);if(d.y-=.5*this.wallWidth,d=t.view.toGlobal(d),this.floor.y=d.y,u*n>d.y){var p=u*n-this.floor.y;h*o!==this.seeW||p!==this.seeH?(this.seeW=h*o,this.seeH=p,this.graphicsFloor(this.floor,h*o,p)):this.nochange=!0}var y=this.lefts.get_localCOM();y=this.body.localPointToWorld(y);var f=this.Vec2Util.vec2ToPoint(y);f.x+=.5*this.wallWidth,f.y=0,f=t.view.toGlobal(f),this.leftDraw.x=f.x,f.x>0&&(-f.x==this.leftSeeW&&u*n==this.leftSeeH||(this.leftSeeW=-f.x,this.leftSeeH=u*n,this.graphicsFloor(this.leftDraw,this.leftSeeW,this.leftSeeH)));var g=this.tops.get_localCOM();g=this.body.localPointToWorld(g);var b=this.Vec2Util.vec2ToPoint(g);b.x=0,b.y+=.5*this.wallWidth,b=t.view.toGlobal(b),this.topDraw.y=b.y,b.y>0&&(-b.y==this.topSeeH&&h*o==this.leftSeeW||(this.topSeeW=h*o,this.topSeeH=-b.y,this.graphicsFloor(this.topDraw,this.topSeeW,this.topSeeH)));var v=this.rights.get_localCOM();v=this.body.localPointToWorld(v);var _=this.Vec2Util.vec2ToPoint(v);if(_.x-=.5*this.wallWidth,_.y=0,_=t.view.toGlobal(_),this.rightDraw.x=_.x,h*o>_.x){var m=h*o-this.rightDraw.x;u*n===this.rightSeeH&&m===this.rightSeeW||(this.rightSeeW=m,this.rightSeeH=u*n,this.graphicsFloor(this.rightDraw,this.rightSeeW,this.rightSeeH))}}},{key:"graphicsFloor",value:function(t,e,i){t.clear(),t.beginFill(this.wallColor),t.drawRect(0,0,e,i),t.endFill()}},{key:"changeCC",value:function(t){isNaN(t)&&(t=.5),this.material.set_dynamicFriction(2*t),this.material.set_staticFriction(2.1*t)}},{key:"changeElastic",value:function(t){isNaN(t)&&(t=.5),this.material.set_elasticity(t)}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function v(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:v(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(449),p=o(d),y=void 0,f=void 0,g=void 0,b=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.callbacks.CbType,g=y.geom.Vec2,i.material=new y.phys.Material(1,0,0,7.8,0),i.radius=23,i.start_p=new l.Point,i.cbtype=new f,i.type=1,i}return a(e,t),r(e,[{key:"weldPy",value:function(t){return t?23.5:this.body.localPointToWorld(g.get(0,-23.5))}},{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.bullet=!0,this.addCbType(this.cbtype)}},{key:"resetUserView",value:function(t,i){var o=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"resetUserView",this).call(this,t,i),t.addEventListener(p["default"].BEGIN,function(t){o.bodyDragBeginHandler(t)}),t.addEventListener(p["default"].END,function(t){o.bodyDragEndHandler(t)})}},{key:"bodyDragEndHandler",value:function(t){if(2===this.type){var i=this.getViewMouseXY(event);l.Point.distance(this.start_p,i)>10?this.dispatchEvent(e.BALL_START,this):this.dispatchEvent(e.BALL_CLICK,this)}else{var o=180*this.body.rotation/Math.PI;3>Math.abs(o)?this.dispatchEvent(e.BALL_CLICK,this):this.dispatchEvent(e.BALL_START,this)}}},{key:"bodyDragBeginHandler",value:function(t){this.start_p=this.getViewMouseXY(t),this.dispatchEvent(e.BALL_DRAG_BEGIN,this)}}]),e}(c["default"]);b.BALL_START="ballStart",b.BALL_DRAG_BEGIN="ballDragBegin",b.BALL_CLICK="ballClick",b.SHOW_ONCE_IMG="showOnceImg",e["default"]=b},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),a=i(616),r=o(a),h=i(454),l=o(h),u=void 0,c=void 0,d=void 0,p=void 0,y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0,m=void 0,x=void 0,w=void 0;e["default"]=function(){function t(e){n(this,t);var i=e.main.phy.nape;d=i.NbBody,p=i.shape.Polygon,y=i.geom.Vec2,u=i.geom.AABB,c=i.geom.Ray,g=i.geom.GeomPolyList,v=i.geom.MarchingSquares,f=i.geom.Vec2List,_=i.dynamics.InteractionFilter,m=i.geom.Geom,b=i.geom.GeomPoly,x=i.dynamics.ArbiterType,w=i.phys.Material,this.main=e.main,this.ALLOW_MOVE=1,this.ALLOW_ROTA=2}return s(t,[{key:"dispose",value:function(){this.main=null}},{key:"destoryBody",value:function(t){var e=this;if(t){var i=this.getView(t),o=t.constraints;t.get_shapes().foreach(function(t){var e=t.get_userData();e.vo&&delete e.vo}),t.set_compound(null),t.set_group(null),t.set_space(null),t.dispose(),t.userData=null;for(var n=o.get_length()-1;n>=0;n--)!function(t){var n=o.at(t);e.destoryJoint(n);var s=n.userData?n.userData.toolView:null;s&&(s.owner&&s.owner!==i&&s.owner.reFixed?setTimeout(function(){s.owner.reFixed()},0):s.removeFromFramework(s))}(n);t=null}}},{key:"destoryJoint",value:function(t){if(t){try{var e=t.userData.hockshape;e&&this.main.activeModule.napeEngine.hockCtrol.removeJointShape(e)}catch(i){}if(t.active=!1,t.body1=null,t.body2=null,t.body3=null,t.body4=null,t.set_compound(null),t.set_space(null),t.zpp_inner.space){t.zpp_inner.space.outer.constraints.remove(t)}}}},{key:"BodyFromSprite",value:function(t,e,i,o){var n=new PIXI.RenderTexture(this.main.renderer,t.width,t.height);n.render(t);var s=new r["default"](n),a=new u(0,0,t.width,t.height),h=o||2,l=i||8,c=new y(l,l),d=function(t,e){return s.iso.call(s,t,e)},f=v.run(d,a,c,h),b=new g,_=e;return f.foreach(function(t){b.merge(t.convexDecomposition())}),b.foreach(function(t){_.add(new p(t,new w))}),_}},{key:"getBodyFromUID",value:function(t){return this.main.activeModule.napeEngine.uidMap[t]}},{key:"getBodyFromCb",value:function(t){return[t.get_int1(),t.get_int2()]}},{key:"getBodyFromAbter",value:function(t){return[t.get_body1(),t.get_body2()]}},{key:"BodyFromArray",value:function(t,e,i){if(t&&t.length>1){var o=new f,n=e||new d;$.each(t,function(t,e){o.push(new y(e.x,e.y))});var s=new p(o,i),a=s.validity();if("VALID"==a)n.add(s);else{if("DEGENERATE"==a)return;var r=new b(o);if(r.isDegenerate())return;var h=null;try{h=r.simpleDecomposition()}catch(u){return}var l=new g;h.foreach(function(t){l.merge(t.convexDecomposition())}),l.foreach(function(t){n.add(new p(t,i))})}return n}return null}},{key:"setShapeMass",value:function(t,e){var i=t.get_area(),o=e/i*1e3;t.get_material().set_density(o)}},{key:"getShapeMass",value:function(t){return t.get_area()*(t.get_material().get_density()/1e3)}},{key:"getBodyArea",value:function(t){for(var e=t.get_shapes(),i=e.get_length(),o=0,n=0;i>n;n++){var s=e.at(n);if(!s.get_sensorEnabled()){o+=s.get_area()}}return o}},{key:"setShapeMaterial",value:function(t,e){var i=this,o=t.get_material();$.each(e,function(t,e){i.setMaterial(o,t,e)})}},{key:"setBodyMaterial",value:function(t,e){t.shapes.foreach(function(t){var i=t.get_material();$.each(e,function(t,e){this.setMaterial&&this.setMaterial(i,t,e)})})}},{key:"setMaterialFromObject",value:function(t,e){for(var i in e){this.setMaterial(t,i,e[i])}}},{key:"setMaterial",value:function(t,e,i){"density"==e?t.set_density(i):"dynamicFriction"==e?t.set_dynamicFriction(i):"elasticity"==e?t.set_elasticity(i):"rollingFriction"==e?t.set_rollingFriction(i):"staticFriction"==e&&t.set_staticFriction(i)}},{key:"frezzBody",value:function(t){t.set_velocity(y.get(0,0)),t.angularVel=0}},{key:"BodyTweenTo",value:function(t,e,i){var o=t.get_position(),n={x:o.get_x(),y:o.get_y()};i.onUpdate=function(){t.set_position(y.get(n.x,n.y))},TweenMax.to(n,e,i)}},{key:"getBodyStatus",value:function(t){var e=0;return t.allowMovement&&(e|=this.ALLOW_MOVE),t.noallowRotation||(e|=this.ALLOW_ROTA),e}},{key:"setBodyStatus",value:function(t,e){t.allowMovement=e&this.ALLOW_MOVE,t.noallowRotation=!(e&this.ALLOW_ROTA);var i=t.userData?t.userData.view:null;null!=i&&i.dispatchEvent(l["default"].SET_BODY_STATE,e)}},{key:"dampingBodyVelocity",value:function(t,e,i){var o=t.velocity,n=o.get_x()*e,s=o.get_y()*i;t.velocity=y.get(n,s)}},{key:"getAllCollisionBodys",value:function(t,e){var i=this,o=[];return t?(t.arbiters.foreach(function(n){if(i.arbiterIsCollision(n)){var s=n.get_body1(),a=n.get_body2();t===s?(e||a.isDynamic)&&o.push(a):(e||s.isDynamic)&&o.push(s)}}),o):[]}},{key:"arbiterIsCollision",value:function(t){return t.get_type()==x.get_COLLISION()}},{key:"setBodyFilter",value:function(t,e){t.get_shapes().foreach(function(t){e&&t.set_filter(e)})}},{key:"getGroupAndMask",value:function(t,e){for(var i=0,o=0,n=0;t.length>n;n++){var s=t[n];if(0>s){i|=-1;break}i|=0==s?1:2<<s-1}for(var n=0;e.length>n;n++){var a=e[n];if(0>a){o|=-1;break}o|=0==a?1:2<<a-1}return{group:i,mask:o}}},{key:"getLiquidGroup",value:function(t,e,i,o){var n=this.getGroupAndMask(t,e),s=this.getGroupAndMask(i,o);return new _(n.group,n.mask,1,-1,s.group,s.mask)}},{key:"getShapeGroup",value:function(t,e){var i=this.getGroupAndMask(t,e);return new _(i.group,i.mask)}},{key:"bodyHitWall",value:function(t){var e=this.main.activeModule.napeEngine.wallArr,i=0;for(i=0;e.length>i;i++){if(m.intersectsBody(t,e[i]))return!0}}},{key:"bodyShapeNums",value:function(t){return t.shapes.get_length()}},{key:"s",value:function(t){return Math.pow(2,t)}},{key:"createRectShape",value:function(t,e,i,o){return new p(p.rect(t,e,i,o))}},{key:"createPolygonShape",value:function(t,e){return this.createPolygonFromPoints(t,e)}},{key:"createPolygonFromPoints",value:function(t,e,i){var o=void 0;try{for(var n=[],s=0;t.length>s;s++)n.push(y.get(t[s].x,t[s].y));o=new p(n,i),e&&e.add&&e.add(o)}catch(a){}return o}},{key:"createIrregularShape",value:function(t){var e=new g;if(t&&t.length>1){var i=new f;$.each(t,function(t,e){i.push(new y(e.x,e.y))});var o=new b(i);if(o.isDegenerate())return null;var n;try{n=o.simpleDecomposition()}catch(s){return null}n.foreach(function(t){e.merge(t.convexDecomposition())})}return e}},{key:"getMechanicsBodiesUnderPoint",value:function(t,e){for(var i=new y(e.x,e.y),o=t.bodiesUnderPoint(i),n=[],s=o.get_length(),a=0;s>a;a++){var r=o.at(a);r.userData.view.isMechanics&&n.push(r)}return n}},{key:"getView",value:function(t){return t&&t.userData?t.userData.view:null}},{key:"getBodyByShape",value:function(t){return t?t.get_body():null}},{key:"getViewByShape",value:function(t){return this.getView(this.getBodyByShape(t))}},{key:"filterMechaTool",value:function(t){for(var e=[],i=t.length,o=0;i>o;o++){var n=t[o];n.userData.view.isMechaTool||e.push(n)}return e}},{key:"getTopBodyFormBodyList",value:function(t,e){var i=-1e4,o=null;if(e){var n=0;for(n=0;e.length>n;n++)t.remove(e[n])}return t.get_length()>0?(t.foreach(function(t){if(t.userData){var e=t.userData.dragLevel;if(e>i)i=e,o=t;else if(i==e){var n=this.getDisplayIndex(t),s=this.getDisplayIndex(o);0>n||0>s||n>s&&(o=t)}}}),o||(o=t.at(0)),o):null}},{key:"getDisplayIndex",value:function(t){var e=-1;if(t.userData&&t.userData.view){var i=t.userData.view.parent;if(i&&i.parent){e=i.parent.getChildIndex(i)}}return e}},{key:"getHandDragBodyFromArbiter",value:function(t){var e=this.getAllCollisionBodys(t,!1);try{var i=0;for(i=0;e.length>i;i++){var o=e[i];if(o.userData&&o.userData.dragManager)return o;var n=o.connectedBodies(),s=0;for(s=0;s<n.get_length();s++){var a=n.at(s);if(a.userData&&a.userData.dragManager)return a}}}catch(r){}return null}},{key:"getSelectBodyUnderPoint",value:function(t,e){for(var i=t.bodiesUnderPoint(new y(e.x,e.y)),o=i.get_length(),n=0;o>n;n++){var s=i.at(n);if(!s.isStatic()&&!s.userData.noDrag){var a=s.userData.view;if(a&&(a.touchEnabled||s.userData.coordinateField)&&a.transformManager)return s}}return null}},{key:"releaseHandDragJoint",value:function(t){var e=t.connectedBodies(),i=e.get_length(),o=void 0;for(o=0;i>o;o++){var n=e.at(o);n.userData&&n.userData.dragManager&&n.userData.dragManager.func_touchEnd(null)}}},{key:"getHandDragBody",value:function(t){var e=t.connectedBodies(),i=e.get_length(),o=void 0;for(o=0;i>o;o++){var n=e.at(o);if(n.userData&&n.userData.dragManager)return n}}},{key:"findArbMc",value:function(t,e){for(var i=t.get_arbiters(),o=i.get_length(),n=0;o>n;n++){var s=i.at(n),a=null;a=s.get_body1()==t?s.get_body2():s.get_body1();var r=a.userData.view;if(r.classname===e)return r}return null}}]),t}()},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var n=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),s=i(1),a=void 0,r=void 0,h=void 0,l=void 0,u=void 0,c=void 0,d=void 0,p=void 0;e["default"]=function(){function t(e){o(this,t),a=e.NbPivotJoint,r=e.NbLineJoint,h=e.NbDistanceJoint,l=e.NbWeldJoint,u=e.NbSpringJoint,c=e.NbAngleJoint,d=e.NbPulleyJoint,p=e.NbRubberJoint,this._space=null,this.PIVOT_JOINT="PivotJoint",this.LINEJOINT_JOINT="LineJointJoint",this.DISTANCE_JOINT="DistanceJoint",this.WELD_JOINT="WeldJoint",this.SPRING_JOINT="SpringJoint",this.ANGLE_JOINT="AngleJoint",this.PULLEY_JOINT="PulleyJoint",this.NBRUBBER_JOINT="NBRubberJoint"}return n(t,[{key:"dispose",value:function(){this.space=null}},{key:"jointType",value:function(t){return t instanceof a?this.PIVOT_JOINT:t instanceof r?this.LINEJOINT_JOINT:t instanceof h?this.DISTANCE_JOINT:t instanceof l?this.WELD_JOINT:t instanceof u?this.SPRING_JOINT:t instanceof c?this.ANGLE_JOINT:t instanceof d?this.PULLEY_JOINT:t instanceof p?this.NBRUBBER_JOINT:""}},{key:"getJointworldVertexs",value:function(t){var e=t.get_body1(),i=t.get_body2(),o=t.get_anchor1(),n=t.get_anchor2();return[e.localPointToWorld(o),i.localPointToWorld(n)]}},{key:"createPivotJoint",value:function(t,e,i,o){var n=new a(t,e,t.worldPointToLocal(i),e.worldPointToLocal(o));return n.set_ignore(!0),n.set_stiff(!0),n.set_damping(0),n.set_frequency(1e5),n.set_space(this.space),n}},{key:"createLineJoint",value:function(t,e,i,o,n,s,a){var h=new r(t,e,t.worldPointToLocal(i),e.worldPointToLocal(o),n,s,a);return h.set_stiff(!0),h.set_ignore(!0),h.set_damping(0),h.set_space(this.space),h}},{key:"createDistanceJoint",value:function(t,e,i,o,n,s){var a=new h(t,e,t.worldPointToLocal(i),e.worldPointToLocal(o),n,s);return a.set_space(this.space),a.set_ignore(!0),a.set_stiff(!1),a.set_damping(0),a.set_frequency(1e10),a}},{key:"createSpringJoint",value:function(t,e,i,o,n){var s=new u(t,e,t.worldPointToLocal(i),e.worldPointToLocal(o),n);return s.set_space(this.space),s.set_frequency(1),s}},{key:"createWeldJoint",value:function(t,e,i,o,n){t.rotation||(t.rotation=0),e.rotation||(e.rotation=0);var s=isNaN(n)?e.rotation-t.rotation:n,a=new l(t,e,t.worldPointToLocal(i),e.worldPointToLocal(o),s);return a.set_maxForce(1e7),a.set_ignore(!0),a.set_space(this.space),a}},{key:"createAngleJoint",value:function(t,e,i,o,n){var s=new c(t,e,i,o,n);return s.set_space(this.space),s}},{key:"createPulleyJoint",value:function(t,e,i,o,n,s,a,r,h,l,u){n=t.worldPointToLocal(n),s=e.worldPointToLocal(s),a=i.worldPointToLocal(a),r=o.worldPointToLocal(r);var c=new d(t,e,i,o,n,s,a,r,h,l,u);return c.set_ignore(!0),c.set_stiff(!0),c.set_damping(0),c.set_frequency(1e5),c.set_space(this.space),c}},{key:"createNBRubberJoint",value:function(t,e,i,o,n){var a=void 0,r=void 0;return a=n>0?n:s.M.vec2Length((new Vec2).add(i).sub(o)),r=new p(t,e,t.worldPointToLocal(i),e.worldPointToLocal(o),a),r.set_stiff(!1),r.set_frequency(2),r.set_damping(.1),r.set_space(this.space),r}},{key:"space",set:function(t){this._space=t},get:function(){return this._space}}]),t}()},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),s=void 0,a=void 0,r=void 0;t.exports=function(){function t(e){o(this,t),this.NBOpticsStr=e.moduleMain.NBOpticsStr,this.main=e.main,s=e.main.phy.nape,a=s.geom.Vec2,r=s.shape.ShapeList,this.threshold=.001,this.space=null,this.eqArr=[],this.intersectedArr=[]}return n(t,[{key:"updateEquips",value:function(){var t=this;this.eqArr.length=0,this.main.getEquipmentArr().forEach(function(e){t.eqArr.push(e.component)})}},{key:"dispose",value:function(){this.NBOpticsStr=null,this.space=null}},{key:"getN",value:function(t,e){return e?e.n*(t/1.5):1}},{key:"getVo",value:function(t){if(t){var e=t.get_userData();if(e)return e.vo}return null}},{key:"getViewByShape",value:function(t){if(t){var e=t.get_body();if(e&&e.userData)return e.userData.view}return null}},{key:"shapeUnderPoint",value:function(t,e){var i=this.shapesUnderPoint(t,e);return 0===i.get_length()?null:i.at(0)}},{key:"getNbyShape",value:function(t,e){if(t){var i=this.getVo(t);if(i)return this.getN(e,i)}return 1}},{key:"vecInBody",value:function(t,e){return t.contains(e)}},{key:"getBody",value:function(t){return t?t.get_body():null}},{key:"getViewByBody",value:function(t){return t&&t.userData?t.userData.view:null}},{key:"getView",value:function(t){return this.getViewByBody(this.getBody(t))}},{key:"rayFindBodyResult",value:function(t,e,i){var o=t.ray,n=this.space.rayCast(o,!0,e);if(n){var s=t.from;n.from=t.from;var a=o.at(n.get_distance()+this.threshold),r=this.shapeUnderPoint(a,s);n.to=r;var h=this.getVo(s),l=this.getVo(r);if(h===l)for(var u=this.space.rayMultiCast(o,!0,e),c=0;c<u.get_length()&&(n=u.at(c),a=o.at(n.get_distance()+this.threshold),r=this.shapeUnderPoint(a,null),n.to=r,l=this.getVo(r),h===l);c++);var d=this.getNbyShape(s,i);return n.rate=this.getNbyShape(r,i)/d,(h&&-1==h.rate||l&&-1==l.rate)&&(n.rate=1),n}}},{key:"shapesUnderPoint",value:function(t,e){var i=this,o=this.space.shapesUnderPoint(t);return o.filter(function(t){return t!==e&&i.underFilter(t)}),o}},{key:"underFilter",value:function(t){return t.get_filter()!==this.NBOpticsStr.LIGHT_AND_HITFILTERS&&t.get_filter()!==this.NBOpticsStr.filters}},{key:"bodyIsMultiShape",value:function(t){for(var e=t.get_body(),i=e.get_shapes(),o=i.get_length(),n=0,s=0;o>s;s++){var a=i.at(s);a.get_filter()!==this.NBOpticsStr.LIGHT_AND_HITFILTERS&&a.get_filter()!==this.NBOpticsStr.filters&&n++}return 1!==n}}]),t}()},,function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e["default"]=function n(t){o(this,n),this.LIGHT_AND_HITFILTERS=t.DRAG_FIELD_FILTER,this.filters=t.LIGHT_SELF_FILTER,this.NO_HIT_FILTERS=t.OPTICS_LENS_FILTER,this.PERISCOPE=t.PERISCOPE,this.PERISCOPE_MIRROR=t.PERISCOPE_MIRROR,this.PERISCOPE_HIT=t.PERISCOPE_HIT}},,,,function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();e["default"]=function(t){function e(t,i,s){o(this,e);var a=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,s));return a.resolution=1,a._resolution=1,a}return s(e,t),a(e,[{key:"resolution",set:function(t){this._resolution=t},get:function(){return 1}}]),e}(PIXI.Text)},,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),a=i(510),r=o(a),h=i(548),l=o(h),u=i(511),c=o(u),d=i(512),p=o(d),y=i(551),f=o(y),g=i(549),b=o(g),v=i(500),_=o(v),m=i(547),x=o(m),w=i(471),k=o(w),P=i(514),O=o(P);e["default"]=function(){function t(){n(this,t),this.map={},this.register("Box",r["default"]),this.register("Triangle",l["default"]),this.register("Circle",c["default"]),this.register("Gear",p["default"]),this.register("ToolSpring",f["default"]),this.register("WeldJointView",b["default"]),this.register("BearingJointView",_["default"]),this.register("ThrusterToolView",x["default"]),this.register("PolygonView",k["default"]),this.register("RopeView",O["default"])}return s(t,[{key:"register",value:function(t,e){this.map[t]=e}},{key:"getClassByName",value:function(t){return this.map[t]}}]),t}()},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(1),h=i(226),l=function(t){return t&&t.__esModule?t:{"default":t}}(h),u=void 0,c=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return u=i.phy.nape,c=u.geom.Vec2,i.classType="ForceArrow",i.fillcolor=i.globalConfig.TXT_COLOR,i.var_txt=i.globalConfig.main.cachePool.popText("",{font:"20px Arial",fill:i.fillcolor}),i.fillcolor="",i.addChild(i.var_txt),i.var_line=i.globalConfig.main.cachePool.popGraphic(),i.addChild(i.var_line),i.var_scale=150,i.var_head=PIXI.Sprite.fromFrame("mechSkin/arrowHead2"),i.var_shen=PIXI.Sprite.fromFrame("mechSkin/arrowBody2"),i.addChild(i.var_head),i.addChild(i.var_shen),r.M.alignPivot(i.var_head,"center","top"),r.M.alignPivot(i.var_shen,"center","top"),i}return s(e,t),a(e,[{key:"headPointTo",value:function(t){return t.toLocal({x:this.var_head.x,y:this.var_head.y+6},this)}},{key:"disposed",value:function(){}},{key:"draw",value:function(t,e,i,o){var n=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;(n&&this.fillcolor!=n||this.fillcolor!==this.globalConfig.TXT_COLOR)&&(this.fillcolor=n||this.globalConfig.TXT_COLOR,this.var_txt.style.fill=this.fillcolor,this.removeChild(this.var_head),this.removeChild(this.var_shen),n?(this.var_head=PIXI.Sprite.fromFrame("mechSkin/arrowHead3"),this.var_shen=PIXI.Sprite.fromFrame("mechSkin/arrowBody3")):"#FFFFFF"===this.fillcolor?(this.var_head=PIXI.Sprite.fromFrame("mechSkin/arrowHead2"),this.var_shen=PIXI.Sprite.fromFrame("mechSkin/arrowBody2")):(this.var_head=PIXI.Sprite.fromFrame("mechSkin/arrowHead"),this.var_shen=PIXI.Sprite.fromFrame("mechSkin/arrowBody")),this.addChild(this.var_head),this.addChild(this.var_shen),r.M.alignPivot(this.var_head,"center","top"),r.M.alignPivot(this.var_shen,"center","top")),this.var_value=t,this.var_dir=i;var s=c.get(this.var_scale*this.var_value*this.var_dir.get_x(),this.var_scale*this.var_value*this.var_dir.get_y()),a=r.M.vec2Length(s);this.var_shen.height=a,this.var_head.y=a,this.rotation=Math.atan2(this.var_dir.get_y(),this.var_dir.get_x())-Math.PI/2,this.var_txt.text=o+" = "+r.M.getNumJie(t,2)+"N",this.var_txt.rotation=-this.rotation,this.x=e.get_x(),this.y=e.get_y(),r.M.alignPivot(this.var_txt,"center","top"),this.var_txt.y=a+50}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var n=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),s=null,a=null,r=null,h=null;e["default"]=function(){function t(e){o(this,t),s=e.main.phy.nape,a=s.NbBody,r=s.phys.BodyType,h=s.NbCircle,this.shapeRadius=30,this.body=new a(r.get_KINEMATIC()),this.body.userData.noDrag=!0;var i=this.createShape();i.get_userData().isself=!0,this.body.add(i)}return n(t,[{key:"updateShapes",value:function(){var t=this;this.body.get_shapes().foreach(function(e){var i=e.get_userData();if(!i.isself){var o=i.hock;o&&!o.get_body()&&t.removeJointShape(e)}})}},{key:"createShape",value:function(){var t=new h(this.shapeRadius);return t.set_sensorEnabled(!0),t}},{key:"addJointShape",value:function(t,e){var i=this.createShape();this.body.add(i),t.userData.hockshape=i,i.get_userData().hock=e}},{key:"removeJointShape",value:function(t){var e=t.get_userData().hock;e&&e.pivjoint&&(e.pivjoint.userData.hockshape=null),t.get_userData().hock=null,this.body.remove(t)}},{key:"breakJointToDrag",value:function(t){var e=t.get_userData().hock,i=e.get_body(),o=e.get_userData().bind.get_body(),n=null;if(i&&o)if(!0===i.userData.notHockDrag)n=o;else if(!0===o.userData.notHockDrag)n=i;else{var s=i.get_position(),a=o.get_position();n=s.get_y()>a.get_y()?i:o}else n=i||o;return e.dragToolClick(!0),this.removeJointShape(t),n}}]),t}()},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e["default"]=function n(t){o(this,n);var e=t.dynamics.InteractionGroup;this.WATER_BEAKER=new e(!0),this.WALL_GROUP=new e(!0),this.VERNIERCALIPER_SPIRALMICROMETER=new e(!0)}},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function g(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:g(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(452),c=o(u),d=i(511),p=o(d),y=i(474),f=o(y);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.isstart=!1,i.var_r=0,i.lineColor=16777215,i.var_arcColor=4605510,i.var_edgeColor=11184810,i.lineThin=2,i.center=null,i.skinColor=null,i.shapeView=new PIXI.Graphics,i.angle=0,i}return a(e,t),r(e,[{key:"setActive",value:function(t){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setActive",this).call(this,t),this.active){var i=this;this.touchBeginUid||(this.touchBeginUid=l.M.addTouch(this.var_dis,{begin:i.func_touchBegin,isAddDB:!1},this)),this.touchMoveUid||(this.touchMoveUid=l.M.addTouch(this.var_dis,{move:i.func_touchMove,isAddDB:!1},this)),this.touchEndUid||(this.touchEndUid=l.M.addTouch(this.var_dis,{end:i.func_touchEnd,isAddDB:!1},this))}else this.touchBeginUid&&l.M.removeTouch(this.var_dis,this.touchBeginUid),this.touchMoveUid&&l.M.removeTouch(this.var_dis,this.touchMoveUid),this.touchEndUid&&l.M.removeTouch(this.var_dis,this.touchEndUid),this.touchBeginUid=this.touchMoveUid=this.touchEndUid=null}},{key:"func_touchBegin",value:function(t){this.isstart=!0,this.lineThin=2/this.globalConfig.main.view.scale.x,this.func_dispose(),this.skinColor=f["default"].getColor(),this.center=new l.Point(t.x,t.y);var e=[];e.push({option:"addElement",target:this.shapeView,params:{x:0,y:0}}),this.func_dispatchGraphic(e),this.config.moduleMain.napeEngine.transformManager.hide()}},{key:"func_touchMove",value:function(t){this.isstart&&(this.var_r=l.Point.distance(this.center,t),this.angle=Math.atan2(t.y-this.center.y,t.x-this.center.x),this.var_r>0&&(this.shapeView.clear(),this.shapeView.lineStyle(this.lineThin,this.var_edgeColor,1),this.shapeView.beginFill(this.skinColor,1),this.shapeView.drawCircle(this.center.x,this.center.y,this.var_r),this.shapeView.endFill(),this.shapeView.lineStyle(this.lineThin,this.var_edgeColor,1),this.shapeView.beginFill(this.var_arcColor,.6),this.shapeView.moveTo(this.center.x,this.center.y),this.shapeView.arc(this.center.x,this.center.y,this.var_r,this.angle-.1,this.angle+.1),this.shapeView.endFill()))}},{key:"func_touchEnd",value:function(t,e){if(this.isstart&&(this.isstart=!1,this.func_dispose(),this.shapeView.clear(),!e)){if(this.var_r>50){this.angle=Math.atan2(t.y-this.center.y,t.x-this.center.x);var i=new p["default"](this.config,[this.var_r,this.skinColor,this.angle]);this.addEquipmentChild(i,this.center),this.globalConfig.main.execute(this.NBCommand.ANALYTICS,{type:"mecTool",name:"circle"}),this.globalConfig.main.isPlay||i.setSelected(!0),this.globalConfig.main.dispatchEvent("phy.addEquipment")}this.var_r=0}}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function g(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:g(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(452),c=o(u),d=i(549),p=o(d),y=void 0,f=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=t.moduleMain.phy.nape,f=y.geom.Vec2,i.singlePoint=!0,i}return a(e,t),r(e,[{key:"setActive",value:function(t){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setActive",this).call(this,t),this.active){var i=this;this.touchTabUid||(this.touchTabUid=l.M.addTouch(this.var_dis,{tab:i.touchTab,isAddDB:!1},this))}else this.touchTabUid&&l.M.removeTouch(this.var_dis,this.touchTabUid),this.touchTabUid=null}},{key:"func_touchBegin",value:function(t){}},{key:"touchTab",value:function(t){var e=new f(t.x,t.y),i=this.space.bodiesUnderPoint(e);if(0!=i.get_length()){i.filter(function(t){if(t.userData){if(t.userData.canfixtool)return!0;if(t.userData.isnbequ)return!1}return!0});var o=this.BodyUtil.getTopBodyFormBodyList(i);if(o&&o.userData.view&&!o.userData.view.isMechaTool){this.cancelMecSelected(t);var n=this.BodyUtil.getTopBodyFormBodyList(i,[o]);n||(n=this.space.world),n!=this.space.world&&this.adsorbToCom(n,t,50),this.adsorbToCom(o,t,50);var s=new p["default"](this.config,o,n);this.addEquipmentChild(s,t),this.initScale(s),s.showToolDatas(),this.globalConfig.main.dispatchEvent("phy.addEquipment"),this.config.moduleMain.napeEngine.transformManager.hide(),this.globalConfig.main.execute(this.NBCommand.ANALYTICS,{type:"mecTool",name:"fix"}),this.globalConfig.main.isPlay||(s.setSelected(!0),s.freshLibPan())}}}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function b(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:b(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(452),c=o(u),d=i(548),p=o(d),y=i(474),f=o(y),g=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.isstart=!1,i.globalPoints=[new l.Point,new l.Point,new l.Point],i}return a(e,t),r(e,[{key:"setActive",value:function(t){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setActive",this).call(this,t),this.active){var i=this;this.touchBeginUid||(this.touchBeginUid=l.M.addTouch(this.var_dis,{begin:i.func_touchBegin,isAddDB:!1},this)),this.touchMoveUid||(this.touchMoveUid=l.M.addTouch(this.var_dis,{move:i.func_touchMove,isAddDB:!1},this)),this.touchEndUid||(this.touchEndUid=l.M.addTouch(this.var_dis,{end:i.func_touchEnd,isAddDB:!1},this))}else this.touchBeginUid&&l.M.removeTouch(this.var_dis,this.touchBeginUid),this.touchMoveUid&&l.M.removeTouch(this.var_dis,this.touchMoveUid),this.touchEndUid&&l.M.removeTouch(this.var_dis,this.touchEndUid),this.touchBeginUid=this.touchMoveUid=this.touchEndUid=null}},{key:"func_touchBegin",value:function(t){this.skinColor=f["default"].getColor(),this.func_dispose(),this.isstart=!0,this.var_startP=new l.Point(t.x,t.y)}},{key:"func_touchMove",value:function(t){if(this.isstart){this._width=t.x-this.var_startP.x,this._height=t.y-this.var_startP.y,this.func_updateGlobalPoints();var e=new PIXI.Graphics;e.lineStyle(1,this.skinColor,1),e.beginFill(this.skinColor,1);for(var i=0;this.globalPoints.length>i;i++){var t=this.globalPoints[i];0==i?e.moveTo(t.x,t.y):e.lineTo(t.x,t.y)}e.endFill();var o=[];o.push({option:"addElement",target:e,params:{x:0,y:0}}),this.func_dispatchGraphic(o)}}},{key:"func_touchEnd",value:function(t,e){if(this.isstart&&(this.isstart=!1,this.func_dispose(),!e&&(this._width=t.x-this.var_startP.x,this._height=t.y-this.var_startP.y,Math.abs(this._width)>=50||Math.abs(this._height)>=50))){var i=this.func_getLocalPoints(),o=[Vec2Util.pointArrToVec2Arr(i)],n=new p["default"](o,this.skinColor);this.addEquipmentChild(n,this.var_startP),this.globalConfig.main.dispatchEvent("phy.addEquipment"),this.globalConfig.main.isPlay||(n.setSelected(!0),n.freshLibPan())}}},{key:"func_updateGlobalPoints",value:function(){var t=this.globalPoints[0],e=this.globalPoints[1],i=this.globalPoints[2];return t.x=this.var_startP.x+this._width/2,t.y=this.var_startP.y,e.x=this.var_startP.x,e.y=this.var_startP.y+this._height,i.x=this.var_startP.x+this._width,i.y=this.var_startP.y+this._height,[t,e,i]}},{key:"func_getLocalPoints",value:function(){for(var t=[],e=0;this.globalPoints.length>e;e++){var i=this.globalPoints[e];t.push(new l.Point(i.x-this.var_startP.x,i.y-this.var_startP.y))}return t}}]),e}(c["default"]);g.preventDraw=!0,e["default"]=g},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function c(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:c(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(226),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.count=20,i.elecLable="弹簧",i.line=new PIXI.Graphics,i.line.lineStyle(3,16711680),i.addChild(i.line),i.overrideFunc(),i}return s(e,t),a(e,[{key:"overrideFunc",value:function(){}},{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.hasAddCompComplete=!0}},{key:"update",value:function(){if(this.joint){var t=this.getMain(),e=h.Point.vec2ToPoint(this.joint.body1.localPointToWorld(this.joint.anchor1)),i=h.Point.vec2ToPoint(this.joint.body2.localPointToWorld(this.joint.anchor2));this.line&&(e=this.line.toLocal(e,t.view),i=this.line.toLocal(i,t.view)),this.drawSJ(e,i)}}},{key:"drawSJ",value:function(t,e){var i=h.M.getPointLen(t,e),o=i/this.count,n=(h.M.getXianDuanGaoXianDian(t,e,20,!0),h.M.getXianDuanGaoXianDian(t,e,20,!1),h.M.getXianDuanGaoXianDian(e,t,20,!0),h.M.getXianDuanGaoXianDian(e,t,20,!1),void 0);for(this.line.clear(),this.line.moveTo(t.x,t.y),n=1;this.count>=n;n++){var s=h.M.getXianDianByDis(o*n-o/2,!0,t,e),a=h.M.getXianDuanGaoXianDian(s,t,14,n%2!=0);n%2==0?this.line.lineStyle(3,10027008):this.line.lineStyle(3,10027059),this.line.lineTo(a.x,a.y)}this.line.lineTo(e.x,e.y)}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.geom.Vec2,p=c.shape.HockShapeBase,i._width=60,i._height=70,i.tophock=null,i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.noallowRotation=!0,this.tophock=new p(15),this.tophock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.tophock),this.tophock.translate(d.weak(0,-50)),this.tophock.addCbtype(this.CbTypeStr.HOOK_TOP_GOU,!0),this.tophock.connectVec=d.get(0,-10),this.changeMass({showValue:"50"}),this.addTweenQuan(this.tophock)}},{key:"removed",value:function(){this.tophock.dragToolClick(),this.tophock.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"changeMass",value:function(t){switch(h.M.getNumStr(t.showValue)+""){case"10":this.bg.gotoAndStop(0),this.body.mass=10;break;case"20":this.bg.gotoAndStop(1),this.body.mass=20;break;case"50":this.bg.gotoAndStop(2),this.body.mass=50;break;case"100":this.bg.gotoAndStop(3),this.body.mass=100}}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.mass=this.body.get_mass()+"g",t}},{key:"setData",value:function(t){t.thisY-=20,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.changeMass({showValue:t.mass})}},{key:"update",value:function(){if(r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.tophock&&!this.tophock.get_userData().useing){this.body.get_allowRotation()&&(this.body.set_rotation(0),this.body.set_allowRotation(!1),this.BodyUtil.frezzBody(this.body)),0!==this.body.get_rotation()&&this.body.set_rotation(0)}}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getDropMenu(this.language.getLocaleStr("mass"),!1,"g",this.body.get_mass()+"g",["10g","20g","50g","100g"],this,this.changeMass,1,0)),t}},{key:"showGlowSP",value:function(t){if(t){this.showGlowIndex(this.tophock.get_userData().useing?1:0)}else this.hideGlow()}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function u(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:u(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(546),l=function(t){return t&&t.__esModule?t:{"default":t}}(h);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.k_areaToH=1,i.liquidW=322,i.halfW=i.liquidW/2,i.wallW=20,i.wallH=365,i.wallOfy=20,i.botH=12,i.boty=200,i.fullH=315,i.totalRange=100,i.isOverflow=!1,i.var_exceptWater=0,i.valueTxtxy={x:200,y:-220},i.poshapexy={x:150,y:-231},i.barxy={x:200,y:0},i.pourxy={x:-199,y:-166},i.limitForceDrag=!0,i.maxDragForce=1e5,i.drawObj={interval:10,nobooksize:30,logoX:-180,lcsize:30,lcX:-150},i.selfmass=70,i.kdalpha=.5,i.hasAo=!1,i.mlArr=["0mL","20mL","30mL","40mL","50mL","80mL","100mL"],i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.kdLine.x=50,this.changeLiquidVolume({showValue:"80mL"})}},{key:"drawScale",value:function(){var t=this,e=function(e,i){var o=new PIXI.Text(e,{font:i+"px Arial",fill:t.lineColor});return o.alpha=t.kdalpha,o};this.kdLine.removeChildren(),this.kdLine.clear();var i=this.fullH,o=this.drawObj.interval,n=this.totalRange/o,s=i/n;this.kdLine.lineStyle(2,this.lineColor,this.kdalpha);var a=this.boty,r=void 0;for(r=0;n>=r;r++)if(r>1)if(r%2==0){var h=a-r*s;this.kdLine.moveTo(-29,h),this.kdLine.lineTo(29,h);var l=e(o*r,25);this.kdLine.addChild(l),l.x=34,l.y=h-15}else this.kdLine.moveTo(-16,a-r*s),this.kdLine.lineTo(16,a-r*s);this.kdLine.moveTo(0,a-2*s),this.kdLine.lineTo(0,a-n*s);var u=e("NOBOOK",this.drawObj.nobooksize);this.kdLine.addChild(u),u.x=this.drawObj.logoX,u.y=a-3*s;var c=e(this.totalRange+"mL",this.drawObj.lcsize);this.kdLine.addChild(c),c.x=this.drawObj.lcX,c.y=a-10.5*s}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function c(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:c(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(226),l=function(t){return t&&t.__esModule?t:{"default":t}}(h),u=i(1);e["default"]=function(t){function e(t,i,s,a){o(this,e);var r=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,a));return r.s1=t,r.s2=i,r.cover=s,r}return s(e,t),a(e,[{key:"init",value:function(){this._sCon=new PIXI.Sprite,this.addChild(this._sCon),this._sCon.addChild(this.s1),this._sCon.addChild(this.s2),this.s1.x=this.s2.x=0,this.sHeight=this.s1.height-4,this.s1.y=-20,this.s2.y=this.s1.y+this.sHeight,this.addChild(this.cover),this.cover.x=0,this.cover.y=0,this.cover.alpha=.3;var t=new PIXI.Graphics;this.addChild(t),t.beginFill(0),t.drawRect(-this.cover.width/2,-this.cover.height/2,this.cover.width,this.cover.height),t.endFill(),this._sCon.mask=t,this.touchId=u.M.addTouch(this,{begin:this.beginFunc,move:this.moveFunc,end:this.endFunc},this)}},{key:"removed",value:function(){this.s1=null,this.s2=null,this.cover=null,this.$target=null,u.M.removeTouch(this,this.touchId),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"beginFunc",value:function(t){this.$target.touchEnabled=!1,this.touchp=this.getMouseXY(t),this.startP=this.touchp.clone()}},{key:"moveFunc",value:function(t){var e=this,i=this.getMouseXY(t),o=i.y-this.touchp.y;this.touchp=i;var n=i.y-this.startP.y;Math.abs(n)>.5*this.cover.height&&(clearTimeout(this.crollTimeFlag),this.crollTimeFlag=setTimeout(function(){if(!e.hadDestory)return 0>n?(clearInterval(e["int"]),void(e["int"]=setInterval(function(){e.dispatchEvent("rolling",{upordown:!1})},25))):n>0?(clearInterval(e["int"]),void(e["int"]=setInterval(function(){e.dispatchEvent("rolling",{upordown:!0})},25))):void 0},500)),clearInterval(this["int"]),this.dispatchEvent("rolling",{upordown:o>0})}},{key:"endFunc",value:function(t){this.$target.touchEnabled=!0,this.touchp=null,clearTimeout(this.crollTimeFlag),clearInterval(this["int"]),this.dispatchEvent("rollend")}},{key:"updata",value:function(t){t?this.s1.y+=2:this.s1.y-=2,this.s2.y=this.s1.y>-15?this.s1.y-this.sHeight:this.s1.y+this.sHeight,this.s1.y=this.s2.y>-15?this.s2.y-this.sHeight:this.s2.y+this.sHeight}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function p(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:p(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(507),u=o(l),c=i(226),d=o(c);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.scaler=new u["default"](t),i}return a(e,t),r(e,[{key:"added",value:function(){this.addChild(this.scaler),this.scaler.added(),this.scaler.initMicrometerH()}},{key:"removed",value:function(){this.scaler.removed(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"reScaleTxt",value:function(t){var e=0;for(e=0;this.scaler.children>e;e++){var i=this.scaler.getChildAt(e);i&&(i.scale.x=i.scale.x=t)}}}]),e}(d["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function u(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:u(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(226),l=function(t){return t&&t.__esModule?t:{"default":t}}(h);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.line=new PIXI.Graphics,i.textObject={},i.space=5,i.total=50*i.space,i}return s(e,t),a(e,[{key:"added",value:function(){this.addChild(this.line),this.initText()}},{key:"removed",value:function(){this.parent&&this.parent.removeChild(this),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"initText",value:function(){var t=0;for(t=0;10>t;t++){var e=new PIXI.Text(5*t+"",{font:"18px Arial",fill:0});this.addChild(e),e.x=10,e.pivotY=4,this.textObject["t"+5*t]=e}}},{key:"reScaleTxt",value:function(t){for(var e in this.textObject){var i=this.textObject[e];i.scale.x=i.scale.y=t}}},{key:"updata",value:function(t){this.posi=-t%this.total,this.drawline()}},{key:"drawline",value:function(){this.line.clear(),this.line.lineStyle(1,0);for(var t=0;50>t;t++){var e=-(t*this.space+this.posi);-this.total/2>e&&(e+=this.total),e>this.total/2&&(e-=this.total),-this.total/2>e&&(e+=this.total);var i=void 0;if(t%5==0){i=15;var o=this.textObject["t"+t];o&&(o.y=e)}else i=7;this.line.moveTo(0,e),this.line.lineTo(i,e)}}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();e["default"]=function(t){function e(t,i,s,a,r,h){o(this,e);var l=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return l.globalConfig=t.moduleMain.globalConfig,l.Check=t.moduleMain.config.Check,l.MouseManager=t.moduleMain.config.MouseManager,l.check=null,l.label=null,l.line=null,l.owner=null,l.bl=i,l.mass=s,l.textureName=h||"PhasePosition",l.color=a||"#ff9900",l.size=r||24,l._isSelected=!0,l.init(),l}return s(e,t),a(e,[{key:"dispose",value:function(){this.MouseManager.removeMouseEvent(this.globalConfig.main.mouseManager,this.check),delete this.globalConfig,delete this.Check,delete this.MouseManager,this.owner=null,this.line=null,this.bl=null,this.check.removeEventListener("selectChange",this.changeFunc),this.changeFunc=null,this.check.dispose(),this.removeChildren()}},{key:"init",value:function(){var t=this,e=PIXI.Sprite.fromFrame(this.textureName+"/kuang"),i=PIXI.Sprite.fromFrame(this.textureName+"/kuang");i.addChild(PIXI.Sprite.fromFrame(this.textureName+"/gou")),this.check=new this.Check({"this":this,selected:!0,fontColor:this.color,fontSize:this.size,defaultSkin:e,selectedSkin:i}),this.addChild(this.check);var o=this.globalConfig.main.language;this.check.label=o.getLocaleStr("length_bai")+this.bl+"cm "+o.getLocaleStr("mass")+" "+this.mass+"g "+o.getLocaleStr("wave_wei"),this.changeFunc=function(){t.owner.dispatchEvent("showOneLine",{boo:t.check.selected,ln:t.line})},this.check.addEventListener("selectChange",this.changeFunc),this.MouseManager.addMouseEvent(this.globalConfig.main.mouseManager,this.check,"hand")}},{key:"checkLabel",value:function(t){this.check&&(this.check.label=t)}},{key:"isSelected",set:function(t){this._isSelected=t,this.check.selected=t},get:function(){return this._isSelected}}]),e}(PIXI.Container)},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function c(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:c(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(226),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.nbtouchid=null,i.startMP=null,i}return s(e,t),a(e,[{key:"addDragSelf",value:function(){var t=this;this.nbtouchid=h.M.addTouch(this,{begin:function(e){t.startMP=t.getMouseXY(e)},move:function(e){var i=t.getMouseXY(e);t.x+=i.x-t.startMP.x,t.y+=i.y-t.startMP.y,t.startMP=i},end:function(t){}})}},{key:"removed",value:function(){this.disposeAll(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"disposeAll",value:function(){h.M.removeDrag(this,this.nbtouchid)}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){o.injectionClass(),this.bitmap=t,this.alphaThreshold=e||128,this.bounds=new r(0,0,this.bitmap.width,this.bitmap.height)}e.__esModule=!0;var n=i(539),s=function(t){return t&&t.__esModule?t:{"default":t}}(n),a=void 0,r=void 0;o.injectionClass=function(){o.injected||(o.injected=!0,a=s["default"].nape,r=a.geom.AABB)},o.prototype.iso=function(t,e){var i=t,o=e;return 0>i&&(i=0),0>o&&(o=0),this.bitmap.width>i||(i=this.bitmap.width-1),this.bitmap.height>o||(o=this.bitmap.height-1),this.alphaThreshold-this.bitmap.getPixel(i,o)[3]},e["default"]=o},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=void 0,h=void 0;e["default"]=function(t){function e(t,i){o(this,e);var s=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return s.JointUtil=t.moduleMain.JointUtil,r=t.main.phy.nape,h=r.geom.Vec2,s.napeEngine=i,s.graphic=new PIXI.Graphics,s.addChild(s.graphic),s}return s(e,t),a(e,[{key:"clear",value:function(){this.graphic.clear()}},{key:"draw",value:function(){this.graphic.clear(),this.graphic.lineStyle(1,16711935);var t=this.napeEngine.space.bodies,e=this.napeEngine.space.get_compounds(),i=0;for(i=0;i<t.get_length();i++){this.createdebugShape(t.at(i).get_shapes())}for(i=0;i<e.get_length();i++){var o=e.at(i),n=o.get_bodies(),s=o.get_constraints(),a=void 0;for(a=0;a<n.get_length();a++){this.createdebugShape(n.at(a).get_shapes())}for(a=0;a<s.get_length();a++){this.createJoint(s.at(a))}}var r=this.napeEngine.space.constraints;for(i=0;i<r.get_length();i++){this.createJoint(r.at(i))}}},{key:"createJoint",value:function(t){if(t.get_anchor1&&!isNaN(t.get_anchor1().get_x())){this.graphic.lineStyle(1,65280);var e=t.get_body1(),i=t.get_body2(),o=t.get_body3?t.get_body3():null,n=t.get_body4?t.get_body4():null,s=e.localPointToWorld(t.get_anchor1()),a=i.localPointToWorld(t.get_anchor2());if(this.JointUtil.jointType(t)===this.JointUtil.PIVOT_JOINT)return this.graphic.lineStyle(2,65535),void this.graphic.drawCircle(s.get_x(),s.get_y(),4);if(this.JointUtil.jointType(t)===this.JointUtil.DISTANCE_JOINT)this.graphic.lineStyle(2,16711680);else{if(this.JointUtil.jointType(t)===this.JointUtil.WELD_JOINT)return this.graphic.lineStyle(2,16776960),void this.graphic.drawCircle(s.get_x(),s.get_y(),4);if(this.JointUtil.jointType(t)===this.JointUtil.LINEJOINT_JOINT){this.graphic.lineStyle(2,16750848),this.graphic.moveTo(s.get_x(),s.get_y());var r=h.get(1,1);r.set_angle(t.get_direction().get_angle()),r.set_length(t.get_jointMax());var l=s.add(r);this.graphic.lineTo(l.get_x(),l.get_y()),this.graphic.lineStyle(2,10092492)}}if(this.graphic.moveTo(s.get_x(),s.get_y()),this.graphic.lineTo(a.get_x(),a.get_y()),o){var u=o.localPointToWorld(t.get_anchor3()),c=n.localPointToWorld(t.get_anchor4());this.graphic.moveTo(u.get_x(),u.get_y()),this.graphic.lineTo(c.get_x(),c.get_y())}}}},{key:"createdebugShape",value:function(t){var e=0,i=0;for(e=0;e<t.get_length();e++){var o=t.at(e),n=o.get_body();if(!isNaN(n.get_position().get_x()))if(this.graphic.beginFill(16711680),this.graphic.drawCircle(n.posx,n.posy,2),this.graphic.endFill(),o.get_radius){var s=o.get_worldCOM();this.graphic.drawCircle(s.get_x(),s.get_y(),o.get_radius())}else{var a=void 0;if(a=o.get_worldVerts()){var r={};for(this.graphic.lineStyle(1,16711935),i=0;i<a.get_length();i++){var h=a.at(i);0===i?(r.x=h.get_x(),r.y=h.get_y(),this.graphic.moveTo(h.get_x(),h.get_y())):this.graphic.lineTo(h.get_x(),h.get_y())}this.graphic.lineTo(r.x,r.y)}}}}},{key:"removed",value:function(){this.JointUtil=null,this.napeEngine=null}}]),e}(PIXI.Container)},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var n=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),s=i(1);e["default"]=function(){function t(e){o(this,t),this.ray=e,this.from=null,this.fsNbRay=null,this.zsNbRay=null,this.rsNbRay=null,this.normal=null,this.owner=null,this.isQfs=!1,this.inAir=!0,this.dis=0,this.level=0,this.isPolar=!1,this.paths=null,this._I=new s.Point(Math.SQRT1_2,Math.SQRT1_2),this.color=0,this.nofline=!1,this.showGuideLine=!0,this.setRay(e),this.endP=null}return n(t,[{key:"setRay",value:function(t){this.ray=t,this.startP=this.vec2point(t.get_origin()),this.dir=this.vec2point(t.get_direction()),this.dir.normalize(1)}},{key:"setPolar",value:function(t){var e=Math.cos(t),i=Math.sin(t),o=0;this.isPolar?o=this._I.x*e+this._I.y*i:(this.isPolar=!0,o=this.I*Math.SQRT1_2),this._I.x=o*e,this._I.y=o*i}},{key:"updateEndP",value:function(){this.endP=new s.Point(this.startP.x+this.dir.x*this.dis,this.startP.y+this.dir.y*this.dis)}},{key:"vec2point",value:function(t){return new s.Point(t.get_x(),t.get_y())}},{key:"inOrderTreeWalk",value:function(t,e){t&&(this.inOrderTreeWalk(t.fsNbRay,e),e.push(t),this.inOrderTreeWalk(t.zsNbRay,e))}},{key:"preOrderTreeWalk",value:function(t,e){t&&(e.push(t),this.preOrderTreeWalk(t.fsNbRay,e),this.preOrderTreeWalk(t.zsNbRay,e))}},{key:"postOrderTreeWalk",value:function(t,e){t&&(this.postOrderTreeWalk(t.fsNbRay,e),this.postOrderTreeWalk(t.zsNbRay,e),e.push(t))}},{key:"BFSTreeWalk",value:function(){for(var t=[this],e=0;t[e];)t[e].fsNbRay&&t.push(t[e].fsNbRay),t[e].zsNbRay&&t.push(t[e].zsNbRay),e++;return t}},{key:"inOrderTreeWalk2",value:function(t,e){t&&(this.inOrderTreeWalk2(t.zsNbRay,e),e.push(t),this.inOrderTreeWalk2(t.fsNbRay,e))}},{key:"preOrderTreeWalk2",value:function(t,e){t&&(e.push(t),this.preOrderTreeWalk2(t.zsNbRay,e),this.preOrderTreeWalk2(t.fsNbRay,e))}},{key:"postOrderTreeWalk2",value:function(t,e){t&&(this.postOrderTreeWalk2(t.zsNbRay,e),this.postOrderTreeWalk2(t.fsNbRay,e),e.push(t))}},{key:"BFSTreeWalk2",value:function(){for(var t=[this],e=0;t[e];)t[e].zsNbRay&&t.push(t[e].zsNbRay),t[e].fsNbRay&&t.push(t[e].fsNbRay),e++;return t}},{key:"I",get:function(){return this._I.length},set:function(t){if(0===this.I)this._I.x=this._I.y=t*Math.SQRT1_2;else{var e=t/this.I;this._I.x*=e,this._I.y*=e}}}],[{key:"cloneI",value:function(t,e){t._I=e._I.clone()}}]),t}()},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){var i=[],o=!0,n=!1,s=undefined;try{for(var a,r=t[Symbol.iterator]();!(o=(a=r.next()).done)&&(i.push(a.value),!e||i.length!==e);o=!0);}catch(h){n=!0,s=h}finally{try{!o&&r["return"]&&r["return"]()}finally{if(n)throw s}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),l=function E(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:E(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},u=i(1),c=i(76),d=i(542),p=o(d),y=i(458),f=o(y),g=i(558),b=o(g),v=i(557),_=o(v),m=i(227),x=o(m),w=i(540),k=o(w),P=i(573),O=o(P),T=i(574),C=o(T),B=i(516),S=o(B),M=i(575),L=o(M),D=i(577),I=o(D);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.napeEngine=null,i.moduleType=5,i._isInToolState=!1,t.globalConfig.DEBUG=!1,i.recovering=!1,i.tempG=9.8,i}return a(e,t),h(e,[{key:"unInjectClass",value:function(){this.BodyUtil.dispose(),this.JointUtil.dispose(),this.RayUtil.dispose()}},{key:"injectClass",value:function(){this.NapeConst=new _["default"],this.ToolStatusStr=new x["default"],this.CbTypeStr=new k["default"](this.main.phy.nape),this.BodyUtil=new O["default"](this.config),this.Vec2Util=new S["default"](this.main.phy.nape),this.JointUtil=new C["default"](this.main.phy.nape),this.InteractionFilterManager=new p["default"](this.BodyUtil),this.NBOpticsStr=new I["default"](this.InteractionFilterManager),this.RayUtil=new L["default"](this.config)}},{key:"init",value:function(){var t=this;return this.hasInit?Promise.resolve():(l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),new Promise(function(e,i){t.injectClass();var o=new b["default"](t.config,t);t.napeEngine=o,o.init(),t.config.UploadSkinTool.load(t.main,["mechanics/mechSkin"],function(){e()})}))}},{key:"startRecoverEqu",value:function(){this.recovering=!0}},{key:"completeRecoverEqu",value:function(){this.recovering&&(this.recovering=!1,this.setGravity(this.tempG))}},{key:"requestAnimationLoop",value:function(){this.napeEngine&&this.napeEngine.viewSync.update(),this.main&&this.main.disComp&&this.main.disComp.update(),this.main.showCoordinate?this.main.coordinate.update():this.main.coordinate.dispose(),this.foreachLooplist()}},{key:"onRemoveEquipment",value:function(){}},{key:"hideFloor",value:function(t){this.napeEngine.hideFloor(t)}},{key:"setPlay",value:function(t){this.napeEngine.play=t}},{key:"getPlay",value:function(){return this.napeEngine.play}},{key:"setGravity",value:function(t){this.recovering&&(this.tempG=t,t=0),this.napeEngine.setGravity(t-0),this.globalConfig.ZULI_NUM=t}},{key:"setGroundCuCao",value:function(t){this.napeEngine.floor.changeCC(t),this.globalConfig.GROUND_CC=t}},{key:"setGroundElastic",value:function(t){this.napeEngine.floor.changeElastic(t),this.globalConfig.GROUND_ELASTIC=t}},{key:"setAirResistance",value:function(t){this.napeEngine.changeAirResistance(t)}},{key:"setActive",value:function(t,i){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setActive",this).call(this,t),i&&t&&this.moveGlobalView(),this.napeEngine.setActive(t),this.napeEngine.floor.step=0,t||(this.main.coordinate.dispose(),this.main.showCoordinateGrid(!1))}},{key:"enterModule",value:function(t){return this.napeEngine.floor.setVisible(!!t),l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"enterModule",this).call(this,t)}},{key:"keyboardPause",value:function(){if(!1===this.napeEngine.play)try{var t=function(t){t.foreach(function(t){if(t.userData&&t.userData.dragManager){var e=t.userData.dragManager;e.func_touchEnd(e.prevP)}})},e=this.napeEngine.space.get_compounds(),i=this.napeEngine.space.get_bodies();e.foreach(function(e){t(e.get_bodies())}),t(i)}catch(o){}}},{key:"moveGlobalView",value:function(){var t=arguments.length>0&&arguments[0]!==undefined&&arguments[0],e=this.main,i=e.view,o=e.W/u.M.getNumStr(this.globalConfig.canvasWidth),n=.5*o;i.x=0,i.y=0,i.scale.x=n,i.scale.y=n;var s=e.getWindowDoorSize(),a=r(s,2),h=a[0],l=a[1];h*=.5,i.x=h*o;var c=r(this.napeEngine.floorDat,2),d=c[0],p=e.H/u.M.getNumStr(this.globalConfig.canvasHeight),y=l-50;y*=p,i.y=e.editRectEnabled?-(d*n-y):t?-d*n/2:-(d*n-y)}},{key:"setScale",value:function(t){}},{key:"destroy",value:function(){this.napeEngine.dispose(),this.unInjectClass(),l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"getData",value:function(){var t={};return t.isplay=this.napeEngine.play,t}},{key:"setData",value:function(t){this.setPlay(!t||t.isplay)}},{key:"nape",get:function(){return this.phy.nape}},{key:"isInToolState",get:function(){return this._isInToolState}}],[{key:"MODULE_TYPE",get:function(){return c.Modules.MECHANICS}}]),e}(f["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function d(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:d(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(446),u=o(l),c=i(540);o(c);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i._maxDensity=1,i._minDensity=1,i}return a(e,t),r(e,[{key:"createShape",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createShape",this).call(this),this.body.setShapeFluidEnabled(this._shape,!0),this.body.setFluidDensity(this._shape,1),this.body.setFluidViscosity(this._shape,1)}},{key:"maxDensity",get:function(){return this._maxDensity},set:function(t){this._maxDensity=t}},{key:"minDensity",get:function(){return this._minDensity},set:function(t){this._minDensity=t}},{key:"viscosity",get:function(){return this.body.getFluidViscosity(this._shape)},set:function(t){this.body.setFluidViscosity(this._shape,t)}},{key:"density",get:function(){return this.body.getFluidDensity(this._shape)},set:function(t){this.body.setFluidDensity(this._shape,t)}},{key:"openFluid",get:function(){return this.body.getShapeFluidEnabled(this._shape)}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function v(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:v(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(471),p=o(d),y=void 0,f=void 0,g=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.geom.Vec2,i.useDragSetCurElec=!0,i.crack=null,i.cracks=[],i.isBroken=!1,i.canBroken=!1,i}return a(e,t),r(e,[{key:"init",value:function(){this.createPoint(),this.material=new y.phys.Material(.1,1,1,1.1),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.removeChild(this.crack);for(var t=0;8>t;t++){var i=new b(t);this.addChild(i),this.cracks[t]=i,i.visible=!1}for(var o=0;8>o;o++){this.cracks[o].opsite=this.cracks[(o+4)%8]}}},{key:"createPoint",value:function(){this.points=[];for(var t=Math.PI/180,e=0,i=0;360>i;i++){this.points.push({x:127.5*Math.cos(e),y:99.5*Math.sin(e)}),e+=t}}},{key:"update",value:function(){var t=this;if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.canBroken){var i=this.body.normalImpulse(),o=i.xy(),n=o.get_length();if(n>5e4){var s=o.unit(),a=Math.atan2(s.get_y(),s.get_x());a-=this.body.get_rotation();for(var r=Math.floor(.5+4*a/Math.PI);0>r;)r+=8;r%=8;var l=this.cracks[r];l.addHurt((n-5e4)/1e3),l.visible=!0,100>l.getHurt()||100>l.opsite.getHurt()||this.isBroken||(this.fragmentArr?(this.isBroken=!0,setTimeout(function(){t.hadDestory||t.fragment()},20)):this.calculateFragmentArr())}}}},{key:"calculateFragmentArr",value:function(){var t=this;if(!this.fragmentArr){for(var e=[],i=0;100>i;i++){var o=i*Math.PI*2/100,n={x:128*Math.sin(o),y:100*Math.cos(o)};e[i]=n}for(var s=[[[15,60],[25,75],[10,65],[40,60],[15,60],[40,60],[0,75],[30,70]],[[10,65],[30,70],[15,60],[25,75],[0,75],[35,65],[20,55],[35,65]],[[10,65],[30,70],[20,55],[25,75],[5,70],[25,75],[0,75],[25,75]],[[0,75],[30,70],[20,55],[30,70],[10,65],[25,75],[15,60],[45,55]],[[15,60],[30,70],[0,75],[25,75],[10,65],[35,65],[15,60],[35,65]],[[10,65],[35,65],[15,60],[30,70],[5,70],[25,75],[20,55],[40,60]],[[0,75],[30,70],[10,65],[35,65],[10,65],[35,65],[5,70],[40,60]],[[20,55],[30,70],[0,75],[40,60],[10,65],[30,70],[15,60],[25,75]],[[20,55],[45,55],[15,60],[25,75],[10,65],[35,65],[5,70],[35,65]],[[15,60],[45,55],[5,70],[25,75],[10,65],[45,55],[0,75],[30,70]]],a=s[Math.floor(10*Math.random())],r=0;a.length>r;r++){var h=a[r];!function(t,i){var o=e[t];e[t]=e[i],e[i]=o}(h[0],h[1])}var l=this.BodyUtil.BodyFromArray(e,null,null);if(l){for(var u=l.shapes,c=u.get_length(),d=[],y=0;c>y;y++)!function(e){var i=u.at(e),o=i.get_localVerts(),n=[];o.foreach(function(t){n.push(t)});var s=new p["default"](t.paramObj,[n],11832939);s.canCurSelect=!1,s.lineColor=11832939,s.noRenderSelected=!0,d.push(s)}(y);this.fragmentPoints=e,this.fragmentArr=d}}}},{key:"fragment",value:function(){for(var t=this,e=new l.Point(this.body.posx,this.body.posy),i=this.fragmentArr,o=0;i.length>o;o++){var n=i[o];n.allowSave=!1,this.getMain().addEquipmentChild(n,e);var s=f.get(1,1);s.set_length(1500),s.set_angle(2*Math.PI*Math.random()),n.body.set_velocity(s)}this.main.dispatchEvent("changePanelStatusEvent",{commandType:1}),this.removeEquipment(this),this.timeId=setTimeout(function(){for(var e=0;i.length>e;e++){t.removeEquipment(i[e])}},5e3)}},{key:"removeEquipment",value:function(t){t.body&&t.body.userData&&(t.body.userData.dragManager&&t.body.userData.dragManager.func_touchEnd(new l.Point),t.getMain().removeEquipment(t))}},{key:"changeCanBroken",value:function(t){if(this.canBroken=t.checked)this.calculateFragmentArr();else for(var e=0;this.cracks.length>e;e++){var i=this.cracks[e];i.visible=!1,i.hurt1=0,i.hurt2=0}}},{key:"getConf",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push(this.ComponentProperty.getSwitch(this.language.getLocaleStr("can_smash"),this.canBroken,this.changeCanBroken,this)),t}}]),e}(c["default"]);g.injected=!1,e["default"]=g;var b=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));i.id=t,i.hurt1=0,i.hurt2=0,i.opsite=null;var o=PIXI.Texture.fromFrame("Egg/crack0"+(t+1)+".png"),a=new PIXI.Sprite(o);i.addChild(a),i.sp=a,i.maskShape=new PIXI.Graphics,i.addChild(i.maskShape),i.sp.mask=i.maskShape,i.w=a.width,i.h=a.height;var r=[[-127,-46],[-114,-84],[-51,-98],[-9,-94],[-7,-45],[-7,-3],[-37,-2],[-95,1]];return a.x=r[t][0],a.y=r[t][1],i.startPositions=[[0,.5],[0,0],[.5,0],[1,0],[1,.5],[1,1],[.5,1],[0,1]],i.startPosition={x:a.x+i.w*i.startPositions[t][0],y:a.y+i.h*i.startPositions[t][1]},i.endPosition={x:a.x+i.w*(1-i.startPositions[t][0]),y:a.y+i.h*(1-i.startPositions[t][1])},i}return a(e,t),r(e,[{key:"addHurt",value:function(t){this.visible=!0,t>0?(this.hurt1+=t)>100&&(this.opsite.addHurt(100-this.hurt1),this.hurt1=100):(this.hurt2-=t)>100&&(this.hurt2=100),this.maskShape.clear();var e=f.get(this.startPosition.x,this.startPosition.y),i=f.get(this.endPosition.x,this.endPosition.y);this.drawHurt(e,i,this.hurt1),this.drawHurt(i,e,this.hurt2)}},{key:"drawHurt",value:function(t,e,i){var o=e.sub(t),n=o.get_length();o=o.unit();var s=t.add(o.mul(n*i/100)),a=f.get(-o.get_y(),o.get_x());a=a.mul(Math.sqrt(this.w*this.w+this.h*this.h));var r=t.add(a),h=s.add(a),l=s.sub(a),u=t.sub(a);this.maskShape.beginFill(0,1),this.maskShape.moveTo(r.get_x(),r.get_y()),this.maskShape.lineTo(h.get_x(),h.get_y()),this.maskShape.lineTo(l.get_x(),l.get_y()),this.maskShape.lineTo(u.get_x(),u.get_y()),this.maskShape.endFill()}},{key:"getHurt",value:function(){return this.hurt1+this.hurt2}}]),e}(PIXI.Sprite)},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function B(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:B(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(1097),p=o(d),y=i(454),f=o(y),g=i(1095),b=o(g),v=i(1099),_=o(v),m=i(678),x=o(m),w=i(449),k=o(w),P=void 0,O=void 0,T=void 0,C=function(t){function e(t,i,o){n(this,e);var a=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return P=a.phy.nape,O=P.phys.BodyType,T=P.shape.Polygon,a.skinName="HpaperTicker",a.hao=new PIXI.Text("",{font:"25px Arial",fill:0}),a.paperXiao=null,a.paperBig=null,a.bindTicker=null,a.isUsed=!1,a.isBigPaper=!1,a.parentPaper=null,a.big_scale=1,a.line_h=45,a.kdLabel=null,a.kdxSh=null,a.dotCon=null,a.isfreeHand=!1,a.sele_zhao=null,a.sele_biao=null,a.smallState=!0,a.l_r_limit=!1,a.left_index=0,a.right_index=0,a.bqAry=[],a.dotAry=[],a.bigW=1680,a.bigH=64,a.hao_index=-1,a.ruler_move=!1,a.startP=null,a.oldP=null,a.paperXiaoW=679,a.isClick=!1,a.scalePaper=null,a.tagHis={},a.leftBiaoOff=0,a.rightBiaoOff=0,a.noRenderSelected=!0,a.startIndex=0,a.interval_scale=new b["default"](t),a.total_scale=new _["default"](t),a.total_scale.skinName=a.skinName,i&&(a.menu=i,a.isBigPaper=!0,a.parentPaper=o),a}return a(e,t),r(e,[{key:"init",value:function(){this.removeChild(this.tt),this.tt=null,this.bg||(this.bg=PIXI.Sprite.fromFrame(this.skinName+"/Bitmap 1"),l.M.alignPivot(this.bg),this.addChild(this.bg),this.big=PIXI.Sprite.fromFrame(this.skinName+"/big"),this.addChild(this.big),l.M.alignPivot(this.big),this.leftBiao=PIXI.Sprite.fromFrame(this.skinName+"/Bitmap 2"),this.rightBiao=PIXI.Sprite.fromFrame(this.skinName+"/Bitmap 2"),this.addChild(this.leftBiao),this.addChild(this.rightBiao),l.M.alignPivot(this.leftBiao,"center","top"),l.M.alignPivot(this.rightBiao,"center","top")),this._width=this.bg.width,this._height=this.bg.height,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_sensorEnabled_at(0,!0),this.paperXiao=this.bg,this.paperBig=this.big,this.leftBiao.visible=this.rightBiao.visible=this.paperBig.visible=!1,this.body.set_type(O.get_KINEMATIC()),this.addCbType(this.CbTypeStr.H_PAPER_TICKER),this.initListener()}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.visible&&(this.isBigPaper?this.parentPaper&&this.parentPaper.body&&!this.parentPaper.smallState&&this.parentPaper.body.set_position(this.body.get_position()):this.scalePaper&&this.scalePaper.body&&this.smallState&&this.scalePaper.body.set_position(this.body.get_position()),-1!=this.hao_index&&this.showNumber())}},{key:"initListener",value:function(){var t=this;this.addEventListener(k["default"].END,function(){t.hpaperDragEnd()}),this.menu||(this.menu=new p["default"](this.skinName,this.paramObj),this.menu.menuChangeFunc=function(e){t.paperMenuChange(e)},this.menu.addEventListener(f["default"].TICKER_PAPER_MENU_CHANGE,this.menu.menuChangeFunc))}},{key:"setSpeed",value:function(t){this.interval_scale.isSpeed=t,this.total_scale.isSpeed=t}},{key:"showFreeOption",value:function(){this.isfreeHand=!0,this.interval_scale.visible=!1,this.total_scale.visible=!1,this.changduChange(),this.showHideTag(!0)}},{key:"showStandard",value:function(){this.isfreeHand=!1,this.interval_scale.visible=!0,this.total_scale.visible=!0,this.changduChange(),this.showHideTag(!1)}},{key:"showHideTag",value:function(t){for(var e in this.tagHis)this.tagHis[e].visible=t}},{key:"paperMenuChange",value:function(t){var e=this.visible?this:this.scalePaper;switch(t){case this.language.getLocaleStr("speed"):e.setSpeed(!0),e.drawIntervalScale();break;case this.language.getLocaleStr("pos_shift"):e.setSpeed(!1),e.drawIntervalScale();break;case this.language.getLocaleStr("hide"):e.showFreeOption(),e.menu.showTwoBtn(!0),e.sele_zhao.y=0,e.sele_zhao.scale.y=.5,e.total_scale.removeChildren();break;case this.language.getLocaleStr("show"):e.showStandard(),e.menu.showTwoBtn(!1),e.sele_zhao.scale.y=1,e.sele_zhao.y=-31.5,e.drawIntervalScale();break;case this.language.getLocaleStr("enlarge"):if(this.left_index>this.right_index)return;this.smallState=!1,this.scaleBitPaper(),this.total_scale.removeChildren(),this.body.wake(),this.scalePaper.body.wake();break;case this.language.getLocaleStr("reduction"):if(this.left_index>this.right_index)return;this.smallState=!0,this.scalePaper.visible=!1,this.scalePaper.body.userData.noDrag=!0,this.visible=!0,this.body.userData.noDrag=!1,this.total_scale.removeChildren(),this.drawIntervalScale(),this.paperMenuChange(this.menu.state),this.body.wake(),this.scalePaper.body.wake()}}},{key:"scaleBitPaper",value:function(){this.visible=!1,this.body.userData.noDrag=!0;var t=this.dotAry.slice(this.left_index,this.right_index+1),i=void 0;i=this.left_index>0?this.dotAry[this.left_index-1].x:0,null===this.scalePaper?(this.scalePaper=new e(this.paramObj,this.menu,this),this.scalePaper.skinName=this.skinName,this.parent.addChild(this.scalePaper),this.scalePaper.init(),this.scalePaper.startIndex=this.left_index,this.scalePaper.body.set_position(this.body.get_position()),this.scalePaper.body.set_position(this.body.get_position()),this.scalePaper.initPaperView(!0),this.setThisTouch(this.scalePaper),this.scalePaper.setSpeed(this.total_scale.isSpeed),this.scalePaper.showScaleDot(t,i)):(this.scalePaper.startIndex=this.left_index,this.scalePaper.setSpeed(this.total_scale.isSpeed),this.scalePaper.showScaleDot(t,i),this.scalePaper.visible=!0,this.visible=!1),this.scalePaper.body.userData.noDrag=!1,this.scalePaper.paperMenuChange(this.menu.state)}},{key:"delFreeTag",value:function(){for(var t in this.tagHis){var e=this.tagHis[t];e.parent.removeChild(e)}this.tagHis={}}},{key:"showScaleDot",value:function(t,e){this.visible=!0,this.isUsed=!0,this.dotCon.removeChildren(),this.dotAry.length=0,this.delFreeTag(),this.big_scale=(this.paperBig.width-180)/(t[t.length-1].x-t[0].x);var i=t[0].x*this.big_scale+.5*this.paperBig.width-90,o=void 0;for(o=0;t.length>o;o++){var n=new l.Point(t[o].x*this.big_scale-i,t[o].y),s=PIXI.Sprite.fromFrame(this.skinName+"/paperDot");s.x=n.x,s.y=n.y,this.dotAry.push(n),this.dotCon.addChild(s)}this.leftBiao.x=this.dotAry[0].x,this.rightBiao.x=this.dotAry[this.dotAry.length-1].x,this.dotAry.length>15?(this.interval_scale.step=5,this.total_scale.step=5):(this.interval_scale.step=1,this.total_scale.step=1),this.paperXiao.visible=!1,this.interval_scale.scale_num=this.big_scale,this.interval_scale.y=-this.paperBig.height,this.addChild(this.interval_scale),this.total_scale.y=10,this.total_scale.scale_num=this.big_scale,this.addChildAt(this.total_scale,2),0==this.startIndex?(this.interval_scale.left_pre=0,this.total_scale.left_pre=0):(this.interval_scale.left_pre=e*this.big_scale-i,this.total_scale.left_pre=e*this.big_scale-i),this.changduChange(),this.biaoMove(0,0),this.firstshowbiao()}},{key:"biaoMove",value:function(t,e){this.leftBiao.x+=t,this.rightBiao.x+=e}},{key:"firstshowbiao",value:function(){this.addChild(this.leftBiao),this.addChild(this.rightBiao),this.sele_biao=this.leftBiao,this.biaoXf(this.leftBiao.x,this.leftBiao.y,!1),this.sele_biao=this.rightBiao,this.biaoXf(this.rightBiao.x,this.rightBiao.y,!1),this.sele_biao=null}},{key:"initPaperView",value:function(t){this.dotCon=new PIXI.Sprite,this.addChild(this.dotCon),this.paperXiao.visible=!1,this.paperBig.visible=!0,this.addChildAt(this.paperBig,0);var e=new T(T.box(this.paperBig.width/this.paperBig.scale.x,this.paperBig.height/this.paperBig.scale.x),this.material);e.set_sensorEnabled(!0),this.body.shapes.clear(),this.body.add(e),t&&this.initRulerView()}},{key:"hpaperDragEnd",value:function(){var t=this;if(!this.isUsed){var e=this.getChildrenByClass("HTickerTimer"),i=void 0;for(i=0;e.length>i;i++)!function(){var o=e[i],n=o.toGlobalView(new l.Point,o);if(t.hitTestViewPoint(t,n)&&!o.havePaper&&!o.powerOpen){var s=function h(t){o.removeEventListener(f["default"].NEI_BU_LINEJOINT_BREAK,h),r.neibuPaperJointBreak.call(r,t)};o.havePaper=t,t.bindTicker=o,t.allowSave=!1,t.visible=!1,t.removeBodyFromSpace(t.body);var a=t.toGlobal(new l.Point);a=o.toLocal(a),o.func_showPaper(a.x),o.addEventListener(f["default"].NEI_BU_LINEJOINT_BREAK,s);var r=t}}()}}},{key:"neibuPaperJointBreak",value:function(t){var e=this,i=t.pos;this.visible=!0,this.allowSave=!0,null===this.body.space&&(this.addBodyToSpace(this.body),this.body.set_type(O.get_KINEMATIC()),this.body.wake()),this.body.set_position(i),this.bindTicker&&(this.bindTicker.havePaper=null,this.bindTicker=null);var o=t.dat.concat(),n=t.a;o.length>0&&(this.isUsed=!0,this.dotCon=new PIXI.Sprite,this.addChild(this.dotCon),this.showSmallDot(o),this.body.rotation=Math.PI,this.addChildAt(this.paperBig,0),this.paperBig.alpha=0,this.paperBig.width=this.paperXiaoW,this.paperBig.height=this.paperXiao.height,TweenMax.to(this.body,.7,{rotation:0,onComplete:function(){if(e.paperXiao.visible=!1,e.paperBig.visible=!0,e.paperBig.alpha=1,e.dotCon.removeChildren(),-1!=n){var t=void 0;for(t=1;o.length>t;t++){var i=o[0].x-.5*n*Math.pow(.02*t,2)+.001+.002*Math.random();if(.5*-e.paperXiaoW>i){o=o.slice(0,t-1);break}o[t].x=i}}e.showDot(o),e.dotCon.scale.x=e.paperBig.scale.x,e.dotCon.scale.x=e.paperBig.scale.y;var s=new T(T.box(e.paperBig.width/e.paperBig.scale.x,e.paperBig.height/e.paperBig.scale.y),e.material);s.set_sensorEnabled(!0),e.body.shapes.clear(),e.body.add(s),TweenMax.to(e.paperBig.scale,.5,{x:1,y:1,onUpdate:function(){e.hadDestory||(e.dotCon.scale.x=e.paperBig.scale.x,e.dotCon.scale.x=e.paperBig.scale.y)},onComplete:function(){e.hadDestory||e.showRuler()}})}}))}},{key:"showDot",value:function(t){e.uidArr.push(this.UID);var i=null;i=this.paperBig.width/this.paperBig.scale.x/this.paperXiaoW;var o=void 0;for(o=0;t.length>o;o++){var n=PIXI.Sprite.fromFrame(this.skinName+"/paperDot");n.x=t[o].x*i*-1,n.y=t[o].y,this.dotAry.push(new l.Point(n.x,n.y)),this.dotCon.addChild(n)}this.interval_scale.y=1.5*-this.paperBig.height,this.addChild(this.interval_scale),this.total_scale.y=10,this.addChildAt(this.total_scale,2),this.showNumber()}},{key:"showNumber",value:function(){this.hao.parent||(this.addChild(this.hao),this.hao.x=.5*-this.bigW+20,this.hao.y=-10);var t=e.uidArr.indexOf(this.UID)+1;t-1!=this.hao_index&&(this.hao_index=t-1,this.hao.text=e.num_list[t+""])}},{key:"showRuler",value:function(){this.initRulerView(),this.changduChange(),this.sele_biao=this.leftBiao,this.biaoXf(this.leftBiao.x,this.leftBiao.y,!1),this.sele_biao=this.rightBiao,this.biaoXf(this.rightBiao.x,this.rightBiao.y,!1),this.sele_biao=null,this.leftBiao.visible=!0,this.rightBiao.visible=!0,this.setThisTouch(this),this.dispatchEvent(f["default"].CAN_GET_SPEEDDATA,this.getPaperData())}},{key:"getPaperData",value:function(){return{velocity:this.total_scale.data,acceleration:this.interval_scale.current_a,displacement:this.total_scale.displacement}}},{key:"setThisTouch",value:function(t){l.M.addTouch(t,{begin:function(t){if(this.visible)return this.startP=this.getMouseXY(t),this.oldP=this.startP.clone(),this.isClick=!0,this.hitTestViewPoint(this.leftBiao,this.startP)?(this.body.userData.noDrag=!0,void(this.sele_biao=this.leftBiao)):this.hitTestViewPoint(this.rightBiao,this.startP)?(this.body.userData.noDrag=!0,void(this.sele_biao=this.rightBiao)):void(this.sele_zhao.parent&&this.hitTestViewPoint(this.sele_zhao,this.startP)&&(this.body.userData.noDrag=!0,this.menu.parent&&this.hitTestViewPoint(this.menu,this.startP)||(this.ruler_move=!0)))},move:function(t){if(this.visible){var e=this.getMouseXY(t);if(l.Point.distance(this.startP,e)>10&&(this.isClick=!1),this.sele_biao&&(this.sele_biao.x+=e.x-this.oldP.x,this.sele_biao==this.leftBiao?this.rightBiao.x-50>this.sele_biao.x?this.l_r_limit=!1:(this.sele_biao.x=this.rightBiao.x-50,this.l_r_limit=!0):this.sele_biao==this.rightBiao&&(this.sele_biao.x>this.leftBiao.x+50?this.l_r_limit=!1:(this.sele_biao.x=this.leftBiao.x+50,this.l_r_limit=!0)),this.sele_biao.x=.5*-this.paperBig.width>this.sele_biao.x?.5*-this.paperBig.width:this.sele_biao.x,this.sele_biao.x=this.sele_biao.x>.5*this.paperBig.width?.5*this.paperBig.width:this.sele_biao.x,this.sele_zhao.x=this.leftBiao.x,this.sele_zhao.width=Math.abs(this.rightBiao.x-this.leftBiao.x),this.changduChange()),this.ruler_move){var i=e.x-this.oldP.x;this.leftBiao.x+=i,this.rightBiao.x+=i,this.sele_zhao.x+=i,.5*-this.paperBig.width>this.leftBiao.x||.5*-this.paperBig.width>this.rightBiao.x?(this.leftBiao.x-=i,this.rightBiao.x-=i,this.sele_zhao.x-=i):(this.leftBiao.x>.5*this.paperBig.width||this.rightBiao.x>.5*this.paperBig.width)&&(this.leftBiao.x-=i,this.rightBiao.x-=i,this.sele_zhao.x-=i),this.changduChange()}this.oldP=e}},end:function(t){if(this.body.userData.noDrag=!1,this.visible){var e=this.getMouseXY(t),i=this.hitTestViewPoint(this.sele_zhao,e),o=!1;this.menu.parent&&(o=this.hitTestViewPoint(this.menu,e));if(!o&&!i&&this.isfreeHand&&this.isClick){var n=this.getMain(),s=this.getMinPo(this.toLocal(this.startP,n.view),!0);if(s>=0&&s>=this.left_index&&this.right_index>=s)if(null==this.tagHis[s]){var a=new x["default"](this.paramObj,this.skinName);this.addChild(a),a.x=this.dotAry[s].x,a.y=.5*-this.paperBig.height-35;var r=Math.abs(this.dotAry[s].x-this.dotAry[this.left_index].x)/this.NapeConst.SCALE_PAPER_SPACE*this.NapeConst.PAPER_VALUE_FACTOR;r/=this.interval_scale.scale_num,a.label(l.M.getNumJie(r,2)),a.switchView(),this.tagHis[s]=a,this.isHitOtherTag()}else{var h=this.tagHis[s];h.parent&&this.removeChild(h),delete this.tagHis[s]}}this.sele_biao&&(this.l_r_limit||this.biaoXf(this.sele_biao.x,this.sele_biao.y,!1)),this.ruler_move&&(this.isClick?(null==this.menu.parent&&(this.addChild(this.menu),this.menu.addTouch()),this.menu.x=this.sele_zhao.x+.5*this.sele_zhao.width):(this.sele_biao=this.leftBiao,this.biaoXf(this.leftBiao.x,this.leftBiao.y,!1),this.sele_biao=this.rightBiao,this.biaoXf(this.rightBiao.x,this.rightBiao.y,!1),this.sele_biao=null)),this.isClick=!1,this.sele_biao=null,this.ruler_move=!1}}},t)}},{key:"isHitOtherTag",value:function(){var t=void 0,e=void 0,i=0;for(i=0;this.dotAry.length>i;i++)if(this.tagHis[i]){if(this.tagHis[i].isHeight){t=null,e=null;continue}if(null==t){t=this.tagHis[i];continue}null==e&&(e=this.tagHis[i]),Math.abs(e.x-t.x)<t.width?(e.lineHei(),t=null,e=null):(t=e,e=null)}}},{key:"biaoXf",value:function(t,e,i){var o=void 0;o=i?this.toLocal(new l.Point(t,e)):new l.Point(t,e);var n=this.getMinPo(o),s=this.left_index;this.sele_biao===this.leftBiao?this.left_index=n:this.sele_biao===this.rightBiao&&(this.right_index=n)>this.dotAry.length&&(this.right_index=this.dotAry.length),s!==this.left_index&&this.delFreeTag(),this.sele_biao.x=this.dotAry[n].x,this.sele_zhao.x=this.leftBiao.x,this.sele_zhao.width=Math.abs(this.rightBiao.x-this.leftBiao.x),this.changduChange(),this.drawIntervalScale()}},{key:"drawIntervalScale",value:function(){this.interval_scale.draw(this.dotAry,this.left_index,this.right_index),this.total_scale.skinName=this.skinName,this.total_scale.draw(this.dotAry,this.left_index,this.right_index)}},{key:"getMinPo",value:function(t,e){var i=1e4,o=0,n=void 0;for(n=0;this.dotAry.length>n;n++){var s=l.Point.distance(t,this.dotAry[n]);i>s&&(i=s,o=n)}return e&&i>30?-1:o}},{key:"changduChange",value:function(){if(!this.isfreeHand)return this.kdxSh.clear(),void(this.kdLabel.text="");this.kdxSh.clear(),this.kdxSh.lineStyle(2,3904494);var t=Math.abs(this.leftBiao.x-this.rightBiao.x),e=t/this.NapeConst.SCALE_PAPER_SPACE*this.NapeConst.PAPER_VALUE_FACTOR;e/=this.big_scale,this.kdLabel.text=e.toFixed(2)+"cm",l.M.alignPivot(this.kdLabel),this.kdLabel.y=this.line_h;if(200>t)return void(this.kdLabel.x=this.leftBiao.x+.5*t);this.rightBiao.x>this.leftBiao.x?(this.kdxSh.moveTo(this.leftBiao.x,this.line_h),this.kdLabel.x=this.leftBiao.x+.5*t,this.kdxSh.lineTo(this.leftBiao.x+.5*t-100,this.line_h),this.kdxSh.moveTo(this.leftBiao.x+.5*t+100,this.line_h),this.kdxSh.lineTo(this.rightBiao.x,this.line_h)):(this.kdxSh.moveTo(this.rightBiao.x,this.line_h),this.kdLabel.x=this.rightBiao.x+.5*t,this.kdxSh.lineTo(this.rightBiao.x+.5*t-100,this.line_h),this.kdxSh.moveTo(this.rightBiao.x+.5*t+100,this.line_h),this.kdxSh.lineTo(this.leftBiao.x,this.line_h))}},{key:"initRulerView",value:function(){this.sele_zhao=PIXI.Sprite.fromFrame(this.skinName+"/yinying"),this.addChild(this.sele_zhao),this.sele_zhao.alpha=.5,this.kdxSh=new PIXI.Graphics,this.addChild(this.kdxSh),this.kdLabel=new PIXI.Text("",{font:"25px Arial",fill:3904494,align:"center"}),this.addChild(this.kdLabel),this.sele_zhao.x=this.leftBiao.x=this.leftBiaoOff-200,this.sele_zhao.y=-31.5,this.rightBiao.x=this.rightBiaoOff+200,this.leftBiao.y=this.rightBiao.y=0,this.sele_zhao.width=this.rightBiao.x-this.leftBiao.x,this.leftBiao.visible=!0,this.rightBiao.visible=!0}},{key:"showSmallDot",value:function(t){var e=void 0;for(e=0;t.length>e;e++){var i=PIXI.Sprite.fromFrame(this.skinName+"/paperDot");i.x=t[e].x,i.y=t[e].y,this.dotCon.addChild(i)}}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return this.dotAry.length>0&&(t.datAry=this.dotAry.concat()),t.nary=e.uidArr,t}},{key:"setData",value:function(t){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.nary&&(e.uidArr=t.nary.concat()),t.datAry){var i=t.datAry;this.isUsed=!0,this.initPaperView(!1),this.dotAry=i;var o=0;for(o=0;i.length>o;o++){var n=PIXI.Sprite.fromFrame(this.skinName+"/paperDot");n.x=i[o].x,n.y=i[o].y,this.dotCon.addChild(n)}this.addChild(this.interval_scale),this.total_scale.y=10,this.addChildAt(this.total_scale,2),this.showRuler(),this.paperXiao.visible=!1,this.showNumber(),this.interval_scale.y=-this.bigH}}},{key:"removed",value:function(){this.menu.removeEventListener(f["default"].TICKER_PAPER_MENU_CHANGE,this.menu.menuChangeFunc),delete this.menu.menuChangeFunc,this.menu.removed();var t=e.uidArr.indexOf(this.UID);0>t||e.uidArr.splice(t,1),this.scalePaper&&this.BodyUtil.destoryBody(this.scalePaper.body),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"backgroundColorChange",value:function(t){this.interval_scale.backgroundColorChange(t),this.total_scale.backgroundColorChange(t)}}]),e}(c["default"]);C.num_list={1:"①",2:"②",3:"③",4:"④",5:"⑤",6:"⑥",7:"⑦",8:"⑧",9:"⑨",10:"⑩",11:"⑪",12:"⑫",13:"⑬",14:"⑭",15:"⑮",16:"⑯",17:"⑰",18:"⑱",19:"⑲",20:"⑳"},C.uidArr=[],e["default"]=C},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function f(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:f(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0,y=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.phys.Material,p=c.geom.Vec2,y=c.shape.HockShapeBase,i.classType="IrregularPlasticplate",i.points=[{x:-199,y:-32},{x:-139,y:118},{x:170,y:118},{x:199,y:45},{x:115,y:-117},{x:-155,y:-117}],i.hockArr=[],i.material=new d(.3,.1,1.5,.5),i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this);for(var t=1;7>t;t++){var i=this.bg["h"+t],o=new y(15);o.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(o);o.translate(p.get(i.x,i.y)),o.addCbtype(this.CbTypeStr.PLASTICPLATE_HOOK),o.createListener(this.CbTypeStr.PLASTICPLATE_HOOK,this.CbTypeStr.CEIL_HOOK),this.addTweenQuan(o);var n=new PIXI.Graphics;o.get_userData().line=n,this.addChild(n),this.hockArr.push(o)}this.body.align()}},{key:"removed",value:function(){for(var t=0;this.hockArr.length>t;t++)this.hockArr[t].dragToolClick(),this.hockArr[t].dispose();r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this);for(var t=!1,i=this.getMain().view,o=0;this.hockArr.length>o;o++){var n=this.hockArr[o];if(n.get_userData().useing){t=!0;var s=n.get_userData().line;s.clear(),s.lineStyle(2,16711680);var a=this.body.localPointToWorld(n.get_localCOM()),l=s.toLocal(new h.Point(a.get_x(),a.get_y()),i);for(s.moveTo(l.x,l.y);;)if(a.addeq(p.get(0,5)),!this.body.contains(a))break;l=s.toLocal(new h.Point(a.get_x(),a.get_y()),i),s.lineTo(l.x,l.y)}}if(t){1!=this.body.userData.handJointFrequency&&(this.body.userData.handJointFrequency=1);var u=this.body.velocity;this.body.velocity=p.get(.9*u.get_x(),u.get_y())}else 10!=this.body.userData.handJointFrequency&&(this.body.userData.handJointFrequency=10)}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function f(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:f(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(543),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0,y=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.shape.Polygon,p=c.geom.Vec2,y=c.shape.HockShapeBase,i.boty=125.5,i.totalRange=25,i.poshapexy={x:92,y:-86},i.pouringY=-43.5,i.leftbotP={x:-59,y:129.45},i.rightbotP={x:59,y:129.45},i.lefttopP={x:-76,y:i.pouringY},i.righttopP={x:76,y:i.pouringY},i.toplen=0,i.botlen=0,i.fullS=0,i.tophock=null,i.selfmass=4,i.botB=null,i.onlyDynamic=!0,i.totalArea=10,i.valueTxtxy={x:90,y:-50},i.fullvects=[p.get(i.leftbotP.x,i.leftbotP.y),p.get(i.rightbotP.x,i.rightbotP.y),p.get(i.righttopP.x,i.pouringY),p.get(i.lefttopP.x,i.pouringY)],i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.leftbotP={x:-59,y:129.45},this.rightbotP={x:59,y:129.45},this.pouringY=-43.5,this.boty=125.5,this.lefttopP={x:-76,y:this.pouringY},this.righttopP={x:76,y:this.pouringY},this.poshape&&this.body.remove(this.poshape),this.body.userData.dragtranslate=!1,this.setUnitMl(),this.body.set_isBullet(!0),this.body.set_allowRotation(!1),this.inithock(),this.valueTxt=new PIXI.Text("",{font:"25px Arial",fill:this.lineColor}),this.addChild(this.valueTxt),this.valueTxt.x=this.valueTxtxy.x,this.valueTxt.y=this.valueTxtxy.y,this.valueTxt.visible=this.globalConfig.SHOWEQUVALUE,this.changeLiquidVolume({showValue:"0mL"})}},{key:"removed",value:function(){this.tophock.dragToolClick(),this.tophock.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"inithock",value:function(){this.tophock=new y(15),this.tophock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.tophock),this.tophock.translate(p.get(0,-133)),this.tophock.addCbtype(this.CbTypeStr.LITTLEPAIL_HPCK),this.tophock.createListener(this.CbTypeStr.LITTLEPAIL_HPCK,[this.CbTypeStr.SPRING_HOCK,this.CbTypeStr.CEIL_HOOK]),this.addTweenQuan(this.tophock)}},{key:"setUnitMl",value:function(){this.toplen=2*this.righttopP.x,this.botlen=2*this.rightbotP.x,this.fullS=(this.toplen+this.botlen)*(this.leftbotP.y-this.lefttopP.y)/2,this.unitMl=this.fullS/this.totalRange}},{key:"waterFlooding",value:function(t,e){var i=t*this.unitMl,o=this.liquidArea;this.liquidArea+=i,e&&this.refreshDensity(e,o,i)}},{key:"getCurtMl",value:function(t){return t?t/this.unitMl:(this.liquidArea+this.overArea)/this.unitMl}},{key:"drawScale",value:function(){}},{key:"getAreaFromMl",value:function(t){return t*this.unitMl}},{key:"createBodyShape",value:function(){var t=new d(d.box(15,182));this.body.add(t);var i=new d(d.box(15,182));this.body.add(i),this.botB=new d(d.box(143,8)),this.body.add(this.botB),t.rotate(-.1),i.rotate(.1),t.translate(p.get(-75,40)),i.translate(p.get(75,40)),this.botB.translate(p.get(0,129.5)),this.handShape=new d(this.fullvects),this.body.add(this.handShape),this.handShape.set_sensorEnabled(!0),this.totalArea=t.get_area()+i.get_area()+this.botB.get_area(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createBodyShape",this).call(this)}},{key:"getTrueArea",value:function(t){return this.getAreaFromMl((this.totalRange+5)*(t/this.totalArea))}},{key:"bottomAddCbtype",value:function(){0>=arguments.length||arguments[0]===undefined||arguments[0]?this.botB.get_cbTypes().add(this.CbTypeStr.CONTAINER_BOTTOM):this.botB.get_cbTypes().remove(this.CbTypeStr.CONTAINER_BOTTOM)}},{key:"changeLiquidVolume",value:function(t){this.liquidArea=this.unitMl*h.M.getNumStr(t.showValue)}},{key:"dragBegin",value:function(t){}},{key:"dragEnd",value:function(t){}},{key:"update",value:function(){if(this.calcuMass(),0>=this.liquidArea)return this.liquid.get_body()&&(this.body.remove(this.liquid),this.bottomAddCbtype()),this.liquidShape.clear(),void(this.valueTxt.text="0.0mL");this.liquid.get_body()||this.bottomAddCbtype(!1),this.calculation();var t=this.fullvects.slice(0,2),e=this.liquidArea+this.overArea,i=0;if(e>this.fullS)i=e-this.fullS,t=this.fullvects;else{var o=Math.atan2(this.leftbotP.y-this.lefttopP.y,this.leftbotP.x-this.lefttopP.x),n=Math.sqrt(4*e/Math.tan(o)+this.botlen*this.botlen),s=Math.tan(o)*(n-this.botlen)/2,a=n/2,r=this.rightbotP.y-s;t.push(p.get(a,r)),t.push(p.get(-a,r))}this.createLiquid(t),this.drawLiquid(t),i>this.liquidArea&&(i=this.liquidArea),this.liquidArea-=i,this.valueTxt.text=h.M.getNumJie(this.getCurtMl(),1)+"mL"}},{key:"freshEquipShows",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"freshEquipShows",this).call(this,t),this.valueTxt.visible=t}},{key:"getConf",value:function(){var t=this,i=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return i.confArr.push(this.getButton(["",this.getLocaleStr("empty","清空"),function(){t.liquidArea=0}])),i}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function c(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:c(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.fm=.2,i.elasticity=.5,i.radius=58,i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.bullet=!0,this.BodyUtil.setShapeMaterial(this.body.shapesAt(0),{density:7.8,elasticity:this.elasticity}),this.changeMass(58==this.radius?{showValue:82.7}:{showValue:20.3})}},{key:"changeFriction",value:function(t){var e=h.M.getNumStr(t.showValue)-0;this.material.set_dynamicFriction(e),this.material.set_staticFriction(e)}},{key:"changeElasticity",value:function(t){this.elasticity=h.M.getNumStr(t.showValue)-0,this.material.set_elasticity(h.M.getNumStr(t.showValue)-0)}},{key:"changeDensity",value:function(t){this.material.set_density(h.M.getNumStr(t.showValue)-0),this.showToolDatas()}},{key:"changeMass",value:function(t){var e=h.M.getNumStr(t.showValue)-0;this.body.mass=e,this.material.set_density(e/this.BodyUtil.getBodyArea(this.body)*1e3),this.showToolDatas()}},{key:"changeForceAnalysis",value:function(t){(this.openF_analysis=t.checked)||this.removeForceAnalysis()}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.analysis=this.openF_analysis,t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),1==t.analysis&&this.changeForceAnalysis({checked:!0})}},{key:"getMaxMass",value:function(){var t=this.body.getArea();return h.M.getNumJie(13.6*t*.001,1)}},{key:"getMinMass",value:function(){var t=this.body.getArea();return h.M.getNumJie(.7*t*.001,1)}},{key:"getConf",value:function(){var t={};t.confArr=[];var e=this;return t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("density"),!0,"g/cm³",13.6,.7,{get value(){return e.body?h.M.getNumJie(e.body.getDensity(),1):null},set value(t){e.material.set_density(t)}},.1,this.changeDensity,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("mass"),!0,"g",this.getMaxMass(),this.getMinMass(),{get value(){return e.body?h.M.getNumJie(e.body.mass,1):null},set value(t){e.body.mass=t}},.1,this.changeMass,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("roughness"),!0,"",1,0,this.getDynamicFriction(),.1,this.changeFriction,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("elastic_coefficient"),!0,"",1,0,this.getBodyElasticity(),.1,this.changeElasticity,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("force_analysis"),this.openF_analysis,this.changeForceAnalysis,this)),t}},{key:"getTipMess",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.language.getLocaleStr("density")+": "+h.M.getNumJie(this.body.getDensity(),1)+"g/cm³\n    "+this.language.getLocaleStr("mass")+": "+h.M.getNumJie(this.body.get_mass(),1)+"g\n    "+this.language.getLocaleStr("elastic_coefficient")+": "+this.getBodyElasticity()+"\n    "}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function T(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:T(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(449),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0,m=void 0,x=void 0,w=void 0,k=void 0,P=void 0,O=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.phys.Material,g=y.shape.Polygon,b=y.constraint.WeldJoint,v=y.geom.Vec2,_=y.callbacks.CbType,m=y.callbacks.CbEvent,x=y.callbacks.InteractionType,w=y.callbacks.InteractionListener,k=y.dynamics.InteractionGroup,P=y.callbacks.PreListener,O=y.shape.HockShapeBase,i.material_left=new f(1,1,1,1,0),i.material_right=new f(1,1,1,1,0),i.level=16,i.curtMass=100,i.unitdw=2.0196403595307,i.shade=null,i.hock=null,i.lefthock=null,i.dgtW=1,i.ropeJoint=null,i.elasticlist=[1,1,.2,1],i.styles=[i.language.getLocaleStr("shrapnel"),i.language.getLocaleStr("firing_pin"),i.language.getLocaleStr("eraser"),i.language.getLocaleStr("string")],i.leftIndex=0,i.rightIndex=0,i.rightHitCb=new _,i.group=new k(!0),i}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_allowRotation(!1),this.createShapde(this.dgtW),this.initListener(),this.hock=new O(15),this.hock.dragingConnect=!0,this.hock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.hock),this.hock.addCbtype(this.CbTypeStr.AIR_SLIDEBLOCK_HOCK),this.lefthock=new O(10),this.lefthock.dragingConnect=!0,this.lefthock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.lefthock),this.lefthock.addCbtype(this.CbTypeStr.AIR_SLIDEBLOCK_LEFT_HOCK),this.changeMass({showValue:"200g"}),this.addTweenQuan(this.hock),this.addTweenQuan(this.lefthock)}},{key:"removed",value:function(){this.removeNapeListeners(this.preHit),this.removeNapeListeners(this.interactListener),this.removeNapeListeners(this.endHit),this.removeEventListener(p["default"].BEGIN,this.bragBeginFunc),this.hock.dragToolClick(),this.lefthock.dragToolClick(),this.hock.dispose(),this.lefthock.dispose(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"createShapde",value:function(t){this.shade&&this.body.remove(this.shade),this.dgtW=t,this.shade=new g(g.box(this.dgtW*this.unitdw,20)),this.body.add(this.shade),this.body.set_isBullet(!0),this.shade.get_userData().shadeW=this.dgtW,this.shade.translate(v.get(0,-40)),this.shade.set_sensorEnabled(!0),this.shade.get_cbTypes().add(this.CbTypeStr.AIR_SLIDEBLOCK_SHADE)}},{key:"initListener",value:function(){var t=this;this.interactListener=new w(m.get_BEGIN(),x.get_COLLISION(),this.CbTypeStr.AIR_SLIDEBLOCK,this.CbTypeStr.AIR_TRACK,function(e){if(e.get_int1().get_body()==t.body){var i=t.body.get_velocity();0!=i.get_y()&&t.body.set_velocity(v.get(i.get_x(),0))}}),this.addNapeListeners(this.interactListener),this.preHit=new P(x.get_COLLISION(),this.rightHitCb,this.CbTypeStr.AIR_SLIDEBLOCK,function(e){if(!t.ropeJoint){var i=e.get_int2().get_body(),o=i.userData.view;if(!o.ropeJoint&&((1==t.rightIndex&&2==o.leftIndex||2==t.rightIndex&&1==o.leftIndex)&&(t.material_right.set_elasticity(0),o.material_left.set_elasticity(0)),(0==t.rightIndex&&3==o.leftIndex||3==t.rightIndex&&0==o.leftIndex)&&(t.body.userData.dragManager||i.userData.dragManager))){var n=v.get(50,-22),s=v.get(-50,-22);t.ropeJoint=new b(t.body,i,n,s),setTimeout(function(){t.hadDestory||t.ropeJoint.set_space(t.body.get_space())},0),t.ropeJoint.breakJoint=function(e){t.BodyUtil.destoryJoint(t.ropeJoint),t.ropeJoint=null,t.body.set_velocity(v.get(-e,0)),i.set_velocity(v.get(e,0))}}}}),this.addNapeListeners(this.preHit),this.endHit=new w(m.get_BEGIN(),x.get_COLLISION(),this.rightHitCb,this.CbTypeStr.AIR_SLIDEBLOCK,function(e){var i=e.get_int2().get_body(),o=i.userData.view;t.refreshRightMaterial(),o.refreshLeftMaterial()}),this.addNapeListeners(this.endHit),this.bragBeginFunc=function(e){t.lefthock.get_userData().useing&&t.lefthock.dragToolClick()},this.addEventListener(p["default"].BEGIN,this.bragBeginFunc)}},{key:"changeMass",value:function(t){var e=l.M.getNumStr(t.showValue)-0;if(this.curtMass!=e){this.curtMass=e,this.body.get_shapes().clear();var i=200==this.curtMass?0:400==this.curtMass?1:2;this.bg.gotoAndStop(i);var o=this.bg.width/2,n=new g(g.box(o,this.bg.height),this.material_left);this.body.add(n),n.get_cbTypes().add(this.CbTypeStr.AIR_SLIDEBLOCK);var s=new g(g.box(o,this.bg.height),this.material_right);this.body.add(s),s.get_cbTypes().add(this.rightHitCb),this.body.add(this.shade),this.body.add(this.hock),n.translate(v.get(-o/2,0)),s.translate(v.get(o/2,0)),n.set_group(this.group),s.set_group(this.group);var a=[{x:45.5,y:-25},{x:58.5,y:-25},{x:74.5,y:-25}];this.hock.set_localCOM(v.get(a[i].x,a[i].y)),this.body.add(this.lefthock),this.lefthock.set_localCOM(v.get(-this.bg.width/2,-25)),this.body.set_mass(this.curtMass);var r=[34,49,64];if(this.left.x=-r[i],this.right.x=r[i],this.lefthock.get_userData().useing){this.lefthock.get_userData().bind.pivjoint.set_anchor2(this.lefthock.get_localCOM())}}}},{key:"changedgt",value:function(t){this.createShapde(l.M.getNumStr(t.showValue)-0)}},{key:"refreshLeftMaterial",value:function(){this.material_left.set_elasticity(this.elasticlist[this.leftIndex])}},{key:"refreshRightMaterial",value:function(){this.material_right.set_elasticity(this.elasticlist[this.rightIndex])}},{key:"changeLeftStyle",value:function(t){this.leftIndex=this.styles.indexOf(t.showValue),this.left.gotoAndStop(this.leftIndex),this.refreshLeftMaterial()}},{key:"changeRightStyle",value:function(t){this.rightIndex=this.styles.indexOf(t.showValue),this.right.gotoAndStop(this.rightIndex),this.refreshRightMaterial()}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.mass=this.curtMass,t.zgtw=this.dgtW,t.lefttype=this.styles[this.leftIndex],t.righttype=this.styles[this.rightIndex],t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.mass!=this.curtMass&&this.changeMass({showValue:t.mass+"g"}),t.zgtw!=this.dgtW&&this.changedgt({showValue:t.zgtw+"cm"}),t.lefttype!=this.styles[this.leftIndex]&&this.changeLeftStyle({showValue:t.lefttype}),t.righttype!=this.styles[this.rightIndex]&&this.changeRightStyle({showValue:t.righttype})}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getDropMenu(this.language.getLocaleStr("mass"),!1,"g",this.curtMass+"g",["200g","400g","600g"],this,this.changeMass,1e3,10),this.ComponentProperty.getDropMenu(this.language.getLocaleStr("light_stripe_w"),!1,"cm",this.dgtW+"cm",["0.5cm","1cm","3cm","5cm"],this,this.changedgt,1e3,10),this.ComponentProperty.getDropMenu(this.language.getLocaleStr("left_duan"),!1,"",this.styles[this.leftIndex],this.styles,this,this.changeLeftStyle,1e3,10),this.ComponentProperty.getDropMenu(this.language.getLocaleStr("right_duan"),!1,"",this.styles[this.rightIndex],this.styles,this,this.changeRightStyle,1e3,10)),t}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var n=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();e["default"]=function(){function t(){o(this,t),this.x=0,this.y=0,this.enabled=!0,this.dir=new PIXI.Point(1,0)}return n(t,[{key:"getPhi",value:function(t,e){return 0}},{key:"getPsi",value:function(t,e){return 0}},{key:"getV",value:function(t,e){return new PIXI.Point}},{key:"getTheta",value:function(t,e){return Math.atan2(e-this.y,t-this.x)}},{key:"getR",value:function(){var t=x0-this.x,e=y0-this.y;return Math.sqrt(t*t+e*e)}},{key:"toLocal",value:function(t,e){if(0===this.x&&0===this.y&&1===this.dir.x&&0===this.dir.y)return new PIXI.Point(t,e);var i=Math.atan2(this.dir.y,this.dir.x),o=new PIXI.Matrix;return o.rotate(i),o.translate(this.x,this.y),o.invert(),o.apply(new PIXI.Point(t,e))}},{key:"toGlobal",value:function(t,e){if(0===this.x&&0===this.y&&1===this.dir.x&&0===this.dir.y)return new PIXI.Point(t,e);var i=Math.atan2(this.dir.y,this.dir.x),o=new PIXI.Matrix;return o.rotate(i),o.translate(this.x,this.y),o.apply(new PIXI.Point(t,e))}},{key:"deltaToGlobal",value:function(t,e){if(0===this.x&&0===this.y&&1===this.dir.x&&0===this.dir.y)return new PIXI.Point(t,e);var i=Math.atan2(this.dir.y,this.dir.x),o=new PIXI.Matrix;return o.rotate(i),o.apply(new PIXI.Point(t,e))}}]),t}()},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(506),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.moduleMain.nape,d=c.geom.Vec2,p=c.phys.Compound,i.table=null,i.nbdesk=null,i.wood=null,i.compo=new p,i.boardWeldJoint=null,i.weight=null,i.saveTable=!0,i.datalength=0,i}return s(e,t),a(e,[{key:"init",value:function(t){var e=this;this.startBtn.fontColor="#ffffff",this.startBtn.text=this.language.getLocaleStr("start"),this.resetBtn.fontColor="#ffffff",this.resetBtn.text=this.language.getLocaleStr("reset"),this.startBtn["this"]=this,this.startBtn.tab=function(){e.initComplete&&e.setSpeed({showValue:1})},this.resetBtn["this"]=this,this.resetBtn.tab=function(){e.initComplete&&(e.resetBtn.reseting||(e.resetBtn.reseting=!0,e.tension.springHock.hock.dragToolClick(),e.tension.speed=0,e.resetHockWoodPosition(),e.weight&&e.weight.resetAllOriginPosition(),setTimeout(function(){e.hadDestory||(e.tension.springHock.hock.var_isbreaking=!1,e.wood.hock.var_isbreaking=!1,e.resetTensionPosition(),e.resetBtn.reseting=!1)},500),e.tension.closeLineTrack({checked:!1})))},this.addTable(t),this.addCursor(this.startBtn,"hand"),this.addCursor(this.resetBtn,"hand")}},{key:"addTable",value:function(t){var e=this,i={data:{col:3,row:5}},o=setTimeout(function(){o&&t&&t()},2e3);this.globalConfig.main.addTable(i,function(i){clearTimeout(o),o=null,e.seComp=i,e.table=i.table,i.allowSave=!1,i.setTableData({heads:[e.language.getLocaleStr("hock_mass")+" m/g",e.language.getLocaleStr("dy_friction")+" f1/N",e.language.getLocaleStr("st_friction")+" f2/N"]}),i.setLineData([{x:0,y:2,linkType:3,ifTr:!0}]),t&&t()})}},{key:"addOthers",value:function(){var t=this.dependEquipments;this.getMain().view.updateTransform(),this.initDesk(t[0]),this.initBoard(t[1]),this.initHockWood(t[2]),this.initTension(t[3]),this.limitTension(),this.initWeightBox(t[4]),this.dispatchLoadedComplete(),this.preSetData&&this.completeSetData(this.preSetData),this.initComplete=!0}},{key:"initDesk",value:function(t){var e=this;this.nbdesk=t,this.nbdesk.getConfJumpTarget=this,this.nbdesk.setComponent(),this.nbdesk.body.userData.moveCompo=!0,this.nbdesk.body.userData.dragTomoveTool=!0,this.compo.set_space(this.nbdesk.body.get_space()),this.nbdesk.body.set_compound(this.compo),this.nbdesk.translateMove=function(t,i){e.compo.translate(d.get(t,i)),e.tension.translateMove(t,i)}}},{key:"initBoard",value:function(t){this.board=t,this.board.getConfJumpTarget=this;var e=this.nbdesk.body.get_position(),i=e.sub(d.get(0,178));this.board.body.set_position(i),this.board.body.userData.noDrag=!0,this.board.body.userData.allowMove=!1,this.board.setComponent(),this.boardWeldJoint=this.JointUtil.createWeldJoint(this.nbdesk.body,this.board.body,i,i),this.board.body.set_compound(this.compo),this.boardWeldJoint.set_compound(this.compo)}},{key:"initHockWood",value:function(t){this.wood=t,this.wood.noRenderSelected=!0,this.wood.getConfJumpTarget=this,this.wood.body.userData.allowMove=!1,this.wood.body.userData.noDrag=!0,this.wood.body.set_allowRotation(!1),this.BodyUtil.frezzBody(this.wood.body),this.resetHockWoodPosition()}},{key:"resetHockWoodPosition",value:function(){this.wood.body.set_position(this.nbdesk.body.get_position().sub(d.get(380,250))),this.wood.body.set_compound(this.compo)}},{key:"resetTensionPosition",value:function(){var t=this.wood.hock.get_worldCOM(),e=this.tension.springHock.body.get_position();this.tension.translateMove(t.get_x()-e.get_x(),t.get_y()-e.get_y())}},{key:"initTension",value:function(t){var e=this;this.tension=t,this.tension.getConfJumpTarget=this,this.tension.lockDirChange({showValue:this.language.getLocaleStr("horizontal_to_left")}),this.tension.revertTiaoLing(null),this.tension.body.userData.allowMove=!1,this.tension.setRange({showValue:"5N"}),this.tension.setComponent(),this.resetTensionPosition(),this.tension.clearLineTrack(),this.tension.addEventListener("springMove",function(t){e.tensionMove(t)})}},{key:"tensionMove",value:function(t){if(t>400){this.tension.speed=0,this.BodyUtil.frezzBody(this.wood.body);this.fillTableData({df:this.tension.force,sf:this.tension.getForceBydistance(this.tension.maxLine),m:this.getWoodUpMass()})}}},{key:"fillTableData",value:function(t){var e=h.M.getNumJie(t.df,2),i=h.M.getNumJie(t.sf,2),o=h.M.getNumJie(t.m,0);this.seComp&&this.seComp.setTableData({row:{index:this.datalength,data:[o,e,i]}}),this.datalength++}},{key:"getWoodUpMass",value:function(){for(var t=this.wood.body.get_arbiters(),e=this.wood.body.get_position().get_y(),i=0,o=0;o<t.get_length();o++){var n=t.at(o);if(n&&n.normalImpulse){if(n.get_contacts().at(0).get_position().get_y()<e){i+=this.Vec2Util.vec3ToVec2(n.normalImpulse(this.wood.body)).get_length()*this.NapeConst.FORCE_RATIO}}}return 1e3*i/this.wood.getGravity()}},{key:"initWeightBox",value:function(t){this.weight=t,this.weight.noRenderSelected=!0,this.weight.getConfJumpTarget=this,this.weight.addCompound(this.compo),this.weight.body.userData.noDrag=!0}},{key:"limitTension",value:function(){var t=this.tension.body.get_position();this.lineJoint=this.JointUtil.createLineJoint(this.nbdesk.body,this.tension.body,t,t,d.get(0,1).rotate(-Math.PI/2),0,760),this.lineJoint.set_compound(this.compo)}},{key:"update",value:function(){if(this.nbdesk&&this.nbdesk.body){var t=this.nbdesk.body.get_position();this.x=t.get_x(),this.y=t.get_y()}}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return this.nbdesk&&this.tension&&(t.datalength=this.datalength,t.boardf=this.board.curtf,t.boardcz=this.board.currentMatrial,t.saveTable=this.saveTable,this.seComp&&(t.tabledata=this.seComp.getData())),t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.datalength=t.datalength,this.preSetData=t}},{key:"completeSetData",value:function(t){isNaN(t.boardf)||t.boardf==this.board.curtf||this.changef({showValue:t.boardf}),t.boardcz&&t.boardcz!=this.board.currentMatrial&&this.switchCaizhi({showValue:t.boardcz}),this.changeSaveTable(0==t.saveTable?{checked:!1}:{checked:!0})}},{key:"removed",value:function(){this.removedCursor(this.startBtn),this.removedCursor(this.resetBtn),this.seComp&&!this.seComp.hadDestory&&this.seComp.destroy(),this.nbdesk&&!this.nbdesk.hadDestory&&this.removeFromFramework(this.nbdesk),this.board&&!this.board.hadDestory&&this.removeFromFramework(this.board),this.wood&&!this.wood.hadDestory&&this.removeFromFramework(this.wood),this.weight&&!this.weight.hadDestory&&this.removeFromFramework(this.weight),this.tension&&!this.tension.hadDestory&&this.removeFromFramework(this.tension),this.startBtn.dispose(),this.resetBtn.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"changef",value:function(t){this.board.changef(t)}},{key:"switchCaizhi",value:function(t){this.board.switchCaizhi(t)}},{key:"setSpeed",value:function(t){this.tension.closeLineTrack({checked:!0}),this.tension.setSpeed(t)}},{key:"changeSaveTable",value:function(t){this.saveTable=t.checked}},{key:"selectRenderChild",value:function(){return this.nbdesk?this.nbdesk.bg.getBounds():this.getBounds()}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("roughness"),!0,"",1,0,this.board.curtf,.1,this.changef,this),this.ComponentProperty.getDropMenu(this.language.getLocaleStr("material"),!1,"",this.board.currentMatrial,this.board.czi,this,this.switchCaizhi,1,0),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("move_speed"),!0,"",4,0,this.tension.speed,1,this.setSpeed,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("auto_entry"),this.saveTable,this.changeSaveTable,this)),t}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function m(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:m(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(506),c=o(u),d=i(449),p=o(d),y=i(454),f=o(y),g=i(513),b=o(g),v=void 0,_=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return v=i.moduleMain.nape,_=v.geom.Vec2,i.nbdesk=null,i.wood=null,i.board=null,i.woodJoint=null,i.woodLineJoint=null,i.ticker=null,i.car=null,i.onekeyph=!1,i.haveWood=!0,i.saveTable=!0,i.a_f=!0,i.a_m=!1,i.curtHockMass=10,i.changingHockMass=!1,i.preSetData=null,i.datalength=0,i.datalength2=0,i.imgIndex=0,i.table=null,i.table2=null,i.seComp=null,i.seComp2=null,i.hashockarr=[],i.resetDisLoadComp=!0,i}return a(e,t),r(e,[{key:"init",value:function(t){function e(){o&&n&&t()}var i=this;this.startBtn.fontColor="#ffffff",this.startBtn.text=this.language.getLocaleStr("eject"),this.resetBtn.fontColor="#ffffff",this.resetBtn.text=this.language.getLocaleStr("reset"),this.startBtn["this"]=this,this.startBtn.tab=function(){i.initComplete&&i.car.tic&&i.car.weldJoint&&(i.ticker.var_powerIsOpen||i.ticker.func_powerClick(),i.car.breakWeldJoint(),i.car.func_tickPowerChange())},this.resetBtn["this"]=this,this.resetBtn.tab=function(){i.initComplete&&(i.ticker.var_powerIsOpen&&i.ticker.func_powerClick(),i.ticker.firstShowPaper(),i.ticker.var_paper.resetAll(),i.resetNbCar(),i.weldBoardRopeToCar(),i.changeHockMass({showValue:i.curtHockMass}))},this.carmc.addBtn.fontColor="#ffffff",this.carmc.addBtn.text="+",this.carmc.subBtn.fontColor="#ffffff",this.carmc.subBtn.text="－",this.carmc.addBtn.tab=function(){if(i.initComplete){var t=i.car.getThisMass()-0;t+=50,t>500&&(t=500),i.changeCarMass({showValue:t}),i.freshLibPan()}},this.carmc.subBtn.tab=function(){if(i.initComplete){var t=i.car.getThisMass()-0;t-=50,100>t&&(t=100),i.changeCarMass({showValue:t}),i.freshLibPan()}},this.hockmc.addBtn.fontColor="#ffffff",this.hockmc.addBtn.text="+",this.hockmc.subBtn.fontColor="#ffffff",this.hockmc.subBtn.text="－",this.hockmc.addBtn.tab=function(){if(i.initComplete&&!i.changingHockMass){var t=i.curtHockMass;t+=10,t>100&&(t=100),i.changeHockMass({showValue:t}),i.freshLibPan()}},this.hockmc.subBtn.tab=function(){if(i.initComplete&&!i.changingHockMass){var t=i.curtHockMass;t-=10,10>t&&(t=10),i.changeHockMass({showValue:t}),i.freshLibPan()}},this.addCursor(this.startBtn,"hand"),this.addCursor(this.resetBtn,"hand"),this.addCursor(this.carmc.addBtn,"hand"),this.addCursor(this.carmc.subBtn,"hand"),this.addCursor(this.hockmc.addBtn,"hand"),this.addCursor(this.hockmc.subBtn,"hand");var o=!1,n=!1;this.addTable1(function(){o=!0,e()}),this.addTable2(function(){n=!0,e()})}},{key:"addTable1",value:function(t){var e=this;this.globalConfig.main.addTable({data:{col:3,row:5}},function(i){e.seComp=i,e.table=i.table,i.allowSave=!1,i.setTableData({heads:["钩码的质量m/kg","拉力F/N","加速度a/(m/s²)"]}),i.setLineData([{x:1,y:2,linkType:3,ifTr:!0}]),i.minMax(!1),t&&t()})}},{key:"addTable2",value:function(t){var e=this;this.globalConfig.main.addTable({data:{col:3,row:5}},function(i){e.table2=i.table,e.seComp2=i,i.allowSave=!1,i.setTableData({heads:[e.language.getLocaleStr("car_mass")+" M/kg",e.language.getLocaleStr("car_mass_reciprocal")+" 1/M/(1/kg)",e.language.getLocaleStr("acceleration")+" a/(m/s²)"]}),i.setLineData([{x:1,y:2,linkType:3,ifTr:!0}]),i.minMax(!1),t&&t()})}},{key:"addOthers",value:function(){var t=this.dependEquipments;this.initDesk(t[0]),this.initWood(t[1]),this.initBoard(t[2]),this.initTicker(t[3]),this.initNbCar(t[4]),this.initHock(t[5]),this.preSetData?this.completeSetData(this.preSetData):this.changeSaveTable({checked:!0},!1);$("#second-tools-id");this.carmc.txt.text=this.car.getThisMass(),this.hockmc.txt.text=this.curtHockMass,this.initComplete=!0}},{key:"initDesk",value:function(t){this.nbdesk=t,this.nbdesk.getConfJumpTarget=this,this.nbdesk.setComponent()}},{key:"resetWoodPosition",value:function(){var t=this.nbdesk.body.get_position(),e=t.sub(_.get(258,186.8));return this.wood.body.set_position(e),e}},{key:"initWood",value:function(t){var e=this;this.wood=t,this.wood.getConfJumpTarget=this,this.wood.owner=this.wood.parent,this.wood.body.userData.handJointFrequency=3,this.wood.mat.set_dynamicFriction(0),this.wood.mat.set_staticFriction(0);var i=this.resetWoodPosition();this.wood.setComponent();var o=this.nbdesk.body.localPointToWorld(_.get(-355,0)).get_x();this.woodLineJoint=this.JointUtil.createLineJoint(this.nbdesk.body,this.wood.body,_.get(o,i.get_y()),i,_.get(1,0),0,300),this.woodJoint=this.JointUtil.createWeldJoint(this.nbdesk.body,this.wood.body,i,i),this.woodBegin=function(){e.onekeyph||(e.woodJoint.set_active(!1),e.board.body.set_allowRotation(!0))},this.woodEnd=function(){if(!e.onekeyph){var t=e.nbdesk.body.worldPointToLocal(e.wood.body.get_position());e.woodJoint.set_anchor1(t),e.woodJoint.set_active(!0),e.board.body.set_allowRotation(!1),e.BodyUtil.frezzBody(e.board.body)}},this.woodMove=function(){e.BodyUtil.frezzBody(e.board.body)},this.wood.addEventListener(p["default"].BEGIN,this.woodBegin),this.wood.addEventListener(p["default"].END,this.woodEnd),this.wood.addEventListener(p["default"].MOVE,this.woodMove)}},{key:"initBoard",value:function(t){this.board=t,this.board.getConfJumpTarget=this;var e=this.nbdesk.body.get_position(),i=e.sub(_.get(0,229));this.board.body.set_rotation(.08941238207918926),this.board.body.set_position(i),this.board.setComponent(),this.board.guPoint=new l.Point(-300,-50);var o=this.nbdesk.rightPi();this.JointUtil.createPivotJoint(this.nbdesk.body,this.board.body,o,o),this.board.body.set_allowRotation(!1),this.BodyUtil.frezzBody(this.board.body)}},{key:"initTicker",value:function(t){var e=this;this.ticker=t,this.ticker.getConfJumpTarget=this,this.ticker.setComponent(),this.ticker.func_bindBoard(this.board),this.tickerpaperBreakfunc=function(){e.ticker.var_paper.breakPaper(),e.ticker.var_powerIsOpen&&e.ticker.func_powerClick()},this.tickerGetPaperfunc||(this.tickerGetPaperfunc=function(t){var i=t;i.paperMenuChange(e.language.getLocaleStr("speed")),i.menu.sdBtn.swap(),i.leftBiaoOff=450,i.rightBiaoOff=500,e.getOnePaperDataFunc=function(t){i.removeEventListener(f["default"].CAN_GET_SPEEDDATA,e.getOnePaperDataFunc),0==e.imgIndex?(e.fillTableData(t),e.datalength++):(e.fillTableData2(t),e.datalength2++)},i.addEventListener(f["default"].CAN_GET_SPEEDDATA,e.getOnePaperDataFunc)}),this.ticker.addEventListener(f["default"].TICKER_PAPER_AUTOMATIC_BREAK,this.tickerpaperBreakfunc),this.ticker.addEventListener(f["default"].SCALE_BIG_PAPER,this.tickerGetPaperfunc)}},{key:"fillTableData",value:function(t){var e=t.acceleration,i=.001*this.hockmc.txt.text,o=this.car.getGravity()*i;this.seComp.setTableData({row:{index:this.datalength,data:[l.M.getNumJie(i,3),l.M.getNumJie(o,3),l.M.getNumJie(e,3)]}})}},{key:"fillTableData2",value:function(t){var e=t.acceleration,i=.001*this.car.getThisMass(),o=1/i;this.seComp2.setTableData({row:{index:this.datalength2,data:[l.M.getNumJie(i,3),l.M.getNumJie(o,3),l.M.getNumJie(e,3)]}})}},{key:"resetNbCar",value:function(){this.car.compo.rotate(this.car.body.get_position(),this.board.body.get_rotation());var t=this.car.body.get_position(),e=this.board.body.localPointToWorld(_.get(-145.2,-40));this.car.translateCom(e.get_x()-t.get_x(),e.get_y()-t.get_y()),this.car.func_checkHitTickerPaper()}},{key:"initNbCar",value:function(t){this.car=t,this.car.getConfJumpTarget=this,this.car.setComponent(),this.car.board=this.board,this.resetNbCar(),this.changeCarMass({showValue:"300"}),this.weldBoardRopeToCar()}},{key:"weldBoardRopeToCar",value:function(){this.board.carHock.updateWeld(!0,this.car.hock.get_worldCOM())}},{key:"initHock",value:function(t){var e=t;e.noRenderSelected=!0,this.hashockarr.push(e),e.getConfJumpTarget=this;var i=this.board.body.localPointToWorld(this.board.pj.get_anchor3());this.board.plHock.body.set_position(i.add(_.get(0,30))),this.BodyUtil.frezzBody(this.board.plHock.body),e.body.set_position(i.add(_.get(0,60))),e.changeMass({showValue:this.curtHockMass})}},{key:"update",value:function(){if(this.board&&this.board.pj.isSlack(),this.nbdesk&&this.nbdesk.body){var t=this.nbdesk.body.get_position();this.x=t.get_x(),this.y=t.get_y()}}},{key:"changePingHeng",value:function(t){var e=this;if(this.onekeyph=t.checked){this.changeFri({showValue:.5}),this.board.body.set_allowRotation(!0);var i=this.nbdesk.body.get_position().sub(_.get(337.7,186.7));this.wood.body.set_position(i);this.woodJoint.set_anchor1(this.nbdesk.body.worldPointToLocal(i)),setTimeout(function(){e.hadDestory||(e.board.body.set_allowRotation(!1),e.BodyUtil.frezzBody(e.board.body))},500),this.freshLibPan()}}},{key:"hideWood",value:function(t){var e=arguments.length>1&&arguments[1]!==undefined&&arguments[1];this.haveWood=!t.checked,this.haveWood?(this.board.body.set_rotation(.08941238207918926),this.wood.body.set_space(this.nbdesk.body.get_space()),this.woodLineJoint.set_active(!0),this.woodJoint.set_active(!0),this.wood.owner.addChild(this.wood)):(this.wood.body.set_space(null),this.woodLineJoint.set_active(!1),this.woodJoint.set_active(!1),this.wood.owner.removeChild(this.wood),this.board.body.set_rotation(0)),e||this.freshLibPan()}},{key:"getboardFri",value:function(){return this.board.fparam}},{key:"changeFri",value:function(t){this.board.changeFri(t)}},{key:"changeCarMass",value:function(t){this.car.changeMass(t),this.carmc.txt.text=this.car.getThisMass()}},{key:"changeHockMass",value:function(t){this.curtHockMass=t.showValue-0,this.hockmc.txt.text=this.curtHockMass,this.refreshHockMass()}},{key:"refreshHockMass",value:function(){var t=this,e=this.curtHockMass,i=[];if(this.board.plHock.useing){var o=this.board.plHock.hock.get_userData().bind,n=o.get_body().userData.view;if(n instanceof b["default"])n.sameCodelist(n,i);else{var s=n.body.get_position();o.dragToolClick(),this.board.plHock.hock.var_isbreaking=!1,n.body.set_position(s.add(_.get(100,100)))}}var a=i.length,r=0;this.changingHockMass=!0;!function h(e){var o=[100,50,20,10],n=!0,s=!1,l=undefined;try{for(var u,c=o[Symbol.iterator]();!(n=(u=c.next()).done);n=!0){var d=u.value;if("break"===function(o){if(e>=o){if(e-=o,a>r){var n=i[r];if(r++,n.changeMass({showValue:o}),-1==t.hashockarr.indexOf(n)&&t.hashockarr.push(n),e>0)h(e);else{t.changingHockMass=!1;for(var s=i.slice(r);s.length>0;){var l=s.pop(),u=t.hashockarr.indexOf(l);-1!=u?(t.hashockarr.splice(u,1),l.removeFromFramework(l)):l.dragToolClick()}}}else{var c=void 0;a>0&&(c=i[a-1],c.bottomHockBreak()),t.addComp([{name:"Hockcode",thisX:0,thisY:0}],function(n){var s=n[0];s.noRenderSelected=!0,s.getConfJumpTarget=t,t.hashockarr.push(s),i.push(s),a++,r++,s.changeMass({showValue:o});var l=void 0;l=c?c.bottomHock.get_worldCOM():t.board.plHock.hock.get_worldCOM();var u=s.topHock.get_localCOM().get_y();s.body.set_position(l.sub(_.get(0,u))),e>0?h(e):t.changingHockMass=!1})}return"break"}}(d))break}}catch(p){s=!0,l=p}finally{try{!n&&c["return"]&&c["return"]()}finally{if(s)throw l}}}(e)}},{key:"changeSaveTable",value:function(t){var e=1>=arguments.length||arguments[1]===undefined||arguments[1];this.saveTable=t.checked,this.saveTable?this.imgChange({checked:this.imgIndex}):(this.seComp.minMax(!1),this.seComp2.minMax(!1)),e&&this.freshLibPan()}},{key:"imgChange",value:function(t){this.imgIndex=t.checked,this.seComp&&this.seComp2&&(0===this.imgIndex?(this.seComp.minMax(!1),this.seComp2.minMax(!0)):(this.seComp.minMax(!0),this.seComp2.minMax(!1)))}},{key:"getConf",value:function(){var t={};if(t.confArr=[],t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("roughness"),!0,"",1,0,this.getboardFri(),.1,this.changeFri,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("car_mass"),!0,"g",500,100,this.car.getThisMass(),50,this.changeCarMass,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("hock_mass"),!0,"g",100,10,this.curtHockMass,10,this.changeHockMass,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("auto_entry"),this.saveTable,this.changeSaveTable,this)),this.saveTable){var e=this.language.getLocaleStr("map");t.confArr.push(this.ComponentProperty.getRadio(this.language.getLocaleStr("image"),this.imgIndex,["a-F "+e,"a-1/M "+e],this.imgChange,this))}return this.haveWood?t.confArr.push(this.ComponentProperty.getSwitch(this.language.getLocaleStr("hidden_wood"),!1,this.hideWood,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("leveling"),this.onekeyph,this.changePingHeng,this)):t.confArr.push(this.ComponentProperty.getSwitch(this.language.getLocaleStr("hidden_wood"),!0,this.hideWood,this)),t}},{key:"completeSetData",value:function(t){var e=this;t.fir!=this.getboardFri()&&this.changeFri({showValue:t.fir}),this.onekeyph&&this.changePingHeng({checked:this.onekeyph}),0==t.haveWood&&this.hideWood({checked:!0}),t.hockmass!=this.curtHockMass&&setTimeout(function(){e.hadDestory||e.changeHockMass({showValue:t.hockmass})},100),this.changeSaveTable(0==t.saveTable?{checked:!1}:{checked:!0}),this.changeCarMass({showValue:t.carmass})}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return this.nbdesk&&this.board&&this.wood&&this.ticker&&this.car&&(t.datalength=this.datalength,t.onekeyph=this.onekeyph,t.fir=this.getboardFri(),t.haveWood=this.haveWood,t.saveTable=this.saveTable,t.hockmass=this.curtHockMass,t.carmass=this.car.getThisMass(),t.imgIndex=this.imgIndex,this.seComp&&(t.tabledata=this.seComp.getData()),this.seComp2&&(t.tabledata2=this.seComp2.getData())),t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.datalength=t.datalength,this.onekeyph=t.onekeyph,this.preSetData=t,this.imgIndex=t.imgIndex}},{key:"removed",value:function(){this.removedCursor(this.startBtn),this.removedCursor(this.resetBtn),this.removedCursor(this.carmc.addBtn),this.removedCursor(this.carmc.subBtn),this.removedCursor(this.hockmc.addBtn),this.removedCursor(this.hockmc.subBtn),this.ticker&&(this.ticker.removeEventListener(f["default"].TICKER_PAPER_AUTOMATIC_BREAK,this.tickerpaperBreakfunc),this.ticker.removeEventListener(f["default"].SCALE_BIG_PAPER,this.tickerGetPaperfunc)),this.wood&&(this.wood.removeEventListener(p["default"].BEGIN,this.woodBegin),this.wood.removeEventListener(p["default"].END,this.woodEnd),this.wood.removeEventListener(p["default"].MOVE,this.woodMove)),this.seComp&&!this.seComp.hadDestory&&this.seComp.destroy(),this.seComp2&&!this.seComp2.hadDestory&&this.seComp2.destroy(),this.nbdesk&&!this.nbdesk.hadDestory&&this.removeFromFramework(this.nbdesk),this.board&&!this.board.hadDestory&&this.removeFromFramework(this.board),this.wood&&!this.wood.hadDestory&&this.removeFromFramework(this.wood),this.ticker&&!this.ticker.hadDestory&&this.removeFromFramework(this.ticker),this.car&&!this.car.hadDestory&&this.removeFromFramework(this.car),this.startBtn.dispose(),this.resetBtn.dispose(),this.carmc.addBtn.dispose(),this.carmc.subBtn.dispose(),this.hockmc.addBtn.dispose(),this.hockmc.subBtn.dispose(),this.removelistHock(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"removelistHock",value:function(){for(var t=0;this.hashockarr.length>t;t++){var e=this.hashockarr[t];e.hadDestory||this.removeFromFramework(e)}this.hashockarr=[]}},{key:"selectRenderChild",value:function(){return this.nbdesk?this.nbdesk.bg.getBounds():this.getBounds()}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function v(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:v(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(506),c=o(u),d=i(513),p=o(d),y=i(454),f=o(y),g=void 0,b=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return g=i.moduleMain.nape,b=g.geom.Vec2,i.ticker=null,i.curtHockMass=50,i.changingHockMass=!1,i.datalength=0,i.saveTable=!0,i.preSetData=null,i.hashockarr=[],i.resetDisLoadComp=!0,i}return a(e,t),r(e,[{key:"init",value:function(t){var e=this;if(this.startBtn.fontColor="#ffffff",this.startBtn.text=this.language.getLocaleStr("eject"),this.resetBtn.fontColor="#ffffff",this.resetBtn.text=this.language.getLocaleStr("reset"),this.startBtn["this"]=this,this.startBtn.tab=function(){e.initComplete&&e.ticker.paper.visible&&e.ticker.paper.useing&&(e.ticker.powerOpen||e.ticker.powerClick())},this.resetBtn["this"]=this,this.resetBtn.tab=function(){e.initComplete&&(e.reseting||(e.reseting=!0,setTimeout(function(){e.hadDestory||(e.reseting=!1)},1e3),e.ticker.powerOpen&&e.ticker.powerClick(),e.ticker.setPaperDefPos(),e.changeHockMass({showValue:e.curtHockMass})))},!this.hockmc)return void this.addTable(t);this.hockmc.addBtn.fontColor="#ffffff",this.hockmc.addBtn.text="+",this.hockmc.subBtn.fontColor="#ffffff",this.hockmc.subBtn.text="－",this.hockmc.addBtn.tab=function(){if(e.initComplete&&!e.changingHockMass){var t=e.curtHockMass;t+=10,t>100&&(t=100),e.changeHockMass({showValue:t}),e.freshLibPan()}},this.hockmc.subBtn.tab=function(){if(e.initComplete&&!e.changingHockMass){var t=e.curtHockMass;t-=10,10>t&&(t=10),e.changeHockMass({showValue:t}),e.freshLibPan()}},this.addTable(t),this.addCursor(this.startBtn,"hand"),this.addCursor(this.resetBtn,"hand"),this.addCursor(this.hockmc.addBtn,"hand"),this.addCursor(this.hockmc.subBtn,"hand")}},{key:"addTable",value:function(t){var e=this;this.globalConfig.main.addTable({data:{col:5,row:5}},function(i){e.seComp=i,e.table=i.table,i.allowSave=!1,i.setTableData({heads:[e.language.getLocaleStr("select_point"),e.language.getLocaleStr("high_degr")+" h/m",e.language.getLocaleStr("speed")+" v(m/s)",e.language.getLocaleStr("g_energy_reduction")+" △Ep(J)",e.language.getLocaleStr("k_energy_recruitment")+" △E(J)"]}),i.setLineData([{x:3,y:4,linkType:3,ifTr:!0}]),t&&t()})}},{key:"addOthers",value:function(){var t=this.dependEquipments;this.main.view.updateTransform(),this.initTicker(t[0]),this.initHock(t[1]),this.preSetData?this.completeSetData(this.preSetData):this.changeSaveTable({checked:!0});$("#second-tools-id");this.hockmc&&(this.hockmc.txt.text=this.curtHockMass),this.initComplete=!0}},{key:"resetHock",value:function(t){t.changeMass({showValue:this.curtHockMass}),t.body.set_position(this.ticker.paper.getHitPoint().add(b.get(0,36)))}},{key:"initHock",value:function(t){var e=t;e.noRenderSelected=!0,this.hashockarr.push(e),e.getConfJumpTarget=this,this.resetHock(t)}},{key:"initTicker",value:function(t){var e=this;this.ticker=t,this.ticker.getConfJumpTarget=this,this.ticker.setComponent(),this.tickerpaperBreakfunc=function(){e.ticker.paper.autoBreakPaper(),e.ticker.powerOpen&&e.ticker.powerClick()},this.tickerGetPaperfunc=function(t){var i=t;i.leftBiaoOff=-5e3,i.rightBiaoOff=5e3,e.getOnePaperDataFunc=function(t){i.paperMenuChange(e.language.getLocaleStr("speed")),i.paperMenuChange(e.language.getLocaleStr("pos_shift"));var o=i.getPaperData();i.removeEventListener(f["default"].CAN_GET_SPEEDDATA,e.getOnePaperDataFunc),e.fillTableData(o),e.datalength++},i.addEventListener(f["default"].CAN_GET_SPEEDDATA,e.getOnePaperDataFunc)},this.ticker.addEventListener(f["default"].SCALE_BIG_PAPER,this.tickerGetPaperfunc)}},{key:"fillTableData",value:function(t){var e=t.velocity,i=t.displacement,o=.001*this.hockmc.txt.text,n=this.ticker.getGravity()*o,s=.01*i[4],a=.01*e[4],r=n*s,h=.5*o*a*a;this.seComp.setTableData({row:{index:this.datalength,data:[5,l.M.getNumJie(s,2),l.M.getNumJie(a,2),l.M.getNumJie(r,2),l.M.getNumJie(h,2)]}})}},{key:"update",value:function(){if(this.ticker&&this.ticker.body){var t=this.ticker.body.get_position();this.x=t.get_x(),this.y=t.get_y()}this.ticker&&this.ticker.paper.visible&&this.ticker.paper.finish&&this.tickerpaperBreakfunc()}},{key:"changeHockMass",value:function(t){this.curtHockMass=t.showValue-0,this.hockmc.txt.text=this.curtHockMass,this.ticker.paper.visible&&this.refreshHockMass()}},{key:"refreshHockMass",value:function(){var t=this,e=this.curtHockMass,i=[];if(this.ticker.paper.useing){var o=this.ticker.paper.hock.get_userData().bind,n=o.get_body().userData.view;if(n instanceof p["default"])n.sameCodelist(n,i);else{var s=n.body.get_position();o.dragToolClick(),this.ticker.paper.hock.var_isbreaking=!1,n.body.set_position(s.add(b.get(100,100)))}}var a=i.length,r=0;this.changingHockMass=!0;!function h(e){var o=[100,50,20,10],n=!0,s=!1,l=undefined;try{for(var u,c=o[Symbol.iterator]();!(n=(u=c.next()).done);n=!0){var d=u.value;if("break"===function(o){if(e>=o){if(e-=o,a>r){var n=i[r];if(r++,-1==t.hashockarr.indexOf(n)&&t.hashockarr.push(n),n.changeMass({showValue:o}),e>0)h(e);else{t.changingHockMass=!1;for(var s=i.slice(r);s.length>0;){var l=s.pop(),u=t.hashockarr.indexOf(l);-1!=u?(t.hashockarr.splice(u,1),l.removeFromFramework(l)):l.dragToolClick()}}}else{var c=void 0;a>0&&(c=i[a-1],c.bottomHockBreak()),t.addComp([{name:"Hockcode",cateid:5,thisX:0,thisY:0}],function(n){var s=n[0];s.noRenderSelected=!0,s.getConfJumpTarget=t,0==i.length&&t.removelistHock(),t.hashockarr.push(s),i.push(s),a++,r++,s.changeMass({showValue:o});var l=void 0;l=c?c.bottomHock.get_worldCOM():t.ticker.paper.getHitPoint();var u=s.topHock.get_localCOM().get_y();s.body.set_position(l.sub(b.get(0,u))),e>0?h(e):t.changingHockMass=!1},!0)}return"break"}}(d))break}}catch(p){s=!0,l=p}finally{try{!n&&c["return"]&&c["return"]()}finally{if(s)throw l}}}(e)}},{key:"changeSaveTable",value:function(t){this.saveTable=t.checked}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.saveTable=this.saveTable,t.hockmass=this.curtHockMass,t.datalength=this.datalength,this.seComp&&(t.tabledata=this.seComp.getData()),t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.datalength=t.datalength,this.preSetData=t}},{key:"completeSetData",value:function(t){var e=this;t.hockmass!=this.curtHockMass&&setTimeout(function(){e.hadDestory||e.changeHockMass({showValue:t.hockmass})},100),this.changeSaveTable(0==t.saveTable?{checked:!1}:{checked:!0})}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("hock_mass"),!0,"",100,10,this.curtHockMass,10,this.changeHockMass,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("auto_entry"),this.saveTable,this.changeSaveTable,this)),t}},{key:"removed",value:function(){this.removedCursor(this.startBtn),this.removedCursor(this.resetBtn),this.hockmc&&(this.removedCursor(this.hockmc.addBtn),this.removedCursor(this.hockmc.subBtn)),this.ticker&&this.ticker.removeEventListener(f["default"].SCALE_BIG_PAPER,this.tickerGetPaperfunc),this.seComp&&!this.seComp.hadDestory&&this.seComp.destroy(),this.ticker&&!this.ticker.hadDestory&&this.removeFromFramework(this.ticker),this.startBtn.dispose(),this.resetBtn.dispose(),this.hockmc&&(this.hockmc.addBtn.dispose(),this.hockmc.subBtn.dispose()),this.removelistHock(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"removelistHock",value:function(){for(var t=0;this.hashockarr.length>t;t++){var e=this.hashockarr[t];e.hadDestory||this.removeFromFramework(e)}this.hashockarr=[]}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function g(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:g(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(449),u=o(l),c=i(451),d=o(c),p=void 0,y=void 0,f=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return p=i.phy.nape,y=p.phys.GravMassMode,f=p.shape.HockShapeBase,i.weldJoint=null,i.isDrag=!1,i.hock=null,i.isconnect=null,i.connectBody=null,i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this);var i=new PIXI.Graphics;this.addChild(i),i.beginFill(0,0),i.drawRect(-15,-15,30,30),i.endFill(),this.body.get_shapes().clear(),this.hock=new f(15),this.hock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.hock),this.hock.addCbtype(this.CbTypeStr.PULLEY_BOARD_HOCK),this.addTweenQuan(this.hock),this.addEventListener(u["default"].BEGIN,function(e){t.beginHandler(e)}),this.addEventListener(u["default"].END,function(e){t.endHandler(e)}),this.body.userData.dragLevel=2,this.body.userData.notHockDrag=!0}},{key:"injectListenOption",value:function(t){this.hock.createListener(this.CbTypeStr.PULLEY_BOARD_HOCK,t)}},{key:"beginHandler",value:function(t){!this.useing&&this.weldJoint&&(this.weldJoint.set_active(!1),this.isDrag=!0)}},{key:"endHandler",value:function(t){!this.useing&&this.weldJoint&&this.updateWeld(!0),this.isDrag=!1}},{key:"updateWeld",value:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(t||!this.weldJoint.get_active()){var i=this.weldJoint.get_body1(),o=void 0;e?(this.body.set_position(e),o=i.worldPointToLocal(e)):o=i.worldPointToLocal(this.body.get_position()),this.weldJoint.set_anchor1(o),this.weldJoint.set_active(!0)}}},{key:"afterUnlockJoint",value:function(){if(this.weldJoint){var t=this.weldJoint.get_body1();if(t){this.weldJoint.set_anchor1(t.worldPointToLocal(this.body.get_position())),this.weldJoint.set_active(!0)}}}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.useing?this.body.set_gravMass(0):this.body.set_gravMassMode(y.get_DEFAULT()),this.weldJoint&&(this.useing&&this.weldJoint.get_active()?this.weldJoint.set_active(!1):this.useing||this.weldJoint.get_active()||this.isDrag||this.weldJoint.set_active(!0))}},{key:"removed",value:function(){this.hock.dragToolClick(),this.hock.dispose(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"theOtherUnlock",value:function(){this.weldJoint&&this.updateWeld(!0)}},{key:"weld",value:function(t,e){this.weldJoint=this.JointUtil.createWeldJoint(t,this.body,e,this.body.get_position())}},{key:"useing",get:function(){return this.hock.get_userData().useing}}]),e}(d["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(1);e["default"]=function(t){function e(){o(this,e);var t=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.line=new PIXI.Graphics,t.label=new PIXI.Text("",{font:"22px Arial",fill:16750848,align:"left"}),t.rotate=0,t.init(),t}return s(e,t),a(e,[{key:"init",value:function(){this.addChild(this.line),this.addChild(this.label)}},{key:"clear",value:function(){this.line.clear(),this.label.text=""}},{key:"update",value:function(t,e,i,o,n){var s=r.M.getXianDianByDis(o,!0,e,t),a=r.M.getXianDianByDis(o,!0,e,i),h=r.M.getDuiDianP(e,s,a),l=this.toLocal(h,n);s=this.line.toLocal(s,n),a=this.line.toLocal(a,n),h=this.line.toLocal(h,n),this.line.clear(),this.line.lineStyle(2,16750848,.6),this.line.moveTo(s.x,s.y),this.line.quadraticCurveTo(h.x,h.y,a.x,a.y),this.label.x=l.x,this.label.y=l.y;var u=.5*Math.PI-Math.atan2(i.y-e.y,i.x-e.x);this.label.text=r.M.getNumJie(180*Math.abs(u)/Math.PI,0)+"°",this.rotate=u}}]),e}(PIXI.Container)},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(1),h=i(226),l=function(t){return t&&t.__esModule?t:{"default":t}}(h);e["default"]=function(t){function e(t,i){o(this,e);var s=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return s.skinName=i||"HpaperTicker",s.bg=null,s.isHeight=!1,s.line=null,s.bg=PIXI.Sprite.fromFrame(s.skinName+"/tag"),s.addChild(s.bg),r.M.alignPivot(s.bg,"center","center"),s.input=new PIXI.Text("",{font:"20px Arial",align:"center"}),s.addChild(s.input),s.bgH=s.bg.height,s.input.x=-45,s.input.y=-10,s}return s(e,t),a(e,[{key:"label",value:function(t){this.input.text=t,this.input.x=.5*-this.input.width}},{key:"switchView",value:function(){this.bg.rotation=Math.PI}},{key:"lineHei",value:function(){this.isHeight=!0,this.line=new PIXI.Graphics,this.addChildAt(this.line,0),this.line.lineStyle(2,3904494),this.line.moveTo(0,-40),this.line.lineTo(0,40),this.bg.y-=50,this.input.y-=50}}]),e}(l["default"])},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function B(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:B(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(49),c=i(446),d=o(c),p=i(676),y=o(p),f=i(671),g=o(f),b=void 0,v=void 0,_=void 0,m=void 0,x=void 0,w=void 0,k=void 0,P=void 0,O=void 0,T=void 0,C=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return b=i.phy.nape,v=b.shape.Polygon,_=b.geom.Vec2,m=b.phys.BodyType,x=b.phys.Material,w=b.callbacks.CbType,k=b.callbacks.CbEvent,P=b.callbacks.InteractionType,O=b.callbacks.InteractionListener,T=b.geom.Mat23,C=b.shape.HockShapeBase,i.level=14,i.nomalStr=i.language.getLocaleStr("nomal_pattern"),i.pullyStr=i.language.getLocaleStr("pully_pattern"),i.patternArr=[i.nomalStr,i.pullyStr],i.s_k=2.0185627766666667,i.track_f=.05,i.mal=new x(0,i.track_f,0,7.9,0),i.fireMaterial=null,i.leftpx=-589,i.totalpx=1179,i.unitdw=2.0196403595307,i.bsape=null,i.curtdis=0,i.s1Shape=null,i.s2Shape=null,i.iswhiff=!1,i.gun=null,i.gunBody=null,i.gunSpeed=30,i.s1HitStart=null,i.s1HitEnd=null,i.s2HitStart=null,i.s2HitEnd=null,i.rightfireListener=null,i.line=new PIXI.Graphics,i.pullyline=new PIXI.Graphics,i.gunType=null,i.iszero=!0,i.num_s11=0,i.num_s11_2=0,i.num_s12=0,i.num_s12_2=0,i.num_s2=0,i.v11=0,i.v12=0,i.v21=0,i.v22=0,i.showSpeed=!1,i.first_num=-1,i.dataModle=0,i.isShowDat=!1,i.dattime=null,i.rightfire=null,i.shimNum=1,i.tophock=null,i.bothock=null,i.records1=[],i.records2=[],i.tRecords1=[],i.tRecords2=[],i}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.bg.gl.visible=!1,this.addChildAt(this.line,0),this.body.set_isBullet(!0),this.initTrack(),this.s1sensor(),this.initvecFire(),this.initBtn(),this.clearNum(),this.refreshkdLine(),this.addChild(this.pullyline),this.changeShim({showValue:this.shimNum}),this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER)}},{key:"test",value:function(t){Math.sin(this.body.get_rotation())}},{key:"clearNum",value:function(){this.hideNum(),this.bg.gl.visible=!1,this.iszero=!0,this.s1.record=!1,this.s2.record=!1,this.num_s11=0,this.num_s12=0,this.num_s2=0,this.num_s11_2=0,this.num_s12_2=0,this.v11=0,this.v12=0,this.v21=0,this.v22=0,this.isShowDat=!1,this.first_num=-1,clearInterval(this.dattime),this.records1.length=0,this.records2.length=0,this.tRecords1.length=0,this.tRecords2.length=0,this.clearTxt()}},{key:"clearTxt",value:function(){this.txtCon.t1.text="",this.txtCon.t2.text="",this.txtCon.t3.text="",this.txtCon.t4.text=""}},{key:"hideNum",value:function(){this.bg.n0.visible=!1,this.bg.n1.visible=!1,this.bg.n2.visible=!1,this.bg.n3.visible=!1,this.bg.dot.visible=!1}},{key:"initTrack",value:function(){this.body.get_shapes().clear(),this.bsape=new v(v.box(1217,112),this.mal),this.body.add(this.bsape),this.bsape.set_localCOM(_.get(0,14)),this.bsape.get_cbTypes().add(this.CbTypeStr.AIR_TRACK),this.body.set_type(m.get_KINEMATIC())}},{key:"s1sensor",value:function(){var t=this,e=this.s1.width,i=new w,o=new w;this.s1Shape=new v(v.box(e,this.s1.height)),this.body.add(this.s1Shape),this.s2Shape=new v(v.box(e,this.s2.height)),this.body.add(this.s2Shape),this.s1Shape.set_sensorEnabled(!0),this.s2Shape.set_sensorEnabled(!0),this.s1Shape.translate(_.get(this.s1.x,this.s1.y)),this.s2Shape.translate(_.get(this.s2.x,this.s2.y)),this.s1Shape.get_cbTypes().add(i),this.s2Shape.get_cbTypes().add(o);var n=void 0,s=void 0;this.s1TouchId=l.M.addTouch(this.s1,{begin:function(e){t.body.userData.noDrag=!0,n=t.getMouseXY(e)},move:function(i){var o=t.getMouseXY(i);t.s1.x+=o.x-n.x,-589>t.s1.x&&(t.s1.x=-589),t.s1.x>t.s2.x-e&&(t.s1.x=t.s2.x-e),n=o,t.s1Shape.set_localCOM(_.get(t.s1.x,t.s1.y)),t.refreshkdLine()},end:function(e){t.body.userData.noDrag=!1}}),this.s2TouchId=l.M.addTouch(this.s2,{begin:function(e){t.body.userData.noDrag=!0,s=t.getMouseXY(e)},move:function(i){var o=t.getMouseXY(i);t.s2.x+=o.x-s.x,t.s2.x>589&&(t.s2.x=589),t.s1.x+e>t.s2.x&&(t.s2.x=t.s1.x+e),s=o,t.s2Shape.set_localCOM(_.get(t.s2.x,t.s2.y)),t.refreshkdLine()},end:function(e){t.body.userData.noDrag=!1}}),this.s1HitStart=new O(k.get_BEGIN(),P.get_SENSOR(),i,this.CbTypeStr.AIR_SLIDEBLOCK_SHADE,function(e){4>t.records1.length&&t.records1.push(t.getInfo(e,1))}),this.s1HitEnd=new O(k.get_END(),P.get_SENSOR(),i,this.CbTypeStr.AIR_SLIDEBLOCK_SHADE,function(e){if(4>t.records1.length){if(t.records1.push(t.getInfo(e,2)),2===t.records1.length){var i=t.calTime(t.records1[0],t.records1[1]);t.tRecords1[0]=i,t.num_s11=i.t0,t.v11=i.v}else if(4===t.records1.length){var o=t.calTime(t.records1[2],t.records1[3]);t.tRecords1[1]=o,t.num_s11_2=o.t0,t.v12=o.v}t.iszero=!1,t.updateTime12(),t.showTxtValue()}}),this.s2HitStart=new O(k.get_BEGIN(),P.get_SENSOR(),o,this.CbTypeStr.AIR_SLIDEBLOCK_SHADE,function(e){if(4>t.records2.length){var i=t.getInfo(e,1);t.records2.push(i)}}),this.s2HitEnd=new O(k.get_END(),P.get_SENSOR(),o,this.CbTypeStr.AIR_SLIDEBLOCK_SHADE,function(e){if(4>t.records2.length){var i=t.getInfo(e,2);if(t.records2.push(i),t.iszero=!1,2===t.records2.length){var o=t.calTime(t.records2[0],t.records2[1]);t.tRecords2[0]=o,t.num_s12=o.t0,t.v21=o.v}else if(4===t.records2.length){var n=t.calTime(t.records2[2],t.records2[3]);t.tRecords2[1]=n,t.num_s12_2=n.t0,t.v22=n.v}t.iszero=!1,t.updateTime12(),t.showTxtValue()}}),this.addNapeListeners(this.s1HitStart),this.addNapeListeners(this.s1HitEnd),this.addNapeListeners(this.s2HitStart),this.addNapeListeners(this.s2HitEnd)}},{key:"updateTime12",value:function(){if(0===this.num_s2){var t=this.tRecords1[this.tRecords1.length-1],e=this.tRecords2[this.tRecords2.length-1];if(t&&e)return this.num_s2=Math.abs(t.t-e.t),1===this.dataModle&&this.playValueToScreen(),!0}return!1}},{key:"calTime",value:function(t,e){var i=t.x1,o=t.x2,n=t.vx,s=t.t,a=t.w1,r=e.vx,h=e.t,l=r-n,c=h-s,d=l/c,p=2*d*(o-i)+n*n;if(0>p)return 2*a/(r+n);var y=Math.sqrt(p);0>(r-y)/d&&(y=-y);var f=void 0;f=0!==d?s+(y-n)/d:s+(o-i)/y;var g=1e3*Math.abs(a)/y;return y=1e3*(0,u.round)(.01*a/this.unitdw,3)/(0,u.round)(g,2),{t0:g,v:y,t:f}}},{key:"getInfo",value:function(t,e){var i=t.get_int1(),o=t.get_int2(),n=i.get_bounds(),s=o.get_bounds(),a=i.get_body().get_velocity().get_x(),r=o.get_body().get_velocity().get_x(),h=r-a,l=n.get_min().get_x(),u=n.get_max().get_x(),c=s.get_min().get_x(),d=s.get_max().get_x(),p=(l+u)/2,y=(c+d)/2;return{t:this.getcurTime(),x1:y,x2:p,w1:d-c,w2:u-l,vx:h,type:e}}},{key:"getT",value:function(t,e){var i=t.get_int1(),o=t.get_int2(),n=i.get_body(),s=o.get_body(),a=n.get_velocity(),r=s.get_velocity(),h=i.get_bounds(),l=o.get_bounds(),u=a.get_x(),c=r.get_x(),d=this.getcurTime(),p=c-u,y=h.get_min().get_x(),f=h.get_max().get_x(),g=l.get_min().get_x(),b=l.get_max().get_x();y=f=(y+f)/2;var v=y-b,_=f-g,m=v/p,x=_/p,w=d+1e3*m,k=d+1e3*x;return w&&k?1===e?Math.min(w,k):Math.max(w,k):d}},{key:"st",value:function(t,e,i,o,n){i=Math.abs(i);var s="";if(this.showSpeed){var a="";1e3>i?(s=(0,u.round)(i,2),a="ms"):(s=(0,u.round)(.001*i,3),a="s"),s=t+s+a,this.showSpeed&&o&&(s+="；\t"+o+(0,u.round)(100*n,2)+"cm/s")}else{var r=this.getValueStr(i);s=t+r[0]+r[1]}e.text=s}},{key:"getValueStr",value:function(t){var e="",i="ms",o=0;return 999.5>t?(e=(0,u.round)(t,0),i="ms",o=0):(t*=.001,9.995>t?(e=(0,u.round)(t,2),o=2):(e=(0,u.round)(t,1),o=1),i="s"),[e,i,o]}},{key:"showTxtValue",value:function(){this.clearTxt(),0==this.dataModle?(this.st("t1：",this.txtCon.t1,this.num_s11,"v1：",this.v11),this.st("t2：",this.txtCon.t2,this.num_s12,"v2：",this.v21)):1==this.dataModle?this.st("t1：",this.txtCon.t1,this.num_s2):2==this.dataModle?(this.st("t1：",this.txtCon.t1,this.num_s11,"v1：",this.v11),this.st("t2：",this.txtCon.t2,this.num_s12,"v2：",this.v21),this.st("t3：",this.txtCon.t3,this.num_s2)):3==this.dataModle&&(this.st("t1：",this.txtCon.t1,this.num_s11,"v1：",this.v11),this.st("t2：",this.txtCon.t2,this.num_s11_2,"v2：",this.v12),this.st("t3：",this.txtCon.t3,this.num_s12,"v3：",this.v21),this.st("t4：",this.txtCon.t4,this.num_s12_2,"v4：",this.v22))}},{key:"calculationTime",value:function(t){var e=t.get_userData().shadeW,i=t.get_body(),o=i.get_velocity().get_x();o=Math.abs(o);var n=o/this.s_k,s=this.getGravity();return s*=Math.cos(this.body.get_rotation()),Math.round(1e3*e/n)}},{key:"getcurTime",value:function(){var t=this.napeEngine;return Math.round(1e3*t.space.get_elapsedTime())}},{key:"initvecFire",value:function(){var t=this;this.fireMaterial=new x(1,0,0,7.9,0);var e=new v(v.box(33,96),this.fireMaterial);this.rightfire=new v(v.box(33,96),this.fireMaterial),this.body.add(e),this.body.add(this.rightfire),e.translate(_.get(-608,-72)),this.rightfire.translate(_.get(608,-72));var i=new w;this.rightfire.get_cbTypes().add(i),this.gun=new C(10),this.gun.dragingConnect=!0,this.gun.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.gun),this.gun.translate(_.get(-590,-116)),this.gunType=new w,this.gun.addCbtype(this.gunType),this.gun.createListener(this.gunType,this.CbTypeStr.AIR_SLIDEBLOCK_LEFT_HOCK),this.addTweenQuan(this.gun),this.gun.connectCallback=function(e,i){return!e.userData.dragManager&&(t.gun.dragToolClick(),!0)},this.rightfireListener=new O(k.get_BEGIN(),P.get_COLLISION(),i,this.CbTypeStr.AIR_SLIDEBLOCK,function(e){if(t.getStatus()!==t.nomalStr){e.get_int2().get_body().set_velocity(_.get(0,0))}}),this.addNapeListeners(this.rightfireListener)}},{key:"playSound",value:function(){0>=arguments.length||undefined;this.freshVolume()}},{key:"freshVolume",value:function(){this.globalConfig.VOLUME&&this.iswhiff?(this.sound=this.globalConfig.SoundTool.playT(this.SoundStr.AIRTRACK,null,null,this,!0),this.sound.volume=.1):this.sound&&(this.globalConfig.SoundTool.stopT(this.sound),this.sound=null)}},{key:"initBtn",value:function(){var t=this;this.addCursor(this.fireBtn,"hand"),this.addCursor(this.stopBtn,"hand"),this.addCursor(this.clearBtn,"hand"),this.addCursor(this.abBtn,"hand"),this.addCursor(this.qbeng.airpower,"hand"),this.fireBtn.tab=function(){if(t.gun.get_userData().useing){t.t0=(new Date).getTime(),t.t00=t.getcurTime();var e=t.gunSpeed*t.s_k,i=t.gun.intShape2.get_body();t.gun.dragToolClick(),i.set_velocity(_.get(e,0))}t.body.get_arbiters().foreach(function(e){var i=e.get_body2().userData.view;i instanceof g["default"]&&i.ropeJoint&&i.ropeJoint.breakJoint(t.gunSpeed*t.s_k)})},this.stopBtn.tab=function(){t.body.get_arbiters().foreach(function(t){var e=t.get_body2().userData.view;e instanceof g["default"]&&e.body.set_velocity(_.get(0,0))})},this.clearBtn.tab=function(){t.clearNum()},this.abBtn.tab=function(){++t.dataModle>3&&(t.dataModle=0);var e=[{x:121.65,y:226.15},{x:121.65,y:244.15},{x:154.4,y:226.15},{x:154.4,y:244.15}];t.green.x=e[t.dataModle].x,t.green.y=e[t.dataModle].y,clearInterval(t.dattime),t.isShowDat=!1,t.clearTxt(),t.showTxtValue()},this.parent.addChildAt(this.qbeng,0),this.qbxy={x:this.qbeng.x,y:this.qbeng.y},this.qbeng.x+=this.x,this.qbeng.y+=this.y,this.powerTouchId=l.M.addTouch(this.qbeng.airpower,{tab:function(){t.iswhiff?(t.iswhiff=!1,t.qbeng.airpower.gotoAndStop(0),t.mal.set_dynamicFriction(t.track_f),t.playSound(!1),t.bsape.set_localCOM(_.get(0,14))):(t.qbeng.airpower.gotoAndStop(1),t.iswhiff=!0,t.mal.set_dynamicFriction(0),t.playSound(),t.bsape.set_localCOM(_.get(0,10))),t.freshGlow()}})}},{key:"playValueToScreen",value:function(){var t=this;if(this.isShowDat=!0,clearInterval(this.dattime),this.tmpStep=0,0==this.dataModle||2==this.dataModle||3==this.dataModle){var e=function(){var e=0==t.dataModle?2:2==t.dataModle?3:4,i=t.tmpStep%e;0==i?t.setText(1,t.num_s11):1==i?3==t.dataModle?t.setText(2,t.num_s11_2):t.setText(2,t.num_s12):2==i?3==t.dataModle?t.setText(3,t.num_s12):t.setText(3,t.num_s2):3==i&&t.setText(4,t.num_s12_2),t.tmpStep++};e(),this.dattime=setInterval(e,3e3)}else this.setText(-1,this.num_s2);this.bg.gl.visible=!0}},{key:"setText",value:function(t,e){this.red.visible=2>=arguments.length||arguments[2]===undefined||arguments[2],this.hideNum(),0>t||(this.bg.n3.visible=!0,this.bg.n3.gotoAndStop(t));var i=this.getValueStr(e),o=i[2];0===o?this.red.y=244.65:(this.bg.dot.visible=!0,this.red.y=226.9,this.bg.dot.x=1===o?19.25:-13.5);var n=i[0]+"";0===o&&(n=(1e3+i[0]+"").substr(1,3)),n=n.replace(".","");for(var s=2;s>=0;s--){var a=this.bg["n"+(2-s)];if(a){a.visible=!0;a.gotoAndStop(+n.charAt(s))}}}},{key:"createPully",value:function(){var t=this;this.tophock=new y["default"](this.paramObj),this.parent.addChild(this.tophock),this.tophock.init(),this.addBodyToSpace(this.tophock.body),this.tophock.injectListenOption([this.CbTypeStr.AIR_SLIDEBLOCK_HOCK]),this.bothock=new y["default"](this.paramObj),this.parent.addChild(this.bothock),this.bothock.init(),this.bothock.injectListenOption([this.CbTypeStr.ALUMINUM_BLOCK,this.CbTypeStr.HOOK_TOP_GOU]),this.addBodyToSpace(this.bothock.body),this.bothock.body.noallowRotation=!0;var e=this.body.localPointToWorld(_.get(-400,-113)),i=this.body.localPointToWorld(_.get(670,94));this.tophock.body.set_position(e),this.bothock.body.set_position(i);this.pj=this.JointUtil.createPulleyJoint(this.tophock.body,this.body,this.body,this.bothock.body,this.tophock.body.position,this.body.localPointToWorld(_.get(650,-113)),this.body.localPointToWorld(_.get(670,-90)),this.bothock.body.position,0,1250),this.tophock.weld(this.body,this.tophock.body.position),this.pj.updateline=function(){t.pullyline.clear(),t.pullyline.lineStyle(3,16750848);var e=t.body.worldPointToLocal(t.tophock.body.get_position()),i=t.body.worldPointToLocal(t.bothock.body.get_position());t.pullyline.moveTo(e.get_x(),e.get_y()),t.pullyline.lineTo(650,-113),t.pullyline.moveTo(670,-90),t.pullyline.lineTo(i.get_x(),i.get_y())}}},{key:"removePully",value:function(){this.BodyUtil.destoryJoint(this.pj);var t=this.parent;this.tophock.removed(),this.bothock.removed(),this.parent.removeChild(this.tophock),this.parent.removeChild(this.bothock),this.pj.updateline=null,this.tophock=null,this.bothock=null,this.pj=null,t.component=this}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.iszero||this.isShowDat||this.playValueToScreen(),this.pj&&this.pj.updateline(),this.qbxy&&(this.qbeng.x=this.x+this.qbxy.x,this.qbeng.y=this.y+this.qbxy.y)}},{key:"freshEquipShows",value:function(t){this.txtCon.visible=t}},{key:"removed",value:function(){this.removedCursor(this.fireBtn),this.removedCursor(this.stopBtn),this.removedCursor(this.clearBtn),this.removedCursor(this.abBtn),this.removedCursor(this.qbeng.airpower),this.pj&&this.removePully(),this.iswhiff=!1,this.playSound(!1),this.gun.dragToolClick(),this.gun.dispose(),this.removeNapeListeners(this.rightfireListener),this.removeNapeListeners(this.s1HitStart),this.removeNapeListeners(this.s1HitEnd),this.removeNapeListeners(this.s2HitStart),this.removeNapeListeners(this.s2HitEnd),l.M.removeTouch(this.qbeng.airpower,this.powerTouchId),l.M.removeTouch(this.s1,this.s1TouchId),l.M.removeTouch(this.s2,this.s2TouchId),this.fireBtn.dispose(),this.stopBtn.dispose(),this.clearBtn.dispose(),this.abBtn.dispose(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.model=this.getStatus(),t.s1x=this.s1.x,t.s2x=this.s2.x,t.shimNum=this.shimNum,t.speed=this.gunSpeed+"cm/s",this.tophock&&(t.bothock={x:this.bothock.body.posx,y:this.bothock.body.posy},t.tophock={x:this.tophock.body.posx,y:this.tophock.body.posy,jac:this.tophock.weldJoint.active}),t.showSpeed=this.showSpeed,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.model!=this.getStatus()&&this.changeStatus({showValue:t.model}),this.s1.x=t.s1x,this.s2.x=t.s2x,this.s1Shape.set_localCOM(_.get(this.s1.x,this.s1.y)),this.s2Shape.set_localCOM(_.get(this.s2.x,this.s2.y)),this.refreshkdLine(),t.shimNum!=this.shimNum&&this.changeShim({showValue:t.shimNum}),this.changeSpeed({showValue:t.speed}),t.tophock&&(this.bothock.body.set_position(_.get(t.bothock.x,t.bothock.y)),this.tophock.body.set_position(_.get(t.tophock.x,t.tophock.y)),1==t.tophock.jac?this.tophock.updateWeld(!0):this.tophock.weldJoint.active=!1),this.showSpeed=!!t.showSpeed,this.showTxtValue()}},{key:"refreshkdLine",value:function(){var t=this.s2.x-this.s1.x;this.curtdis=l.M.getNumJie(t/this.unitdw,2)-0,this.txt.text=this.curtdis+"cm";var e=this.txt.width;this.txt.x=this.s1.x+t/2;var i=l.M.getPointLen(this.s1,this.s2),o=(i-e)/2;this.line.clear(),this.line.lineStyle(2,16777215),this.line.moveTo(this.s1.x,this.s1.y),this.line.lineTo(this.s1.x+o,this.s1.y),this.line.moveTo(this.s2.x-o,this.s2.y),this.line.lineTo(this.s2.x,this.s2.y)}},{key:"changeSpeed",value:function(t){this.gunSpeed=l.M.getNumStr(t.showValue)-0}},{key:"changeStatus",value:function(t){var e=this.patternArr[t.checked];this.getStatus()!=e&&(e===this.nomalStr?(this.bg.dizuo.gotoAndStop(0),this.rightfire.translate(_.get(-20)),this.fireMaterial.set_elasticity(1),this.removePully(),this.pullyline.clear()):(this.bg.dizuo.gotoAndStop(1),this.rightfire.translate(_.get(20)),this.fireMaterial.set_elasticity(0),this.createPully()))}},{key:"getStatus",value:function(){return 0==this.bg.dizuo.currentFrame?this.nomalStr:this.pullyStr}},{key:"changeShim",value:function(t){this.shimNum=t.showValue-0,this.dp.gotoAndStop(this.shimNum);this.body.set_rotation(.01*this.shimNum-.01)}},{key:"pixToCen",value:function(t){return l.M.getNumJie(t/this.unitdw,1)}},{key:"getMaxS1",value:function(){return this.pixToCen(this.s2.x-this.leftpx)}},{key:"getMinS2",value:function(){return this.pixToCen(this.s1.x-this.leftpx)}},{key:"changeS1Cen",value:function(t){var e=l.M.getNumStr(t.showValue)-0;e*=this.unitdw,this.s1.x=this.leftpx+e,this.refreshkdLine(),this.showToolDatas()}},{key:"changeS2Cen",value:function(t){var e=l.M.getNumStr(t.showValue)-0;e*=this.unitdw,this.s2.x=this.leftpx+e,this.refreshkdLine(),this.showToolDatas()}},{key:"showSpeedChanged",value:function(t){this.showSpeed=t.checked,this.showTxtValue()}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("eject_speed"),!0,"cm/s",100,0,this.gunSpeed,1,this.changeSpeed,this),this.ComponentProperty.getRadio(this.language.getLocaleStr("pattern"),this.bg.dizuo.currentFrame,this.patternArr,this.changeStatus.bind(this)),this.ComponentProperty.getDropMenu(this.language.getLocaleStr("gaskets_num"),!1,"",this.shimNum,["0","1","2","3"],this,this.changeShim,3,1),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("photogate")+" s1",!0,"cm",this.getMaxS1(),0,this.pixToCen(this.s1.x-this.leftpx),.1,this.changeS1Cen,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("photogate")+" s2",!0,"cm",150,this.getMinS2(),this.pixToCen(this.s2.x-this.leftpx),.1,this.changeS2Cen,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("show_speed"),this.showSpeed,this.showSpeedChanged,this)),t}},{key:"getLocalBoundsElecs",value:function(){return[this,this.qbeng]}},{key:"showGlowSP",value:function(t){if(t){this.showGlowIndex(this.iswhiff?1:0)}else this.hideGlow()}}]),e}(d["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function p(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:p(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(446),l=function(t){return t&&t.__esModule?t:{"default":t}}(h),u=void 0,c=void 0,d=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return u=i.phy.nape,c=u.geom.Vec2,d=u.shape.HockShapeBase,i._width=83,i._height=120,i.tophock=null,i.material=u.phys.Material.steel(),i.isuse=!1,i.typeIndex=0,i}return s(e,t),a(e,[{key:"init",value:function(){this.material.set_density(8.9),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.tophock=new d(15),this.tophock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.tophock),this.tophock.translate(c.get(0,-80)),this.tophock.addCbtype(this.CbTypeStr.HOOK_TOP_GOU,!0),this.tophock.connectVec=c.get(0,-10),this.tophock.get_material().set_density(.2),this.interval=null,this.addTweenQuan(this.tophock)}},{key:"removed",value:function(){this.interval&&(clearTimeout(this.interval),this.interval=null),this.tophock.dragToolClick(),this.tophock.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.typeIndex=this.typeIndex,t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),isNaN(t.typeIndex)||t.typeIndex===this.typeIndex||this.switchCaizhi({showValue:this.caizhi[t.typeIndex]})}},{key:"switchCaizhi",value:function(t){this.typeIndex=this.caizhi.indexOf(t.showValue);var e={density:1,dynamicFriction:0,elasticity:1,rollingFriction:0,staticFriction:0};switch(this.typeIndex){case 0:e.elasticity=.2,e.dynamicFriction=.57,e.staticFriction=.74,e.density=8.9,e.rollingFriction=.001;break;case 1:e.elasticity=.2,e.dynamicFriction=.57,e.staticFriction=.74,e.density=7.8,e.rollingFriction=.001;break;case 2:e.elasticity=.2,e.dynamicFriction=.57,e.staticFriction=.74,e.density=2.7,e.rollingFriction=.001;break;case 3:e.elasticity=.4,e.dynamicFriction=.2,e.staticFriction=.38,e.density=.7,e.rollingFriction=.005}this.bg.gotoAndStop(this.typeIndex),this.BodyUtil.setMaterialFromObject(this.material,e)}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getDropMenu(this.language.getLocaleStr("type"),!1,"",this.currentCZ,this.caizhi,this,this.switchCaizhi,1,0)),t}},{key:"showGlowSP",value:function(t){if(t){this.showGlowIndex(this.tophock.get_userData().useing?1:0)}else this.hideGlow()}},{key:"caizhi",get:function(){return[this.language.getLocaleStr("copper_block"),this.language.getLocaleStr("steel_block"),this.language.getLocaleStr("aluminum_block"),this.language.getLocaleStr("wood_block")]}},{key:"currentCZ",get:function(){return this.caizhi[this.typeIndex]}},{key:"isUseing",get:function(){return this.tophock.get_userData().useing}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function m(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:m(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(449),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.NbBody,g=y.shape.Polygon,b=y.phys.Compound,v=y.phys.BodyType,_=y.geom.Vec2,i.level=14,i.halfleng=130.5,i.canRotate=!1,i.rulerBody=null,i.leftBody=null,i.rightBody=null,i.youbiaoBody=null,i.ybBox=null,i.luoleftBox=null,i.luorightBox=null,i.rulerJoint=null,i.canLeveling=!0,i.nosetbodyxy=!0,i.compo=new b,i.onekeyph=!1,i.jarr=[],i.k5omg=[33,36,4.5],i.k10omg=[33,37,8.5],i.curtK=i.k5omg,i.ltype=0,i.ltypeArr=["100g","500g"],i.leftTouchid=null,i.rightTouchid=null,i.biaoTouchid=null,i.ybObj={width:0,height:0},i.dixy={x:0,y:0},i}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.left.interactive=!1,this.left.interactiveChildren=!1,this.right.interactive=!1,this.right.interactiveChildren=!1,this.ybObj.width=this.gang.youbiao.width,this.ybObj.height=this.gang.youbiao.height,this.body.set_type(v.get_KINEMATIC()),this.halfleng=this.gang.biaochi.width/2-93,this.dixy.x=this.pan.x-this.bot.x,this.dixy.y=this.pan.y-this.bot.y,this.pan.selectTarget=this.parent,this.compo.set_space(this.body.get_space()),this.body.set_compound(this.compo),this.initBg(),this.initGang(),this.body.userData.handJointFrequency=1e8,this.initTp(),this.initYoubiao(),this.gang.nie.visible=!1;var t={x:this.gang.nie.x,y:this.gang.nie.y};this.bot.addChild(this.gang.nie),this.setniePosition(t),this.initLun(),this.gang.youbiao.x=.5*this.ybObj.width-this.halfleng+Math.random()*this.halfleng*2,this.ybBox.set_localCOM(_.get(this.gang.youbiao.x,0),0),this.gang.leftlun.x=50*Math.random()-600,this.gang.rightlun.x=600+50*Math.random(),this.changeRightBox(),this.addCursor(this.gang.youbiao,"zuoyou"),this.addCursor(this.gang.leftlun,"shangxia"),this.addCursor(this.gang.rightlun,"shangxia")}},{key:"initLun",value:function(){function t(t,e){s=this.getViewMouseXY(t).y,h=e.currentFrame}function e(t,e){this.onekeyph=!1;var i=this.getViewMouseXY(t),o=1;i.y-s>0?(o=1,h++):(o=-1,h--),e.totalFrames>h||(h=0),0>h&&(h=e.totalFrames),this.gang.leftlun==e?(this.gang.leftlun.x+=.6*o,this.gang.leftlun.x>-a&&(this.gang.leftlun.x=-a),-r>this.gang.leftlun.x&&(this.gang.leftlun.x=-r)):this.gang.rightlun==e&&(this.gang.rightlun.x+=.6*o,a>this.gang.rightlun.x&&(this.gang.rightlun.x=a),this.gang.rightlun.x>r&&(this.gang.rightlun.x=r)),e.gotoAndStop(h),this.changeRightBox(),s=i.y}function i(t,e){}var o=this.gang.leftlun.width,n=this.gang.leftlun.height;this.luoleftBox=new g(g.box(o,n)),this.rulerBody.add(this.luoleftBox),this.luoleftBox.set_sensorEnabled(!0),this.luorightBox=new g(g.box(o,n)),this.rulerBody.add(this.luorightBox),this.luorightBox.set_sensorEnabled(!0),this.BodyUtil.setShapeMass(this.luoleftBox,this.curtK[0]),this.BodyUtil.setShapeMass(this.luorightBox,this.curtK[1]),this.leftTouchid=l.M.addTouch(this.gang.leftlun,{begin:t,move:e,end:i},this),this.rightTouchid=l.M.addTouch(this.gang.rightlun,{begin:t,move:e,end:i},this);var s=void 0,a=550,r=650,h=0}},{key:"changeRightBox",value:function(){this.luoleftBox.set_localCOM(_.get(this.gang.leftlun.x,this.gang.leftlun.y)),this.luorightBox.set_localCOM(_.get(this.gang.rightlun.x,this.gang.rightlun.y))}},{key:"setniePosition",value:function(t){var e=this.bot.toLocal(t,this.gang);this.gang.nie.x=e.x,this.gang.nie.y=e.y}},{key:"initYoubiao",value:function(){var t=this;this.ybBox=new g(g.box(this.ybObj.width,this.ybObj.height)),this.rulerBody.add(this.ybBox),this.ybBox.set_sensorEnabled(!0),this.BodyUtil.setShapeMass(this.ybBox,this.curtK[2]);var e=new l.Point;this.biaoTouchid=l.M.addTouch(this.gang.youbiao,{begin:function(i){var o=t.getMouseXY(i);e.x=o.x,t.body.forbidDrag(!0),t.gang.nie.visible=!0,t.setniePosition({x:t.gang.youbiao.x,y:t.gang.youbiao.y+20})},move:function(i){var o=t.getMouseXY(i);t.gang.youbiao.x+=o.x-e.x,e.x=o.x,.5*t.ybObj.width-t.halfleng>t.gang.youbiao.x&&(t.gang.youbiao.x=.5*t.ybObj.width-t.halfleng),t.gang.youbiao.x>t.halfleng+.5*t.ybObj.width&&(t.gang.youbiao.x=t.halfleng+.5*t.ybObj.width),t.ybBox.set_localCOM(_.get(t.gang.youbiao.x,0)),t.setniePosition({x:t.gang.youbiao.x,y:t.gang.youbiao.y+20})},end:function(e){t.body.forbidDrag(!1),t.gang.nie.visible=!1}})}},{key:"initTp",value:function(){function t(t,o){var n=new g(g.box(o.width,e)),s=new f;return n.get_cbTypes().add(t.CbTypeStr.BALANCE_PAN),s.noallowRotation=!0,s.add(n),n.translate(i),s.set_position(t.body.localPointToWorld(_.get(o.x,o.y))),s.userData.view=o,s.userData.isnbequ=!0,s}this.left.tpH.visible=!1,this.right.tpH.visible=!1;var e=this.left.tpH.height,i=_.get(this.left.tpH.x,this.left.tpH.y);this.leftBody=t(this,this.left),this.rightBody=t(this,this.right),this.addBodyToSpace(this.leftBody,this),this.addBodyToSpace(this.rightBody,this);var o=this.leftBody.get_position(),n=this.rightBody.get_position(),s=this.JointUtil.createPivotJoint(this.leftBody,this.rulerBody,o,o),a=this.JointUtil.createPivotJoint(this.rightBody,this.rulerBody,n,n);this.leftBody.set_compound(this.compo),this.rightBody.set_compound(this.compo),s.set_compound(this.compo),a.set_compound(this.compo),this.leftBody.userData.handJointFrequency=1,this.rightBody.userData.handJointFrequency=1;var r=this.JointUtil.createDistanceJoint(this.leftBody,this.body,o,_.get(o.get_x(),o.get_y()+100),100,100),h=this.JointUtil.createDistanceJoint(this.rightBody,this.body,n,_.get(n.get_x(),n.get_y()+100),100,100);r.frequency=h.frequency=.9,r.damping=h.damping=.3,r.stiff=h.stiff=!1,r.ignore=r.ignore=!1,r.set_compound(this.compo),h.set_compound(this.compo)}},{key:"initGang",value:function(){var t=new g(g.box(this.gang.biaochi.width,this.gang.biaochi.height));this.rulerBody=new f,this.rulerBody.add(t),t.translate(_.get(this.gang.biaochi.x,this.gang.biaochi.y));var e=this.body.localPointToWorld(_.get(this.gang.x,this.gang.y));this.rulerBody.set_position(e),this.rulerBody.userData.view=this.gang,this.rulerBody.forbidDrag(!0),this.addBodyToSpace(this.rulerBody,this),this.rulerBody.set_shape_sensorEnabled(t,!0);this.rulerJoint=this.JointUtil.createPivotJoint(this.body,this.rulerBody,e,e),this.rulerJoint.coerceAB=!0,this.rulerJoint.aTob=!1;var i=this.JointUtil.createAngleJoint(this.body,this.rulerBody,-.12,.12);i.set_frequency(1e5),i.set_stiff(!1),this.rulerBody.set_compound(this.compo),this.rulerJoint.set_compound(this.compo),i.set_compound(this.compo)}},{key:"initBg",value:function(){var t=this;this.body.shapes.clear();var e=new g(g.box(this.bot.width,this.bot.height));e.set_sensorEnabled(!0),this.body.add(e),e.translate(_.get(this.bot.x,this.bot.y));var i=new g(g.box(235,this.pan.zhen.height));i.set_sensorEnabled(!0),this.body.add(i),i.translate(_.get(this.pan.zhen.x,this.pan.zhen.y)),this.resetUserView(this.pan,this,!0),this.pan.addEventListener(p["default"].BEGIN,function(e){t.startMove()}),this.pan.addEventListener(p["default"].END,function(e){t.endMove()}),this.pan.kuang.alpha=0,this.pan.kuang.y=10}},{key:"startMove",value:function(t){var e=this.BodyUtil.getAllCollisionBodys(this.leftBody);e=e.concat(this.BodyUtil.getAllCollisionBodys(this.rightBody));var i=0;for(i=0;e.length>i;i++){var o=e[i];if(o!==this.body){var n=o.position;this.jarr.push(this.JointUtil.createWeldJoint(this.body,o,n,n))}}}},{key:"endMove",value:function(t){var e=void 0;for(e=0;this.jarr.length>e;e++)this.BodyUtil.destoryJoint(this.jarr[e]);this.jarr.length=0}},{key:"removed",value:function(){this.removedCursor(this.gang.youbiao),this.removedCursor(this.gang.leftlun),this.removedCursor(this.gang.rightlun),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this),this.BodyUtil.destoryBody(this.rulerBody),this.BodyUtil.destoryBody(this.leftBody),this.BodyUtil.destoryBody(this.rightBody),this.pan.removeAllListeners(),l.M.removeTouch(this.gang.leftlun,this.leftTouchid),l.M.removeTouch(this.gang.rightlun,this.rightTouchid),l.M.removeTouch(this.gang.youbiao,this.biaoTouchid)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.onekeyph=this.onekeyph,t.youbiaoX=this.gang.youbiao.x,t.rulerBodyRot=this.rulerBody.rotation,t.lc=this.getLc(),t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),1==t.onekeyph&&this.changePingHeng({checked:!0}),t.youbiaoX&&(this.gang.youbiao.x=t.youbiaoX,this.ybBox.set_localCOM(_.get(this.gang.youbiao.x,0)),this.rulerBody.rotation=t.rulerBodyRot),t.lc&&t.lc!=this.getLc()&&this.changeLc({showValue:t.lc}),this.BodyUtil.frezzBody(this.rulerBody),this.BodyUtil.frezzBody(this.leftBody),this.BodyUtil.frezzBody(this.rightBody);var i=this.body.get_position();this.compo.translate(_.get(t.posx-i.get_x(),t.posy-i.get_y()))}},{key:"changePingHeng",value:function(t){this.gang.rightlun.x=580,this.gang.youbiao.x=.5*this.ybObj.width-this.halfleng,this.ybBox.set_localCOM(_.get(this.gang.youbiao.x,0),0);var e=this.BodyUtil.getShapeMass(this.luoleftBox),i=this.BodyUtil.getShapeMass(this.ybBox);this.gang.leftlun.x=5-(580*this.BodyUtil.getShapeMass(this.luorightBox)-i*Math.abs(this.gang.youbiao.x))/e,this.changeRightBox(),this.onekeyph=!0}},{key:"changeLc",value:function(t){this.ltype=t.checked,0===this.ltype?(this.curtK=this.k5omg,this.gang.biaochi.gotoAndStop(0)):1===this.ltype&&(this.curtK=this.k10omg,this.gang.biaochi.gotoAndStop(1)),this.showToolDatas(),this.refreshLuoMuMass(),this.onekeyph&&this.changePingHeng()}},{key:"getLc",value:function(){return 0===this.ltype?"100g":"500g"}},{key:"getFd",value:function(){return 0===this.ltype?"0.2":"0.5"}},{key:"refreshLuoMuMass",value:function(){this.BodyUtil.setShapeMass(this.luoleftBox,this.curtK[0]),this.BodyUtil.setShapeMass(this.luorightBox,this.curtK[1]),this.BodyUtil.setShapeMass(this.ybBox,this.curtK[2])}},{key:"clickLeveling",value:function(){this.changePingHeng()}},{key:"getConf",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr=[],t.confArr.push(this.ComponentProperty.getLabel(this.language.getLocaleStr("min_divid_value"),this.getFd()),this.ComponentProperty.getRadio(this.language.getLocaleStr("range"),this.ltype,this.ltypeArr,this.changeLc.bind(this))),t}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.bot.x=this.pan.x-this.dixy.x,this.bot.y=this.pan.y-this.dixy.y}},{key:"selectRenderChild",value:function(){return this.pan.getBounds()}},{key:"getTipMess",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.language.getLocaleStr("min_divid_value")+": "+this.getFd()+"\n    "+this.language.getLocaleStr("range")+": "+this.ltype+"\n    "}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function c(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:c(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(226),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.thumb=null,i.finger=null,i.tube=null,i.liquid=null,i.column=null,i.pressArea=null,i.pressRect=new PIXI.Rectangle(-104,-65,212,280),i.pressArea2=null,i.pressRect2=new PIXI.Rectangle(-230,-58,366,277),i.pressTouchId=0,i.pressTouchId2=0,i.isPressed=!1,i.COLUMN_HEIGHT_0=420,i.COLUMN_HEIGHT_1=460,i.COLUMN_HEIGHT_2=500,i}return s(e,t),a(e,[{key:"added",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.pressArea2=this.createRectGra(this.pressRect2),this.pressArea=this.createRectGra(this.pressRect),this.column.height=this.COLUMN_HEIGHT_0,this.pressTouchId=h.M.addTouch(this.pressArea,{begin:this.pressBegin,move:this.pressMove,end:this.pressEnd},this),this.addCursor(this.pressArea,"hand"),this.pressTouchId2=h.M.addTouch(this.pressArea2,{begin:this.pressBegin2,move:this.pressMove2,end:this.pressEnd},this),this.addCursor(this.pressArea2,"hand")}},{key:"createRectGra",value:function(t){var e=new PIXI.Graphics;return this.addChild(e),e.beginFill(0,0),e.drawRect(t.x,t.y,t.width,t.height),e.endFill(),e}},{key:"removed",value:function(){this.removedCursor(this.pressArea),this.pressTouchId&&(h.M.removeTouch(this.pressArea,this.pressTouchId),this.pressTouchId=null),this.removedCursor(this.pressArea2),this.pressTouchId2&&(h.M.removeTouch(this.pressArea2,this.pressTouchId2),this.pressTouchId2=null),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"pressBegin",value:function(t){this.touchEnabled=!1,this.isPressed=!0,this.thumb.gotoAndStop(1),this.finger.gotoAndStop(1),this.tweenColumn(this.COLUMN_HEIGHT_1)}},{key:"pressMove",value:function(t){var e=this.getMouseXY(t);e=this.toLocal(e,this.getMain().view),this.pressRect.contains(e.x,e.y)||this.pressEnd(t)}},{key:"pressEnd",value:function(t){this.touchEnabled=!0,this.isPressed&&(this.isPressed=!1,this.thumb.gotoAndStop(0),this.finger.gotoAndStop(0),this.tweenColumn(this.COLUMN_HEIGHT_0))}},{key:"pressBegin2",value:function(t){this.touchEnabled=!1,this.isPressed=!0,this.thumb.gotoAndStop(2),this.finger.gotoAndStop(2),this.tweenColumn(this.COLUMN_HEIGHT_2)}},{key:"pressMove2",value:function(t){var e=this.getMouseXY(t);e=this.toLocal(e,this.getMain().view),this.pressRect2.contains(e.x,e.y)||this.pressEnd(t)}},{key:"tweenColumn",value:function(t){TweenLite.to(this.column,.5,{height:t})}},{key:"selectRenderChild",value:function(){return this.updateTransform(),this.getBounds()}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function x(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:x(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(664),u=o(l),c=i(446),d=o(c),p=void 0,y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0,m=void 0;e["default"]=function(t){function e(){n(this,e);var t=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return p=u["default"].getInstance().nape,y=p.NbBody,m=p.shape.LiquidShape,f=p.geom.Vec2,g=p.shape.Polygon,b=p.phys.BodyType,v=p.dynamics.ArbiterType,_=p.shape.Circle,t.level=14,t}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.dragLevel=-2,this.removeChild(this.bg),this.graphics=new PIXI.Graphics,this.addChild(this.graphics),this.drawBunker()}},{key:"drawBunker",value:function(){var t=500,e=300;this.graphics.beginFill(16777215,.5),this.graphics.drawRect(-250,-150,t,e),this.graphics.endFill(),this.graphics.lineStyle(4,16776960),this.graphics.moveTo(-250,-150),this.graphics.lineTo(-250,150),this.graphics.lineTo(250,150),this.graphics.lineTo(250,-150),this.body.get_shapes().clear(0);var i=new g(g.rect(-250,-150,30,e)),o=new g(g.rect(250,-150,30,e)),n=new g(g.rect(-250,150,t,30));this.body.get_shapes().add(i),this.body.get_shapes().add(o),this.body.get_shapes().add(n);for(var s=new p.dynamics.InteractionGroup(!0),a=0;15>a;a++)for(var r=0;15>r;r++){var h=new y;h.get_shapes().add(new _(10)),h.set_space(this.body.get_space()),h.set_position(this.body.get_position()),h.set_group(s)}this.body.set_type(b.get_KINEMATIC())}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this)}}]),e}(d["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function v(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:v(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0,y=void 0,f=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.geom.Vec2,p=c.shape.Polygon,y=c.phys.BodyType,f=c.shape.LiquidShape,i.gravity=9.8,i.density=1,i.woodDensity=.5,i.h1px=0,i.h1cm=0,i.h2px=0,i.h2cm=0,i.liquidTop=-102,i.pxPerCm=9.6,i.targetY=0,i.islock=!1,i.isPress=!0,i.minHpx=0,i.maxHpx=260,i.minHcm=i.px2cm(i.minHpx),i.maxHcm=i.px2cm(i.maxHpx),i.verticesArr=i.Vec2Util.pointArrArrToVec2ArrArr([[{x:-141.35,y:-162.25},{x:-128.8,y:205.6},{x:-118.8,y:205.25},{x:-131.35,y:-162.6}],[{x:167,y:-207.5},{x:167,y:207.4},{x:177,y:207.4},{x:177,y:-207.5}],[{x:177,y:171.35},{x:-140.95,y:171.35},{x:-140.95,y:206.75},{x:177,y:206.75}]]),i.WOOD_WIDTH=96,i.WOOD_HEIGHT=102,i.WIDTH=363,i.HEIGHT=440,i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.noallowRotation=!0,this.body.userData.cannotToolRot=!0,this.body.userData.dragLevel=-1,this.waterBeaker.interactiveChildren=!1,this.waterBeaker.interactive=!1,this.wood.interactive=!0,this.labelGraphic=new g,this.labelGraphic.x=this.wood.x,this.addChild(this.labelGraphic);var t=new PIXI.Graphics;this.addChildAt(t,0),t.beginFill(0,0),t.drawRect(-this.WIDTH/2,-this.HEIGHT/2,this.WIDTH,this.HEIGHT),t.endFill(),this.updateMinH(),this.woodTouchid=h.M.addTouch(this.wood,{begin:this.woodTouchBegin,move:this.woodTouchgMove,end:this.woodTouchEnd},this),this.needleTouchid=h.M.addTouch(this.needle,{begin:this.woodTouchBegin,move:this.woodTouchgMove,end:this.woodTouchEnd},this),this.addCursor(this.wood,"shangxia"),this.addCursor(this.needle,"shangxia"),this.selfRender();var i=new f(p.box(300,260));this.body.add(i),i.addCbtype(this.CbTypeStr.LIQUID_SHAPE),i.set_filter(this.InteractionFilterManager.LIQUID_GROUP),i.translate(d.get(20,30)),i.density=1,this.liquid=i,this.needle.x-=4}},{key:"removed",value:function(){this.removedCursor(this.wood),this.removedCursor(this.needle),h.M.removeTouch(this.wood,this.woodTouchid),h.M.removeTouch(this.needle,this.needleTouchid),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this);var t=this.napeEngine.getGravity();this.gravity!==t&&(0!==this.gravity||this.isPress||this.tween2Top(),this.gravity=t,this.selfRender())}},{key:"createShape",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createShape",this).call(this);var t=new p(p.box(this.WIDTH,this.HEIGHT));this.body.add(t),t.set_sensorEnabled(!0)}},{key:"woodTouchBegin",value:function(t){this.touchEnabled=!1,this.oldP=this.getMouseXY(t)}},{key:"woodTouchgMove",value:function(t){var e=this.getMouseXY(t);this.wood.y+=e.y-this.oldP.y,this.oldP=e,this.selfRender()}},{key:"woodTouchEnd",value:function(t){this.touchEnabled=!0,this.freshLibPan(),this.needle.visible||0!==this.gravity&&this.tween2Top(),this.freshLibPan()}},{key:"selfRender",value:function(){this.liquidTop+this.minHpx-this.WOOD_WIDTH/2>this.wood.y&&(this.wood.y=this.liquidTop+this.minHpx-this.WOOD_WIDTH/2),this.wood.y>this.liquidTop+this.maxHpx-this.WOOD_WIDTH/2&&(this.wood.y=this.liquidTop+this.maxHpx-this.WOOD_WIDTH/2),this.h1px=this.wood.y-this.WOOD_WIDTH/2-this.liquidTop,this.h2px=this.h1px+this.WOOD_WIDTH,this.h1cm=this.px2cm(this.h1px),this.h2cm=this.px2cm(this.h2px),this.needle.y=this.liquidTop+this.h1px+8;var t=this.getPressureByPx(this.h1px),e=this.getPressureByPx(this.h2px),i=this.getPressureScale(),o=this.getArea();this.labelGraphic.pressScale=i,this.labelGraphic.h0=this.liquidTop,this.labelGraphic.h1px=this.h1px,this.labelGraphic.h2px=this.h2px,this.labelGraphic.h1cm=this.h1cm,this.labelGraphic.h2cm=this.h2cm,this.labelGraphic.f1=t*o,this.labelGraphic.f2=e*o,this.labelGraphic.y=this.wood.y,this.labelGraphic.selfRender()}},{key:"getArea",value:function(){var t=this.px2cm(this.WOOD_WIDTH);return t*t}},{key:"updateMinH",value:function(){this.minHpx=this.woodDensity*this.WOOD_WIDTH/this.density,this.minHcm=this.px2cm(this.minHpx)}},{key:"getPressureByPx",value:function(t){return t>0?this.getPressureBycm(this.px2cm(t)):0}},{key:"getPressureBycm",value:function(t){return t>0?this.density*this.gravity*t*.001:0}},{key:"getPressureScale",value:function(){return this.density*this.gravity/9.8}},{key:"getWoodTotalForce",value:function(){return 1*this.gravity-(this.labelGraphic.f2-this.labelGraphic.f1)}},{key:"cm2px",value:function(t){return t*this.pxPerCm}},{key:"px2cm",value:function(t){return t/this.pxPerCm}},{key:"changeLock",value:function(t){this.islock=t.checked,this.islock?(this.body.set_type(y.get_KINEMATIC()),this.BodyUtil.frezzBody(this.body)):(this.body.set_type(y.get_DYNAMIC()),this.body.set_allowRotation(!1))}},{key:"changeWoodDensity",value:function(t){if(this.woodDensity=t.showValue,this.updateMinH(),!this.isPress){this.wood.y=this.liquidTop+this.minHpx-this.WOOD_WIDTH/2}this.selfRender(),this.delayConfInterval&&clearTimeout(this.delayConfInterval),this.delayConfInterval=setTimeout(function(){},500)}},{key:"changeDensity",value:function(t){if(this.density=t.showValue,this.liquid.density=this.density,this.updateMinH(),!this.isPress){this.wood.y=this.liquidTop+this.minHpx-this.WOOD_WIDTH/2}this.selfRender(),this.delayConfInterval&&clearTimeout(this.delayConfInterval),this.delayConfInterval=setTimeout(function(){},500)}},{key:"changeH",value:function(t){this.h2cm=t.showValue,this.h2px=this.cm2px(this.h2cm),this.wood.y=this.h2px+this.liquidTop-this.WOOD_WIDTH/2,this.selfRender()}},{key:"changePress",value:function(t){this.isPress=t.checked,this.isPress?this.needle.visible=!0:(this.needle.visible=!1,0!==this.gravity&&this.tween2Top()),this.selfRender(),this.freshLibPan()}},{key:"tween2Top",value:function(){var t=this,e=this.liquidTop+this.minHpx-this.WOOD_WIDTH/2,i=.03*Math.abs((this.wood.y-e)/10);TweenLite.to(this.wood,i,{y:e,onUpdate:function(){t.selfRender()},onComplete:function(){t.freshLibPan()}})}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.islock=this.islock,t.isPress=this.isPress,t.density=this.density,t.woodDensity=this.woodDensity,t.h2cm=this.h2cm,t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.islock=t.islock,this.isPress=t.isPress,this.density=t.density,this.woodDensity=t.woodDensity,this.h2cm=t.h2cm,this.liquid.density=this.density,this.h2px=this.cm2px(this.h2cm),this.wood.y=this.h2px+this.liquidTop-this.WOOD_WIDTH/2,this.updateMinH(),this.changeLock({checked:this.islock}),this.changePress({checked:this.isPress})}},{key:"getConf",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push(this.ComponentProperty.getLabel(this.language.getLocaleStr("wood_border_len"),this.px2cm(this.WOOD_WIDTH)+"cm"),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("liquid_density"),!1,"g/cm³",1.5,.8,this.density,.01,this.changeDensity,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("wood_density"),!1,"g/cm³",.8,.3,this.woodDensity,.01,this.changeWoodDensity,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("lock"),this.islock,this.changeLock,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("press"),this.isPress,this.changePress,this)),this.isPress&&t.confArr.splice(2,0,this.ComponentProperty.getScrollBar(this.language.getLocaleStr("immersion_depth"),!1,"cm",h.M.getNumJie(this.maxHcm,2),h.M.getNumJie(this.minHcm,2),h.M.getNumJie(this.h2cm,2),.1,this.changeH,this)),t}},{key:"getTipMess",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.language.getLocaleStr("liquid_density")+": "+this.density+"g/cm³\n    "}}]),e}(u["default"]);var g=function(t){function e(){o(this,e);var t=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.HW=48,t.pressScale=1,t.h0=0,t.h1px=0,t.h2px=0,t.h1cm=0,t.h2cm=0,t.f1=0,t.f2=0,t.interactive=!1,t.interactiveChildren=!1,t.BLUE=1939455,t.ORANGE=16734488,t.YELLOW=13408563,t.LEN_1=180,t.LEN_2=320,t.line01=t.createLine(50,0,2,t.LEN_2-40,t.ORANGE),t.line02=t.createLine(50,100,2,t.LEN_1-40,t.YELLOW),t.line03=t.createLine(50,200,2,t.LEN_2-40,t.ORANGE);t.arrowH10=new b(t,t.LEN_1-10,0,2,10,t.YELLOW,3),t.arrowH11=new b(t,t.LEN_1-10,0,2,10,t.YELLOW,1),t.arrowH20=new b(t,t.LEN_2-10,0,2,10,t.ORANGE,3),t.arrowH21=new b(t,t.LEN_2-10,0,2,10,t.ORANGE,1);return t.arrow10=new b(t,0,-t.HW,2,20,t.BLUE,1),t.arrow30=new b(t,0,t.HW,2,20,t.BLUE,3),t.arrow01=new b(t,-t.HW,-t.HW/3,2,20,t.BLUE,0),t.arrow02=new b(t,-t.HW,t.HW/3,2,20,t.BLUE,0),t.arrow20=new b(t,t.HW,-t.HW/3,2,20,t.BLUE,2),t.arrow21=new b(t,t.HW,t.HW/3,2,20,t.BLUE,2),t.arrow40=new b(t,0,-t.HW/3,2,20,t.BLUE,3,2),t.arrow41=new b(t,0,t.HW/3,2,20,t.BLUE,3,2),t.arrow40.lenScale=.4,t.arrow41.lenScale=.4,t.fArrows=[t.arrow10,t.arrow30,t.arrow01,t.arrow02,t.arrow20,t.arrow21,t.arrow40,t.arrow41],t.FONT_SIZE=20,t.tfH1=t.cretaeTf(t.LEN_1+10,0,t.FONT_SIZE,t.YELLOW),t.tfH2=t.cretaeTf(t.LEN_2+10,0,t.FONT_SIZE,t.ORANGE),t.tfF1=t.cretaeTf(-110,-t.HW-2*t.FONT_SIZE,t.FONT_SIZE,t.BLUE),t.tfF2=t.cretaeTf(-110,t.HW+t.FONT_SIZE,t.FONT_SIZE,t.BLUE),t.line=new PIXI.Graphics,t.addChild(t.line),t}return s(e,t),a(e,[{key:"cretaeTf",value:function(t,e,i,o){var n=new PIXI.Text("",{font:i+"px Arial",fill:o});return this.addChild(n),n.x=t,n.y=e,n}},{key:"createLine",value:function(t,e,i,o,n){var s=new PIXI.Graphics;return s.lineStyle(i,n,1),h.M.drawDashed(s,new PIXI.Point(0,0),new PIXI.Point(o,0),15,10),s.x=t,s.y=e,this.addChild(s),s}},{key:"selfRender",value:function(){this.line01.y=this.h0-this.y,this.line02.y=this.line01.y+this.h1px,this.line03.y=this.line01.y+this.h2px;this.arrowH10.y=this.line01.y+10,this.arrowH11.y=this.line02.y-10,this.arrowH20.y=this.line01.y+10,this.arrowH21.y=this.line03.y-10,this.arrowH11.len=this.arrowH10.len=this.h1px/2-10,this.arrowH10.selfRender(),this.arrowH11.selfRender(),this.arrowH20.len=this.arrowH21.len=this.h2px/2-10,this.arrowH20.selfRender(),this.arrowH21.selfRender(),this.tfH1.y=(this.line01.y+this.line02.y)/2-this.FONT_SIZE/2,this.tfH2.y=(this.line01.y+this.line03.y)/2-this.FONT_SIZE/2,this.tfH1.text="h1="+h.M.getNumJie(this.h1cm,2)+"cm",this.tfH2.text="h2="+h.M.getNumJie(this.h2cm,2)+"cm";for(var t=0;this.fArrows.length>t;t++){var e=this.fArrows[t],i=e.y-this.line01.y;0>i&&(i=0),e.scale.x=e.scale.y=0===this.pressScale?0:1+.005*i*this.pressScale,e.visible=i>0,e.offX=-7,e.selfRender()}this.tfF1.text="F1="+h.M.getNumJie(this.f1,2)+"N",this.tfF2.text="F2="+h.M.getNumJie(this.f2,2)+"N",this.tfH1.visible=this.arrowH10.visible=this.arrowH11.visible=this.line02.visible=this.tfF1.visible=this.arrow10.visible,this.line.clear(),-15>this.h1px&&(this.line.lineStyle(1,16777215,.2),this.line.moveTo(-48,-48-this.h1px),this.line.lineTo(48,-48-this.h1px)),this.arrow40.visible=!1,this.arrow41.visible=!1}}]),e}(PIXI.Graphics),b=function(t){function e(t,i,s,a,r,h,l,u){o(this,e);var c=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return c.offX=0,c.arrowType=u||1,c.x=i,c.y=s,c.w=a,c.len=r,c.co=h,c.dir=l,c.lenScale=1,c.graphics=new PIXI.Graphics,c.addChild(c.graphics),c.selfRender(),t.addChild(c),c}return s(e,t),a(e,[{key:"selfRender",value:function(){this.graphics.clear(),this.graphics.x=this.offX,1===this.arrowType?(this.graphics.beginFill(this.co,1),this.graphics.moveTo(0,4),this.graphics.lineTo(0,-4),this.graphics.lineTo(7,0),this.graphics.lineTo(0,4),this.graphics.endFill()):(this.graphics.beginFill(this.co,1),this.graphics.moveTo(0,4),this.graphics.lineTo(0,-4),this.graphics.lineTo(3,0),this.graphics.lineTo(0,4),this.graphics.endFill()),this.graphics.beginFill(this.co,1),this.graphics.drawRect(-this.len*this.lenScale,-this.w/2,this.len*this.lenScale,this.w),this.graphics.endFill(),this.rotation=Math.PI*this.dir*.5}}]),e}(PIXI.Graphics)},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function O(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:O(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(492),p=o(d),y=i(463),f=o(y),g=i(449),b=o(g),v=void 0,_=void 0,m=void 0,x=void 0,w=void 0,k=void 0,P=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return v=i.phy.nape,_=v.NbBody,m=v.phys.BodyType,x=v.shape.Circle,w=v.shape.Polygon,k=v.geom.Vec2,P=v.phys.Compound,i.ballBody1=null,i.ballBody2=null,i.rulerBody=null,i.rayBody=null,i.mirrBody=null,i.mirrShape=null,i.weld1=null,i.weld2=null,i.compo=new P,i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;this._width=290,this._height=470,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_type(m.get_KINEMATIC()),this.body.sensorEnabled(!0),this.compo.set_space(this.body.get_space()),this.body.set_compound(this.compo),this._shape.set_filter(this.NBOpticsStr.filters),this.resetUserView(this.bg,this,!0),this.initBall(),this.initRuler(),this.initMirr(),this.initRay(),this.body.userData.dragtranslate=!0,this.bg.translateMove=function(e,i){t.translateMove(e,i)},this.addCursor(this.left,"hand"),this.addCursor(this.right,"hand"),this.addCursor(this.ball1,"hand"),this.addCursor(this.ball2,"hand")}},{key:"translateMove",value:function(t,e){this.compo.translate(k.get(t,e))}},{key:"initMirr",value:function(){this.mirrBody=new _,this.mirrShape=new w(w.box(12,128)),this.mirrShape.set_sensorEnabled(!0),this.mirrBody.add(this.mirrShape);var t=new f["default"](!0,!1,1);t.var_open_angle=!1,t.var_show_direction=!1,this.mirrBody.noallowRotation=!0,this.mirrShape.get_userData().vo=t,this.addBodyToSpace(this.mirrBody),this.mirrBody.set_position(k.get(this.x+10,this.y+32));var e=this.JointUtil.createPivotJoint(this.body,this.mirrBody,this.mirrBody.get_position(),this.mirrBody.get_position());this.mirrBody.set_compound(this.compo),e.set_compound(this.compo)}},{key:"initRay",value:function(){this.rayBody=new _,this.rayBody.add(new w(w.box(205,26))),this.rayBody.set_type(m.get_KINEMATIC()),this.rayBody.set_sensorEnabled_at(0,!0),this.rayBody.userData.view=this.pen,this.addBodyToSpace(this.rayBody,this),this.rayBody.set_position(k.get(this.x+this.pen.x,this.y+this.pen.y)),this.rayBody.set_rotation(161*Math.PI/180),this.rayBody.noallowRotation=!0,this.ray=new p["default"](this.rayBody,1.513,16711680,this.paramObj),this.ray.lineStart=[117,0],this.ray.isShowValue=!1,this.ray.var_showDirection=!1,this.pen.addChild(this.ray),this.ray.init(),this.rayBody.set_compound(this.compo)}},{key:"initRuler",value:function(){this.rulerBody=new _;var t=new w(w.box(this.ruler.width,this.ruler.height));t.set_sensorEnabled(!0),this.rulerBody.add(t),this.rulerBody.set_type(m.get_KINEMATIC()),this.rulerBody.userData.view=this.ruler,this.rulerBody.userData.cannotToolRot=!0,this.addBodyToSpace(this.rulerBody,this),this.rulerBody.set_position(k.get(this.x+this.ruler.x,this.y+this.ruler.y)),this.rulerBody.set_rotation(-60*Math.PI/180),this.rulerBody.set_compound(this.compo)}},{key:"initBall",value:function(){var t=this;this.ballBody1=new _,this.ballBody1.add(new x(23)),this.ballBody1.userData.view=this.ball1,this.addBodyToSpace(this.ballBody1,this),this.ballBody1.sensorEnabled(!0),this.ballBody1.set_type(m.get_KINEMATIC()),this.ballBody1.set_position(k.get(this.x+this.ball1.x,this.y+this.ball1.y+70)),this.ballBody1.set_compound(this.compo),this.ballBody2=new _,this.ballBody2.add(new x(23)),this.ballBody2.userData.view=this.ball2,this.addBodyToSpace(this.ballBody2,this),this.ballBody2.sensorEnabled(!0),this.ballBody2.set_type(m.get_KINEMATIC()),this.ballBody2.set_position(k.get(this.x+this.ball2.x,this.y+this.ball2.y+70)),this.ballBody2.set_compound(this.compo),this.left.x=this.ballBody1.posx-this.x,this.left.y=this.ballBody1.posy-this.y,this.right.x=this.ballBody2.posx-this.x,this.right.y=this.ballBody2.posy-this.y,this.ball1.addEventListener(b["default"].BEGIN,function(e){t.left.visible&&(t.left.visible=!1,t.removeChild(t.left)),1==t.ball1.tp?t.weld1=!1:2==t.ball1.tp&&(t.weld2=!1),t.ball1.tp=0}),this.ball1.addEventListener(b["default"].END,function(e){var i=l.Point.vec2ToPoint(t.ballBody1.get_position()),o=t.toGlobalView(new l.Point(t.bg.quan1.x,t.bg.quan1.y),t),n=t.toGlobalView(new l.Point(t.bg.quan2.x,t.bg.quan2.y),t);!t.weld1&&57>l.Point.distance(i,o)&&(t.ballBody1.posx=o.x,t.ballBody1.posy=o.y,t.weld1=!0,t.ball1.tp=1),!t.weld2&&57>l.Point.distance(i,n)&&(t.ballBody1.posx=n.x,t.ballBody1.posy=n.y,t.weld2=!0,t.ball1.tp=2)}),this.ball2.addEventListener(b["default"].BEGIN,function(e){t.right.visible&&(t.right.visible=!1,t.removeChild(t.right)),1==t.ball2.tp?t.weld1=!1:2==t.ball2.tp&&(t.weld2=!1),t.ball2.tp=0}),this.ball2.addEventListener(b["default"].END,function(e){var i=l.Point.vec2ToPoint(t.ballBody2.get_position()),o=t.toGlobalView(new l.Point(t.bg.quan1.x,t.bg.quan1.y),t.bg),n=t.toGlobalView(new l.Point(t.bg.quan2.x,t.bg.quan2.y),t.bg);!t.weld1&&57>l.Point.distance(i,o)&&(t.ballBody2.posx=o.x,t.ballBody2.posy=o.y,t.weld1=!0,t.ball2.tp=1),!t.weld2&&57>l.Point.distance(i,n)&&(t.ballBody2.posx=n.x,t.ballBody2.posy=n.y,t.weld2=!0,t.ball2.tp=2)})}},{key:"removed",value:function(){this.removedCursor(this.left),this.removedCursor(this.right),this.removedCursor(this.ball1),this.removedCursor(this.ball2),delete this.bg.translateMove,this.pen.removeChild(this.ray),this.ray.removed(),this.ray=null,this.BodyUtil.destoryBody(this.ballBody1),this.BodyUtil.destoryBody(this.ballBody2),this.BodyUtil.destoryBody(this.rulerBody),this.BodyUtil.destoryBody(this.rayBody),this.BodyUtil.destoryBody(this.mirrBody),this.ball1.removeAllListeners(),this.ball2.removeAllListeners(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.ray&&this.ray.update(),this.weld1&&this.weld2?(this.bg.mirr.gotoAndStop(2),this.bg.gan.gotoAndStop(2),this.mirrBody.rotation=2.5*Math.PI/180):this.weld1||this.weld2?(this.bg.mirr.gotoAndStop(1),this.bg.gan.gotoAndStop(1),this.mirrBody.rotation=1.25*Math.PI/180):(this.bg.mirr.gotoAndStop(0),this.bg.gan.gotoAndStop(0),this.mirrBody.rotation=0),this.left.visible&&(this.left.x=this.ballBody1.posx-this.x,this.left.y=this.ballBody1.posy-this.y),this.right.visible&&(this.right.x=this.ballBody2.posx-this.x,this.right.y=this.ballBody2.posy-this.y)}},{key:"refreshballpos",value:function(){if(this.weld1||this.weld2){var t=this.toGlobalView(new l.Point(this.bg.quan1.x,this.bg.quan1.y),this.bg),e=this.toGlobalView(new l.Point(this.bg.quan2.x,this.bg.quan2.y),this.bg),i=k.get(t.x,t.y),o=k.get(e.x,e.y);this.weld1&&(1==this.ball1.tp?this.ballBody1.set_position(i):this.ballBody2.set_position(i)),this.weld2&&(1==this.ball2.tp?this.ballBody2.set_position(o):this.ballBody1.set_position(o))}}},{key:"selectRenderChild",value:function(){return this.getBounds()}},{key:"hideTips",value:function(){this.left.visible=!1,this.right.visible=!1}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function u(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:u(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(226),l=function(t){return t&&t.__esModule?t:{"default":t}}(h);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.cylinderLeft=null,i.cylinderRight=null,i.baffleLeft2=null,i.baffleLeft1=null,i.baffleRight1=null,i.baffleRight2=null,i.armLeft=null,i.armRight=null,i.transmissionBeltFront=null,i.transmissionBeltBack=null,i.roker=null,i.startBtn=null,i.mBtn=null,i.rBtn=null,i.wBtn=null,i.isPlaying=!1,i.m1=1,i.r1=1,i.w1=1,i.m2=1,i.r2=1,i.w2=1,i.mScale=1,i.rScale=1,i.wScale=1,i.animationScale=.3,i}return s(e,t),a(e,[{key:"added",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.startBtn.fontColor="#ffffff",this.startBtn.text=this.language.getLocaleStr("start"),this.startBtn.tab=this.startClick,this.startBtn["this"]=this,this.mBtn.fontColor="#0033CC",this.mBtn.text="1：1",this.mBtn.tab=this.changeMClick,this.mBtn["this"]=this,this.rBtn.fontColor="#0033CC",this.rBtn.text="1：1",this.rBtn.tab=this.changeRClick,this.rBtn["this"]=this,this.wBtn.fontColor="#0033CC",this.wBtn.text="1：1",this.wBtn.tab=this.changeWClick,this.wBtn["this"]=this,this.baffleLeft2.visible=!1,this.baffleRight2.visible=!1,this.transmissionBeltFront.gotoAndStop(1),this.transmissionBeltBack.gotoAndStop(1),this.baffleLeft2.stop(),this.baffleLeft1.stop(),this.baffleRight1.stop(),this.baffleRight2.stop(),this.armLeft.stop(),this.armRight.stop(),this.roker.stop(),this.roker.animationSpeed=this.animationScale,this.updateSpeed(),this.addCursor(this.startBtn,"hand"),this.addCursor(this.mBtn,"hand"),this.addCursor(this.rBtn,"hand"),this.addCursor(this.wBtn,"hand")}},{key:"update",value:function(){this.moduleMain.napeEngine.play||this.isPlaying&&this.stopPlay()}},{key:"removed",value:function(){this.removedCursor(this.startBtn),this.removedCursor(this.mBtn),this.removedCursor(this.rBtn),this.removedCursor(this.wBtn),this.startBtn.destroy(),this.mBtn.destroy(),this.rBtn.destroy(),this.wBtn.destroy(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"updateSpeed",value:function(){var t=this.w1*this.animationScale,e=this.w2*this.animationScale;this.baffleLeft2.animationSpeed=t,this.baffleLeft1.animationSpeed=t,this.armLeft.animationSpeed=t,this.baffleRight1.animationSpeed=e,this.baffleRight2.animationSpeed=e,this.armRight.animationSpeed=e}},{key:"updateF",value:function(){var t=void 0,e=void 0;this.isPlaying?(t=this.m1*this.r1*this.w1*this.w1,e=this.m2*this.r2*this.w2*this.w2):(t=0,e=0),this.setF(this.cylinderLeft,t),this.setF(this.cylinderRight,e)}},{key:"setF",value:function(t,e){var i=(e>0?1:0)-72+12*e;t.sleeve.y!==i&&(TweenLite.to(t.sleeve,.5,{y:i}),TweenLite.to(t.spring,.5,{height:70-12*e}))}},{key:"startClick",value:function(){this.moduleMain.napeEngine.play&&(this.isPlaying=!this.isPlaying,this.isPlaying?this.startPlay():this.stopPlay())}},{key:"startPlay",value:function(){this.isPlaying=!0,this.startBtn.text=this.language.getLocaleStr("stopIt"),this.baffleLeft2.play(),this.baffleLeft1.play(),this.baffleRight1.play(),this.baffleRight2.play(),this.armLeft.play(),this.armRight.play(),this.roker.play(),this.updateF()}},{key:"stopPlay",value:function(){this.isPlaying=!1,this.startBtn.text=this.language.getLocaleStr("start"),this.baffleLeft2.stop(),this.baffleLeft1.stop(),this.baffleRight1.stop(),this.baffleRight2.stop(),this.armLeft.stop(),this.armRight.stop(),this.roker.stop(),this.updateF()}},{key:"changeMClick",value:function(){1===this.mScale?(this.reset(),this.mScale=2,this.m2=2):(this.reset(),this.mScale=1,this.m2=1),this.updateState(),this.updateSpeed(),this.updateF()}},{key:"changeRClick",value:function(){1===this.rScale?(this.reset(),this.rScale=2,this.r1=2):(this.reset(),this.rScale=1,this.r1=1),this.updateState(),this.updateSpeed(),this.updateF()}},{key:"updateState",value:function(){1===this.rScale?(this.rBtn.text="1：1",this.baffleLeft2.visible=!1,this.baffleLeft1.visible=!0):(this.rBtn.text="2：1",this.baffleLeft2.visible=!0,this.baffleLeft1.visible=!1),1===this.wScale?(this.wBtn.text="1：1",this.transmissionBeltFront.gotoAndStop(1),this.transmissionBeltBack.gotoAndStop(1)):(this.wBtn.text="1：2",this.transmissionBeltFront.gotoAndStop(0),this.transmissionBeltBack.gotoAndStop(0)),1===this.mScale?(this.mBtn.text="1：1",this.baffleRight1.visible=!0,this.baffleRight2.visible=!1):(this.mBtn.text="1：2",this.baffleRight1.visible=!1,this.baffleRight2.visible=!0)}},{key:"changeWClick",value:function(){1===this.wScale?(this.reset(),this.wScale=2,this.w1=1,this.w2=2):(this.reset(),this.wScale=1,this.w1=1,this.w2=1),this.updateState(),this.updateSpeed(),this.updateF()}},{key:"reset",value:function(){this.m1=1,this.r1=1,this.w1=1,this.m2=1,this.r2=1,this.w2=1,this.mScale=1,this.rScale=1,this.wScale=1}},{key:"selectRenderChild",value:function(){return this.updateTransform(),this.getBounds()}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(226),c=o(u),d=i(451),p=o(d);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.normalLine=new PIXI.Graphics,i.steps=-1,i.angDraw=!0,i.in_dragBall=!1,i.dragOldP=null,i.originBallY=null,i.currBallX=null,i.currBallY=null,i.endY=0,i.ballStart=!1,i.line=new PIXI.Graphics,i.angLine=new PIXI.Graphics,i.angLabel=null,i.dotSp=null,i.di=new l.Point(0,276),i.time=null,i.T=2,i.oneAngle=.05,i.oneNum=null,i.czTime=0,i.L=2,i.R=0,i.bei=.16,i.ballAng=0,i.hengTxt=null,i.hengLine=null,i.dataTxt=null,i}return a(e,t),r(e,[{key:"added",value:function(){var t=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.componentBox.visible=!1,this.removeChild(this.componentBox),this.stopBtn.fontColor="#ffffff",this.stopBtn.text=this.language.getLocaleStr("stopIt"),this.stopBtn.tab=function(e){t.stopAll()},this.addChildAt(this.normalLine,1),this.addChildAt(this.line,2),this.addChild(this.angLine),this.angLabel=new PIXI.Text("",{font:"25px Arial",fill:16750848}),this.addChild(this.angLabel),this.dotSp=new PIXI.Graphics,this.dotSp.beginFill(0,0),this.dotSp.drawCircle(0,0,5),this.dotSp.endFill(),this.addChild(this.dotSp),this.hengTxt=new PIXI.Text("",{font:"25px Arial",fill:16750848}),this.bg.addChild(this.hengTxt),this.hengTxt.pivot.x=this.hengTxt.height/2,this.hengLine=new PIXI.Graphics,this.bg.addChild(this.hengLine),this.dataTxt=new PIXI.Text("",{font:"25px Arial",fill:16750848}),this.addChild(this.dataTxt),this.dataTxt.y=15,this.dataTxt.x=15,this.dataTxt.scale.x=this.dataTxt.scale.y=.7,this.drawNormalLine(),this.initBall(),this.addCursor(this.ball,"zuoyou"),this.addCursor(this.stopBtn,"hand"),this.aTxt.text=this.language.getLocaleStr("length_bai")+" 200cm",this.bTxt.text=this.language.getLocaleStr("smallb_mass")+" 10g",this.writeSteps()}},{key:"removed",value:function(){this.removedCursor(this.ball),this.removedCursor(this.stopBtn),this.stopBtn.dispose(),this.tick&&(this.tick.stop(),this.tick=null),l.M.removeTouch(this.ball,this.ballTouchid),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"stopAll",value:function(){this.ballStart=!1,this.cannotSystemDrag=!1,this.ballAng=0,this.steps=0,this.angLine.clear(),this.hengLine.clear(),this.hengTxt.text="",this.dotSp.x=0,this.ball.x=0,this.ball.y=this.originBallY,this.ball.rotation=0,this.ball.scale.x=this.ball.scale.y=1}},{key:"update",value:function(){var t=new l.Point(0,0);if(this.angDraw||this.ballStart){var e=l.M.getXianDianByDis(30,!0,t,this.di),i=new l.Point(this.ball.x,this.ball.y),o=l.M.getXianDianByDis(30,!0,t,i),n=l.M.getXianDianByDis(46,!1,i,t),s=(new l.Point(n.x,n.y+30),l.M.getDuiDianP(t,e,o));this.angLine.clear(),this.angLine.lineStyle(2,16750848),this.angLine.moveTo(e.x,e.y),this.angLine.quadraticCurveTo(s.x,s.y,o.x,o.y),this.angLabel.x=s.x,this.angLabel.y=s.y}if(this.angDraw&&!this.ballStart){var a=.5*Math.PI-Math.atan2(this.ball.y-t.y,this.ball.x-t.x);this.ball.rotation=-a,this.hengTxt.rotation=0;var r=this.di,h=new l.Point(this.dotSp.x,this.di.y),u=l.M.getPointLen(r,h),c=(u-this.hengTxt.width)/2,d=l.M.getXianDianByDis(c,!0,r,h);l.M.getXianDianByDis(c,!0,h,r);this.hengTxt.x=d.x,this.hengTxt.y=310,Math.abs(h.x-r.x)>this.hengTxt.width/2&&(this.hengTxt.rotation=l.M.toHu(l.M.getAngleP(h,r)),this.hengLine.clear(),this.hengLine.lineStyle(3,16742400),l.M.drawDashed(this.hengLine,r,h)),this.R=l.M.getNumJie(u*this.bei,1)/100;var p=200*Math.tan(a);this.hengTxt.text="R="+l.M.getNumJie(Math.abs(200*Math.tan(a)),0),this.angLabel.text=l.M.getNumJie(180*a/Math.PI,2)+"°  tanθ="+l.M.getNumJie(Math.tan(a),2),this.dotSp.x=this.currBallX+40*Math.sin(a),this.dotSp.y=320,this.oneAngle=2*Math.PI*Math.sqrt(this.L*Math.cos(a)/9.8),this.hengTxt.x=p>0?d.x:d.x-this.hengTxt.width,this.hengTxt.rotation=0}if(this.ballStart){var y=this.getCurrentTime(),f=y-this.time;this.ballAng=-(f/1e3%this.oneAngle)/this.oneAngle*Math.PI*2,this.ball.x=this.currBallX*Math.cos(this.ballAng),this.ball.y=this.originBallY+this.currBallY*Math.sin(this.ballAng),this.ball.scale.x=this.ball.scale.y=this.ball.y/this.originBallY,this.writeTime(),this.steps=Math.floor(f/1e3/this.oneAngle),this.writeSteps();var g=.5*Math.PI-Math.atan2(this.ball.y,this.ball.x);this.ball.rotation=-g,this.dataTxt.text="θ="+this.angLabel.text+" "+this.hengTxt.text,this.dotSp.x=this.ball.x+40*Math.sin(g),this.dotSp.y=this.currBallY*Math.sin(this.ballAng)+440-120}this.main.view.updateTransform();var b=this.line.toLocal(new l.Point(0,3),this.ball);this.line.clear(),this.line.lineStyle(3,13421772),this.line.moveTo(0,0),this.line.lineTo(b.x,b.y)}},{key:"writeTime",value:function(){var t=this.getCurrentTime(),e=t-this.time,i=l.M.getNumToInt(e/1e3),o=Math.floor(.1*(e-1e3*i));return this.timeTxt.text=(10>i?"0"+i:i)+":"+(10>o?"0"+o:o),e}},{key:"initBall",value:function(){var t=this;this.originBallY=this.ball.y,this.ballTouchid=l.M.addTouch(this.ball,{begin:function(e){t.steps=-1,t.writeSteps(),t.timeTxt.text="00:00",t.angDraw=!0,t.cannotSystemDrag=!0,t.in_dragBall=!0,t.dragOldP=t.getMouseXY(e)},move:function(e){var i=t.getMouseXY(e);t.ball.x+=i.x-t.dragOldP.x,t.ball.x=t.ball.x>145?145:t.ball.x,t.ball.x=-145>t.ball.x?-145:t.ball.x,t.ball.y=Math.sqrt(t.originBallY*t.originBallY-t.ball.x*t.ball.x),t.currBallX=t.ball.x,t.dragOldP=i},end:function(e){t.currBallX=t.ball.x,t.currBallY=110*t.ball.x/215,t.ballStart=!0,t.time=t.getCurrentTime(),t.cannotSystemDrag=!1,t.in_dragBall=!1;var i=new p["default"](t.paramObj),o=i.getGravity();t.T=Math.sqrt(4*l.M.sq(Math.PI)*t.L*t.R/(o*Math.sqrt(l.M.sq(t.L)-l.M.sq(t.R)))),t.czTime=0,t.oneNum=2*Math.PI/t.oneAngle,t.endY=t.ball.y}},this)}},{key:"writeSteps",value:function(){var t=-1==this.steps?0:this.steps;this.cishuTxt.text=this.language.getLocaleStr("tv_frequency")+" n="+t+this.language.getLocaleStr("ci")}},{key:"drawNormalLine",value:function(){this.normalLine.lineStyle(3,16711680);var t=void 0;for(t=0;28>t;t++)t%2==0&&(this.normalLine.moveTo(0,10*t),this.normalLine.lineTo(0,10*t+10))}},{key:"selectRenderChild",value:function(){return this.getBounds()}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function b(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:b(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(546),l=function(t){return t&&t.__esModule?t:{"default":t}}(h),u=void 0,c=void 0,d=void 0,p=void 0,y=void 0,f=void 0,g=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return u=i.phy.nape,c=u.geom.Vec2,d=u.shape.Polygon,p=u.callbacks.CbType,y=u.callbacks.InteractionType,f=u.callbacks.PreListener,g=u.callbacks.PreFlag,i.valueTxtxy={x:304,y:-300},i.WIDTH=321,i.HEIGHT=394,i.liquidW=642,i.totalRange=100,i.fullH=394,i.unitMl=0,i.boty=75,i.poshapexy={x:313,y:-340},i.pourxy={x:-320,y:-318},i.canPour=!0,i.barxy={x:35,y:-100},i.hasAo=!1,i.verticesArr=i.Vec2Util.pointArrArrToVec2ArrArr([[{x:-99.9,y:-314.8},{x:-92,y:-315.1},{x:-89,y:-219.1},{x:-96.9,y:-218.8}],[{x:-96.8,y:-217.8},{x:-89.1,y:-220.1},{x:-75.1,y:-174.1},{x:-82.8,y:-171.8}],[{x:-82.8,y:-174},{x:-75.1,y:-171.9},{x:-91.1,y:-115.9},{x:-98.8,y:-118}],[{x:-98.8,y:-116},{x:-91.1,y:-117.9},{x:-77.1,y:-59.9},{x:-84.8,y:-58}],[{x:-84.8,y:-60.1},{x:-77.1,y:-57.8},{x:-90.1,y:-13.9},{x:-97.8,y:-16.1}],[{x:-97.9,y:-15.1},{x:-90,y:-14.9},{x:-92,y:43.1},{x:-99.9,y:42.9}],[{x:-95.9,y:47},{x:-96,y:39},{x:76,y:38},{x:76,y:46}],[{x:80,y:42.1},{x:72,y:41.9},{x:73,y:-18.1},{x:81,y:-17.9}],[{x:80.4,y:-15.9},{x:73.6,y:-20.1},{x:105.6,y:-73},{x:112.4,y:-68.9}],[{x:111.4,y:-74.2},{x:106.6,y:-67.7},{x:29.6,y:-124.7},{x:34.4,y:-131.2}],[{x:35.9,y:-128.8},{x:28.1,y:-127.1},{x:21.1,y:-158.1},{x:28.9,y:-159.8}],[{x:28.7,y:-157.5},{x:21.3,y:-160.4},{x:32.3,y:-189.4},{x:39.7,y:-186.5}],[{x:38.6,y:-184.9},{x:33.4,y:-191},{x:73.4,y:-226},{x:78.6,y:-219.9}],[{x:80,y:-222.5},{x:72,y:-223.4},{x:83,y:-314.4},{x:91,y:-313.5}],[{x:121,y:-315.3},{x:129,y:-314.6},{x:120,y:-220.6},{x:112,y:-221.3}],[{x:112.4,y:-222.7},{x:119.6,y:-219.2},{x:101.6,y:-183.2},{x:94.4,y:-186.7}],[{x:95.4,y:-188},{x:100.6,y:-181.9},{x:65.6,y:-151.9},{x:60.4,y:-158}],[{x:60.4,y:-151.9},{x:65.6,y:-158},{x:143.6,y:-92},{x:138.4,y:-85.9}],[{x:137,y:-88.5},{x:145,y:-89.4},{x:149,y:-56.4},{x:141,y:-55.5}],[{x:141.6,y:-58.1},{x:148.4,y:-53.8},{x:120.4,y:-9.9},{x:113.6,y:-14.1}],[{x:113,y:-12.4},{x:121,y:-11.6},{x:116,y:43.4},{x:108,y:42.6}],[{x:112,y:47},{x:112,y:39},{x:241,y:38},{x:241,y:46}],[{x:243.6,y:45},{x:238.4,y:39},{x:253.4,y:26},{x:258.6,y:32}],[{x:260,y:28.9},{x:252,y:29.1},{x:250,y:-48.8},{x:258,y:-49.1}],[{x:256.2,y:-52.3},{x:251.8,y:-45.6},{x:227.8,y:-61.6},{x:232.2,y:-68.3}],[{x:234,y:-64.9},{x:226,y:-65},{x:227,y:-312},{x:235,y:-311.9}],[{x:315,y:-312.9},{x:323,y:-312.9},{x:323,y:-59.9},{x:315,y:-59.9}],[{x:316.9,y:-63.3},{x:321.1,y:-56.6},{x:299.1,y:-42.6},{x:294.9,y:-49.3}],[{x:293,y:-46.1},{x:301,y:-45.8},{x:297,y:39.2},{x:289,y:38.8}],[{x:289.8,y:36.6},{x:296.2,y:41.4},{x:269.2,y:77.4},{x:262.8,y:72.6}],[{x:266,y:71},{x:266,y:79},{x:-288.9,y:80},{x:-289,y:72}],[{x:-285.9,y:73.4},{x:-292,y:78.6},{x:-323,y:41.6},{x:-316.9,y:36.4}],[{x:-316,y:39},{x:-323.9,y:39},{x:-324.9,y:-315.9},{x:-317,y:-316}],[{x:-285.9,y:-312.9},{x:-278,y:-313},{x:-277,y:29},{x:-284.9,y:29}],[{x:-283.8,y:31.8},{x:-278.1,y:26.2},{x:-265.1,y:39.2},{x:-270.8,y:44.8}],[{x:-268,y:46},{x:-267.9,y:38},{x:-134.9,y:39},{x:-135,y:47}],[{x:-130.9,y:43},{x:-138.9,y:43},{x:-138.9,y:-15},{x:-130.9,y:-15}],[{x:-131.2,y:-16.3},{x:-138.7,y:-13.7},{x:-153.7,y:-55.6},{x:-146.2,y:-58.3}],[{x:-146.1,y:-55.8},{x:-153.8,y:-58.1},{x:-136.8,y:-117.1},{x:-129.1,y:-114.8}],[{x:-129.2,y:-117.2},{x:-136.7,y:-114.7},{x:-154.7,y:-167.7},{x:-147.2,y:-170.2}],[{x:-147.1,y:-167.9},{x:-154.8,y:-170},{x:-139.8,y:-224},{x:-132.1,y:-221.9}],[{x:-132,y:-222.9},{x:-139.9,y:-223},{x:-137.9,y:-312},{x:-130,y:-311.9}],[{x:13.2,y:77},{x:-28.9,y:77},{x:-28.9,y:198},{x:13.2,y:198}],[{x:139.5,y:198},{x:-152.5,y:198},{x:-152.5,y:313.75},{x:139.5,y:313.75}]]),i.material=new u.phys.Material(0,.5,.6,2.4,.001),i.liquidType=new p,i.renderTexture=new PIXI.RenderTexture(i.globalConfig.main.renderer,2*i.WIDTH,i.HEIGHT),i.mlArr=["0mL","20mL","30mL","40mL","50mL","80mL","100mL"],i.islock=!0,i.canIgnoreBuoyancy=!0,i}return s(e,t),a(e,[{key:"init",value:function(){var t=this;r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.valueTxt.visible=!1,this.renderTexture.render(this.maskShape),this.sp=new PIXI.Sprite(this.renderTexture),this.renderTextureDatas=this.main.renderer.extract.pixels(this.renderTexture,1),this.sp.x=400,this.p0=new PIXI.Graphics,this.sp.addChild(this.p0),this.p0.beginFill(16711680),this.p0.drawCircle(0,0,10),this.p0.endFill(),this.createShape(),this.body.set_isBullet(!0),this.body.noallowRotation=!0,this.body.userData.cannotToolRot=!0,this.body.userData.dragLevel=-1,this.onPreCallBack=function(e){return t.onPre(e)},this.preListener=new f(y.get_ANY(),p.get_ANY_BODY(),this.liquidType,this.onPreCallBack),this.space.get_listeners().add(this.preListener),this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.changeLock({checked:this.islock}),this.handShape=null}},{key:"removed",value:function(){this.space.get_listeners().remove(this.preListener),this.onPreCallBack=null,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"onPre",value:function(t){return this.ignoreBuoyancy(t.get_arbiter())?g.get_IGNORE():g.get_ACCEPT()}},{key:"hasBuoyancyAtPoint",value:function(t){var e=this.renderTextureDatas,i=Math.round((t.x-this.maskShape.x)*this.globalConfig.RESOLUTION),o=Math.round((t.y-this.maskShape.y)*this.globalConfig.RESOLUTION),n=4*(o*this.WIDTH*2+i),s=[e[n],e[n+1],e[n+2],e[n+3]],a=s[0],r=s[1]<<16|s[2]<<8|s[3],h=!(0===a&&0===r);return this.p0.x=i,this.p0.y=o,h}},{key:"createBodyShape",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createBodyShape",this).call(this),this.body.get_shapes().clear();var t=new d(d.box(2*this.WIDTH,this.HEIGHT),this.material);t.translate(c.get(0,-120)),this.body.add(t),t.set_sensorEnabled(!0),this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER)}},{key:"drawScale",value:function(){}},{key:"drawLiquid",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"drawLiquid",this).call(this,t),this.liquidShape.mask=this.maskShape.getChildAt(0)}},{key:"createLiquid",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createLiquid",this).call(this,t),this.liquid.addCbtype(this.liquidType)}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.geom.Vec2,p=c.shape.Polygon,i.bg=null,i.plumbLineMec=null,i.cantToTop=!0,i.fixP=new PIXI.Point(0,-92),i.verticesArr=i.Vec2Util.pointArrArrToVec2ArrArr([[{x:-15,y:-113.95},{x:-191.95,y:90.05},{x:-160.95,y:91.05},{x:16,y:-113.95}],[{x:190,y:90.05},{x:15,y:-112.95},{x:-14,y:-113.95},{x:162,y:91.05}],[{x:191.05,y:90.05},{x:-188.95,y:90.05},{x:-188.95,y:111.05},{x:191.05,y:111.05}],[{x:-14.95,y:93.05},{x:15.05,y:93.05},{x:15.05,y:-108.45},{x:-14.95,y:-108.45}]]),i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_isBullet(!0),this.body.userData.dragLevel=-1,this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.addOthers()}},{key:"addOthers",value:function(){var t=new h.Point(this.body.posx,this.body.posy),e=this.dependEquipments,i=e[0];i.upToTop(),h.M.setSPPoint(i,t),this.plumbLineMec=i,this.JointUtil.createPivotJoint(this.body,this.plumbLineMec.body,this.body.localPointToWorld(d.get(this.fixP.x,this.fixP.y)),i.body.localPointToWorld(d.get(this.fixP.x,this.fixP.y))),this.BodyUtil.setBodyFilter(i.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.plumbLineMec.getConfJumpTarget=this}},{key:"removed",value:function(){this.plumbLineMec&&this.removeFromFramework(this.plumbLineMec),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.plumbLineMec&&this.BodyUtil.dampingBodyVelocity(this.plumbLineMec.body,.9,.9)}},{key:"getData",value:function(){return r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this)}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t)}},{key:"getConf",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push(),t}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function m(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:m(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(1071),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.NbBody,g=y.phys.BodyType,b=y.shape.Polygon,v=y.geom.Vec2,_=y.phys.Compound,i.carBody=null,i.lefthock=null,i.righthock=null,i.line=null,i.isnzCick=!1,i.isrevert=!1,i.lunBody1=null,i.lunBody2=null,i.compo=new _,i.leftPulley=null,i.rightPulley=null,i.endStart=!1,i.firststart=!0,i.lineTop=-41.05,i.modelIndex=0,i.modelArr=["小车","卡片"],i.paperObj={pullTop:{x:435,y:-100},pullLeft:{x:461,y:-64},paperNL:{x:-12,y:-23},paperNR:{x:34,y:25},paperL:{x:-55,y:-67},paperR:{x:60,y:-67}},i}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_type(g.get_KINEMATIC()),this.compo.set_space(this.body.get_space()),this.body.userData.dragtranslate=!0,this.initView(),this.initCar(),this.initBtn(),this.initGou(),this.line=new PIXI.Graphics,this.addChildAt(this.line,1),this.car.body.lun.visible=!1,this.addCursor(this.bg.btn,"hand"),this.changeModel({showValue:"小车"})}},{key:"translateMove",value:function(t,e){this.compo.translate(v.weak(t,e))}},{key:"initGou",value:function(){this.lefthock=new p["default"](this.paramObj),this.lefthock.init(),this.lefthock.body.posx=this.x+this.leftgou.x,this.lefthock.body.posy=this.y+this.leftgou.y,this.addChild(this.lefthock),this.lefthock.addChild(this.leftgou),this.leftgou.x=this.leftgou.y=0,this.lefthock.resetUserView(this.lefthock,this,!0),this.lefthock.body.set_compound(this.compo),this.righthock=new p["default"](this.paramObj),this.righthock.init(),this.righthock.body.posx=this.x+this.rightgou.x,this.righthock.body.posy=this.y+this.rightgou.y,this.addChild(this.righthock),this.righthock.addChild(this.rightgou),this.rightgou.x=this.rightgou.y=0,this.righthock.resetUserView(this.righthock,this,!0),this.righthock.body.set_compound(this.compo);this.leftPulley=this.JointUtil.createPulleyJoint(this.lefthock.body,this.body,this.body,this.carBody,this.lefthock.body.position.add(v.get(0,-13)),this.body.position.add(v.get(-450,8)),this.body.position.add(v.get(-412,this.lineTop)),this.carBody.position.add(v.get(-56,-10)),20,570),this.rightPulley=this.JointUtil.createPulleyJoint(this.righthock.body,this.body,this.body,this.carBody,this.righthock.body.position.add(v.get(0,-13)),this.body.position.add(v.get(450,8)),this.body.position.add(v.get(412,this.lineTop)),this.carBody.position.add(v.get(56,-10)),20,570),this.lefthock.pulleyjoint=this.leftPulley,this.righthock.pulleyjoint=this.rightPulley,this.leftPulley.set_compound(this.compo),this.rightPulley.set_compound(this.compo)}},{key:"updatePaper",value:function(){var t=this.getMain(),e=this.paperObj;this.line.clear(),this.line.lineStyle(3,13421772);var i=new l.Point(0,-13);i=this.line.toLocal(i,this.leftgou);var o=this.body.get_position().add(v.get(-e.pullLeft.x,e.pullLeft.y)),n=this.body.get_position().add(v.get(-e.pullTop.x,e.pullTop.y)),s=void 0,a=void 0,r=void 0,h=void 0;this.isnzCick?(s=this.line.toLocal(new l.Point(e.paperNL.x,e.paperNL.y),this.car.paper),a=this.line.toLocal(new l.Point(e.paperNR.x,e.paperNR.y),this.car.paper),r=s,h=a):(s=this.carBody.get_position().add(v.get(e.paperL.x,e.paperL.y)),a=this.carBody.get_position().add(v.get(e.paperR.x,e.paperR.y)),h=this.line.toLocal(l.Point.vec2ToPoint(a),t.view),r=this.line.toLocal(l.Point.vec2ToPoint(s),t.view));var u=new l.Point(0,-13);u=this.line.toLocal(u,this.rightgou);var c=this.body.get_position().add(v.get(e.pullLeft.x,e.pullLeft.y)),d=this.body.get_position().add(v.get(e.pullTop.x,e.pullTop.y)),p=this.line.toLocal(l.Point.vec2ToPoint(o),t.view),y=this.line.toLocal(l.Point.vec2ToPoint(n),t.view),f=this.line.toLocal(l.Point.vec2ToPoint(c),t.view),g=this.line.toLocal(l.Point.vec2ToPoint(d),t.view);this.line.moveTo(i.x,i.y),this.line.lineTo(p.x,p.y),this.line.moveTo(y.x,y.y),this.line.lineTo(r.x,r.y),this.line.moveTo(u.x,u.y),this.line.lineTo(f.x,f.y),this.line.moveTo(g.x,g.y),this.line.lineTo(h.x,h.y),this.endStart&&this.isnzCick&&!this.isrevert&&(this.lefthock.useing||this.righthock.useing)&&(this.isrevert=!1,this.isnzCick=!1,this.endStart=!1,this.car.paper.mc.rotation=0)}},{key:"update",value:function(){var t=this;if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),1==this.modelIndex)return void this.updatePaper();this.firststart&&(this.firststart=!1,this.parent.updateTransform());var i=this.getMain();this.lefthock.body.angularVel=0,this.righthock.body.angularVel=0,this.line.clear(),this.line.lineStyle(3,13421772);var o=new l.Point(0,-13);o=this.line.toLocal(o,this.leftgou);var n=this.body.get_position().add(v.get(-450,8)),s=this.body.get_position().add(v.get(-412,this.lineTop)),a=void 0,r=void 0,u=void 0,c=void 0;this.isnzCick?(a=this.line.toLocal(new l.Point(-12,-23),this.car.body),r=this.line.toLocal(new l.Point(34,25),this.car.body),u=a,c=r):(a=this.carBody.get_position().add(v.get(-56,-8)),r=this.carBody.get_position().add(v.get(56,-8)),c=this.line.toLocal(l.Point.vec2ToPoint(r),i.view),u=this.line.toLocal(l.Point.vec2ToPoint(a),i.view));var d=new l.Point(0,-13);d=this.line.toLocal(d,this.rightgou);var p=this.body.get_position().add(v.get(450,8)),y=this.body.get_position().add(v.get(412,this.lineTop)),f=this.line.toLocal(l.Point.vec2ToPoint(n),i.view),g=this.line.toLocal(l.Point.vec2ToPoint(s),i.view),b=this.line.toLocal(l.Point.vec2ToPoint(p),i.view),_=this.line.toLocal(l.Point.vec2ToPoint(y),i.view);if(this.line.moveTo(o.x,o.y),this.line.lineTo(f.x,f.y),this.line.moveTo(g.x,g.y),this.line.lineTo(u.x,u.y),this.line.moveTo(d.x,d.y),this.line.lineTo(b.x,b.y),this.line.moveTo(_.x,_.y),this.line.lineTo(c.x,c.y),this.endStart&&this.isnzCick&&!this.isrevert&&(this.lefthock.useing||this.righthock.useing)){this.isrevert=!0;var m={index:3},x=3;TweenMax.to(m,.3,{index:0,onUpdate:function(){x--,x=0>x?0:x,0===x&&(t.isnzCick=!1),t.car.body.gotoAndStop(x)},onComplete:function(){t.car.body.lun.visible=!1,t.isnzCick=!1,t.isrevert=!1,t.endStart=!1,t.car.lun1.visible=!0,t.car.lun2.visible=!0}})}}},{key:"initBtn",value:function(){var t=this;this.bg.btn.fontColor="#ffffff",this.bg.btn.label.style.font="22px Arial",this.bg.btn.text=this.language.getLocaleStr("turn_car"),this.bg.btn["this"]=this,this.bg.btn.begin=function(){t.isnzCick||(t.isnzCick=!0,0==t.modelIndex?(t.car.body.lun.visible=!0,t.car.body.gotoAndStop(3),t.car.lun1.visible=!1,t.car.lun2.visible=!1):t.car.paper.mc.rotation=Math.PI/9)},this.bg.btn.end=function(){t.endStart=!0}}},{key:"initCar",value:function(){this.carBody=new f,this.carBody.add(new b(b.box(70,50))),this.carBody.userData.view=this.car.body,this.carBody.userData.noDrag=!0,this.carBody.noallowRotation=!0,this.carBody.set_position(this.body.get_position().add(v.get(0,-40))),this.addBodyToSpace(this.carBody,this.car),this.carBody.set_mass(40),this.carBody.set_compound(this.compo);var t=new b(b.rect(-310,-60,100,60)),e=new b(b.rect(250,-60,100,60));this.body.add(t),this.body.add(e);var i=new f;i.add(new y.shape.Circle(11)),i.userData.view=this.car.lun1,this.addBodyToSpace(i,this.car);var o=new f;o.add(new y.shape.Circle(11)),o.userData.view=this.car.lun2,this.addBodyToSpace(o,this.car),i.set_compound(this.compo),o.set_compound(this.compo);var n=this.carBody.localPointToWorld(v.get(-26,30)),s=this.carBody.localPointToWorld(v.get(26,30));i.set_position(n),o.set_position(s);var a=this.JointUtil.createPivotJoint(this.carBody,i,n,n),r=this.JointUtil.createPivotJoint(this.carBody,o,s,s);a.set_compound(this.compo),r.set_compound(this.compo),i.userData.noDrag=!0,o.userData.noDrag=!0,i.set_mass(50),o.set_mass(50),this.lunBody1=i,this.lunBody2=o}},{key:"initView",value:function(){this.body.shapes.clear(),this.body.add(new b(b.rect(-394,8,783,39)));var t=new b(b.rect(-394,-36,783,42));this.body.add(t),t.set_sensorEnabled(!0),this.body.set_mass(100),this.body.set_compound(this.compo)}},{key:"removed",value:function(){this.compo.set_space(null),this.lefthock.removed(),this.righthock.removed(),this.bg.btn.dispose(),this.removedCursor(this.bg.btn),this.bg.btn=null,this.BodyUtil.destoryBody(this.carBody),this.BodyUtil.destoryBody(this.lunBody1),this.BodyUtil.destoryBody(this.lunBody2),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"changeModel",value:function(t){this.modelIndex=this.modelArr.indexOf(t.showValue),0==this.modelIndex?(this.car.paper.visible=!1,this.bg.ban.currentFrame=0,this.car.body.visible=!0,this.car.lun1.visible=!0,this.car.lun2.visible=!0,this.carBody.userData.view=this.car.body,this.leftPulley.set_anchor2(v.get(-450,8)),this.rightPulley.set_anchor2(v.get(450,8)),this.bg.btn.text=this.language.getLocaleStr("turn_car")):(this.car.paper.visible=!0,this.bg.ban.currentFrame=1,this.car.body.visible=!1,this.car.lun1.visible=!1,this.car.lun2.visible=!1,this.carBody.userData.view=this.car.paper,this.car.paper.pivot.y=70,this.leftPulley.set_anchor2(v.get(-460,-30)),this.rightPulley.set_anchor2(v.get(460,-30)),this.bg.btn.text="扭转卡片")}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.ismecJoint=!0,t.left=this.lefthock.getData(),t.right=this.righthock.getData(),t.car={x:this.carBody.posx},t.modelIndex=this.modelIndex,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.lefthock&&(this.carBody.posx=t.car.x,this.lefthock.setData(t.left),this.righthock.setData(t.right)),isNaN(t.modelIndex)||this.changeModel({showValue:this.modelArr[t.modelIndex]})}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.getDropMenu([this.getLocaleStr("mec_moshi","模式"),!1,"",this.modelArr[this.modelIndex],this.modelArr,this,this.changeModel,0,0])),t}},{key:"selectRenderChild",value:function(){return this.bg.getBounds()}},{key:"showGlowSP",value:function(t){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"showGlowSP",this).call(this,t),t){var i=this.lefthock.useing,o=this.righthock.useing;this.glowSPArr[0][0].visible=!i,this.glowSPArr[0][1].visible=i,this.glowSPArr[0][2].visible=!o,this.glowSPArr[0][3].visible=o}else this.hideGlow()}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function c(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:c(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(226),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.cateid=5,i.startplay=!1,i.steps1=[{x:231.85,y:32.35},{x:231,y:34.75},{x:230.2,y:37.1},{x:229.35,y:39.4},{x:228.45,y:41.8},{x:227.6,y:44.1},{x:226.7,y:46.45},{x:225.8,y:48.8},{x:224.85,y:51.1},{x:223.95,y:53.4},{x:222.95,y:55.75},{x:222,y:58.05},{x:221,y:60.35},{x:220,y:62.65},{x:218.95,y:64.95},{x:217.9,y:67.2},{x:216.85,y:69.5},{x:215.8,y:71.75},{x:214.7,y:74},{x:213.55,y:76.25},{x:212.45,y:78.5},{x:211.3,y:80.75},{x:210.1,y:82.95},{x:208.9,y:85.2},{x:207.7,y:87.4},{x:206.45,y:89.6},{x:205.25,y:91.75},{x:203.95,y:93.95},{x:202.65,y:96.1},{x:201.35,y:98.25},{x:200.05,y:100.4},{x:198.65,y:102.55},{x:197.3,y:104.65},{x:195.9,y:106.8},{x:194.5,y:108.9},{x:193.05,y:110.95},{x:191.6,y:113},{x:190.1,y:115.1},{x:188.65,y:117.1},{x:187.1,y:119.15},{x:185.55,y:121.15},{x:184,y:123.15},{x:182.4,y:125.15},{x:180.8,y:127.1},{x:179.15,y:129.05},{x:177.5,y:130.95},{x:175.8,y:132.85},{x:174.15,y:134.75},{x:172.4,y:136.6},{x:170.65,y:138.5},{x:168.9,y:140.3},{x:167.1,y:142.1},{x:165.3,y:143.9},{x:163.45,y:145.7},{x:161.6,y:147.4},{x:159.7,y:149.15},{x:157.8,y:150.85},{x:155.9,y:152.5},{x:153.95,y:154.2},{x:152,y:155.8},{x:150,y:157.4},{x:148,y:159},{x:145.95,y:160.55},{x:143.95,y:162.1},{x:141.85,y:163.6},{x:139.75,y:165.05},{x:137.65,y:166.5},{x:135.55,y:167.95},{x:133.4,y:169.35},{x:131.25,y:170.7},{x:129.05,y:172.05},{x:126.85,y:173.35},{x:124.65,y:174.65},{x:122.4,y:175.9},{x:120.15,y:177.1},{x:117.9,y:178.3},{x:115.6,y:179.5},{x:113.3,y:180.6},{x:111,y:181.7},{x:108.7,y:182.8},{x:106.35,y:183.85},{x:104,y:184.85},{x:101.65,y:185.85},{x:99.3,y:186.85},{x:96.9,y:187.75},{x:94.5,y:188.65},{x:92.1,y:189.55},{x:89.7,y:190.4},{x:87.25,y:191.2},{x:84.8,y:192},{x:82.4,y:192.75},{x:79.9,y:193.45},{x:77.45,y:194.15},{x:75,y:194.85},{x:72.55,y:195.55},{x:70.1,y:196.2},{x:67.6,y:196.85},{x:65.1,y:197.45},{x:62.65,y:198},{x:60.15,y:198.5},{x:57.6,y:198.95},{x:55.1,y:199.35},{x:52.55,y:199.7},{x:50,y:200},{x:47.45,y:200.25},{x:44.95,y:200.5},{x:42.35,y:200.65},{x:39.8,y:200.75},{x:37.25,y:200.85},{x:34.7,y:200.85},{x:32.15,y:200.85},{x:29.6,y:200.85},{x:27.05,y:200.85},{x:24.5,y:200.85},{x:21.95,y:200.9},{x:19.35,y:200.9},{x:16.85,y:200.8},{x:14.3,y:200.75},{x:11.7,y:200.6},{x:9.2,y:200.5},{x:6.65,y:200.3},{x:4.1,y:200.15},{x:1.55,y:200},{x:-1,y:199.8},{x:-3.55,y:199.55},{x:-6.05,y:199.3},{x:-8.6,y:199},{x:-11.15,y:198.65},{x:-13.65,y:198.3},{x:-16.2,y:197.9},{x:-18.7,y:197.5},{x:-21.2,y:197.05},{x:-23.75,y:196.55},{x:-26.2,y:196},{x:-28.7,y:195.45},{x:-31.2,y:194.9},{x:-33.7,y:194.25},{x:-36.15,y:193.6},{x:-38.6,y:192.9},{x:-41.05,y:192.2},{x:-43.5,y:191.45},{x:-45.95,y:190.7},{x:-48.35,y:189.85},{x:-50.75,y:189.05},{x:-53.2,y:188.15},{x:-55.55,y:187.25},{x:-57.95,y:186.3},{x:-60.3,y:185.35},{x:-62.65,y:184.35},{x:-64.95,y:183.35},{x:-67.3,y:182.3},{x:-69.6,y:181.25},{x:-71.9,y:180.15},{x:-74.2,y:179},{x:-76.45,y:177.85},{x:-78.7,y:176.65},{x:-80.95,y:175.45},{x:-83.15,y:174.2},{x:-85.35,y:172.9},{x:-87.55,y:171.6},{x:-89.75,y:170.25},{x:-91.9,y:168.9},{x:-94.05,y:167.5},{x:-96.15,y:166.05},{x:-98.25,y:164.6},{x:-100.35,y:163.1},{x:-102.4,y:161.6},{x:-104.45,y:160.05},{x:-106.45,y:158.5},{x:-108.45,y:156.9},{x:-110.45,y:155.3},{x:-112.4,y:153.6},{x:-114.3,y:151.95},{x:-116.2,y:150.25},{x:-118.1,y:148.5},{x:-119.95,y:146.75},{x:-121.8,y:144.95},{x:-123.65,y:143.15},{x:-125.4,y:141.35},{x:-127.15,y:139.5},{x:-128.9,y:137.6},{x:-130.65,y:135.7},{x:-132.3,y:133.8},{x:-134,y:131.8},{x:-135.6,y:129.85},{x:-137.25,y:127.9},{x:-138.85,y:125.85},{x:-140.4,y:123.85},{x:-141.9,y:121.8},{x:-143.45,y:119.75},{x:-144.9,y:117.65},{x:-146.4,y:115.6},{x:-147.8,y:113.45},{x:-149.25,y:111.35},{x:-150.65,y:109.2},{x:-152,y:107.05},{x:-153.35,y:104.9},{x:-154.7,y:102.7},{x:-156.05,y:100.5},{x:-157.3,y:98.35},{x:-158.6,y:96.1},{x:-159.85,y:93.9},{x:-161.1,y:91.65},{x:-162.3,y:89.4},{x:-163.45,y:87.1},{x:-164.65,y:84.85},{x:-165.75,y:82.55},{x:-166.9,y:80.25},{x:-168,y:77.95},{x:-169.05,y:75.65},{x:-170.1,y:73.3},{x:-171.15,y:70.95},{x:-172.15,y:68.65},{x:-173.15,y:66.25},{x:-174.1,y:63.9},{x:-175,y:61.5},{x:-175.95,y:59.1},{x:-176.85,y:56.75},{x:-177.7,y:54.35},{x:-178.45,y:51.9},{x:-179.15,y:49.4},{x:-179.85,y:46.95},{x:-180.5,y:44.5},{x:-181.15,y:42},{x:-181.75,y:39.55},{x:-182.3,y:37.05},{x:-182.85,y:34.6},{x:-183.4,y:32.15},{x:-183.9,y:29.65},{x:-184.4,y:27.15},{x:-184.85,y:24.65},{x:-185.3,y:22.15},{x:-185.7,y:19.65},{x:-186.05,y:17.15},{x:-186.4,y:14.65},{x:-186.75,y:12.15},{x:-187.05,y:9.65},{x:-187.3,y:7.1},{x:-187.55,y:4.55},{x:-187.8,y:2.05},{x:-187.95,y:-.5},{x:-188.1,y:-3.05},{x:-188.25,y:-5.6},{x:-188.35,y:-8.15},{x:-188.4,y:-10.65},{x:-188.4,y:-13.2},{x:-188.4,y:-15.8},{x:-188.35,y:-18.3},{x:-188.25,y:-20.85},{x:-188.15,y:-23.4},{x:-188,y:-25.95},{x:-187.8,y:-28.5},{x:-187.6,y:-31.05},{x:-187.35,y:-33.55},{x:-187.1,y:-36.05},{x:-186.85,y:-38.5},{x:-186.6,y:-40.95},{x:-186.35,y:-43.45},{x:-186.1,y:-45.9},{x:-185.85,y:-48.4},{x:-185.55,y:-50.85},{x:-185.3,y:-53.35},{x:-185,y:-55.85},{x:-184.75,y:-58.3},{x:-184.45,y:-60.8},{x:-184.15,y:-63.3},{x:-183.85,y:-65.75},{x:-183.55,y:-68.3},{x:-183.25,y:-70.75},{x:-182.9,y:-73.25},{x:-182.55,y:-75.8},{x:-182.2,y:-78.3},{x:-181.8,y:-80.8},{x:-181.45,y:-83.35},{x:-181.1,y:-85.85},{x:-180.75,y:-88.4},{x:-180.45,y:-90.95},{x:-180.2,y:-93.45},{x:-179.95,y:-96},{x:-179.7,y:-98.55},{x:-179.5,y:-101.1},{x:-179.3,y:-103.65},{x:-179.15,y:-106.2},{x:-179,y:-108.75},{x:-178.9,y:-111.3},{x:-178.8,y:-113.85},{x:-178.75,y:-116.4},{x:-178.7,y:-118.95},{x:-178.65,y:-121.5},{x:-178.65,y:-124.05},{x:-178.7,y:-126.6},{x:-178.75,y:-129.2},{x:-178.85,y:-131.75},{x:-178.95,y:-134.3},{x:-179.05,y:-136.85},{x:-179.2,y:-139.4},{x:-179.4,y:-141.95},{x:-179.6,y:-144.5},{x:-179.8,y:-147},{x:-180.05,y:-149.55},{x:-180.35,y:-152.1},{x:-180.65,y:-154.6},{x:-181,y:-157.1},{x:-181.4,y:-159.65},{x:-181.8,y:-162.15},{x:-182.2,y:-164.65},{x:-182.65,y:-167.15},{x:-183.15,y:-169.65},{x:-183.65,y:-172.15},{x:-184.2,y:-174.65},{x:-184.8,y:-177.15},{x:-185.4,y:-179.6},{x:-186.05,y:-182.1},{x:-186.7,y:-184.55},{x:-187.4,y:-187.05},{x:-188.15,y:-189.5},{x:-188.9,y:-191.95},{x:-189.65,y:-194.35},{x:-190.5,y:-196.8},{x:-191.35,y:-199.2},{x:-192.2,y:-201.6},{x:-193.15,y:-204},{x:-194.05,y:-206.4},{x:-195.05,y:-208.75},{x:-196.05,y:-211.15},{x:-197.1,y:-213.5},{x:-198.15,y:-215.85},{x:-199.25,y:-218.15},{x:-200.35,y:-220.45},{x:-201.5,y:-222.75},{x:-202.7,y:-225.05},{x:-203.9,y:-227.3},{x:-205.1,y:-229.55},{x:-206.4,y:-231.8},{x:-207.7,y:-234.05},{x:-209,y:-236.25},{x:-210.35,y:-238.45},{x:-211.75,y:-240.6},{x:-213.15,y:-242.75},{x:-214.55,y:-244.9},{x:-216,y:-247.05},{x:-217.5,y:-249.15},{x:-219,y:-251.25},{x:-220.55,y:-253.3},{x:-222.1,y:-255.35},{x:-223.65,y:-257.4},{x:-225.25,y:-259.4},{x:-226.85,y:-261.4},{x:-228.55,y:-263.35},{x:-230.2,y:-265.3},{x:-231.85,y:-267.25},{x:-233.6,y:-269.2},{x:-235.3,y:-271.1},{x:-237.05,y:-272.95},{x:-238.85,y:-274.85},{x:-240.6,y:-276.7},{x:-242.4,y:-278.5},{x:-244.25,y:-280.3},{x:-246.1,y:-282.1},{x:-247.95,y:-283.85},{x:-249.85,y:-285.6},{x:-251.7,y:-287.35},{x:-253.65,y:-289.05},{x:-255.55,y:-290.75},{x:-257.5,y:-292.45},{x:-259.45,y:-294.1},{x:-261.45,y:-295.75},{x:-263.4,y:-297.35},{x:-265.4,y:-298.95},{x:-267.4,y:-300.55},{x:-269.45,y:-302.1},{x:-271.45,y:-303.65},{x:-273.55,y:-305.2},{x:-275.6,y:-306.7},{x:-277.65,y:-308.2},{x:-279.75,y:-309.7},{x:-282,y:-310.9},{x:-284.3,y:-312.05},{x:-286.55,y:-313.2},{x:-288.85,y:-314.35},{x:-291.1,y:-315.5},{x:-293.4,y:-316.65},{x:-295.65,y:-317.8},{x:-297.95,y:-319},{x:-300.25,y:-320.15},{x:-302.5,y:-321.3},{x:-304.8,y:-322.45},{x:-307.05,y:-323.6},{x:-309.35,y:-324.75},{x:-311.65,y:-325.9},{x:-313.9,y:-327.05},{x:-316.15,y:-328.2},{x:-318.45,y:-329.4},{x:-320.75,y:-330.55},{x:-323,y:-331.7},{x:-325.3,y:-332.85},{x:-327.55,y:-334},{x:-329.85,y:-335.15},{x:-332.15,y:-336.3},{x:-334.4,y:-337.45},{x:-336.7,y:-338.65},{x:-338.95,y:-339.8},{x:-341.25,y:-340.95},{x:-343.5,y:-342.1},{x:-345.8,y:-343.25},{x:-348.1,y:-344.4},{x:-350.35,y:-345.55},{x:-352.65,y:-346.7},{x:-354.9,y:-347.9},{x:-357.2,y:-349.05},{x:-359.5,y:-350.2},{x:-361.75,y:-351.35},{x:-364.05,y:-352.5},{x:-366.3,y:-353.65},{x:-368.6,y:-354.8},{x:-370.85,y:-355.95},{x:-373.15,y:-357.1},{x:-375.45,y:-358.3},{x:-377.7,y:-359.45},{x:-380,y:-360.6},{x:-382.25,y:-361.75},{x:-384.55,y:-362.9},{x:-386.8,y:-364.05},{x:-389.1,y:-365.2},{x:-391.35,y:-366.35},{x:-393.65,y:-367.55},{x:-395.95,y:-368.7},{x:-398.2,y:-369.85},{x:-400.5,y:-371},{x:-402.75,y:-372.15},{x:-405.05,y:-373.3},{x:-407.35,y:-374.45},{x:-409.6,y:-375.6},{x:-411.9,y:-376.75},{x:-414.15,y:-377.95},{x:-416.45,y:-379.1},{x:-418.7,y:-380.25},{x:-421,y:-381.4},{x:-423.3,y:-382.55},{x:-425.55,y:-383.7},{x:-427.85,y:-384.85},{x:-430.1,y:-386},{x:-432.4,y:-387.15},{x:-434.7,y:-388.35},{x:-436.95,y:-389.5},{x:-439.2,y:-390.65},{x:-441.5,y:-391.8},{x:-443.8,y:-392.95},{x:-446.05,y:-394.1},{x:-448.35,y:-395.25},{x:-450.6,y:-396.4},{x:-452.9,y:-397.55},{x:-455.2,y:-398.75},{x:-457.45,y:-399.9},{x:-459.75,y:-401.05},{x:-462,y:-402.2},{x:-464.3,y:-403.35},{x:-466.55,y:-404.5},{x:-468.85,y:-405.65},{x:-471.15,y:-406.8},{x:-473.4,y:-408},{x:-475.7,y:-409.15},{x:-477.95,y:-410.3},{x:-480.25,y:-411.45},{x:-482.55,y:-412.6},{x:-484.8,y:-413.75},{x:-487.1,y:-414.9},{x:-489.35,y:-416.05},{x:-491.65,y:-417.25},{x:-493.9,y:-418.4},{x:-496.2,y:-419.55},{x:-498.45,y:-420.7},{x:-500.75,y:-421.85},{x:-503.05,y:-423},{x:-505.3,y:-424.15},{x:-507.6,y:-425.3},{x:-509.85,y:-426.5},{x:-512.15,y:-427.65},{x:-514.4,y:-428.8},{x:-516.7,y:-429.95},{x:-519,y:-431.1},{x:-521.25,y:-432.25},{x:-523.55,y:-433.4},{x:-525.8,y:-434.55},{x:-528.1,y:-435.7},{x:-530.4,y:-436.9},{x:-532.65,y:-438.05},{x:-534.95,y:-439.2},{x:-537.2,y:-440.35},{x:-539.5,y:-441.5},{x:-541.75,y:-442.65},{x:-544.05,y:-443.8},{x:-546.35,y:-444.95},{x:-548.6,y:-446.1},{x:-550.9,y:-447.3},{x:-553.15,y:-448.45},{x:-555.45,y:-449.6},{x:-557.75,y:-450.75}],i.steps2=[{x:231.3,y:33.85},{x:230.3,y:36.8},{x:229.2,y:39.75},{x:228.15,y:42.7},{x:227,y:45.65},{x:225.9,y:48.55},{x:224.75,y:51.45},{x:223.55,y:54.35},{x:222.35,y:57.25},{x:221.1,y:60.1},{x:219.8,y:63},{x:218.55,y:65.85},{x:217.2,y:68.7},{x:215.85,y:71.55},{x:214.5,y:74.4},{x:213.1,y:77.2},{x:211.65,y:80},{x:210.2,y:82.8},{x:208.7,y:85.55},{x:207.2,y:88.35},{x:205.65,y:91.1},{x:204.05,y:93.8},{x:202.4,y:96.5},{x:200.8,y:99.2},{x:199.1,y:101.9},{x:197.4,y:104.55},{x:195.65,y:107.2},{x:193.85,y:109.8},{x:192.05,y:112.4},{x:190.2,y:115},{x:188.35,y:117.55},{x:186.4,y:120.05},{x:184.45,y:122.55},{x:182.5,y:125.05},{x:180.45,y:127.5},{x:178.4,y:129.95},{x:176.3,y:132.3},{x:174.2,y:134.7},{x:172,y:137.05},{x:169.85,y:139.35},{x:167.6,y:141.65},{x:165.35,y:143.85},{x:163.05,y:146.1},{x:160.7,y:148.25},{x:158.3,y:150.4},{x:155.95,y:152.5},{x:153.5,y:154.6},{x:151,y:156.6},{x:148.5,y:158.6},{x:145.95,y:160.55},{x:143.4,y:162.45},{x:140.8,y:164.3},{x:138.15,y:166.15},{x:135.5,y:167.95},{x:132.85,y:169.7},{x:130.1,y:171.4},{x:127.35,y:173.05},{x:124.6,y:174.65},{x:121.8,y:176.2},{x:119,y:177.75},{x:116.15,y:179.2},{x:113.25,y:180.65},{x:110.35,y:182.05},{x:107.45,y:183.35},{x:104.5,y:184.65},{x:101.55,y:185.9},{x:98.6,y:187.1},{x:95.6,y:188.25},{x:92.6,y:189.35},{x:89.6,y:190.4},{x:86.5,y:191.45},{x:83.5,y:192.4},{x:80.4,y:193.35},{x:77.35,y:194.2},{x:74.25,y:195.05},{x:71.2,y:195.9},{x:68.05,y:196.75},{x:64.95,y:197.5},{x:61.85,y:198.15},{x:58.7,y:198.75},{x:55.55,y:199.25},{x:52.4,y:199.7},{x:49.2,y:200.1},{x:46,y:200.4},{x:42.8,y:200.6},{x:39.6,y:200.75},{x:36.4,y:200.85},{x:33.2,y:200.85},{x:30,y:200.85},{x:26.8,y:200.85},{x:23.6,y:200.9},{x:20.4,y:200.9},{x:17.2,y:200.85},{x:14.05,y:200.7},{x:10.8,y:200.55},{x:7.65,y:200.4},{x:4.45,y:200.2},{x:1.25,y:199.95},{x:-1.9,y:199.7},{x:-5.1,y:199.4},{x:-8.25,y:199.05},{x:-11.45,y:198.65},{x:-14.6,y:198.15},{x:-17.75,y:197.65},{x:-20.9,y:197.1},{x:-24,y:196.5},{x:-27.15,y:195.8},{x:-30.3,y:195.1},{x:-33.35,y:194.35},{x:-36.5,y:193.5},{x:-39.55,y:192.65},{x:-42.6,y:191.75},{x:-45.7,y:190.75},{x:-48.7,y:189.75},{x:-51.75,y:188.7},{x:-54.75,y:187.55},{x:-57.7,y:186.4},{x:-60.7,y:185.15},{x:-63.65,y:183.9},{x:-66.55,y:182.6},{x:-69.45,y:181.25},{x:-72.35,y:179.85},{x:-75.2,y:178.4},{x:-78,y:176.9},{x:-80.85,y:175.35},{x:-83.6,y:173.75},{x:-86.4,y:172.15},{x:-89.1,y:170.5},{x:-91.75,y:168.75},{x:-94.45,y:167},{x:-97.05,y:165.2},{x:-99.65,y:163.35},{x:-102.25,y:161.45},{x:-104.8,y:159.5},{x:-107.3,y:157.55},{x:-109.75,y:155.5},{x:-112.2,y:153.4},{x:-114.6,y:151.3},{x:-116.95,y:149.1},{x:-119.25,y:146.9},{x:-121.55,y:144.65},{x:-123.8,y:142.35},{x:-125.95,y:140.05},{x:-128.1,y:137.65},{x:-130.25,y:135.25},{x:-132.3,y:132.8},{x:-134.3,y:130.3},{x:-136.3,y:127.8},{x:-138.25,y:125.25},{x:-140.1,y:122.65},{x:-141.95,y:120},{x:-143.75,y:117.35},{x:-145.5,y:114.7},{x:-147.2,y:111.95},{x:-148.85,y:109.2},{x:-150.45,y:106.45},{x:-152.05,y:103.65},{x:-153.6,y:100.9},{x:-155.15,y:98.1},{x:-156.7,y:95.25},{x:-158.2,y:92.4},{x:-159.65,y:89.6},{x:-161.05,y:86.7},{x:-162.45,y:83.8},{x:-163.75,y:80.9},{x:-165.1,y:78},{x:-166.35,y:75.05},{x:-167.6,y:72.1},{x:-168.8,y:69.1},{x:-169.95,y:66.15},{x:-171.1,y:63.15},{x:-172.2,y:60.15},{x:-173.25,y:57.1},{x:-174.3,y:54.1},{x:-175.3,y:51.05},{x:-176.25,y:48},{x:-177.15,y:44.95},{x:-178,y:41.85},{x:-178.85,y:38.8},{x:-179.65,y:35.7},{x:-180.4,y:32.6},{x:-181.15,y:29.5},{x:-181.8,y:26.35},{x:-182.45,y:23.2},{x:-183.05,y:20.1},{x:-183.6,y:16.95},{x:-184.15,y:13.8},{x:-184.6,y:10.6},{x:-185.05,y:7.45},{x:-185.45,y:4.25},{x:-185.8,y:1.1},{x:-186.1,y:-2.1},{x:-186.35,y:-5.3},{x:-186.6,y:-8.45},{x:-186.75,y:-11.65},{x:-186.9,y:-14.9},{x:-187,y:-18.05},{x:-187.05,y:-21.25},{x:-187.1,y:-24.5},{x:-187.05,y:-27.65},{x:-187,y:-30.85},{x:-186.9,y:-34.1},{x:-186.75,y:-37.25},{x:-186.55,y:-40.45},{x:-186.3,y:-43.65},{x:-186.05,y:-46.85},{x:-185.75,y:-50.05},{x:-185.4,y:-53.25},{x:-185.05,y:-56.4},{x:-184.7,y:-59.55},{x:-184.3,y:-62.75},{x:-183.9,y:-65.95},{x:-183.5,y:-69.1},{x:-183.05,y:-72.3},{x:-182.6,y:-75.45},{x:-182.15,y:-78.6},{x:-181.65,y:-81.8},{x:-181.2,y:-84.95},{x:-180.8,y:-88.1},{x:-180.4,y:-91.3},{x:-180.1,y:-94.45},{x:-179.75,y:-97.65},{x:-179.5,y:-100.85},{x:-179.25,y:-104.05},{x:-179.1,y:-107.2},{x:-178.9,y:-110.45},{x:-178.8,y:-113.65},{x:-178.7,y:-116.8},{x:-178.65,y:-120.05},{x:-178.65,y:-123.25},{x:-178.7,y:-126.4},{x:-178.75,y:-129.65},{x:-178.85,y:-132.85},{x:-179,y:-136},{x:-179.2,y:-139.25},{x:-179.4,y:-142.4},{x:-179.7,y:-145.6},{x:-180,y:-148.75},{x:-180.35,y:-151.9},{x:-180.75,y:-155.05},{x:-181.15,y:-158.25},{x:-181.65,y:-161.4},{x:-182.2,y:-164.5},{x:-182.75,y:-167.65},{x:-183.4,y:-170.8},{x:-184.05,y:-173.9},{x:-184.75,y:-177.05},{x:-185.5,y:-180.15},{x:-186.35,y:-183.2},{x:-187.2,y:-186.3},{x:-188.1,y:-189.35},{x:-189.05,y:-192.4},{x:-190.05,y:-195.5},{x:-191.1,y:-198.5},{x:-192.2,y:-201.5},{x:-193.3,y:-204.5},{x:-194.5,y:-207.5},{x:-195.75,y:-210.45},{x:-197.05,y:-213.4},{x:-198.35,y:-216.3},{x:-199.75,y:-219.2},{x:-201.15,y:-222.1},{x:-202.65,y:-224.95},{x:-204.15,y:-227.75},{x:-205.7,y:-230.6},{x:-207.3,y:-233.35},{x:-208.95,y:-236.1},{x:-210.65,y:-238.85},{x:-212.35,y:-241.55},{x:-214.15,y:-244.25},{x:-215.95,y:-246.9},{x:-217.8,y:-249.55},{x:-219.65,y:-252.15},{x:-221.6,y:-254.7},{x:-223.55,y:-257.25},{x:-225.55,y:-259.75},{x:-227.6,y:-262.25},{x:-229.65,y:-264.7},{x:-231.75,y:-267.1},{x:-233.9,y:-269.55},{x:-236.05,y:-271.9},{x:-238.25,y:-274.2},{x:-240.5,y:-276.55},{x:-242.75,y:-278.8},{x:-245.05,y:-281.05},{x:-247.35,y:-283.3},{x:-249.7,y:-285.45},{x:-252.05,y:-287.6},{x:-254.5,y:-289.7},{x:-257,y:-291.7},{x:-259.5,y:-293.65},{x:-262,y:-295.7},{x:-264.5,y:-297.7},{x:-267,y:-299.65},{x:-269.5,y:-301.7},{x:-272,y:-303.65},{x:-274.5,y:-305.65},{x:-277,y:-307.65},{x:-279.5,y:-309.65},{x:-282.05,y:-311.6},{x:-284.75,y:-313.4},{x:-287.45,y:-315.1},{x:-290.2,y:-316.7},{x:-293,y:-318.25},{x:-295.8,y:-319.75},{x:-298.65,y:-321.2},{x:-301.5,y:-322.65},{x:-304.4,y:-324.05},{x:-307.25,y:-325.45},{x:-310.2,y:-326.75},{x:-313.1,y:-328.05},{x:-316,y:-329.35},{x:-319,y:-330.55},{x:-321.95,y:-331.75},{x:-324.95,y:-332.9},{x:-327.95,y:-334},{x:-330.95,y:-335.1},{x:-333.95,y:-336.15},{x:-337,y:-337.15},{x:-340.05,y:-338.1},{x:-343.1,y:-338.95},{x:-346.2,y:-339.8},{x:-349.25,y:-340.6},{x:-352.35,y:-341.3},{x:-355.45,y:-342},{x:-358.6,y:-342.65},{x:-361.7,y:-343.25},{x:-364.85,y:-343.8},{x:-368,y:-344.3},{x:-371.15,y:-344.75},{x:-374.3,y:-345.15},{x:-377.5,y:-345.5},{x:-380.65,y:-345.75},{x:-383.85,y:-346},{x:-387.05,y:-346.2},{x:-390.2,y:-346.3},{x:-393.4,y:-346.4},{x:-396.6,y:-346.4},{x:-399.8,y:-346.35},{x:-403,y:-346.25},{x:-406.2,y:-346.1},{x:-409.4,y:-345.85},{x:-412.6,y:-345.6},{x:-415.75,y:-345.25},{x:-418.9,y:-344.85},{x:-422.1,y:-344.4},{x:-425.25,y:-343.9},{x:-428.4,y:-343.35},{x:-431.5,y:-342.75},{x:-434.55,y:-342.2},{x:-437.6,y:-341.55},{x:-440.65,y:-340.95},{x:-443.7,y:-340.25},{x:-446.75,y:-339.55},{x:-449.8,y:-338.85},{x:-452.8,y:-338.1},{x:-455.85,y:-337.3},{x:-458.9,y:-336.5},{x:-461.9,y:-335.65},{x:-464.9,y:-334.7},{x:-467.9,y:-333.75},{x:-470.9,y:-332.8},{x:-473.85,y:-331.75},{x:-476.85,y:-330.6},{x:-479.75,y:-329.45},{x:-482.7,y:-328.2},{x:-485.6,y:-326.85},{x:-488.45,y:-325.45},{x:-491.25,y:-323.95},{x:-494,y:-322.4},{x:-496.7,y:-320.9},{x:-499.4,y:-319.3},{x:-502.1,y:-317.7},{x:-504.75,y:-316.05},{x:-507.4,y:-314.35},{x:-510.05,y:-312.65},{x:-512.6,y:-310.85},{x:-515.2,y:-309},{x:-517.7,y:-307.05},{x:-520.15,y:-305.05},{x:-522.55,y:-302.9},{x:-524.9,y:-300.7},{x:-527.2,y:-298.5},{x:-529.5,y:-296.2},{x:-531.75,y:-293.95},{x:-533.95,y:-291.65},{x:-536.15,y:-289.3},{x:-538.3,y:-286.9},{x:-540.4,y:-284.55},{x:-542.55,y:-282.1},{x:-544.6,y:-279.65},{x:-546.7,y:-277.15},{x:-548.8,y:-274.6},{x:-550.8,y:-272.05},{x:-552.8,y:-269.5},{x:-554.8,y:-266.9},{x:-556.75,y:-264.35},{x:-558.65,y:-261.7},{x:-560.6,y:-259.05},{x:-562.45,y:-256.45},{x:-564.3,y:-253.8},{x:-566.15,y:-251.1},{x:-567.95,y:-248.4},{x:-569.75,y:-245.7},{x:-571.55,y:-243},{x:-573.25,y:-240.3},{x:-575,y:-237.55},{x:-576.7,y:-234.8},{x:-578.4,y:-232.05},{x:-580.05,y:-229.3},{x:-581.7,y:-226.5},{x:-583.35,y:-223.75},{x:-584.95,y:-220.95},{x:-586.55,y:-218.15},{x:-588.1,y:-215.35},{x:-589.65,y:-212.55},{x:-591.2,y:-209.7},{x:-592.75,y:-206.9},{x:-594.25,y:-204.1},{x:-595.75,y:-201.2},{x:-597.2,y:-198.4},{x:-598.7,y:-195.55},{x:-600.15,y:-192.65},{x:-601.55,y:-189.8},{x:-603,y:-186.95},{x:-604.25,y:-184},{x:-605.45,y:-181.05},{x:-606.7,y:-178.1},{x:-607.9,y:-175.1},{x:-609.15,y:-172.2},{x:-610.35,y:-169.25},{x:-611.6,y:-166.25},{x:-612.85,y:-163.3},{x:-614.05,y:-160.35},{x:-615.3,y:-157.4},{x:-616.5,y:-154.45},{x:-617.75,y:-151.5},{x:-618.95,y:-148.55},{x:-620.2,y:-145.6},{x:-621.4,y:-142.65},{x:-622.65,y:-139.65},{x:-623.9,y:-136.7},{x:-625.1,y:-133.75},{x:-626.35,y:-130.8},{x:-627.55,y:-127.85},{x:-628.8,y:-124.9},{x:-630,y:-121.95},{x:-631.25,y:-119},{x:-632.45,y:-116.05},{x:-633.7,y:-113.05},{x:-634.95,y:-110.1},{x:-636.15,y:-107.15},{x:-637.4,y:-104.2},{x:-638.6,y:-101.25},{x:-639.85,y:-98.3},{x:-641.05,y:-95.35},{x:-642.3,y:-92.4},{x:-643.5,y:-89.45},{x:-644.75,y:-86.5},{x:-646,y:-83.55},{x:-647.2,y:-80.6},{x:-648.45,y:-77.6},{x:-649.65,y:-74.65},{x:-650.9,y:-71.7},{x:-652.1,y:-68.75},{x:-653.35,y:-65.8},{x:-654.55,y:-62.85},{x:-655.8,y:-59.9},{x:-657.05,y:-56.95},{x:-658.25,y:-54},{x:-659.5,y:-51},{x:-660.7,y:-48.05},{x:-661.95,y:-45.1},{x:-663.15,y:-42.15},{x:-664.4,y:-39.2},{x:-665.6,y:-36.25},{x:-666.85,y:-33.3},{x:-668.1,y:-30.35},{x:-669.3,y:-27.4},{x:-670.55,y:-24.4},{x:-671.75,y:-21.45},{x:-673,y:-18.55},{x:-674.2,y:-15.55},{x:-675.45,y:-12.6},{x:-676.65,y:-9.65},{x:-677.9,y:-6.7},{x:-679.15,y:-3.75},{x:-680.35,y:-.8},{x:-681.6,y:2.15},{x:-682.8,y:5.1},{x:-684.05,y:8.05},{x:-685.25,y:11.05},{x:-686.5,y:14},{x:-687.7,y:16.95},{x:-688.95,y:19.9},{x:-690.2,y:22.85},{x:-691.4,y:25.8},{x:-692.65,y:28.75}],i.speed=1,i.currentStep=i.steps1,i.g1Point=new h.Point(-451,-279),i.stepindex=0,i.line=new PIXI.Graphics,i.preObj=null,i.firstPlay=!0,i}return s(e,t),a(e,[{key:"added",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.componentBox.visible=!1,this.removeChild(this.componentBox),this.initBtn(),this.initG1(),this.addChild(this.line),this.addChild(this.ball),this.line.clear(),this.line.lineStyle(2,16711680),this.line.moveTo(this.currentStep[0].x,this.currentStep[0].y)}},{key:"removed",value:function(){this.removedCursor(this.startBtn),h.M.removeTouch(this.g1,this.g1Touchid),this.startBtn.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){if(this.startplay)if(this.stepindex+=h.M.getNumToInt(2*this.speed),this.currentStep.length>this.stepindex){var t=this.currentStep[this.stepindex];this.ball.x=t.x,this.ball.y=t.y,this.line.moveTo(this.preObj.x,this.preObj.y),this.line.lineTo(t.x,t.y),this.preObj=t}else this.startplay=!1}},{key:"initG1",value:function(){var t=this;this.g1.x=-550,this.g1.y=15;var e=void 0;this.g1Touchid=h.M.addTouch(this.g1,{begin:function(i){t.startplay||(e=t.getMouseXY(i),t.cannotSystemDrag=!0)},move:function(i){if(!t.startplay){var o=t.getMouseXY(i);t.g1.x+=o.x-e.x,t.g1.y+=o.y-e.y,e=o}},end:function(e){if(!t.startplay){var i=new h.Point(t.g1.x,t.g1.y);50>h.Point.distance(i,t.g1Point)?(t.g1.x=t.g1Point.x,t.g1.y=t.g1Point.y,t.currentStep=t.steps2):t.currentStep=t.steps1,t.cannotSystemDrag=!1}}},this)}},{key:"initBtn",value:function(){this.startBtn.fontColor="#ffffff",this.startBtn.text=this.language.getLocaleStr("start"),this.startBtn["this"]=this,this.startBtn.tab=this.startClick,this.addCursor(this.startBtn,"hand")}},{key:"startClick",value:function(){this.startBtn.tab=this.resetClick,this.startBtn.text=this.language.getLocaleStr("reset"),this.stepindex=0,this.line.clear(),this.line.lineStyle(2,16711680),this.line.moveTo(this.currentStep[0].x,this.currentStep[0].y),this.preObj=this.currentStep[0],this.startplay=!0}},{key:"resetClick",value:function(){this.ball.x=this.currentStep[0].x,this.ball.y=this.currentStep[0].y,this.stepindex=0,this.line.clear(),this.line.lineStyle(2,16711680),this.line.moveTo(this.currentStep[0].x,this.currentStep[0].y),this.preObj=this.currentStep[0],this.startBtn.tab=this.startClick,this.startBtn.text=this.language.getLocaleStr("start"),this.startplay=!1}},{key:"speedChange",value:function(t){this.speed=h.M.getNumStr(t.showValue)-0,this.resetClick()}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("initial_velocity"),!0,"m/s",5,1,this.speed,.1,this.speedChange,this)),t}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function _(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:_(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0,y=void 0,f=void 0,g=void 0,b=void 0,v=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.geom.Vec2,p=c.shape.Polygon,y=c.phys.Material,f=c.callbacks.InteractionListener,g=c.callbacks.InteractionType,b=c.callbacks.CbEvent,v=c.callbacks.CbType,i.bg=null,i.WIDTH=30,i.HEIGHT=576,i.HALF_WIDTH=i.WIDTH/2,i.HALF_HEIGHT=i.HEIGHT/2,i.material=new y(0,1,2,1e-6,.001),i.minRho=.8,i.maxRho=1.5,i.deltaRho=i.maxRho-i.minRho,i.s1=8,i.h1=340,i.s2=30,i.h2=235,i.h3=240,i.heavy={mass:0,area:0,density:0},i.mass=0,i.area=0,i.density=0,i.offY=0,i.zoomBgCon=null,i}return s(e,t),a(e,[{key:"calculateMass",value:function(){return this.minRho*this.h2*this.s2}},{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.kdLine=new PIXI.Graphics,this.addChild(this.kdLine),this.kdLineZoom=new PIXI.Graphics,this.zoomBg.addChild(this.kdLineZoom),this.createShape(),this.drawScale(this.kdLine),this.drawScale(this.kdLineZoom),this.cbtype=new v,this.body.get_cbTypes().add(this.cbtype),this.hitListener=new f(b.get_BEGIN(),g.get_ANY(),this.cbtype,this.CbTypeStr.LIQUID_SHAPE,this.liquidHitHandler.bind(this)),this.addNapeListeners(this.hitListener),this.body.set_isBullet(!0);var t=new PIXI.Graphics;t.beginFill(16711680,.5),t.drawCircle(148,125,123),t.endFill(),t.x=this.zoom.x,t.y=this.zoom.y,this.zoomBgCon=new PIXI.Graphics,this.zoomBgCon.addChild(this.zoomBg),this.zoomBgCon.addChild(this.zoom),this.zoomBgCon.addChild(t),this.zoomBg.mask=t;var i=[];i.push({option:"addElement",target:this.zoomBgCon,params:{x:0,y:0}}),this.dispatchGraphic(i),this.showZoom(!1)}},{key:"removed",value:function(){this.removeNapeListeners(this.hitListener),this.disposeGraphic(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"dispatchGraphic",value:function(t){this.var_UID||(this.var_UID=h.M.getUniqueID()),this.napeEngine.grC.dispatchEvent("Start_Graphic",t,this.var_UID)}},{key:"disposeGraphic",value:function(){this.napeEngine.grC.dispatchEvent("Dispose_Graphics",this.var_UID),this.var_UID=null}},{key:"liquidHitHandler",value:function(t){var e=this;this.interval&&(clearTimeout(this.interval),this.interval=0),this.showZoom(!0),this.zoomBgCon.parent&&this.zoomBgCon.parent.addChild(this.zoomBgCon),this.zoomBgCon.x=this.body.posx,this.zoomBgCon.y=this.body.posy,this.zoomBgCon.rotation=this.body.get_rotation(),this.interval=setTimeout(function(){e.hadDestory||(e.showZoom(!1),e.interval=0)},200);var i=this.body.get_rotation()%(2*Math.PI);if(i>Math.PI/6&&i<11*Math.PI/6||i<-Math.PI/6&&i>-11*Math.PI/6)return void this.showZoom(!1);var o=t.get_int1(),n=t.get_int2(),s=void 0;if(s=o.isShape()?o.get_castShape():n.get_castShape(),!s.get_body())return void this.showZoom(!1);var a=s.get_bounds(),r=this.body.get_position().copy(),h=r.get_y()-a.get_y();this.zoom.y=-h-136,this.zoomBg.mask&&(this.zoomBg.mask.y=this.zoom.y),this.zoomBg.y=4*h-h+this.offY;var l=s.get_body(),u=this.BodyUtil.getView(l);if(u&&u.ignoreBuoyancy){t.get_arbiters().foreach(function(t){u.ignoreBuoyancy(t)&&e.showZoom(!1)})}}},{key:"createShape",value:function(){this.body.get_shapes().clear();this.massMaterial=new y(0,1,2,10,.001),this.massShape=new p(p.box(10,40),this.massMaterial),this.massShape.translate(d.get(0,this.HALF_HEIGHT-35)),this.body.add(this.massShape);var t=[{x:5.55,y:48.2},{x:-3.25,y:48.8},{x:-13.8,y:66.35},{x:-13.85,y:274.7},{x:.3,y:287.2},{x:13.35,y:274.1},{x:12.5,y:66.9}];t=this.Vec2Util.pointArrToVec2Arr(t);var e=new p(t,this.material);this.body.add(e);var i=e.get_area()+this.massShape.get_area(),o=this.deltaRho*this.h1/this.h3,n=this.minRho+this.deltaRho/2+o/2;this.s1=o*i/(n-o)/this.h1;var s=new p(p.box(this.s1/2,this.h1),this.material);s.translate(d.get(0,(this.h1-this.HEIGHT)/2)),this.body.add(s),s=new p(p.box(this.s1/2,this.h1),this.material),s.translate(d.get(0,(this.h1-this.HEIGHT)/2)),this.body.add(s),this.massMaterial.set_density((i*n-(e.get_area()+2*s.get_area())*this.material.get_density())/400),this.updateParam()}},{key:"drawScale",value:function(t){t.clear();t.lineStyle(1,0,1);for(var e=this.minRho,i=(this.getHyByRho(e),this.minRho);this.maxRho>i;i+=.1){var o=0;for(o=0;10>o;o++)this.drawScaleAtRho(t,o,i+.01*o);i+.1>this.maxRho&&this.drawScaleAtRho(t,o,i+.1)}}},{key:"getHyByRho",value:function(t){return(this.area-this.mass/t)/this.s1-this.HEIGHT/2}},{key:"drawScaleAtRho",value:function(t,e,i){var o=this.getHyByRho(i),n=4;i=Math.floor(1e3*i)/1e3,e%10==0?n=9:e%5==0&&(n=6),t.moveTo(5,o),t.lineTo(5-n,o)}},{key:"createTxt",value:function(t,e,i,o,n,s){var a=new PIXI.Text(o,{font:n+"px Arial",fill:s});return t.addChild(a),a.x=e,a.y=i,a}},{key:"showZoom",value:function(t){this.zoomBg.visible=this.zoom.visible=t,this.zoomBg.mask&&(this.zoomBg.mask.visible=t)}},{key:"setHeavyDensimeter",value:function(t){this.massMaterial.set_density(t)}},{key:"getTotalArea",value:function(){for(var t=0,e=this.body.get_shapes(),i=0;i<e.get_length();i++){t+=e.at(i).get_area()}return t}},{key:"getTotalMass",value:function(){for(var t=0,e=this.body.get_shapes(),i=0;i<e.get_length();i++){var o=e.at(i);t+=o.get_area()*o.get_material().get_density()}return t}},{key:"updateParam",value:function(){this.mass=this.getTotalMass(),this.area=this.getTotalArea(),this.density=this.mass/this.area,this.heavy.area=this.massShape.get_area(),this.heavy.density=this.massMaterial.get_density(),this.heavy.mass=this.heavy.area*this.heavy.density}},{key:"selectRenderChild",value:function(){return this.bg.getBounds()}},{key:"getConf",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push(this.ComponentProperty.getLabel(this.language.getLocaleStr("range"),this.minRho+"~"+this.maxRho+" g/cm³"),this.ComponentProperty.getLabel(this.language.getLocaleStr("dividing_value"),"0.01 g/cm³")),t}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function T(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:T(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(449),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0,m=void 0,x=void 0,w=void 0,k=void 0,P=void 0,O=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.NbBody,g=y.phys.BodyType,b=y.shape.Polygon,v=y.shape.Circle,_=y.callbacks.CbType,m=y.callbacks.CbEvent,x=y.callbacks.InteractionType,w=y.callbacks.InteractionListener,P=y.shape.LiquidShape,O=y.phys.LiquidDrop,k=y.geom.Vec2,i.level=5,i.sensor=null,i.totalRange=2,i.fullH=427,i.fullW=26,i.unitMl=i.fullH/i.totalRange,i.colorli=16777215,i.boty=282,i.liquidH=0,i.prevH=0,i.hitListener=null,i.hitEndListener=null,i.pushing=!1,i.pushTime=0,i.pushStep=0,i.guanMask=null,i.liquid=null,i.curliquidDat={density:0,alpha:0},i.tweening=!1,i}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.guanMask=this.getChildAt(2),this.body.set_type(g.get_KINEMATIC()),this.createbgShape(),this.initSensor(),this.initLiquid(),this.initOption(),this.addCursor(this.jiao,"hand"),this.freshTxtColor()}},{key:"createbgShape",value:function(){this.body.get_shapes().clear();var t=new b(b.box(40,610));this.body.add(t),t.set_sensorEnabled(!0)}},{key:"initLiquid",value:function(){this.liquid=new PIXI.Graphics,this.addChildAt(this.liquid,0),this.liquid.mask=this.guanMask}},{key:"initSensor",value:function(){this.sensor=new v(10),this.body.add(this.sensor),this.sensor.set_sensorEnabled(!0),this.sensor.translate(k.weak(0,275))}},{key:"initOption",value:function(){var t=this;this.addEventListener(p["default"].BEGIN,function(e){if(!t.tweening){var i=t.getViewMouseXY(e),o=t.body.worldPointToLocal(k.get(i.x,i.y));i.x=o.get_x(),i.y=o.get_y(),t.jiao.y>i.y&&(t.jiao.gotoAndStop(1),t.pushing=!0,t.pushStep=t.getCurrentTime(),t.effluentLiquid())}}),this.addEventListener(p["default"].END,function(e){if(!t.tweening){t.jiao.gotoAndStop(0),t.pushing=!1,t.pushStep=0,clearInterval(t.pushTime);var i=t.getViewMouseXY(e),o=t.body.worldPointToLocal(k.get(i.x,i.y));i.x=o.get_x(),i.y=o.get_y(),t.jiao.y>i.y&&t.inletLiquid()}})}},{key:"getCurtMl",value:function(){return this.liquidH/this.unitMl}},{key:"effluentLiquid",value:function(){var t=this;if(this.getCurtMl()>0){var e=new PIXI.Graphics;this.parent.addChild(e),e.beginFill(this.colorli,this.curliquidDat.alpha);var i=new l.Point(20,35),o=new l.Point(0,40);e.quadraticCurveTo(i.x,i.y,o.x,o.y),e.moveTo(0,0),e.quadraticCurveTo(-i.x,i.y,o.x,o.y),e.x=this.x,e.y=this.y+this.boty;var n=new O(null,null,this.CbTypeStr),s=new v(10);n.add(s),s.translate(k.weak(0,30)),this.addBodyToSpace(n,this.parent),s.set_sensorEnabled(!0),n.userData.view=e,n.set_position(k.weak(e.x,e.y));var a=this.getCurrentTime();a-=this.pushStep;var r=2e3/a;r>1&&(r=1),.2>r&&(r=.2);var h={ml:.05,density:this.curliquidDat.density,alpha:this.curliquidDat.alpha};.05>this.getCurtMl()?(h.ml=this.getCurtMl(),this.liquidH=0):this.liquidH-=.05*this.unitMl,n.data=h;var u=this.JointUtil.createWeldJoint(this.body,n,n.get_position(),n.get_position());TweenMax.from(e.scale,r,{x:.1,y:.1,onComplete:function(){t.BodyUtil.destoryJoint(u),n.addHit(),t.pushing&&t.effluentLiquid()}})}}},{key:"inletLiquid",value:function(){var t=this;if(!this.tweening){var e=this.getHitLiquidShape();if(e){var i=e.get_body(),o=i.userData.view;if(o){if(!o.canPour)return;var n=this.totalRange-this.getCurtMl(),s=o.dropperInlet(n);this.curliquidDat.density=s.density,this.curliquidDat.alpha=s.alpha;var a=s.ml,r=this.liquidH+a*this.unitMl,h={xx:this.liquidH};this.tweening=!0,TweenMax.to(h,.5,{xx:r,onUpdate:function(){t.liquidH=h.xx,t.tweening=!1}})}}}}},{key:"getHitLiquidShape",value:function(){for(var t=this.sensor.get_worldCOM(),e=this.space.shapesInCircle(t,this.sensor.get_radius(),!1),i=null,o=0;o<e.get_length();o++){var n=e.at(o);if(n instanceof P){i=n;break}}if(i&&i.get_body().userData.view){var s=i.get_body().userData.view;if(s.fieldWidth){var a=this.sensor.get_worldCOM();if(Math.abs(a.get_x()-s.body.get_position().get_x())>s.fieldWidth())return null}}return i}},{key:"backgroundColorChange",value:function(t){this.colorli="#"===t.charAt(0)?"0x"+t.slice(1):t,this.prevH--}},{key:"update",value:function(){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.prevH!=this.liquidH){var t=this.getCurtMl();if(this.liquid.clear(),this.liquid.beginFill(this.colorli,this.curliquidDat.alpha),t>.15){this.liquid.drawRect(-this.fullW/2,this.boty,this.fullW,-(this.boty-90+(t-.15)*((this.fullH-this.boty+90)/(this.totalRange-.15))))}else{this.liquid.drawRect(-this.fullW/2,this.boty,this.fullW,-(t*((this.boty-90)/.15)))}this.liquid.endFill(),this.prevH=this.liquidH}}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.liquidH=this.liquidH,t.density=this.curliquidDat.density,t.alpha=this.curliquidDat.alpha,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.liquidH!=this.liquidH&&(this.liquidH=t.liquidH,this.curliquidDat.density=t.density,this.curliquidDat.alpha=t.alpha)}},{key:"removed",value:function(){this.removedCursor(this.jiao),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function _(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:_(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(572),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0,v=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.NbBody,g=y.phys.BodyType,b=y.shape.Polygon,v=y.geom.Vec2,i.bailong=400,i.ballmass=10,i.dangShape=null,i.disJoint=null,i.pball=null,i.top_y=11,i.line=null,i.dangW=134,i.bottomLine=null,i.jmodel=0,i.dangNoMove=!1,i.danBody=null,i.dangJoint=null,i.k=1.395,i.bailongtxt=0,i}return a(e,t),r(e,[{key:"init",value:function(){this._width=300,this._height=200,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_type(g.get_KINEMATIC()),this.createDragShape(),this.resetUserView(this.bg,this,!0),this.initBtn(),this.initBall(),this.resetJoint(),this.refreshTxt(),this.initDangBan(),this.initBottomLine(),this.line=new PIXI.Graphics,this.bg.addChildAt(this.line,0),this.addCursor(this.bg.stopBtn,"hand"),this.addCursor(this.ball,"zuoyou"),this.changeBaiLong({showValue:"400cm"})}},{key:"removed",value:function(){this.removedCursor(this.bg.stopBtn),this.removedCursor(this.ball),this.BodyUtil.destoryBody(this.danBody),this.pball.removed(),l.M.removeTouch(this.bg.dang,this.dangTouchid),l.M.removeTouch(this.bottomLine,this.blineTouchid),this.ball.removeAllListeners(),this.bg.stopBtn.dispose(),this.bg.stopBtn=null,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"initBottomLine",value:function(){function t(t){o=this.getMouseXY(t),this.body.userData.noDrag=!0}function e(t){var e=this.getMouseXY(t);this.bottomLine.y+=e.y-o.y,o=e,40>this.bottomLine.y&&(this.bottomLine.y=40)}function i(t){this.body.userData.noDrag=!1}this.bottomLine=new PIXI.Graphics,this.bg.addChildAt(this.bottomLine,0),this.bottomLine.y=2*this.bailong/3,this.bottomLine.beginFill(16711680,0),this.bottomLine.drawRect(-430,-25,860,50),this.bottomLine.endFill(),this.bottomLine.lineStyle(2,16750848),l.M.drawDashed(this.bottomLine,new l.Point(-430,0),new l.Point(430,0),10,5),this.blineTouchid=l.M.addTouch(this.bottomLine,{begin:t,move:e,end:i},this);var o=void 0}},{key:"refreshTxt",value:function(){this.bg.aTxt.text=this.language.getLocaleStr("mass")+":"+this.ballmass+"g",this.bg.bTxt.text=this.language.getLocaleStr("pendulum_len")+":"+this.bailongtxt+"cm"}},{key:"initDangBan",value:function(){function t(t){this.dangNoMove||(this.body.userData.noDrag=!0,o=this.getMouseXY(t))}function e(t){if(!this.dangNoMove){var e=this.getMouseXY(t);this.bg.dang.x+=e.x-o.x,this.bg.dang.y+=e.y-o.y,o=e,this.dangW>this.bg.dang.x&&(this.bg.dang.x=this.dangW),40>this.bg.dang.y&&(this.bg.dang.y=40),this.dangShape.set_localCOM(v.get(this.bg.dang.x,this.bg.dang.y)),this.danBody.set_position(this.body.localPointToWorld(this.dangShape.get_localCOM())),this.dangJoint.anchor1=this.body.worldPointToLocal(this.danBody.position)}}function i(t){this.dangNoMove||(this.body.userData.noDrag=!1)}this.dangShape=new b(b.box(2*this.dangW,30)),this.body.add(this.dangShape),this.dangShape.set_localCOM(v.get(this.bg.dang.x,this.bg.dang.y)),this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.danBody=new f,this.danBody.add(new b(b.box(2*this.dangW,28))),this.addBodyToSpace(this.danBody),this.BodyUtil.setBodyMaterial(this.danBody,{elasticity:1}),this.danBody.set_position(this.body.localPointToWorld(this.dangShape.get_localCOM())),this.dangJoint=this.JointUtil.createWeldJoint(this.body,this.danBody,this.danBody.position,this.danBody.position),this.BodyUtil.setBodyFilter(this.danBody,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.dangTouchid=l.M.addTouch(this.bg.dang,{begin:t,move:e,end:i},this);var o=void 0}},{key:"resetJoint",value:function(){this.disJoint&&this.BodyUtil.destoryJoint(this.disJoint),this.pball.body.set_rotation(0);var t=this.body.get_position().add(v.get(0,this.top_y)),e=t.add(v.get(0,this.bailong-this.top_y));this.pball.body.set_position(e);var i=this.bailong-this.pball.weldPy(!0)-this.top_y;this.disJoint=this.JointUtil.createDistanceJoint(this.pball.body,this.body,e.sub(v.get(0,this.pball.weldPy(!0))),t,0,i),this.disJoint.ignore=!0,this.disJoint.stiff=!0,this.disJoint.damping=0,this.disJoint.frequency=1e7}},{key:"initBall",value:function(){var t=this;this.pball=new p["default"](this.paramObj),this.pball.init(),this.pball.resetUserView(this.ball,this),this.pball.body.set_position(v.get(this.x+this.ball.x,this.y+this.ball.y)),this.pball.body.set_allowRotation(!1),this.pball.body.set_mass(this.ballmass),this.ball.addEventListener(p["default"].BALL_START,function(e){t.disJoint.stiff=!1,t.BodyUtil.frezzBody(t.pball.body)})}},{key:"initBtn",value:function(){this.bg.stopBtn.fontColor="#ffffff",this.bg.stopBtn.text=this.language.getLocaleStr("stopIt"),this.bg.stopBtn["this"]=this,this.bg.stopBtn.tab=this.stopTabFun}},{key:"stopTabFun",value:function(t){this.resetJoint(),this.BodyUtil.frezzBody(this.pball.body),this.pball.body.posx=this.body.posx,this.pball.body.posy=this.body.posy+this.bailong,this.pball.body.rotation=0,this.dangNoMove=!1}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this);var t=this.getMain(),i=this.pball.weldPy();if(0==this.jmodel){this.pball.body.set_rotation(-(.5*Math.PI-Math.atan2(i.get_y()-this.body.posy+this.top_y,i.get_x()-this.body.posx)))}else{var o=this.x+this.bg.x+this.bg.dang.x-this.dangW,n=this.y+this.bg.y+this.bg.dang.y;this.pball.body.set_rotation(-(.5*Math.PI-Math.atan2(i.get_y()-n,i.get_x()-o)))}var s=this.line.toLocal(l.Point.vec2ToPoint(this.pball.weldPy()),t.view);if(this.line.clear(),this.line.lineStyle(3,12829635),this.line.moveTo(0,this.top_y),this.bailong>this.bg.dang.y){var a=this.bg.toLocal(new l.Point(this.pball.body.posx,this.pball.body.posy),t.view),r=v.get(this.bg.dang.x-this.dangW,this.bg.dang.y);if(l.M.checkPointOnLineLeftOrRight(l.Point.vec2ToPoint(r),new l.Point(0,this.top_y),l.Point.vec2ToPoint(this.body.worldPointToLocal(this.pball.weldPy())))>0&&a.y>this.bg.dang.y){this.dangNoMove=!0;var u=this.body.worldPointToLocal(this.pball.weldPy());if(0==this.jmodel){this.jmodel=1;var c=this.x+this.bg.x+this.bg.dang.x-this.dangW,d=this.y+this.bg.y+this.bg.dang.y;this.pball.body.rotation=-(.5*Math.PI-Math.atan2(i.get_y()-d,i.get_x()-c));var p=l.M.vec2Length(u.sub(r));this.disJoint.anchor2=v.get(this.bg.dang.x-this.dangW,this.bg.dang.y),this.disJoint.jointMax=p}this.line.lineTo(r.get_x(),r.get_y())}else if(this.dangNoMove=!1,1==this.jmodel){this.jmodel=0;var y=-(.5*Math.PI-Math.atan2(i.get_y()-this.body.posy+this.top_y,i.get_x()-this.body.posx));this.pball.body.rotation=y;var f=this.bailong-this.pball.weldPy(!0)-this.top_y;this.disJoint.anchor2=v.get(0,this.top_y),this.disJoint.jointMax=f}}this.line.lineTo(s.x,s.y),this.jsvelocity()}},{key:"jsvelocity",value:function(){}},{key:"createDragShape",value:function(){var t=this.body.shapes.at(0);t.set_localCOM(v.get(0,-80)),t.set_sensorEnabled(!0);var e=new PIXI.Graphics;e.beginFill(0,0),e.drawRect(-150,-110,300,220),e.endFill(),this.bg.addChildAt(e,0),e.y=-80}},{key:"changBallMass",value:function(t){var e=l.M.getNumStr(t.showValue);this.pball.body.mass=e-0,this.ballmass=e-0,this.refreshTxt(),this.stopTabFun(null)}},{key:"changeBaiLong",value:function(t){var e=l.M.getNumStr(t.showValue);this.bailongtxt=e-0,this.bailong=e*this.k,this.refreshTxt(),this.resetJoint(),this.stopTabFun(null)}},{key:"getBailong",value:function(){return l.M.getNumJie(this.bailong/this.k,0)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.mass=this.ballmass+"g",t.bai=this.getBailong()+"cm",t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.changBallMass({showValue:t.mass}),this.changeBaiLong({showValue:t.bai})}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getDropMenu(this.language.getLocaleStr("mass"),!0,"g",this.ballmass+"g",["5g","10g","15g"],this,this.changBallMass,15,1),this.ComponentProperty.getDropMenu(this.language.getLocaleStr("pendulum_len"),!0,"cm",this.getBailong()+"cm",["200cm","400cm","600cm","800cm"],this,this.changeBaiLong,800,200)),t}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function k(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:k(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(451),p=o(d),y=i(449),f=o(y),g=i(542),b=o(g),v=void 0,_=void 0,m=void 0,x=void 0,w=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return v=i.phy.nape,_=v.shape.HockShapeBase,m=v.shape.Polygon,x=v.shape.Circle,w=v.geom.Vec2,i.iscomponent=!0,i.handL=null,i.handR=null,i.hookL=null,i.hookR=null,i.hook01=null,i.hook02=null,i.pulley=null,i.turntable=null,i.pulleyMec=null,i.hookShape01=null,i.hookShape02=null,i.hookLMec=null,i.hookRMec=null,i.handLMec=null,i.handRMec=null,i.lineGra=null,i.R0=46,i.R1=46,i.R2=12,i.R3=12,i.lineLen=600,i.isLightPulley=!0,i.pulleyMass=10,i.equlock=!1,i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.turntable=this.pulley.turntable,this.hook01=this.pulley.hook01,this.hook02=this.pulley.hook02,this.hookL.visible=!1,this.hookR.visible=!1,this.hook01.visible=!1,this.hook02.visible=!1,this.lineGra=new PIXI.Graphics,this.addChildAt(this.lineGra,0),this.body.noallowRotation=!0,this.body.userData.cannotToolRot=!0,this.body.userData.dragLevel=-2,this.BodyUtil.setBodyFilter(this.body,b["default"].MEC_COMPONENT_FILTER),this.pulleyMec=new p["default"](this.paramObj),this.initCircle(this.pulleyMec,this.pulley,this.R0);var i=new m(m.rect(-8,-60,16,120));this.pulleyMec.body.add(i),i.set_sensorEnabled(!0),this.JointUtil.createPivotJoint(this.body,this.pulleyMec.body,this.body.position,this.body.position),this.hookShape01=this.initHookShape(this.pulleyMec,this.hook01,this.R2,w.get(0,-20),this.CbTypeStr.FIXED_PULLEY_UP_HOCK),this.hookShape02=this.initHookShape(this.pulleyMec,this.hook02,this.R2,w.get(0,20),this.CbTypeStr.FIXED_PULLEY_BOTTOM_HOCK),this.hookLMec=new c["default"](this.paramObj),this.hookLShape=new _(this.R3,null,null),this.hookLShape.registerClass(this.paramObj.moduleMain),this.initHook(this.hookLMec,this.hookLShape,this.hookL,this.CbTypeStr.FIXED_PULLEY_LEFT_HOCK),this.hookLMec.body.add(new x(this.R3)),this.hookLShape.connectCallback=this.connectCallbackL.bind(this),this.hookLShape.breakClickCallback=this.breakClickCallbackL.bind(this),this.addTweenQuan(this.hookLShape),this.handLMec=new c["default"](this.paramObj),this.handLShape=new m(m.rect(-139,-24,148,135)),this.initHandMec(this.handLMec,this.handLShape,this.handL),this.handLMec.changeLock({checked:!0}),this.JointUtil.createPivotJoint(this.handLMec.body,this.hookLMec.body,this.hookLMec.body.position,this.hookLMec.body.position),this.hookRMec=new c["default"](this.paramObj),this.hookRShape=new _(this.R3,null,null),this.hookRShape.registerClass(this.paramObj.moduleMain),this.initHook(this.hookRMec,this.hookRShape,this.hookR,this.CbTypeStr.FIXED_PULLEY_RIGHT_HOCK),this.hookRMec.body.add(new x(this.R3)),this.addTweenQuan(this.hookRShape),this.hookRShape.connectCallback=this.connectCallbackR.bind(this),this.hookRShape.breakClickCallback=this.breakClickCallbackR.bind(this),this.handRMec=new c["default"](this.paramObj),this.handRShape=new m(m.rect(-9,-24,148,135)),this.initHandMec(this.handRMec,this.handRShape,this.handR),this.handRMec.changeLock({checked:!0}),this.JointUtil.createPivotJoint(this.handRMec.body,this.hookRMec.body,this.hookRMec.body.position,this.hookRMec.body.position),this.pulleyJoint=this.createPulleyJoint(this.pulleyMec,this.hookLMec,this.hookRMec,w.get(-this.R1,0),w.get(this.R1,0),0,this.lineLen),this.body.set_gravMass(0),this.pulleyMec.body.set_gravMass(0),this.hookLMec.body.set_gravMass(0),this.handLMec.body.set_gravMass(0),this.hookRMec.body.set_gravMass(0),this.handRMec.body.set_gravMass(0);var o=[this.CbTypeStr.FIXED_PULLEY_UP_HOCK,this.CbTypeStr.FIXED_PULLEY_BOTTOM_HOCK,this.CbTypeStr.FIXED_PULLEY_LEFT_HOCK,this.CbTypeStr.FIXED_PULLEY_RIGHT_HOCK,this.CbTypeStr.HOOKWOOD_HOCK];this.hookShape01.createListener(this.CbTypeStr.FIXED_PULLEY_UP_HOCK,o),this.hookShape02.createListener(this.CbTypeStr.FIXED_PULLEY_BOTTOM_HOCK,o),this.hookLShape.createListener(this.CbTypeStr.FIXED_PULLEY_LEFT_HOCK,o),this.hookRShape.createListener(this.CbTypeStr.FIXED_PULLEY_RIGHT_HOCK,o),this.setPulleyMass(this.pulleyMass),this.pulleyDragBegin=function(){t.equlock&&(t.changeLock({checked:!1}),t.pulleyMec.tmplock=!0)},this.pulleyDragEnd=function(){t.pulleyMec.tmplock&&(t.changeLock({checked:!0}),t.pulleyMec.tmplock=!1)},this.pulleyMec.addEventListener(f["default"].BEGIN,this.pulleyDragBegin),this.pulleyMec.addEventListener(f["default"].END,this.pulleyDragEnd)}},{key:"connectCallbackL",value:function(t,e){return this.hookLShape.get_userData().useing&&(this.handL.visible=!1,this.handLMec.body.remove(this.handLShape),this.handLMec.removeDragManager(),this.handLMec.changeLock({checked:!1}),this.hookL.visible=!0),!1}},{key:"breakClickCallbackL",value:function(t){this.hookLShape.get_userData().useing&&(this.handL.visible=!0,this.handLMec.body.add(this.handLShape),this.handLMec.changeLock({checked:!0}),this.hookL.visible=!1)}},{key:"connectCallbackR",value:function(t,e){return this.hookRShape.get_userData().useing&&(this.handR.visible=!1,this.handRMec.body.remove(this.handRShape),this.handRMec.removeDragManager(),this.handRMec.changeLock({checked:!1}),this.hookR.visible=!0),!1}},{key:"breakClickCallbackR",value:function(t){this.hookRShape.get_userData().useing&&(this.handR.visible=!0,this.handRMec.body.add(this.handRShape),this.handRMec.changeLock({checked:!0}),this.hookR.visible=!1)}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.updateChildMecPosition(this.pulleyMec),this.updateChildMecPosition(this.hookLMec),this.updateChildMecPosition(this.hookRMec),this.updateChildMecPosition(this.handLMec),this.updateChildMecPosition(this.handRMec),this.updateTransform(),this.updatePulleyJoint(),this.updateLine(),this.updateHandAngle(),this.updatePulleyRotation(),this.handL.visible=!this.hookLShape.get_userData().useing,this.handR.visible=!this.hookRShape.get_userData().useing}},{key:"updatePulleyRotation",value:function(){var t=this.p1,e=this.p2,i=this.p3,o=this.p4,n=l.M.getPointLen(t,e),s=l.M.getPointLen(i,o);Math.abs(n+s-this.lineLen),this.pulleyJoint.isSlack()||!this.lenL&&0!==this.lenL||(this.turntable.rotation+=(n-this.lenL)/this.R1),this.lenL=n,this.lenR=s}},{key:"removed",value:function(){this.hookShape01.dragToolClick(),this.hookShape02.dragToolClick(),this.hookLShape.dragToolClick(),this.hookRShape.dragToolClick(),this.hookShape01.dispose(),this.hookShape02.dispose(),this.hookLShape.dispose(),this.hookRShape.dispose(),this.pulleyMec.removed(),this.hookLMec.removed(),this.hookRMec.removed(),this.handLMec.removed(),this.handRMec.removed(),this.pulleyMec.removeEventListener(f["default"].BEGIN,this.pulleyDragBegin),this.pulleyMec.removeEventListener(f["default"].END,this.pulleyDragEnd),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"updatePulleyJoint",value:function(){var t=new l.Point(this.pulleyMec.x,this.pulleyMec.y);this.p2=new l.Point(this.hookLMec.x,this.hookLMec.y),this.p4=new l.Point(this.hookRMec.x,this.hookRMec.y),this.p1=this.getPointOfTangency(t,this.p2,this.R1,-1);var e=this.pulley.toLocal(this.p1,this);this.pulleyJoint.set_anchor1(w.get(e.x,e.y)),this.p3=this.getPointOfTangency(t,this.p4,this.R1,1);var i=this.pulley.toLocal(this.p3,this);this.pulleyJoint.set_anchor3(w.get(i.x,i.y))}},{key:"getPointOfTangency",value:function(t,e,i,o){var n=new l.Point,s=new l.Point(e.x-t.x,e.y-t.y),a=s.length;if(i>=a)return s.normalize(i),n.x=t.x+s.x,n.y=t.y+s.y,n;var r=i*i/a,h=s.clone();h.normalize(r);var u=new l.Point(-h.y,h.x);return u.normalize(Math.sqrt(i*i-r*r)*o),n.x=t.x+h.x+u.x,n.y=t.y+h.y+u.y,n}},{key:"updateLine",value:function(){var t=this.p1,e=this.p2,i=this.p3,o=this.p4;this.lineGra.clear(),this.lineGra.lineStyle(2,16750848,1),this.lineGra.moveTo(t.x,t.y),this.lineGra.lineTo(e.x,e.y),this.lineGra.moveTo(i.x,i.y),this.lineGra.lineTo(o.x,o.y)}},{key:"updateHandAngle",value:function(){var t=this.p1,e=new PIXI.Point(this.hookLMec.x,this.hookLMec.y),i=this.p3,o=new PIXI.Point(this.hookRMec.x,this.hookRMec.y),n=Math.atan2(e.y-t.y,e.x-t.x),s=Math.atan2(o.y-i.y,o.x-i.x);this.handLMec.body.set_rotation(n+Math.PI),this.handRMec.body.set_rotation(s)}},{key:"updateChildMecPosition",value:function(t){t.body.set_angularVel(0),t.x=t.body.posx-this.body.posx,t.y=t.body.posy-this.body.posy,this.BodyUtil.dampingBodyVelocity(t.body,.95,.95)}},{key:"createPulleyJoint",value:function(t,e,i,o,n,s,a){return this.JointUtil.createPulleyJoint(t.body,e.body,t.body,i.body,t.body.get_position().add(o),e.body.get_position(),t.body.get_position().add(n),i.body.get_position(),s,a,1)}},{key:"initHookShape",value:function(t,e,i,o,n){var s=new _(i,null,null);return s.registerClass(this.paramObj.moduleMain),t.body.add(s),s.translate(w.get(e.x,e.y).add(o)),s.addCbtype(n,!0),this.addTweenQuan(s),s}},{key:"initHook",value:function(t,e,i,o){t.x=this.body.posx+i.x,t.y=this.body.posy+i.y,t.init(),t.addChild(i),i.x=0,i.y=0,t.body.shapes.clear(),t.body.add(e),e.addCbtype(o),e.createListener(o,this.CbTypeStr.ALL_HOOK_ARY.concat(this.CbTypeStr.HOOKWOOD_HOCK)),this.addChild(t),t.body.noallowRotation=!0,t.body.userData.cannotToolRot=!0,t.body.userData.dragLevel=-2}},{key:"initHandMec",value:function(t,e,i){t.x=this.body.posx+i.x,t.y=this.body.posy+i.y,t.init(),t.addChild(i),i.x=0,i.y=0,t.body.add(e),this.addChild(t),t.body.userData.dragLevel=-2,t.body.shapes.foreach(function(t){t.set_sensorEnabled(!0)})}},{key:"initCircle",value:function(t,e,i){t.x=this.body.posx+e.x,t.y=this.body.posy+e.y,t.init(),t.body.shapes.clear(),t.addChild(e),e.x=0,e.y=0,t.body.add(new x(i)),this.addChild(t),this.BodyUtil.setBodyFilter(t.body,b["default"].MEC_COMPONENT_FILTER)}},{key:"selectRenderChild",value:function(){return this.updateTransform(),this.pulley.getBounds()}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.pulleyData=this.pulleyMec.getData(),t.hookLData=this.hookLMec.getData(),t.hookRData=this.hookRMec.getData(),t.handLData=this.handLMec.getData(),t.handRData=this.handRMec.getData(),t.pulleyMass=this.pulleyMass,t.lineLen=this.lineLen,t.equlock=this.equlock,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.pulleyMec.setData(t.pulleyData),this.hookLMec.setData(t.hookLData),this.hookRMec.setData(t.hookRData),this.handLMec.setData(t.handLData),this.handRMec.setData(t.handRData),this.pulleyMass=t.pulleyMass,this.setPulleyMass(this.pulleyMass),this.lineLen=t.lineLen,this.changLineLen({showValue:t.lineLen}),this.equlock=t.equlock,this.changeLock({checked:t.equlock})}},{key:"changeIsLightPulley",value:function(t){this.isLightPulley=t.checked,this.isLightPulley?this.pulleyMec.body.set_gravMass(0):this.pulleyMec.body.set_gravMassMode((void 0).get_DEFAULT())}},{key:"setPulleyMass",value:function(t){this.pulleyMec.body.set_gravMass(t)}},{key:"changePulleyMass",value:function(t){this.pulleyMass=t.showValue,this.setPulleyMass(this.pulleyMass)}},{key:"changLineLen",value:function(t){this.lineLen=t.showValue,this.pulleyJoint.set_jointMax(this.lineLen)}},{key:"menuRotaChange",value:function(t){var e=t.value;e+=90,e=e*Math.PI/180,e*=-1,this.pulleyMec.body.rotation=e}},{key:"getConf",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this),i=this,o=180*this.pulleyMec.body.get_rotation()/Math.PI;o*=-1,o-=90,0>o&&(o+=360),o=Math.round(o);var n={type:this.ComponentProperty.ANGLE,name:this.getLocaleStr("angle"),"this":i,value:o,callBack:i.menuRotaChange};return t.confArr.push(this.getScrollBar([this.getLocaleStr("pulley_mass","滑轮质量"),!0,"g",100,0,this.pulleyMass,1,this.changePulleyMass,this]),this.getScrollBar([this.getLocaleStr("rope_length","绳长"),!0,"cm",2e3,300,this.lineLen,10,this.changLineLen,this]),this.getSwitch([this.getLocaleStr("lock","锁定"),this.equlock,this.changeLock,this]),n),t}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function _(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:_(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(451),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0,v=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.phys.BodyType,g=y.shape.Circle,b=y.geom.Vec2,v=y.shape.HockShapeBase,i.level=14,i.pulleyL=null,i.pulleyR=null,i.iconRingC=null,i.iconRingT=null,i.hookL=null,i.hookR=null,i.hookT=null,i.pulleyLShape=null,i.pulleyRShape=null,i.ringTopShape=null,i.iconRingCMec=null,i.hookLMec=null,i.hookLShape=null,i.hookRMec=null,i.hookRShape=null,i.lineGra=null,i.lineGra2=null,i.pulleyJointL=null,i.pulleyJointR=null,i.vR2=0,i.vL2=0,i.R1=328,i.R2=40,i.R3=38,i.R4=20,i.R5=30,i.R6=20,i.islock=!1,i.halfCircle=!1,i.verticesArr=i.Vec2Util.pointArrArrToVec2ArrArr([[{x:16.05,y:323.85},{x:-15.95,y:323.85},{x:-15.95,y:791.7},{x:16.05,y:791.7}],[{x:-25,y:828.95},{x:25,y:828.95},{x:25,y:790.95},{x:-25,y:790.95}],[{x:-38,y:852.95},{x:39,y:852.95},{x:39,y:828.95},{x:-38,y:828.95}],[{x:37,y:852.95},{x:-38,y:852.95},{x:-158.95,y:922.9},{x:153,y:922.9}],[{x:-199.9,y:958.4},{x:195.1,y:958.4},{x:195.1,y:922.65},{x:-199.9,y:922.65}]]),i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.lineGra=new PIXI.Graphics,this.addChildAt(this.lineGra,1),this.lineGra2=new PIXI.Graphics,this.addChild(this.lineGra2),this.pulleyL.scale.x=this.pulleyL.scale.y=this.pulleyR.scale.x=this.pulleyR.scale.y=this.R2/56,this.hookL.visible=this.hookR.visible=!1,this.iconRingT.scale.x=this.iconRingT.scale.y=this.R6/38;var i=new g(this.R1);this.body.add(i),i.set_sensorEnabled(!0);var o=this.body.get_shapes();o.at(o.get_length()-1).set_sensorEnabled(!0),this.body.set_isBullet(!0),this.body.noallowRotation=!0,this.body.userData.cannotToolRot=!0,this.body.userData.dragLevel=-2,this.changeLock({checked:!0}),this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.pulleyR.x=this.R1*Math.cos(50*Math.PI/180),this.pulleyR.y=this.R1*Math.sin(50*Math.PI/180),this.pulleyL.x=this.R1*Math.cos(130*Math.PI/180),this.pulleyL.y=this.R1*Math.sin(130*Math.PI/180);var n=this.body.get_position();this.pulleyLShape=new g(this.R2,b.get(this.pulleyL.x,this.pulleyL.y)),this.body.add(this.pulleyLShape),this.pulleyRShape=new g(this.R2,b.get(this.pulleyR.x,this.pulleyR.y)),this.body.add(this.pulleyRShape),this.iconRingCMec=new p["default"](this.paramObj),this.initCircle(this.iconRingCMec,this.iconRingC,this.R3),this.ringTopShape=new g(this.R6,b.get(this.iconRingT.x,this.iconRingT.y)),this.iconRingCMec.body.add(this.ringTopShape),this.JointUtil.createDistanceJoint(this.iconRingCMec.body,this.body,n,n,0,24),this.iconRingCMec.body.set_gravMass(0),this.iconRingCMec.body.allowRotation=!1,this.iconRingCMec.body.userData.cannotToolRot=!0,this.hockT=new v(this.R6,null,null),this.hockT.registerClass(this.paramObj.moduleMain),this.iconRingCMec.body.add(this.hockT),this.hockT.translate(b.get(0,this.iconRingT.y)),this.hockT.connectPoint=b.get(0,-this.R6),this.hockT.addCbtype(this.CbTypeStr.HOOK_BOTTOM_GOU,!0),this.addTweenQuan(this.hockT),this.hookLMec=new p["default"](this.paramObj),this.hookLShape=new v(this.R4,null,null),this.hookLShape.registerClass(this.paramObj.moduleMain),this.initHook(this.hookLMec,this.hookLShape,this.hookL,this.R4),this.addTweenQuan(this.hookLShape);var s=b.get(this.body.posx+this.pulleyL.x-this.R5,this.body.posy+this.pulleyL.y);this.vL2=this.getTangentPoint(0,0,this.pulleyL.x,this.pulleyL.y,this.R5,1),this.vL1=s,this.pulleyJointL=this.JointUtil.createPulleyJoint(this.body,this.hookLMec.body,this.body,this.iconRingCMec.body,s,this.hookLMec.body.get_position(),this.vL2.add(n),this.iconRingCMec.body.get_position(),10,this.R1+200,1),this.hookRMec=new p["default"](this.paramObj),this.hookRShape=new v(this.R4,null,null),this.hookRShape.registerClass(this.paramObj.moduleMain),this.initHook(this.hookRMec,this.hookRShape,this.hookR,this.R4),this.addTweenQuan(this.hookRShape);var a=b.get(this.body.posx+this.pulleyR.x+this.R5,this.body.posy+this.pulleyR.y);this.vR2=this.getTangentPoint(0,0,this.pulleyR.x,this.pulleyR.y,this.R5,-1),this.vR1=a,this.pulleyJointR=this.JointUtil.createPulleyJoint(this.body,this.hookRMec.body,this.body,this.iconRingCMec.body,a,this.hookRMec.body.get_position(),this.vR2.add(n),this.iconRingCMec.body.get_position(),10,this.R1+200,1),this.getMScale=function(){return t.getMain().view.scale},this.pulleyLDragId=l.M.addDrag(this.pulleyL,null,{begin:this.pulleyBegin,move:this.pulleyLMove,end:this.pulleyEnd},this),this.pulleyL.getMScale=this.getMScale,this.addCursor(this.pulleyL,"hand"),this.pulleyRDragId=l.M.addDrag(this.pulleyR,null,{begin:this.pulleyBegin,move:this.pulleyRMove,end:this.pulleyEnd},this),this.pulleyR.getMScale=this.getMScale,this.addCursor(this.pulleyR,"hand"),this.update(),this.pulleyRMove(null),this.pulleyLMove(null)}},{key:"removed",value:function(){this.removedCursor(this.pulleyL),this.removedCursor(this.pulleyR),l.M.removeDrag(this.pulleyL,this.pulleyLDragId),l.M.removeDrag(this.pulleyR,this.pulleyRDragId),this.pulleyL.getMScale=null,this.pulleyR.getMScale=null,this.iconRingCMec.removeBodyFromSpace(this.iconRingCMec.body),this.hookRMec.removeBodyFromSpace(this.hookRMec.body),this.hookLMec.removeBodyFromSpace(this.hookLMec.body),this.hockT.dragToolClick(),this.hookLShape.dragToolClick(),this.hookRShape.dragToolClick(),this.hockT.dispose(),this.hookLShape.dispose(),this.hookRShape.dispose(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"pulleyBegin",value:function(t){this.touchEnabled=!1}},{key:"pulleyEnd",value:function(t){this.touchEnabled=!0}},{key:"pulleyRMove",value:function(t){var e=Math.atan2(this.pulleyR.y,this.pulleyR.x);if(this.halfCircle){var i=-Math.PI/2*(16.5/18),o=-i;0>e&&i>e?e=i:e>0&&e>o&&(e=o)}this.pulleyR.x=Math.cos(e)*this.R1,this.pulleyR.y=Math.sin(e)*this.R1,this.pulleyRShape.set_localCOM(b.get(this.pulleyR.x,this.pulleyR.y));var n=this.formatAngle(e-Math.PI/2)<Math.PI?1:-1;this.vR2=this.getTangentPoint(this.iconRingCMec.x,this.iconRingCMec.y,this.pulleyR.x,this.pulleyR.y,this.R5,n),this.vR1=n>0?b.get(this.pulleyR.x-this.R5,this.pulleyR.y):b.get(this.pulleyR.x+this.R5,this.pulleyR.y),this.pulleyJointR.set_anchor1(this.vR1),this.pulleyJointR.set_anchor3(this.vR2)}},{key:"pulleyLMove",value:function(t){var e=Math.atan2(this.pulleyL.y,this.pulleyL.x);if(this.halfCircle){var i=-Math.PI/2*(19.5/18),o=-i;0>e&&e>i?e=i:e>0&&o>e&&(e=o)}this.pulleyL.x=Math.cos(e)*this.R1,this.pulleyL.y=Math.sin(e)*this.R1,this.pulleyLShape.set_localCOM(b.get(this.pulleyL.x,this.pulleyL.y));var n=this.formatAngle(e-Math.PI/2)<Math.PI?1:-1;this.vL2=this.getTangentPoint(this.iconRingCMec.x,this.iconRingCMec.y,this.pulleyL.x,this.pulleyL.y,this.R5,n),this.vL1=n>0?b.get(this.pulleyL.x-this.R5,this.pulleyL.y):b.get(this.pulleyL.x+this.R5,this.pulleyL.y),this.pulleyJointL.set_anchor1(this.vL1),this.pulleyJointL.set_anchor3(this.vL2)}},{key:"formatAngle",value:function(t){return t%=2*Math.PI,0>t&&(t+=2*Math.PI),t}},{key:"getTangentPoint",value:function(t,e,i,o,n,s){var a=o-e,r=i-t,h=Math.atan2(a,r),l=Math.sqrt(a*a+r*r),u=Math.asin(n/l),c=h+(s>0?1:-1)*u;return b.get(t+l*Math.cos(c),e+l*Math.sin(c))}},{key:"initHook",value:function(t,e,i,o){t.x=this.body.posx+i.x,t.y=this.body.posy+i.y,t.init(),t.addChild(i),i.x=i.y=0,t.body.shapes.clear(),t.body.add(e),e.addCbtype(this.CbTypeStr.HOOK_BOTTOM_GOU,!0),this.addChild(t),t.body.noallowRotation=!0,t.body.userData.cannotToolRot=!0,t.body.userData.dragLevel=-2}},{key:"initCircle",value:function(t,e,i){t.x=this.body.posx+e.x,t.y=this.body.posy+e.y,t.init(),t.addChild(e),e.x=e.y=0,t.body.add(new g(i)),this.addChild(t),this.BodyUtil.setBodyFilter(t.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER)}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.updateChildMecPosition(this.iconRingCMec),this.updateChildMecPosition(this.hookLMec),this.updateChildMecPosition(this.hookRMec);var t=this.ringTopShape.get_worldCOM();this.iconRingT.x=t.get_x()-this.body.posx,this.iconRingT.y=t.get_y()-this.body.posy,this.hookLMec.body.set_gravMass(this.hookLShape.get_userData().useing?0:1),this.hookRMec.body.set_gravMass(this.hookRShape.get_userData().useing?0:1),this.updateLines()}},{key:"updateChildMecPosition",value:function(t){t.body.set_angularVel(0),t.x=t.body.posx-this.body.posx,t.y=t.body.posy-this.body.posy,this.BodyUtil.dampingBodyVelocity(t.body,.9,.9)}},{key:"updateLines",value:function(){this.lineGra.clear(),this.lineGra.lineStyle(2,16750848,1),this.lineGra.moveTo(this.vL1.get_x(),this.vL1.get_y()),this.lineGra.lineTo(this.hookLMec.x,this.hookLMec.y);var t=this.vL2.unit();t.muleq(this.R3),this.lineGra.moveTo(this.vL2.get_x(),this.vL2.get_y()),this.lineGra.lineTo(this.iconRingCMec.x+t.get_x(),this.iconRingCMec.y+t.get_y()),this.lineGra.moveTo(this.vR1.get_x(),this.vR1.get_y()),this.lineGra.lineTo(this.hookRMec.x,this.hookRMec.y);var e=this.vR2.unit();e.muleq(this.R3),this.lineGra.moveTo(this.vR2.get_x(),this.vR2.get_y()),this.lineGra.lineTo(this.iconRingCMec.x+e.get_x(),this.iconRingCMec.y+e.get_y()),this.lineGra2.clear(),this.lineGra2.lineStyle(2,16750848,1);var i=b.get(0,-this.R3).rotate(this.iconRingCMec.body.get_rotation()),o=i.mul(-this.R6/this.R3);this.lineGra2.moveTo(this.iconRingT.x+o.get_x(),this.iconRingT.y+o.get_y()),this.lineGra2.lineTo(this.iconRingCMec.x+i.get_x(),this.iconRingCMec.y+i.get_y())}},{key:"changeLock",value:function(t){this.islock=t.checked,this.islock?(this.body.set_type(f.get_KINEMATIC()),this.BodyUtil.frezzBody(this.body)):(this.body.set_type(f.get_DYNAMIC()),this.body.set_allowRotation(!1))}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.pR={x:this.pulleyR.x,y:this.pulleyR.y},t.pL={x:this.pulleyL.x,y:this.pulleyL.y},t.pC={x:this.iconRingCMec.body.posx,y:this.iconRingCMec.body.posy},t.pHL={x:this.hookLMec.body.posx,y:this.hookLMec.body.posy},t.pHR={x:this.hookRMec.body.posx,y:this.hookRMec.body.posy},t.cRot=this.iconRingCMec.body.get_rotation(),t}},{key:"setData",value:function(t){var i=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.iconRingCMec.body.posx=t.pC.x,this.iconRingCMec.body.posy=t.pC.y,this.iconRingCMec.body.set_rotation(t.cRot),this.hookLMec.body.posx=t.pHL.x,this.hookLMec.body.posy=t.pHL.y,this.hookRMec.body.posx=t.pHR.x,this.hookRMec.body.posy=t.pHR.y,this.pulleyR.x=t.pR.x,this.pulleyR.y=t.pR.y,this.pulleyL.x=t.pL.x,this.pulleyL.y=t.pL.y,setTimeout(function(){i.hadDestory||(i.pulleyRMove(null),i.pulleyLMove(null))},1)}},{key:"getConf",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push(this.ComponentProperty.getSwitch(this.language.getLocaleStr("lock"),this.islock,this.changeLock,this)),t}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function g(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:g(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(226),c=o(u),d=i(1066),p=o(d),y=i(1067),f=o(y);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));i.bg1=null,i.bg2=null,i.letterMc=null,i.letterMc2=null,i.isSideView=!1,i.pAry=[[145,17.75],[250,25.75],[355,28.75],[460,25.75],[565,18.75]],i.lenAry=[177,307,400,307,265],i.mArr=[1,1,1,2,1],i.omegaArr=[0,0,0,0,0];for(var o=0;5>o;o++)i.omegaArr[o]=Math.sqrt(100*9.8/i.lenAry[o]);return i.vectorBall=[],i.balltouchidArr=[],i.offAry=[0,0,0,0,0],i.allLine=new PIXI.Graphics,i.isStart=!1,i.baiIndex=0,i.MaxDragLen=600,i.speed=.03,i.trueMaxlen=0,i.ang=0,i.wave=null,i.time=null,i.isTime=!1,i.heng=0,i.xyAng=.45,i}return a(e,t),r(e,[{key:"added",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.addChild(this.allLine),this.removeChild(this.skin),this.wave=new f["default"](this.paramObj),this.addChildAt(this.wave,0),this.wave.visible=!1,this.initBtn(),this.createBall(),this.drawAllLine(),this.letterMc2.visible=this.bg2.visible=!1,this.bg=this.bg1,this.wave.x=850,this.wave.y=265}},{key:"removed",value:function(){for(var t=0;this.vectorBall.length>t;t++){var i=this.vectorBall[t];l.M.removeTouch(i,i.touchId),this.removedCursor(i),i.removed()}this.wave.removed(),this.removedCursor(this.waveBtn),this.removedCursor(this.stopBtn),this.waveBtn.destroy(),this.stopBtn.destroy(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"initBtn",value:function(){var t=this;this.waveBtn.fontColor="#ffffff",this.waveBtn.text=this.language.getLocaleStr("image"),this.stopBtn.fontColor="#ffffff",this.stopBtn.text=this.language.getLocaleStr("stopIt"),this.addCursor(this.waveBtn,"hand"),this.addCursor(this.stopBtn,"hand"),this.stopBtn.tab=function(){t.reset()},this.waveBtn.tab=function(){t.wave.visible=!t.wave.visible}}},{key:"reset",value:function(){this.isStart=!1,this.isTime=!1,this.ang=0,this.trueMaxlen=0,this.offAry=[0,0,0,0,0];for(var t=0;this.vectorBall.length>t;t++){var e=this.vectorBall[t];e.orignX=this.isSideView?357:this.pAry[t][0],e.reset()}this.drawAllLine()}},{key:"createBall",value:function(){for(var t=PIXI.Texture,e=4;e>=0;e--){var i=void 0;if(3==e){var o=new PIXI.Sprite(t.fromFrame("ForcedVibration/bigball"));i=new p["default"](this.paramObj,o),i.isBig=!0}else{var n=new PIXI.Sprite(t.fromFrame("ForcedVibration/smallball"));i=new p["default"](this.paramObj,n)}i.touchId=this.ballTouch(i),i.mass=this.mArr[e],i.len=this.lenAry[e],i.index=e,i.x=this.pAry[e][0],i.y=this.pAry[e][1]+this.lenAry[e],i.orignX=i.x,i.orignY=i.y,i.orignTopY=this.pAry[e][1],i.angle=Math.PI/2,this.addChild(i),this.addCursor(i,"tuozhuai"),this.vectorBall[e]=i}}},{key:"ballTouch",value:function(t){var e=this;return l.M.addTouch(t,{begin:function(i){e.isStart||(e.baiIndex=t.index,e.cannotSystemDrag=!0,e.ballTouchP=e.getMouseXY(i))},move:function(t){if(!e.isStart){var i=e.vectorBall[e.baiIndex],o=e.getMouseXY(t);o=e.toLocal(o,e.getMain().view);var n=new PIXI.Point(i.orignX,i.orignTopY),s=Math.atan2(o.y-n.y,o.x-n.x);s<Math.PI/4?s=Math.PI/4:s>Math.PI-Math.PI/4&&(s=Math.PI-Math.PI/4),i.angle=s,e.ballMove(i),e.drawAllLine()}},end:function(t){if(!e.isStart){e.isStart=!0;var i=e.vectorBall[e.baiIndex];e.trueMaxlen=i.maxOff=i.angle-Math.PI/2,e.heng=.5*e.trueMaxlen,e.updateForcedAmplitude(),e.speed=e.omegaArr[e.baiIndex],e.wave.reset(),e.cannotSystemDrag=!1}}})}},{key:"updateForcedAmplitude",value:function(){for(var t=this.mArr[this.baiIndex],e=this.omegaArr[this.baiIndex],i=0;this.offAry.length>i;i++)if(i!==this.baiIndex){var o=this.vectorBall[i],n=this.mArr[i];o.lenCha=Math.PI/2;var s=this.omegaArr[i],a=s*s-e*e;o.maxOff=Math.sqrt(t/n)*(2*this.trueMaxlen*.01*e)/Math.sqrt(a*a+4e-4*e*e)}}},{key:"drawAllLine",value:function(){var t=this.getMain();this.allLine.clear(),this.allLine.lineStyle(3,16777215,.7);for(var e=0;this.pAry.length>e;e++){var i=new PIXI.Point(this.pAry[e][0],this.pAry[e][1]),o=this.vectorBall[e].centerP,n=this.allLine.toLocal(o,t.view);this.isSideView&&(i.x=357),this.allLine.moveTo(i.x,i.y),this.allLine.lineTo(n.x,n.y)}}},{key:"update",value:function(){if(this.wave.visible||(this.wave.x=850,this.wave.y=265),this.isStart){this.isTime||(this.time=this.getCurrentTime(),this.isTime=!0);var t=this.getCurrentTime();this.ang=this.speed*(t-this.time)/1e3,Math.abs(this.trueMaxlen)>Math.abs(this.heng)&&(this.trueMaxlen>0?this.trueMaxlen-=2e-4:this.trueMaxlen+=2e-4,this.updateForcedAmplitude());for(var e=0;this.vectorBall.length>e;e++){var i=this.vectorBall[e];e===this.baiIndex?i.angle=this.trueMaxlen*Math.cos(this.ang)+Math.PI/2:(i.maxOff>0?(i.offX+=28e-5)>i.maxOff&&(i.offX=i.maxOff):(i.offX-=28e-5,i.maxOff>i.offX&&(i.offX=i.maxOff)),i.angle=i.offX*Math.cos(this.ang-i.lenCha)+Math.PI/2),this.ballMove(i),this.wave.draw(e,t-this.time,180*i.angle/Math.PI-90)}this.drawAllLine()}}},{key:"ballMove",value:function(t){var e=t.angle,i=new PIXI.Point(t.orignX,t.orignTopY);if(this.isSideView)t.x=i.x+t.len*Math.cos(e),t.y=i.y+t.len*Math.sin(e),t.rotation=e-Math.PI/2,t.scale.x=t.scale.y=1;else{t.x=i.x+-20*Math.cos(e),t.y=i.y+t.len*Math.sin(e);var o=t.x-i.x,n=t.x-i.y;t.rotation=Math.atan2(n,o)-Math.PI/2;t.scale.x=t.scale.y=1+.3*Math.cos(e)}}},{key:"changeSideView",value:function(t){this.isSideView=t.checked,this.letterMc.visible=this.bg1.visible=!this.isSideView,this.letterMc2.visible=this.bg2.visible=this.isSideView,this.reset(),this.bg=this.isSideView?this.bg2:this.bg1}},{key:"getConf",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push(this.ComponentProperty.getSwitch(this.language.getLocaleStr("lateral_view"),this.isSideView,this.changeSideView,this)),t}},{key:"selectRenderChild",value:function(){return this.updateTransform(),this.bg.getBounds()}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function u(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:u(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(226),l=function(t){return t&&t.__esModule?t:{"default":t}}(h);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.canRotate=!1,i.daoBtn=null,i.chouBtn=null,i.start_Y=0,i.end_Y=0,i.b_s=0,i.k_s=0,i.h_s=0,i.a_b=.2,i.a_k=.7,i.a_h=.5,i.isJk=!1,i.dir=1,i.isXq=!1,i.b_c=!1,i.k_c=!1,i.h_c=!1,i}return s(e,t),a(e,[{key:"added",value:function(){function t(t,e){var o=PIXI.Sprite.fromFrame("FreeFallMotion/btnup"),n=PIXI.Sprite.fromFrame("FreeFallMotion/btndown"),s=PIXI.Sprite.fromFrame("FreeFallMotion/btnup");return new i.Button({text:t,tab:e,fontColor:16777215,fontSize:30,disabledSkin:o,downSkin:n,upSkin:s})}r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.componentBox.visible=!1,this.bg.qi.visible=!1;var i=this;this.daoBtn=t(this.language.getLocaleStr("inversion"),this.daoBtnClick),this.addChild(this.daoBtn),this.daoBtn.x=this.dao.x,this.daoBtn.y=this.dao.y,this.removeChild(this.dao),this.chouBtn=t(this.language.getLocaleStr("pumping"),this.chouBtnClick),this.addChild(this.chouBtn),this.chouBtn.x=this.chou.x,this.chouBtn.y=this.chou.y,this.removeChild(this.chou),this.daoBtn["this"]=this,this.chouBtn["this"]=this,this.addCursor(this.daoBtn,"hand"),this.addCursor(this.chouBtn,"hand"),this.bg.top.visible=!1,this.bg.bottom.visible=!1}},{key:"daoBtnClick",value:function(t){this.bg.rotation=this.bg.rotation==Math.PI?0:Math.PI,this.b_s=0,this.h_s=0,this.k_s=0,0==this.bg.rotation?(this.start_Y=this.bg.top.y,this.end_Y=this.bg.bottom.y,this.dir=1,this.bg.scale.x=1):(this.start_Y=this.bg.bottom.y,this.end_Y=this.bg.top.y,this.dir=-1,this.bg.scale.x=-1),this.bg.han.y=this.bg.block.y=this.bg.bird.y=this.start_Y,this.b_c=!1,this.k_c=!1,this.h_c=!1}},{key:"update",value:function(){this.isJk?(this.h_s+=this.a_h,this.b_c||(this.bg.bird.y+=this.h_s*this.dir),this.h_c||(this.bg.han.y+=this.h_s*this.dir),this.k_c||(this.bg.block.y+=this.h_s*this.dir)):(this.b_s+=this.a_b,this.h_s+=this.a_h,this.k_s+=this.a_k,this.b_c||(this.bg.bird.y+=this.b_s*this.dir),this.h_c||(this.bg.han.y+=this.h_s*this.dir),this.k_c||(this.bg.block.y+=this.k_s*this.dir)),this.b_c||(this.bg.top.y>this.bg.bird.y&&(this.bg.bird.y=this.bg.top.y,this.b_c=!0),this.bg.bird.y>this.bg.bottom.y&&(this.bg.bird.y=this.bg.bottom.y,this.b_c=!0)),this.h_c||(this.bg.top.y>this.bg.han.y&&(this.bg.han.y=this.bg.top.y,this.h_c=!0),this.bg.han.y>this.bg.bottom.y&&(this.bg.han.y=this.bg.bottom.y,this.h_c=!0)),this.k_c||(this.bg.top.y>this.bg.block.y&&(this.bg.block.y=this.bg.top.y,this.k_c=!0),this.bg.block.y>this.bg.bottom.y&&(this.bg.block.y=this.bg.bottom.y,this.k_c=!0))}},{key:"removed",value:function(){this.removedCursor(this.daoBtn),this.removedCursor(this.chouBtn),this.daoBtn.dispose(),this.chouBtn.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"chouBtnClick",value:function(t){var e=this;this.isXq||(this.isJk=!this.isJk,this.daoBtn.visible=!1,this.isJk?(this.bg.qi.play(),this.bg.qi.visible=!0,this.isXq=!0):(this.daoBtn.visible=!0,this.bg.jia.gotoAndStop(0),this.chouBtn.text=this.language.getLocaleStr("pumping")),setTimeout(function(){e.hadDestory||(e.bg.qi.stop(),e.bg.qi.visible=!1,e.daoBtn.visible=!0,e.isXq=!1,e.isJk?(e.bg.jia.gotoAndStop(1),e.chouBtn.text=e.language.getLocaleStr("ventilation")):(e.bg.jia.gotoAndStop(0),e.chouBtn.text=e.language.getLocaleStr("pumping")))},3e3))}},{key:"selectRenderChild",value:function(){return this.updateTransform(),this.getBounds()}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function m(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:m(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(668),p=o(d),y=i(669),f=o(y),g=void 0,b=void 0,v=void 0,_=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return g=i.phy.nape,b=g.geom.Vec2,v=g.phys.BodyType,_=g.shape.HockShapeBase,i.classType="FurredCeiling",i.var_typeIndex=0,i.jointLen=0,i.hock=null,i.joint=null,i.startV=new l.Point(0,5),i.line=new PIXI.Graphics,i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;this._width=this.bg.width,this._height=this.bg.height,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.jointLen=this.gou.y+this.startV.y,this.body.set_type(v.get_KINEMATIC()),this.body.userData.notHockDrag=!0,this.body.userData.dragLevel=-5,this.hock=new _(15),this.hock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.hock),this.body.userData.cannotToolRot=!0,this.hock.translate(b.get(0,this.jointLen)),this.hock.addCbtype(this.CbTypeStr.CEIL_HOOK),this.hock.connectCallback=function(e,i){return t.connectCallback(e,i)},this.hock.breakClickCallback=function(e){t.breakClickCallback(e)},this.addChildAt(this.line,0),this.addTweenQuan(this.hock)}},{key:"removed",value:function(){this.hock.dragToolClick(),this.hock.dispose(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"breakClickCallback",value:function(){this.BodyUtil.destoryJoint(this.joint),this.joint=null,this.body.add(this.hock),this.hock.set_localCOM(b.get(0,this.jointLen)),this.gou.x=0,this.gou.y=this.jointLen-this.startV.y,this.gou.rotation=0}},{key:"connectCallback",value:function(t,e){var i=this.body.get_position().add(b.get(this.startV.x,this.startV.y)),o=t.userData.view;if(o&&o instanceof p["default"]){var n=this.hock.get_localCOM().get_y()-this.startV.y;this.joint=this.JointUtil.createDistanceJoint(this.body,t,i,e,n,n)}else if(o&&o instanceof f["default"]){this.joint=this.JointUtil.createDistanceJoint(this.body,t,i,e,140,140)}else{this.joint=this.JointUtil.createDistanceJoint(this.body,t,i,e.add(b.get(0,-10)),145,145)}return this.napeEngine.hockCtrol.addJointShape(this.joint,this.hock.get_userData().bind),this.joint.userData.hocknum=2,this.body.get_shapes().remove(this.hock),this.main.dispatchEvent(this.main.constructor.HOCK_CHANGE,{bind:!0}),!0}},{key:"update",value:function(){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.updateTransform(),this.line.clear(),this.line.lineStyle(4,13408512),this.joint){var t=this.JointUtil.getJointworldVertexs(this.joint),i=new l.Point(t[0].get_x(),t[0].get_y()),o=new l.Point(t[1].get_x(),t[1].get_y());i=this.toLocal(i,this.getMain().view),o=this.toLocal(o,this.getMain().view);var n=Math.sqrt(Math.pow(o.x,2)+Math.pow(o.y,2));this.gou.x=o.x*this.jointLen/n,this.gou.y=o.y*this.jointLen/n;this.gou.rotation=-Math.PI/2+Math.atan2(o.y-i.y,o.x-i.x)}this.line.moveTo(this.startV.x,this.startV.y);var s=this.toLocal(new l.Point(0,-15),this.gou);this.line.lineTo(s.x,s.y)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);if(this.joint){var i=this.JointUtil.getJointworldVertexs(this.joint);new l.Point(i[1].get_x(),i[1].get_y());t.gourot=this.gou.rotation,t.hock_x=i[1].get_x(),t.hock_y=i[1].get_y()}return t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t);var i=void 0,o=void 0;t.hockPos?(i=b.get(t.hockPos.x,t.hockPos.y),o=t.hockRot):t.gourot&&(i=b.get(t.hock_x,t.hock_y),o=t.gourot),i&&(i=this.body.worldPointToLocal(i),this.hock.set_localCOM(i),this.gou.x=i.get_x()*this.jointLen/i.get_length(),this.gou.y=i.get_y()*this.jointLen/i.get_length(),this.gou.rotation=o)}},{key:"showGlowSP",value:function(t){if(t){this.showGlowIndex(this.hock.get_userData().useing?1:0)}else this.hideGlow()}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(446),l=function(t){return t&&t.__esModule?t:{"default":t}}(h),u=void 0,c=void 0,d=void 0,p=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return u=i.phy.nape,c=u.phys.BodyType,d=u.geom.Vec2,p=u.shape.HockShapeBase,i.hock=null,i.iscomponent=!1,i.toleftStr=i.language.getLocaleStr("to_left"),i.torightStr=i.language.getLocaleStr("to_right"),i.totopStr=i.language.getLocaleStr("to_top"),i.tobottomStr=i.language.getLocaleStr("to_bottom"),i.currentdir=i.tobottomStr,i}return s(e,t),a(e,[{key:"init",value:function(){this._width=this.bg.width,this._height=this.bg.height,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_type(c.get_KINEMATIC()),this.hock=new p(15),this.hock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.hock),this.body.userData.dragLevel=-5,this.body.userData.cannotToolRot=!0,this.hock.translate(d.get(0,35)),this.hock.addCbtype(this.CbTypeStr.CEIL_HOOK),this.hock.get_userData().noDrag=!0,this.gou.y=20,this.addTweenQuan(this.hock)}},{key:"removed",value:function(){this.hock.dragToolClick(),this.hock.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"removeHockCbtype",value:function(){this.hock.removeCbtype(this.CbTypeStr.CEIL_HOOK)}},{key:"setComponent",value:function(){this.iscomponent=!0,this.noRenderSelected=!0}},{key:"gethockPosition",value:function(){return this.hock.get_worldCOM()}},{key:"changDir",value:function(t){var e=t.showValue;switch(this.currentdir=e,e){case this.tobottomStr:this.body.set_rotation(0);break;case this.totopStr:this.body.set_rotation(Math.PI);break;case this.toleftStr:this.body.set_rotation(Math.PI/2);break;case this.torightStr:this.body.set_rotation(-Math.PI/2)}}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.dir=this.currentdir,t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.dir&&(this.currentdir=t.dir)}},{key:"getConf",value:function(){var t={};t.confArr=[];var e=[this.tobottomStr,this.totopStr,this.toleftStr,this.torightStr];return t.confArr.push(this.ComponentProperty.getDropMenu(this.language.getLocaleStr("hock_dir"),!1,"",this.currentdir,e,this,this.changDir,1,0)),t}},{key:"showGlowSP",value:function(t){if(t){this.showGlowIndex(this.hock.get_userData().useing?1:0)}else this.hideGlow()}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function v(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:v(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(449),c=o(u),d=i(446),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.geom.Vec2,g=y.shape.Polygon,b=y.shape.HockShapeBase,i.topHock=null,i.botHock=null,i.ropeLen=180,i.ropeW=4,i.line=new PIXI.Graphics,i.weld1=null,i.weld2=null,i.ismecJoint=!0,i.dragFlag=!1,i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;this.bg.visible=!1,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.topHock=new b(15),this.botHock=new b(15),this.body.add(this.topHock),this.body.add(this.botHock),this.topHock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.botHock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.topHock.addCbtype(this.CbTypeStr.GALLOON_HOCK),this.botHock.addCbtype(this.CbTypeStr.GALLOON_HOCK);var i=[this.CbTypeStr.STONE_HOCK,this.CbTypeStr.SPRING_HOCK];this.topHock.createListener(this.CbTypeStr.GALLOON_HOCK,i),this.botHock.createListener(this.CbTypeStr.GALLOON_HOCK,i),this.addChild(this.line),this.changeLen(),this.body.mass=10,this.body.set_gravMass(0),this.addTweenQuan(this.topHock),this.addTweenQuan(this.botHock),this.dragBeginCallBack=function(){t.dragFlag=!0},this.dragEndCallBack=function(){t.dragFlag=!1},this.addEventListener(c["default"].BEGIN,this.dragBeginCallBack),this.addEventListener(c["default"].END,this.dragEndCallBack)}},{key:"removed",value:function(){this.removeEventListener(c["default"].BEGIN,this.dragBeginCallBack),this.removeEventListener(c["default"].END,this.dragEndCallBack),this.topHock.dragToolClick(),this.botHock.dragToolClick(),this.topHock.dispose(),this.botHock.dispose(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"changeLen",value:function(){var t=this;this.line.clear(),this.line.beginFill(16750848),this.line.drawRect(-this.ropeW/2,-this.ropeLen/2,this.ropeW,this.ropeLen),this.line.endFill(),this.line.beginFill(16711935,0),this.line.drawRect(-this.ropeW/2-15,-this.ropeLen/2-15,this.ropeW+30,this.ropeLen+30),this.line.endFill(),this.body.shapes.clear();var e=new g(g.box(30,this.ropeLen));this.body.add(e),e.set_sensorEnabled(!0),this.body.add(new g(g.box(this.ropeW,this.ropeLen))),this.body.add(this.topHock),this.body.add(this.botHock),this.body.get_shapes().foreach(function(e){e.set_filter(t.InteractionFilterManager.LIQUID_IGNORE_GROUP)}),this.topHock.set_localCOM(f.get(0,-this.ropeLen/2)),this.botHock.set_localCOM(f.get(0,this.ropeLen/2)),this.body.mass=10;var i=void 0;if(this.topHock.pivjoint){i=this.topHock.pivjoint;var o=i.get_body1(),n=i.get_body2();o==this.body?i.set_anchor1(this.topHock.get_localCOM().copy()):n==this.body&&i.set_anchor2(this.topHock.get_localCOM().copy())}else{var s=this.topHock.get_userData();if(s.bind&&s.bind.pivjoint){i=s.bind.pivjoint;var a=i.get_body1(),r=i.get_body2();a==this.body?i.set_anchor1(this.topHock.get_localCOM().copy()):r==this.body&&i.set_anchor2(this.topHock.get_localCOM().copy())}}if(this.botHock.pivjoint){i=this.botHock.pivjoint;var h=i.get_body1(),l=i.get_body2();h==this.body?i.set_anchor1(this.botHock.get_localCOM().copy()):l==this.body&&i.set_anchor2(this.botHock.get_localCOM().copy())}else{var u=this.botHock.get_userData();if(u.bind&&u.bind.pivjoint){i=u.bind.pivjoint;var c=i.get_body1(),d=i.get_body2();c==this.body?i.set_anchor1(this.botHock.get_localCOM().copy()):d==this.body&&i.set_anchor2(this.botHock.get_localCOM().copy())}}}},{key:"changeRopeLength",value:function(t){this.ropeLen=3*(l.M.getNumStr(t.showValue)-0),this.changeLen()}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.topHock.get_userData().useing||this.botHock.get_userData().useing?(this.dragFlag&&this.BodyUtil.dampingBodyVelocity(this.body,.8,.8),this.body.set_gravMass(0)):this.body.set_gravMass(.1)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.ropeLen=this.ropeLen,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.ropeLen=t.ropeLen,this.changeLen()}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("length"),!0,"",100,10,this.ropeLen/3,1,this.changeRopeLength,this)),t}},{key:"selectRenderChild",value:function(){return this.line.getBounds()}},{key:"getTipMess",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.language.getLocaleStr("length")+": "+this.ropeLen/3+"\n    "}}]),e}(p["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function m(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:m(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(226),c=o(u),d=i(515),p=o(d),y=i(1094),f=o(y),g=i(1093),b=o(g),v=void 0,_=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.JointUtil=t.moduleMain.JointUtil,i.ToolStatusStr=t.moduleMain.ToolStatusStr,v=i.phy.nape,_=v.geom.Vec2,i.bg=i,i.isMechanics=!0,i.fromEquTools=!0,i.ismecJoint=!0,i.cateid=5,i.spring=null,i.botBox=null,i.topHock=null,i.botWeld=null,i.botHock=null,i.helpline=!1,i.k=1,i.hand=null,i.lineJoint=null,i.damping=.1,i.touchid=null,i.sview=null,i}return a(e,t),r(e,[{key:"added",value:function(){var t=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.cannotSystemDrag=!0,this.removeChild(this.componentBox),this.topHock=new f["default"](this.paramObj),this.topHock.parentUpdate=this.updateGou,this.parent.addChild(this.topHock),this.topHock.targetThis=this,this.topHock.init(),this.botHock=new b["default"](this.paramObj),this.parent.addChild(this.botHock),this.botHock.init(),this.botHock.line.visible=this.helpline,this.topHock.body.set_position(_.get(this.x+this.top.x,this.y+this.top.y)),this.topHock.addChild(this.top),this.top.x=0,this.top.y=0,this.botHock.body.set_position(_.get(this.x+this.bottom.x,this.y+this.bottom.y)),this.botHock.addChild(this.bottom),this.bottom.x=0,this.bottom.y=0;this.spring=this.JointUtil.createSpringJoint(this.topHock.body,this.botHock.body,this.topHock.body.position,this.botHock.body.position,220),this.spring.damping=this.damping,this.spring.frequency=this.k,this.sview=new p["default"](this.paramObj),this.sview.joint=this.spring,this.sview.count=18,this.spring.userData.view=this.sview,this.parent.addChild(this.sview),this.lineJoint=this.JointUtil.createLineJoint(this.topHock.body,this.botHock.body,this.topHock.body.position,this.botHock.body.position,this.botHock.body.position.sub(this.topHock.body.position),20,1e4);var i=void 0;this.touchid=l.M.addTouch(this.sview,{begin:function(e){var o=t.topHock.getEngineTouchManager();if(o.getCurrentToolStatus()===t.ToolStatusStr.DRAG){i=new o.currentTool(t.paramObj),i.cannotStart=!0,i.init(o.dis,o.space);var n=t.getMouseXY(e);i.toDragJoint(t.topHock.body,n)}},move:function(e){if(i){var o=t.getMouseXY(e);i.func_touchMove(o)}},end:function(e){if(i){var o=t.getMouseXY(e);i.func_touchEnd(o),i.dispose()}}},this)}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.spring&&this.spring.update()}},{key:"updateGou",value:function(){this.botHock&&this.botHock.body&&(this.botHock.body.rotation=this.topHock.body.rotation)}},{key:"showOrHideHelpline",value:function(t){this.botHock.line.visible=this.helpline=t.checked}},{key:"changeNM",value:function(t){var e=l.M.getNumStr(t.showValue)-0;this.damping=.1*e/100,this.spring.damping=this.damping,this.k=e/100,this.spring.frequency=this.k}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.fromEquTools=this.fromEquTools,t.ismecJoint=this.ismecJoint,t.uid=this.UID,t.thisX=this.x,t.thisY=this.y,t.topHock=this.topHock.getData(),t.botHock=this.botHock.getData(),t.helpline=this.helpline,t.k=100*this.k+"N/m",t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.topHock&&(this.topHock.setData(t.topHock),this.botHock.setData(t.botHock),1==t.helpline&&this.showOrHideHelpline({checked:!0}),this.changeNM({showValue:t.k}))}},{key:"removed",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this),l.M.removeTouch(this.sview,this.touchid),this.topHock.parentUpdate=null,this.topHock.targetThis=null,this.sview.destroy(),this.topHock.removed(),this.botHock.removed(),this.topHock.destroy(),this.botHock.destroy(),this.JointUtil=null,this.ToolStatusStr=null}},{key:"getLocalBoundsElecs",value:function(){return[this.top,this.bottom]}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("stiffness_coefficient"),!0,"N/m",200,10,100*this.k+"N/m",1,this.changeNM,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("subline"),this.helpline,this.showOrHideHelpline,this)),t}},{key:"getTipMess",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.language.getLocaleStr("stiffness_coefficient")+": "+100*this.k+"N/m\n    "}},{key:"showGlowSP",value:function(t){if(t){var e=this.topHock.hock.get_userData().useing,i=this.botHock.hock.get_userData().useing;this.showGlowIndex(e||i?e&&!i?1:!e&&i?2:3:0)}else this.hideGlow()}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function u(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:u(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(546),l=function(t){return t&&t.__esModule?t:{"default":t}}(h);e["default"]=function(t){function e(){o(this,e);var t=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.liquidW=158,t.halfW=t.liquidW/2,t.wallW=20,t.wallH=1150,t.botH=63,t.boty=527,t.fullH=900,t.totalRange=100,t.valueTxtxy={x:110,y:-600},t.poshapexy={x:71,y:-610},t.pourxy={x:-111,y:-565},t.barxy={x:30,y:0},t.selfmass=70,t.totaltxtY=130,t}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.changeLiquidVolume({showValue:"80mL"})}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function v(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:v(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0,y=void 0,f=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,y=c.NbBody,d=c.geom.Vec2,p=c.shape.Polygon,f=c.phys.BodyType,i.verticesArr=i.Vec2Util.pointArrArrToVec2ArrArr([[{x:-312.05,y:-158},{x:-312.05,y:159.1},{x:-305.05,y:159.1},{x:-305.05,y:-158}],[{x:303.95,y:-158},{x:303.95,y:159.1},{x:310.95,y:159.1},{x:310.95,y:-158}],[{x:310.25,y:152.1},{x:-309.95,y:152.1},{x:-309.95,y:159.1},{x:310.25,y:159.1}],[{x:304,y:-43},{x:-306.45,y:-43},{x:-306.45,y:152.1},{x:304,y:152.1}]]),i.MIN_Y=-108,i.MIDDLE_Y=-12,i.MAX_H=130,i.radio1=.1,i.radio2=.01,i.tableTurned=!1,i.pxPerCm=9.6,i}return s(e,t),a(e,[{key:"init",value:function(){var t=this;r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this);var i=new p(p.box(624,318));i.translate(d.get(0,0)),this.body.add(i),i.set_sensorEnabled(!0),this.body.userData.cannotToolRot=!0,this.body.noallowRotation=!0,this.body.userData.dragLevel=-1,this.deskFoot.y=this.desk.y=this.MIN_Y;var o=[[{x:234.95,y:-74},{x:-234,y:-74},{x:-234,y:-44},{x:234.95,y:-44}],[{x:213,y:-42.95},{x:-213.95,y:-42.95},{x:-213.95,y:-27.95},{x:213,y:-27.95}],[{x:-213,y:-27},{x:-213,y:73},{x:-188,y:73},{x:-188,y:-27}],[{x:188,y:-28},{x:188,y:72},{x:213,y:72},{x:213,y:-28}]];this.tableBody=new y(f.get_KINEMATIC()),o=this.Vec2Util.pointArrArrToVec2ArrArr(o),o.forEach(function(e){var i=new p(e);t.tableBody.add(i)}),this.tableBody.set_position(d.get(this.body.posx+this.desk.x,this.body.posy+this.desk.y)),this.tableBody.userData.view=this.desk,this.tableBody.userData.allowMove=!1,this.tableBody.userData.noDrag=!0,this.tableBody.userData.cannotToolRot=!0,this.tableBody.userData.dragLevel=-1,this.addBodyToSpace(this.tableBody),this.op=this.body.get_position().copy(),this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.BodyUtil.setBodyFilter(this.tableBody,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.labelGraphics=new g,this.addChild(this.labelGraphics),this.changeLock({checked:!0})}},{key:"update",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this);var t=this.body.get_position().copy(),i=t.sub(this.op);this.op=t.copy();var o=this.tableBody.get_position();o=o.add(i),this.tableBody.set_position(o),this.deskFoot.x=this.desk.x=this.tableBody.posx-this.body.posx,this.deskFoot.y=this.desk.y=this.tableBody.posy-this.body.posy,this.deskFoot.rotation=this.desk.rotation;var n=this.tableBody.normalImpulse(),s=n.get_y();s*=this.NapeConst.FORCE_RATIO;var a=this.paramObj.moduleMain.napeEngine.getGravity(),h=a*this.tableBody.mass*.001,l=s+h,u=this.desk.y-this.MIN_Y,c=void 0;c=this.tableTurned||this.desk.y>this.MIDDLE_Y?this.radio2:this.radio1,l>(1/(1-u/this.MAX_H)-1)/c&&this.tableBody.set_position(d.get(this.tableBody.posx,this.tableBody.posy+1)),this.updateGraphics()}},{key:"removed",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this),this.removeBodyFromSpace(this.tableBody)}},{key:"updateGraphics",value:function(){this.labelGraphics.h!==this.desk.y-this.MIN_Y&&(this.labelGraphics.top=-35,this.labelGraphics.h=this.desk.y-this.MIN_Y,this.labelGraphics.hcm=this.px2cm(this.labelGraphics.h),this.labelGraphics.selfRender())}},{key:"cm2px",value:function(t){return t*this.pxPerCm}},{key:"px2cm",value:function(t){return t/this.pxPerCm}},{key:"changeLock",value:function(t){this.islock=t.checked,this.islock?this.body.set_type(f.get_KINEMATIC()):(this.body.set_type(f.get_DYNAMIC()),this.body.set_allowRotation(!1))}},{key:"changeTableTurned",value:function(t){this.tableTurned=t.checked,this.tableBody.set_rotation(this.tableTurned?Math.PI:0),this.resetTable()}},{key:"resetTable",value:function(t){this.tableBody.set_position(d.get(this.tableBody.posx,this.body.posy+this.MIN_Y))}},{key:"changeRadio1",value:function(t){this.radio1=1-t.showValue,this.radio2=.1*this.radio1}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.islock=this.islock,t.tableTurned=this.tableTurned,t.radio1=this.radio1,t.radio2=this.radio2,t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.islock=t.islock,this.tableTurned=t.tableTurned,this.radio1=t.radio1||.01,this.radio2=t.radio2||.001,this.changeLock({checked:this.islock}),this.changeTableTurned({checked:this.tableTurned}),this.resetTable()}},{key:"getConf",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("sand_damp_coefficient"),!1,"",1,0,h.M.getNumJie(1-this.radio1,2),.01,this.changeRadio1,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("lock"),this.islock,this.changeLock,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("flip_desk"),this.tableTurned,this.changeTableTurned,this),this.ComponentProperty.getButton(this.language.getLocaleStr("desk_diaplasis"),this.language.getLocaleStr("diaplasis"),this.resetTable,this)),t}}]),e}(u["default"]);var g=function(t){function e(){o(this,e);var t=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.top=0,t.h=0,t.hcm=0,t.ORANGE=16734488,t.FONT_SIZE=20,t.LEN_1=220,t.LEN_2=360,t.OFF_X=20,t.line01=t.createLine(t.LEN_1,0,2,t.LEN_2-t.LEN_1,t.ORANGE),t.line02=t.createLine(t.LEN_1,0,2,t.LEN_2-t.LEN_1,t.ORANGE),t.arrow01=new b(t,t.LEN_2-t.OFF_X,0,2,20,t.ORANGE,3),t.arrow02=new b(t,t.LEN_2-t.OFF_X,0,2,20,t.ORANGE,1),t.tfH=t.cretaeTf(t.LEN_2,0,t.FONT_SIZE,t.ORANGE),t}return s(e,t),a(e,[{key:"selfRender",value:function(){this.line01.y=this.top,this.line02.y=this.top+this.h;this.arrow01.y=this.line01.y+10,this.arrow02.y=this.line02.y-10,this.arrow02.len=this.arrow01.len=this.h/2,this.arrow01.selfRender(),this.arrow02.selfRender(),this.tfH.y=(this.line01.y+this.line02.y-this.FONT_SIZE)/2,this.tfH.text="h="+h.M.getNumJie(this.hcm,2)+"cm"}},{key:"cretaeTf",value:function(t,e,i,o){var n=new PIXI.Text("",{font:i+"px Arial",fill:o});return this.addChild(n),n.x=t,n.y=e,n}},{key:"createLine",value:function(t,e,i,o,n){var s=new PIXI.Graphics;return s.lineStyle(i,n,1),h.M.drawDashed(s,new PIXI.Point(0,0),new PIXI.Point(o,0),15,10),s.x=t,s.y=e,this.addChild(s),s}}]),e}(PIXI.Graphics),b=function(t){function e(t,i,s,a,r,h,l,u){o(this,e);var c=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return c.offX=0,c.arrowType=u||1,c.x=i,c.y=s,c.w=a,c.len=r,c.co=h,c.dir=l,c.lenScale=1,c.graphics=new PIXI.Graphics,c.addChild(c.graphics),c.selfRender(),t.addChild(c),c}return s(e,t),a(e,[{key:"selfRender",value:function(){this.graphics.clear(),this.graphics.x=this.offX,1===this.arrowType?(this.graphics.beginFill(this.co,1),this.graphics.moveTo(0,4),this.graphics.lineTo(0,-4),this.graphics.lineTo(7,0),this.graphics.lineTo(0,4),this.graphics.endFill()):(this.graphics.beginFill(this.co,1),this.graphics.moveTo(0,4),this.graphics.lineTo(0,-4),this.graphics.lineTo(3,0),this.graphics.lineTo(0,4),this.graphics.endFill()),this.graphics.beginFill(this.co,1),this.graphics.drawRect(-this.len*this.lenScale,-this.w/2,this.len*this.lenScale,this.w),this.graphics.endFill(),this.rotation=Math.PI*this.dir*.5}}]),e}(PIXI.Graphics)},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function g(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:g(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(226),c=o(u),d=i(1096),p=o(d),y=i(454),f=o(y);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.Vec2Util=t.moduleMain.Vec2Util,i.BodyUtil=t.moduleMain.BodyUtil,i.level=13,i.classType="HTickerTimer",i.var_paper=null,i.havePaper=null,i.var_canTouch=!0,i.var_ispowerClick=!1,i.var_powerIsOpen=!1,i.var_startP=null,i.var_oldP=null,i.var_bindLongBoard=null,i.var_hasCar=!1,i.bindCar=null,i.paperWidth=679,i.isMechanics=!0,i.sound=null,i.btnTouchid=null,i.touchid=null,i.iscomponent=!1,i.resetDisLoadComp=!0,i}return a(e,t),r(e,[{key:"added",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.removeChild(this.tt),this.tt=null,this.btn.gotoAndStop(1),this.componentBox.visible=!1,this.removeChild(this.componentBox),this.cannotSystemDrag=!0,this.init(),this.addCursor(this.btn,"hand"),this.addCursor(this.var_paper,"zuoyou")}},{key:"init",value:function(){this.var_paper=new p["default"](this.paramObj),this.var_paper.thisRoot=this,this.initListener(),this.firstShowPaper()}},{key:"firstShowPaper",value:function(){this.func_showPaper(.5*-this.paperWidth*.618)}},{key:"setComponent",value:function(){this.iscomponent=!0,this.noRenderSelected=!0,l.M.removeTouch(this,this.touchid),this.removedCursor(this.var_paper)}},{key:"initListener",value:function(){var t=this;this.btnTouchid=l.M.addTouch(this.btn,{tab:this.func_powerClick},this),this.paperneiBreakfunc=function(e){t.neibuPaperJointBreak(e)},this.var_paper.addEventListener(f["default"].NEI_BU_LINEJOINT_BREAK,this.paperneiBreakfunc),this.touchid=l.M.addTouch(this,{begin:this.func_touchBegin,move:this.func_touchMove,end:this.func_touchEnd},this),this.ht=function(e){t.func_paperUpdate()},this.paramObj.moduleMain.napeEngine.addEventListener(f["default"].WORLD_TIME_CHANGE,this.ht)}},{key:"func_changePaperXY",value:function(t){t=this.toLocal(t,this.getMain().view),this.var_paper.x=t.x-.5*this.var_paper.paW,this.var_paper.updateTransform()}},{key:"func_setPaperA",value:function(t){-1==this.var_paper.var_a&&(this.var_paper.var_a=t)}},{key:"getPaperRightP",value:function(){var t=void 0;return this.var_paper.visible&&(t=new l.Point(this.var_paper.x+.5*this.var_paper.paW,this.var_paper.y),t=this.toGlobalView(t,this)),t}},{key:"func_paperUpdate",value:function(){if(this.var_powerIsOpen&&this.var_paper.visible){this.var_paper.x>-339.5&&339.5>this.var_paper.x&&this.var_paper.addDot()}}},{key:"func_touchBegin",value:function(t){this.var_canTouch&&(this.var_startP=this.getMouseXY(t),this.var_ispowerClick=!0,this.var_oldP=this.var_startP.clone())}},{key:"func_touchMove",value:function(t){if(this.var_canTouch){var e=this.getMouseXY(t);this.var_bindLongBoard?l.Point.distance(e,this.var_startP)>50&&(this.var_bindLongBoard.haveTick=!1,this.var_bindLongBoard.tick=null,this.var_bindLongBoard=null,this.rotation=0):(this.x+=e.x-this.var_oldP.x,this.y+=e.y-this.var_oldP.y,this.var_oldP=e),l.Point.distance(e,this.var_startP)>20&&(this.var_ispowerClick=!1)}}},{key:"func_touchEnd",value:function(t){this.var_canTouch&&(this.var_bindLongBoard||this.func_endDragHandler())}},{key:"func_endDragHandler",value:function(){var t=this.getChildrenByClass("PulleyLongBoard"),e=void 0;for(e=0;t.length>e;e++){var i=t[e];if(this.hitTestViewPoint(i,this.toGlobalView(new l.Point,this))&&!i.haveTick)return void this.func_bindBoard(i)}}},{key:"func_bindBoard",value:function(t){this.rotation=t.body.rotation,t.haveTick=!0,t.tick=this;var e=this.getMain(),i=void 0;if(t.guPoint)i=this.parent.toLocal(t.guPoint,t);else{var o=this.toGlobalView(new l.Point,this),n=l.Point.distance(o,t.weldPoint());t.x>o.x&&(n*=-1),i=this.parent.toLocal(t.weldPoint(n),e.view)}this.x=i.x,this.y=i.y,t.tickPoint=t.toLocal(this.toGlobalView(new l.Point,this),e.view),this.var_bindLongBoard=t}},{key:"func_powerClick",value:function(){if(!this.iscomponent&&!this.var_ispowerClick)return void(this.var_ispowerClick=!1);this.var_powerIsOpen?(this.var_powerIsOpen=!1,this.var_paper.var_working=!1,this.btn.gotoAndStop(1),this.freshVolume()):(this.btn.gotoAndStop(0),this.var_paper.dadian(),this.var_paper.var_working=!0,this.var_powerIsOpen=!0,this.freshVolume()),this.freshGlow(),this.dispatchEvent(f["default"].TICKER_POWER_CHANGE)}},{key:"freshVolume",value:function(){this.var_powerIsOpen&&1==this.globalConfig.VOLUME?this.var_sound||(this.var_sound=this.globalConfig.SoundTool.play(this.SoundStr.TICKER_TIME,!0)):this.var_sound&&(this.globalConfig.SoundTool.stopT(this.var_sound),this.var_sound=null)}},{key:"func_showPaper",value:function(t){this.var_paper.parent||this.addChildAt(this.var_paper,1),this.var_paper.resetAll(),this.var_paper.showneipaper(t)}},{key:"neibuPaperJointBreak",value:function(t){var e=this,i=void 0;if(i=this.iscomponent?this.toGlobalView(new l.Point(this.var_paper.x+200,this.var_paper.y-200),this):this.toGlobalView(new l.Point(this.var_paper.x,this.var_paper.y),this),this.havePaper){var o=this.havePaper;this.havePaper=null,this.dispatchEvent(f["default"].NEI_BU_LINEJOINT_BREAK,{a:this.var_paper.var_a,pos:this.Vec2Util.pointToVec2(i),dat:t}),this.iscomponent&&this.dispatchEvent(f["default"].SCALE_BIG_PAPER,o)}else this.addComp([{name:"HpaperTicker",p:new l.Point}],function(o){var n=o[0];n.neibuPaperJointBreak({a:e.var_paper.var_a,pos:e.Vec2Util.pointToVec2(i),dat:t}),n.allowSave=!0,e.dispatchLoadedComplete(),e.iscomponent&&e.dispatchEvent(f["default"].SCALE_BIG_PAPER,n)},!0)}},{key:"func_changeXY",value:function(){var t=this.parent.toLocal(this.var_bindLongBoard.tickPoint,this.var_bindLongBoard);this.x=t.x,this.y=t.y}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.thisx=this.x,t.thisy=this.y,t.paperVisible=this.var_paper.visible,t.nei_x=this.var_paper.x,this.var_bindLongBoard&&(t.boardUid=this.var_bindLongBoard.UID),t}},{key:"setData",value:function(t){var i=this;if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.x=t.thisx,this.y=t.thisy,this.var_paper.visible=t.paperVisible,this.var_paper.x=t.nei_x,t.boardUid){var o=this.BodyUtil.getBodyFromUID(t.boardUid).userData.view;o&&setTimeout(function(){i.hadDestory||i.func_bindBoard(o)},10)}}},{key:"removed",value:function(){this.removedCursor(this.btn),this.removedCursor(this.var_paper),this.bindCar=null,this.paramObj.moduleMain.napeEngine.removeEventListener(f["default"].WORLD_TIME_CHANGE,this.ht),this.var_paper.removeEventListener(f["default"].NEI_BU_LINEJOINT_BREAK,this.paperneiBreakfunc),l.M.removeTouch(this.btn,this.btnTouchid),l.M.removeTouch(this,this.touchid),this.var_paper.removeAllListeners(),this.var_paper.thisRoot=null,this.var_paper.destroyBefore(),this.var_paper.destroy(),delete this.ht,this.var_bindLongBoard&&(this.var_bindLongBoard.haveTick=!1,this.var_bindLongBoard.tick=!1,this.var_bindLongBoard=null),this.havePaper&&(this.havePaper.bindTicker=null,this.havePaper=null),this.var_sound&&(this.globalConfig.SoundTool.stopT(this.var_sound),this.var_sound=null),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"showGlowSP",value:function(t){if(t){this.showGlowIndex(this.var_powerIsOpen?1:0)}else this.hideGlow()}},{key:"getLocalBoundsElecs",value:function(){return[this.bg]}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function f(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:f(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0,y=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.geom.Vec2,p=c.phys.Material,y=c.shape.HockShapeBase,i.hock=null,i.dirBoo=!0,i.material=p.wood(),i.originMass=0,i}return s(e,t),a(e,[{key:"init",value:function(){this._width=190,this._height=this.bg.height,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.classType="HookWood",this.hock=new y(15,null,this.material),this.hock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.hock),this.hock.translate(d.weak(125,0)),this.hock.addCbtype(this.CbTypeStr.HOOKWOOD_HOCK,!0),this.originMass=this.body.get_mass(),this.b200.visible=!1,this.addTweenQuan(this.hock)}},{key:"addWeight",value:function(t){t?(this.b200.visible=!0,this.dirBoo?(this.b200.x=0,this.b200.y=-128,this.b200.rotation=0):(this.b200.x=-158,this.b200.y=0,this.b200.rotation=-Math.PI/2),this.body.set_mass(this.originMass+200)):(this.b200.visible=!1,this.body.set_mass(this.originMass))}},{key:"removed",value:function(){this.hock.dragToolClick(),this.hock.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"func_changeAngle",value:function(t){if(this.hock.get_userData().useing)return this.freshLibPan(),void this.freshGlow();this.dirBoo=t.checked,this.dirBoo?(this.bg.gotoAndStop(0),this.hock.translate(d.get(125,96))):(this.bg.gotoAndStop(1),this.hock.translate(d.get(-125,-96))),this.freshGlow()}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.ang=this.dirBoo,t.mass=this.body.get_mass(),t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),0==t.ang&&this.func_changeAngle({checked:!1}),isNaN(t.mass)||this.changeMass({showValue:t.mass})}},{key:"changeMass",value:function(t){var e=h.M.getNumStr(t.showValue)-0;this.body.set_mass(e),this.originMass=e}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("mass"),!0,"g",50,15,h.M.getNumJie(this.body.get_mass(),0),1,this.changeMass,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("change_angle"),this.dirBoo,this.func_changeAngle,this)),t}},{key:"getTipMess",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.language.getLocaleStr("mass")+": "+h.M.getNumJie(this.body.get_mass(),0)+"g\n    "}},{key:"showGlowSP",value:function(t){if(t){var e=void 0;e=this.dirBoo?this.hock.get_userData().useing?1:0:this.hock.get_userData().useing?3:2,this.showGlowIndex(e)}else this.hideGlow()}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function x(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:x(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0,y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0,m=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.NbBody,p=c.phys.BodyType,y=c.shape.Polygon,f=c.geom.Vec2,g=c.shape.Circle,b=c.phys.Material,v=c.callbacks.PreListener,_=c.callbacks.InteractionType,m=c.callbacks.CbType,i.isStart=!1,i.ball1cbtype=new m,i.ball2cbtype=new m,i.ishit=!1,i}return s(e,t),a(e,[{key:"init",value:function(){this._width=700,this._height=670,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_type(p.get_KINEMATIC()),this.body.sensorEnabled(!0),this.initBtn(),this.initTrack(),this.initGdq(),this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.topCtP1=new h.Point(this.ct1.x,this.ct1.y),this.topCtP2=new h.Point(this.ct2.x,this.ct2.y);var t=37*Math.PI/180;this.bottomCtP1=new h.Point(this.topCtP1.x+160*Math.cos(t),this.topCtP1.y+160*Math.sin(t)),this.bottomCtP2=new h.Point(this.topCtP2.x+160*Math.cos(t),this.topCtP2.y+160*Math.sin(t)),this.initBall(),this.addCursor(this.resetBtn,"hand"),this.addCursor(this.startBtn,"hand"),this.addCursor(this.dragCt1,"qingxie"),this.addCursor(this.dragCt2,"qingxie")}},{key:"initBall",value:function(){var t=this;this.ball1Body=new d;var e=new b(0,0,0,2.7,0);this.ball1Body.add(new g(7.5,null,e)),this.ball1Body.userData.view=this.ball1,this.addBodyToSpace(this.ball1Body,this),this.ball2Body=new d,this.ball2Body.add(new g(7.5,null,e)),this.ball2Body.userData.view=this.ball2,this.addBodyToSpace(this.ball2Body,this),this.ball1Body.get_cbTypes().add(this.ball1cbtype),this.ball2Body.get_cbTypes().add(this.ball2cbtype),this.preHitListen=new v(_.get_COLLISION(),this.ball1cbtype,this.ball2cbtype,function(e){t.ishit=!0}),this.createJoint()}},{key:"createJoint",value:function(){this.ball1Body.posx=this.x+this.ct1.x+18,this.ball1Body.posy=this.y+this.ct1.y+12,this.ball2Body.posx=this.x+this.ct2.x+18,this.ball2Body.posy=this.y+this.ct2.y+13,this.weld1=this.JointUtil.createWeldJoint(this.ball1Body,this.body,this.ball1Body.position,this.ball1Body.position),this.weld2=this.JointUtil.createWeldJoint(this.ball2Body,this.body,this.ball2Body.position,this.ball2Body.position)}},{key:"initGdq",value:function(){function t(t){i=t.target,o="dragCt1"==i.name?this.dragCt2:this.dragCt1,n=this.getMouseXY(t)}function e(t){var e=this.getMouseXY(t),a=h.Point.distance(n,e),r=a*Math.cos(s),l=a*Math.sin(s);e.x>n.x?(i.x+=r,i.y+=l,o.x+=r,o.y+=l):(i.x-=r,i.y-=l,o.x-=r,o.y-=l),this.dragCt1.x=this.topCtP1.x>this.dragCt1.x?this.topCtP1.x:this.dragCt1.x,this.dragCt1.x=this.dragCt1.x>this.bottomCtP1.x?this.bottomCtP1.x:this.dragCt1.x,this.dragCt1.y=this.topCtP1.y>this.dragCt1.y?this.topCtP1.y:this.dragCt1.y,this.dragCt1.y=this.dragCt1.y>this.bottomCtP1.y?this.bottomCtP1.y:this.dragCt1.y,this.dragCt2.x=this.topCtP2.x>this.dragCt2.x?this.topCtP2.x:this.dragCt2.x,this.dragCt2.x=this.dragCt2.x>this.bottomCtP2.x?this.bottomCtP2.x:this.dragCt2.x,this.dragCt2.y=this.topCtP2.y>this.dragCt2.y?this.topCtP2.y:this.dragCt2.y,this.dragCt2.y=this.dragCt2.y>this.bottomCtP2.y?this.bottomCtP2.y:this.dragCt2.y,this.ct1.x=this.dragCt1.x,this.ct1.y=this.dragCt1.y,this.ct2.x=this.dragCt2.x,this.ct2.y=this.dragCt2.y,n=e,this.weld1&&(this.weld1.anchor2=f.get(this.ct1.x+19,this.ct1.y+12),this.weld2.anchor2=f.get(this.ct2.x+19,this.ct2.y+12))}this.dragCt1.x=this.ct1.x,this.dragCt1.y=this.ct1.y,this.dragCt2.x=this.ct2.x,this.dragCt2.y=this.ct2.y,this.c1Touchid=h.M.addTouch(this.dragCt1,{begin:t,move:e},this),this.c2Touchid=h.M.addTouch(this.dragCt2,{begin:t,move:e},this);var i=void 0,o=void 0,n=void 0,s=37*Math.PI/180}},{key:"initTrack",value:function(){this.createSp(-430,-348,260,20,37*Math.PI/180),this.createSp(-430,137,260,20,37*Math.PI/180),this.createSp(-305,-272,126,20,0),this.createSp(-62,215,620,20,0)}},{key:"createSp",value:function(t,e,i,o,n){var s=new y(y.box(i,o));this.body.add(s),s.rotate(n),s.set_localCOM(f.get(t,e)),this.BodyUtil.setShapeMaterial(s,{dynamicFriction:0,elasticity:0,rollingFriction:0,staticFriction:0})}},{key:"initBtn",value:function(){this.startBtn.fontColor="#ffffff",this.startBtn.text=this.language.getLocaleStr("start"),this.startBtn["this"]=this,this.startBtn.tab=function(t){this.isStart||(this.weld1&&(this.BodyUtil.destoryJoint(this.weld1),this.BodyUtil.destoryJoint(this.weld2),this.isStart=!0,this.weld1=null,this.weld2=null),this.addNapeListeners(this.preHitListen))},this.resetBtn.fontColor="#ffffff",this.resetBtn.text=this.language.getLocaleStr("reset"),this.resetBtn["this"]=this,this.resetBtn.tab=function(t){this.isStart&&(this.createJoint(),this.isStart=!1),this.ishit=!1,this.removeNapeListeners(this.preHitListen)}}},{key:"update",value:function(){if(r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.isStart&&!this.ishit){var t=this.ball2Body.get_position().get_x(),i=this.ball1Body.get_position();i.set_x(t),this.ball1Body.set_position(i)}this.isStart&&this.ishit&&this.removeNapeListeners(this.preHitListen)}},{key:"removed",value:function(){this.removedCursor(this.resetBtn),this.removedCursor(this.startBtn),this.removedCursor(this.dragCt1),this.removedCursor(this.dragCt2),this.BodyUtil.destoryBody(this.ball1Body),this.BodyUtil.destoryBody(this.ball2Body),this.startBtn.dispose(),this.resetBtn.dispose(),h.M.removeTouch(this.dragCt1,this.c1Touchid),h.M.removeTouch(this.dragCt2,this.c2Touchid),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"getLocalBoundsElecs",value:function(){return[this.bg,this.dh,this.lh]}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function u(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:u(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(226),l=function(t){return t&&t.__esModule?t:{"default":t}}(h);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.SPED1=3,i.SPED2=6,i.speed=0,i.haveSpeed=!1,i.ballIsMove=!1,i.ang=0,i.dotCon=new PIXI.Sprite,i.vec=[],i}return s(e,t),a(e,[{key:"added",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.componentBox.visible=!1,this.removeChild(this.componentBox),this.jiandao.animationSpeed=.3,this.gan.animationSpeed=.2,this.jiandao.play(),this.speed1.fontColor="#ffffff",this.speed1.text=this.language.getLocaleStr("speed")+1,this.speed2.fontColor="#ffffff",this.speed2.text=this.language.getLocaleStr("speed")+2,this.stopBtn.fontColor="#ffffff",this.stopBtn.text=this.language.getLocaleStr("stopIt"),this.addChildAt(this.dotCon,1);var t=new PIXI.Graphics;t.beginFill(0),t.drawRect(-290,-130,500,260),t.endFill(),this.addChild(t),this.dotCon.mask=t,this.addChild(this.startBtn),this.initListener(),this.addCursor(this.speed1,"hand"),this.addCursor(this.speed2,"hand"),this.addCursor(this.startBtn,"hand"),this.addCursor(this.stopBtn,"hand")}},{key:"removed",value:function(){this.removedCursor(this.speed1),this.removedCursor(this.speed2),this.removedCursor(this.startBtn),this.removedCursor(this.stopBtn),this.tic&&this.tic.stop(),this.speed1.dispose(),this.speed2.dispose(),this.startBtn.dispose(),this.stopBtn.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"initListener",value:function(){this.speed1.tab=this.btn1Click,this.speed2.tab=this.btn1Click,this.stopBtn.tab=this.btn1Click,this.startBtn.tab=this.btn1Click,this.speed1["this"]=this.speed2["this"]=this.startBtn["this"]=this.stopBtn["this"]=this}},{key:"update",value:function(){if(!this.paramObj.moduleMain.napeEngine.play)return void this.gan.stop();0==this.speed||this.gan.playing||this.gan.play(),this.ballIsMove&&(this.ball.y=90*Math.sin(this.ang),this.ang+=.1,this.tanhuang.height=this.tanhuang.y-this.ball.y),this.createDot(),this.updateDot()}},{key:"createDot",value:function(){if(this.ballIsMove){var t=new PIXI.Graphics;t.beginFill(16711680),t.drawCircle(0,0,2),t.endFill(),t.x=this.ball.x,t.y=this.ball.y,this.dotCon.addChild(t),this.vec.push(t)}}},{key:"updateDot",value:function(){if(this.haveSpeed)for(var t=0;this.vec.length>t;t++)(this.vec[t].x+=this.speed)>210&&(this.dotCon.removeChild(this.vec[t]),this.vec.splice(t,1),t--)}},{key:"btn1Click",value:function(t){switch(t.target.name){case"speed1":this.speed=this.SPED1,this.haveSpeed=!0,this.ballIsMove&&this.gan.play(),this.gan.animationSpeed=.1;break;case"speed2":this.speed=this.SPED2,this.haveSpeed=!0,this.ballIsMove&&this.gan.play(),this.gan.animationSpeed=.3;break;case"stopBtn":this.speed=0,this.haveSpeed=!1,this.gan.stop();break;case"startBtn":this.haveSpeed&&this.gan.play(),this.ang=Math.asin(this.ball.y/90),this.ballIsMove=!0,this.removeChild(this.tishi),this.removeChild(this.startBtn),this.removeChild(this.line),this.removeChild(this.jiandao)}}},{key:"selectRenderChild",value:function(){return this.bg.getBounds()}},{key:"hideTips",value:function(){this.tishi.visible=!1}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function P(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:P(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(1072),p=o(d),y=i(609),f=o(y),g=i(513),b=o(g),v=void 0,_=void 0,m=void 0,x=void 0,w=void 0,k=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return v=i.phy.nape,_=v.NbBody,m=v.phys.BodyType,x=v.shape.Polygon,w=v.geom.Vec2,k=v.phys.Compound,i.l1txt=null,i.l2txt=null,i.ganBody=null,i.ganJoint=null,i.diaoLineLen=170,i.armLeft=-155,i.armRight=155,i.leftHock=null,i.rightHock=null,i.leftJoint=null,i.rightJoint=null,i.hockLine=new PIXI.Graphics,i.angLine=new PIXI.Graphics,i.angTxt=new PIXI.Text("",{font:"25px Arial",fill:16750848}),i.angTxt2=new PIXI.Text("",{font:"25px Arial",fill:16750848}),i.angTxt3=new PIXI.Text("",{font:"25px Arial",fill:16750848}),i.armLine=new PIXI.Graphics,i.defshowAng=!0,i.ganpos=.5,i.ganW=0,i.ganMass=30,i.isTiaoing=!1,i.tpTimer=0,i.tpStep=0,i.balancePL=0,i.balancePR=0,i.balancePGra=new PIXI.Graphics,i.showArm=!0,i.canLeveling=!0,i.compo=new k,i}return a(e,t),r(e,[{key:"init",value:function(){this.removeChild(this.tst),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_type(m.get_KINEMATIC()),this.body.userData.dragtranslate=!0,this.compo.set_space(this.body.get_space()),this.body.set_compound(this.compo),this.angLine.addChild(this.angTxt),this.angTxt.x=15,this.angTxt.y=45,this.angLine.addChild(this.angTxt2),this.angLine.addChild(this.angTxt3),this.bg.addChild(this.angLine),this.ganW=this.gan.width,this.gan.addChildAt(this.hockLine,0),this.addChildAt(this.armLine,0),this.addChild(this.balancePGra),this.initGan(),this.initLeftArm(),this.initRightArm(),this.createDragFeild(),this.addCursor(this.gan.leftDrag,"zuoyou"),this.addCursor(this.gan.rightDrag,"zuoyou")}},{key:"removed",value:function(){clearTimeout(this.tpTimer),this.removedCursor(this.gan.leftDrag),this.removedCursor(this.gan.rightDrag),l.M.removeTouch(this.gan.leftDrag,this.leftTouchId),l.M.removeTouch(this.gan.rightDrag,this.rightTouchId),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this),this.leftHock.removed(),this.rightHock.removed(),this.BodyUtil.destoryBody(this.ganBody),this.leftHock.destroy(),this.rightHock.destroy()}},{key:"translateMove",value:function(t,e){this.compo.translate(w.get(t,e))}},{key:"createDragFeild",value:function(){this.body.get_shapes().clear(),this.body.add(new x(x.box(200,100))),this.body.userData.dragLevel=-2,this.body.sensorEnabled(!0)}},{key:"initLeftArm",value:function(){function t(t){o=l.M.getMouseXY(t),this.ganBody.userData.noDrag=!0,this.balancePGra.visible=!0,this.updateBalanceP(),this.drawBalanceP(this.balancePL)}function e(t){var e=l.M.getMouseXY(t);this.gan.leftDrag.x+=e.x-o.x;var i=.5*this.ganW;25-i>this.gan.leftDrag.x?this.gan.leftDrag.x=25-i:this.gan.leftDrag.x>i-25&&(this.gan.leftDrag.x=i-25),this.armLeft=this.gan.leftDrag.x,this.refreshArmLeft(),this.freshLibPan(),o=e,this.updateBalanceP(),this.drawBalanceP(this.balancePL)}function i(t){this.ganBody.userData.noDrag=!1,this.balancePGra.visible=!1;var e=this.gan.L1.x-this.balancePL;(e||0===e)&&15>Math.abs(e)&&(this.armLeft=this.balancePL,this.refreshArmLeft())}this.leftHock=new p["default"](this.paramObj),this.leftHock.init(),this.leftHock.body.set_position(w.get(this.ganBody.posx+this.armLeft,this.ganBody.posy+this.diaoLineLen)),this.leftJoint=this.JointUtil.createDistanceJoint(this.ganBody,this.leftHock.body,w.get(this.leftHock.body.posx,this.ganBody.posy),this.leftHock.body.position,this.diaoLineLen,this.diaoLineLen),this.leftJoint.stiff=!0,this.leftHock.body.set_compound(this.compo),this.leftJoint.set_compound(this.compo),this.refreshArmLeft(),this.leftTouchId=l.M.addTouch(this.gan.leftDrag,{begin:t,move:e,end:i},this);var o=void 0}},{key:"drawBalanceP",value:function(t){if(this.balancePGra.clear(),t||0===t){var e=this.toLocal(new l.Point(t,0),this.gan);this.balancePGra.lineStyle(1,65280,1),this.balancePGra.beginFill(16711680,.3),this.balancePGra.drawCircle(e.x,e.y,15),this.balancePGra.endFill()}}},{key:"initRightArm",value:function(){function t(t){o=l.M.getMouseXY(t),this.ganBody.userData.noDrag=!0,this.balancePGra.visible=!0,this.updateBalanceP(),this.drawBalanceP(this.balancePR)}function e(t){var e=l.M.getMouseXY(t);this.gan.rightDrag.x+=e.x-o.x,this.gan.rightDrag.x>.5*this.ganW-25?this.gan.rightDrag.x=.5*this.ganW-25:25-.5*this.ganW>this.gan.rightDrag.x&&(this.gan.rightDrag.x=25-.5*this.ganW),this.armRight=this.gan.rightDrag.x,this.refreshArmRight(),this.freshLibPan(),o=e,this.updateBalanceP(),this.drawBalanceP(this.balancePR)}function i(t){this.ganBody.userData.noDrag=!1,this.balancePGra.visible=!1;var e=this.gan.L2.x-this.balancePR;(e||0===e)&&15>Math.abs(e)&&(this.armRight=this.balancePR,this.refreshArmRight())}this.rightHock=new p["default"](this.paramObj),this.rightHock.init(),this.rightHock.body.set_position(w.get(this.ganBody.posx+this.armRight,this.ganBody.posy+this.diaoLineLen)),this.rightJoint=this.JointUtil.createDistanceJoint(this.ganBody,this.rightHock.body,w.get(this.rightHock.body.posx,this.ganBody.posy),this.rightHock.body.position,this.diaoLineLen,this.diaoLineLen),this.rightJoint.stiff=!0,this.rightHock.body.set_compound(this.compo),this.rightJoint.set_compound(this.compo),this.refreshArmRight(),this.rightTouchId=l.M.addTouch(this.gan.rightDrag,{begin:t,move:e,end:i},this);var o=void 0}},{key:"initGan",value:function(){this.ganBody=new _;var t=new x(x.box(this.ganW,25));t.set_sensorEnabled(!0),this.ganBody.add(t),this.addBodyToSpace(this.ganBody,this.parent),this.ganBody.set_position(w.get(this.x+this.gan.x,this.y+this.gan.y)),this.parent.addChildAt(this.gan,0),this.gan.x+=this.x,this.gan.y+=this.y,this.ganBody.userData.view=this.gan,this.ganBody.set_gravMass(this.ganMass),this.ganBody.set_compound(this.compo),this.ganJoint=this.JointUtil.createPivotJoint(this.body,this.ganBody,this.ganBody.position,this.ganBody.position);var e=this.JointUtil.createAngleJoint(this.ganBody,this.body,.4*-Math.PI,.4*Math.PI,1);e.set_stiff(!1),this.ganJoint.set_compound(this.compo),e.set_compound(this.compo)}},{key:"update",value:function(){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),!this.leftHock.useing){var t=this.leftJoint.get_anchor1(),i=this.ganBody.localPointToWorld(t),o=this.leftHock.body.get_position();o.set_x(i.get_x()),this.leftHock.body.set_position(o)}if(!this.rightHock.useing){var n=this.rightJoint.get_anchor1(),s=this.ganBody.localPointToWorld(n),a=this.rightHock.body.get_position();a.set_x(s.get_x()),this.rightHock.body.set_position(a)}this.updateTransform(),this.drawArmLine(),this.drawAngTxt(),this.armLine.clear(),this.getL1(),this.getL2()}},{key:"drawAngTxt",value:function(){if(this.angLine.visible){var t=this.getMain(),e=new l.Point(0,115),i=new l.Point(0,e.y-30),o=l.Point.vec2ToPoint(this.ganBody.localPointToWorld(this.ganJoint.anchor2.sub(w.get(-30,0))));o=this.bg.toLocal(o,t.view),this.angLine.clear(),this.drawAngle(e,i,o,this.angTxt);var n=l.Point.vec2ToPoint(this.leftHock.body.get_position());n=this.angLine.toLocal(n,t.view);this.drawAngle(this.angLine.toLocal(new PIXI.Point(this.armLeft,0),this.gan),n,this.angLine.toLocal(new PIXI.Point(1.5*this.armLeft,0),this.gan),this.angTxt2);var s=l.Point.vec2ToPoint(this.rightHock.body.get_position());s=this.angLine.toLocal(s,t.view);this.drawAngle(this.angLine.toLocal(new PIXI.Point(this.armRight,0),this.gan),s,this.angLine.toLocal(new PIXI.Point(1.5*this.armRight,0),this.gan),this.angTxt3)}}},{key:"getAnticlockwise",value:function(t,e){return!(e-t>=0&&e-t<=Math.PI||e-t<=-Math.PI)}},{key:"drawAngle",value:function(t,e,i,o){var n=new l.Point(e.x-t.x,e.y-t.y);n.normalize(30);var s=new l.Point(i.x-t.x,i.y-t.y);s.normalize(30),e=new l.Point(t.x+n.x,t.y+n.y),i=new l.Point(t.x+s.x,t.y+s.y);var a=Math.atan2(e.y-t.y,e.x-t.x),r=Math.atan2(i.y-t.y,i.x-t.x);this.angLine.lineStyle(2,16750848),this.angLine.moveTo(e.x,e.y),this.angLine.arc(t.x,t.y,30,a,r,this.getAnticlockwise(a,r));var h=l.M.getAngleByP(t,e,i);o.text=Math.ceil(h)+"°";var u=l.M.getDuiDianP(t,e,i);o.x=u.x-o.width/2,o.y=u.y-o.height/2}},{key:"drawArmLine",value:function(){var t=this.getMain();this.hockLine.clear(),this.hockLine.lineStyle(3,16750848);var e=l.Point.vec2ToPoint(this.leftHock.body.get_position());e=this.gan.toLocal(e,t.view),this.hockLine.moveTo(this.armLeft,0),this.hockLine.lineTo(e.x,e.y),this.gan.leftDrag.rotation=Math.atan2(e.y,e.x-this.armLeft)-.5*Math.PI;var i=l.Point.vec2ToPoint(this.rightHock.body.get_position());i=this.gan.toLocal(i,t.view),this.hockLine.moveTo(this.armRight,0),this.hockLine.lineTo(i.x,i.y),this.gan.rightDrag.rotation=Math.atan2(i.y,i.x-this.armRight)-.5*Math.PI,this.hockLine.lineStyle(3,16750848,0),this.hockLine.moveTo(this.armLeft,0),this.hockLine.lineTo(e.x,e.y),this.hockLine.moveTo(this.armRight,0),this.hockLine.lineTo(i.x,i.y)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.ganRot=this.ganBody.rotation,t.showAng=this.defshowAng,t.ganMass=this.ganMass+"g",t.ganpos=this.ganpos,t.armL=this.armLeft,t.armR=this.armRight,t.left={x:this.leftHock.body.posx,y:this.leftHock.body.posy},t.right={x:this.rightHock.body.posx,y:this.rightHock.body.posy},t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.ganMass&&(this.changeGanMass({showValue:t.ganMass}),this.changeGanPosition({showValue:t.ganpos}),this.hideShowAng({checked:t.showAng}),this.ganBody.rotation=t.ganRot,this.armLeft=t.armL,this.armRight=t.armR,this.refreshArmLeft(),this.refreshArmRight(),this.leftHock.body.set_position(w.get(t.left.x,t.left.y)),this.rightHock.body.set_position(w.get(t.right.x,t.right.y)),this.BodyUtil.frezzBody(this.leftHock.body),this.BodyUtil.frezzBody(this.rightHock.body))}},{key:"hideShowAng",value:function(t){this.defshowAng=t.checked,this.angLine.visible=this.defshowAng}},{key:"changeShowArm",value:function(t){this.showArm=t.checked,this.l2txt.visible=this.showArm,this.l1txt.visible=this.showArm,this.armLine.visible=this.showArm}},{key:"changeGanMass",value:function(t){this.ganMass=l.M.getNumStr(t.showValue)-0,this.ganBody.set_gravMass(this.ganMass)}},{key:"changeGanPosition",value:function(t){var e=l.M.getNumStr(t.showValue)-0;this.ganpos=e;this.ganJoint.anchor2=w.get(-.5*this.ganW+25+(this.ganW-50)*e,0)}},{key:"refreshArmLeft",value:function(){this.gan.leftDrag.x=this.armLeft,this.leftJoint.anchor1=w.get(this.armLeft,0),this.gan.L1.x=this.armLeft}},{key:"refreshArmRight",value:function(){this.gan.rightDrag.x=this.armRight,this.rightJoint.anchor1=w.get(this.armRight,0),this.gan.L2.x=this.armRight}},{key:"getL1",value:function(){var t=this.ganW,e=this.ganBody.localPointToWorld(this.ganJoint.anchor2),i=this.ganBody.localPointToWorld(this.leftJoint.get_anchor1()),o=this.leftHock.body.localPointToWorld(this.leftJoint.get_anchor2()),n=new l.Point(e.get_x(),e.get_y()),s=new l.Point(i.get_x(),i.get_y()),a=new l.Point(o.get_x(),o.get_y()),r=l.M.getGaoDianFrom3Dian(n,s,a),h=l.Point.distance(r,n),u=h/t*100;this.l1txt.text="L1 = "+l.M.getNumJie(u,1)+"cm";var c=this.toLocal(n,this.getMain().view),d=this.toLocal(r,this.getMain().view),p=this.toLocal(s,this.getMain().view);this.l1txt.x=(d.x+c.x)/2-this.l1txt.width/2,this.l1txt.y=(d.y+c.y)/2-this.l1txt.height,this.armLine.lineStyle(2,13487565,1),this.armLine.moveTo(c.x,c.y),this.armLine.lineTo(d.x,d.y);var y=new l.Point(d.x+.3*(d.x-p.x),d.y+.3*(d.y-p.y));return l.M.drawDashed(this.armLine,p,y,10,5),this.drawRightAngle(this.armLine,13487565,10,c,d,p),l.M.getNumJie(u,1)+"cm"}},{key:"getL2",value:function(){var t=this.ganW,e=this.ganBody.localPointToWorld(this.ganJoint.anchor2),i=this.ganBody.localPointToWorld(this.rightJoint.get_anchor1()),o=this.rightHock.body.localPointToWorld(this.rightJoint.get_anchor2()),n=new l.Point(e.get_x(),e.get_y()),s=new l.Point(i.get_x(),i.get_y()),a=new l.Point(o.get_x(),o.get_y()),r=l.M.getGaoDianFrom3Dian(n,s,a),h=l.Point.distance(r,n),u=h/t*100;this.l2txt.text="L2 = "+l.M.getNumJie(u,1)+"cm";var c=this.toLocal(n,this.getMain().view),d=this.toLocal(r,this.getMain().view),p=this.toLocal(s,this.getMain().view);this.l2txt.x=(d.x+c.x)/2-this.l2txt.width/2,this.l2txt.y=(d.y+c.y)/2-this.l2txt.height,this.armLine.lineStyle(2,13487565,1),this.armLine.moveTo(c.x,c.y),this.armLine.lineTo(d.x,d.y);var y=new l.Point(d.x+.3*(d.x-p.x),d.y+.3*(d.y-p.y));return l.M.drawDashed(this.armLine,p,y,10,5),this.drawRightAngle(this.armLine,13487565,10,c,d,p),l.M.getNumJie(u,1)+"cm"}},{key:"drawRightAngle",value:function(t,e,i,o,n,s){var a=new l.Point(o.x-n.x,o.y-n.y),r=new l.Point(s.x-n.x,s.y-o.y);a.normalize(i),r.normalize(i);var h=new l.Point(n.x+a.x+r.x,n.y+a.y+r.y),u=new l.Point(n.x+a.x,n.y+a.y),c=new l.Point(n.x+r.x,n.y+r.y);t.lineStyle(2,e,1),t.moveTo(u.x,u.y),t.lineTo(h.x,h.y),t.lineTo(c.x,c.y)}},{key:"changeL2",value:function(t){this.armRight=this.calcArmPosition(l.M.getNumStr(t.showValue)-0),this.refreshArmRight(),this.freshLibPan()}},{key:"calcArmPosition",value:function(t){var e=-.5*this.ganW+25,i=.5*this.ganW-25,o=this.ganW,n=t/100*o,s=this.ganJoint.get_anchor2(),a=s.get_x()+n;return a>i?a=i:e>a&&(a=e),a}},{key:"changeL1",value:function(t){this.armLeft=this.calcArmPosition(l.M.getNumStr(t.showValue)-0),this.refreshArmLeft(),this.freshLibPan()}},{key:"getConnectHockMass",value:function(t){for(var e=t.body.connectedBodies(1),i=0,o=[this.ganBody];2==e.get_length();){var n=e.at(0),s=e.at(1);-1===o.indexOf(n)?(i+=n.get_mass(),o.push(n),e=n.connectedBodies(1)):(i+=s.get_mass(),o.push(s),e=s.connectedBodies(1))}return i}},{key:"updateBalanceP",value:function(){if(this.balancePL=null,this.balancePR=null,this.checkLink()){var t=this.getConnectHockMass(this.leftHock),e=this.getConnectHockMass(this.rightHock),i=this.ganJoint.get_anchor2(),o=this.armLeft-i.get_x(),n=this.armRight-i.get_x(),s=this.ganMass,a=this.ganW/2,r=-a-i.get_x(),h=a-i.get_x(),l=s*Math.abs(r)/this.ganW*(.5*r),u=s*Math.abs(h)/this.ganW*(.5*h),c=-(t*o+l+u)/e,d=-(e*n+u+l)/t;this.balancePL=i.get_x()+d,this.balancePR=i.get_x()+c}}},{key:"tpL",value:function(){if(!this.isTiaoing&&(this.updateBalanceP(),(this.balancePL||0===this.balancePL)&&(this.balancePR||0===this.balancePR))){var t=(this.ganJoint.get_anchor2(),-.5*this.ganW+25),e=.5*this.ganW-25,i=this.balancePL,o=this.balancePR;t>i||i>e?t>o||o>e?(t>i?i=t:i>e&&(i=e),this.armLeft=i,this.refreshArmLeft(),this.tpL(null)):(this.armRight=o,this.refreshArmRight(),this.freshLibPan()):(this.armLeft=i,this.refreshArmLeft(),this.freshLibPan())}}},{key:"checkLink",value:function(){if(!this.leftHock.useing||!this.rightHock.useing)return!1;var t=this.leftHock.hock.get_userData().bind,e=this.rightHock.hock.get_userData().bind;if(!t||!e)return!1;var i=t.get_body().userData.view,o=e.get_body().userData.view;return(i instanceof f["default"]||i instanceof b["default"])&&(o instanceof f["default"]||o instanceof b["default"])}},{key:"revertHorizantol",value:function(){this.ganBody.rotation=0;var t=this.ganBody.localPointToWorld(this.leftJoint.anchor1);this.leftHock.body.set_position(w.get(t.get_x(),this.ganBody.posy+this.diaoLineLen)),this.BodyUtil.frezzBody(this.leftHock.body);var e=this.ganBody.localPointToWorld(this.rightJoint.anchor1);this.rightHock.body.set_position(w.get(e.get_x(),this.ganBody.posy+this.diaoLineLen)),this.BodyUtil.frezzBody(this.rightHock.body)}},{key:"getleftDis",value:function(){var t=this.ganW,e=this.ganJoint.get_anchor2(),i=this.gan.leftDrag.x-e.get_x(),o=i/t*100;return Math.round(10*o)/10}},{key:"getrightDis",value:function(){var t=this.ganW,e=this.ganJoint.get_anchor2(),i=this.gan.rightDrag.x-e.get_x(),o=i/t*100;return Math.round(10*o)/10}},{key:"clickLeveling",value:function(){this.tpL()}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getSwitch(this.language.getLocaleStr("show_angle"),this.defshowAng,this.hideShowAng,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("show_force_arm"),this.showArm,this.changeShowArm,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("rod_mass"),!0,"g",100,0,this.ganMass+"g",1,this.changeGanMass,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("rod_position"),!0,"",1,0,this.ganpos,.01,this.changeGanPosition,this),this.ComponentProperty.getTextInput("OA",this.getleftDis(),"cm",this.changeL1,this),this.ComponentProperty.getTextInput("OB",this.getrightDis(),"cm",this.changeL2,this)),t}},{key:"getLocalBoundsElecs",value:function(){return[this.bg,this.gan]}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function k(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:k(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(609),p=o(d),y=i(513),f=o(y),g=void 0,b=void 0,v=void 0,_=void 0,m=void 0,x=void 0,w=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return g=i.phy.nape,b=g.NbBody,v=g.phys.BodyType,_=g.shape.Polygon,m=g.geom.Vec2,x=g.phys.Compound,w=g.shape.HockShapeBase,i.level=13,i.rulerBody=null,i.hockArr=[],i.onekeyph=!1,i.s1=null,i.s2=null,i.compo=null,i.leftTouchid=null,i.rightTouchid=null,i.pj=null,i.patternValueArr=["均匀","不均匀"],i.patternIndex=0,i.normalShape=null,i.notNormalShape=null,i.prePos=null,i.pointIndex=0,i.pointValueArr=["中心","重心"],i.zxX=25.588461538461566,i.zxY=-2.6923076923076943,i.kdmask=new PIXI.Graphics,i.canLeveling=!0,i}return a(e,t),r(e,[{key:"init",value:function(){this.points=[{x:-99,y:152},{x:-122,y:264.95},{x:119,y:264.95},{x:92,y:152},{x:14,y:152},{x:14,y:-296.95},{x:-17,y:-296.95},{x:-17,y:152}],h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_type(v.get_KINEMATIC()),this.body.sensorEnabled(!0),this.body.userData.dragtranslate=!0,this.compo=new x,this.compo.set_space(this.body.get_space()),this.body.set_compound(this.compo),this.initRulerBody(),this.initHock(),this.initLun(),this.initSpring(),this.BodyUtil.setBodyFilter(this.rulerBody,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.addCursor(this.rule.leftlun,"shangxia"),this.addCursor(this.rule.rightlun,"shangxia"),this.kdmask.beginFill(0,.5),this.kdmask.drawRect(-335,-36,670,72),this.kdmask.endFill(),this.rule.addChild(this.kdmask),this.rule.kd.mask=this.kdmask}},{key:"translateMove",value:function(t,e){this.compo.translate(m.get(t,e))}},{key:"initSpring",value:function(){var t=m.get(this.rulerBody.posx-300,this.rulerBody.posy-100),e=m.get(this.rulerBody.posx-300,this.rulerBody.posy),i=m.get(this.rulerBody.posx+300,this.rulerBody.posy-100),o=m.get(this.rulerBody.posx+300,this.rulerBody.posy),n=this.JointUtil.createDistanceJoint(this.body,this.rulerBody,t,e,100,100),s=this.JointUtil.createDistanceJoint(this.body,this.rulerBody,i,o,100,100);n.frequency=.3,s.frequency=.3,n.damping=.3,s.damping=.3,n.stiff=!1,s.stiff=!1,n.set_compound(this.compo),s.set_compound(this.compo)}},{key:"initLun",value:function(){function t(t){this.rulerBody.userData.noDrag=!0;var e=this.getMouseXY(t);this.s1.contains(m.get(e.x,e.y))&&(o=this.rule.leftlun),this.s2.contains(m.get(e.x,e.y))&&(o=this.rule.rightlun),n=e}function e(t){if(this.onekeyph=!1,null!=o){var e=this.getMouseXY(t);0>e.x-n.x?o.x-=1:o.x+=1,n=e,"leftlun"==o.name?(o.x>-370&&(o.x=-370),-450>o.x&&(o.x=-450)):(370>o.x&&(o.x=370),o.x>450&&(o.x=450)),this.s1.set_localCOM(m.get(this.rule.leftlun.x,0)),this.s2.set_localCOM(m.get(this.rule.rightlun.x,0))}}function i(t){this.rulerBody.userData.noDrag=!1}this.rule.leftlun.x=-370-80*Math.random(),this.rule.rightlun.x=370+80*Math.random(),this.s1=new _(_.box(40,40)),this.s2=new _(_.box(40,40)),this.BodyUtil.setShapeMass(this.s1,30),this.BodyUtil.setShapeMass(this.s2,30),this.rulerBody.add(this.s1),this.rulerBody.add(this.s2),this.s1.set_sensorEnabled(!0),this.s2.set_sensorEnabled(!0),this.s1.set_localCOM(m.get(this.rule.leftlun.x,0)),this.s2.set_localCOM(m.get(this.rule.rightlun.x,0)),this.leftTouchid=l.M.addTouch(this.rule.leftlun,{begin:t,move:e,end:i},this),this.rightTouchid=l.M.addTouch(this.rule.rightlun,{begin:t,move:e,end:i},this);var o=void 0,n=null}},{key:"initHock",value:function(){var t=0,e=[this.CbTypeStr.SPRING_HOCK,this.CbTypeStr.HOOK_TOP_GOU];for(t=0;5>t;t++){var i=new w(12);i.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.rulerBody.add(i),i.translate(m.weak(-60.3*(t+1)-2,22)),i.addCbtype(this.CbTypeStr.LEVER_HOOK_GOU),this.addTweenQuan(i);var o=new w(12);o.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.rulerBody.add(o),o.translate(m.get(60.3*(t+1)-2,22)),o.addCbtype(this.CbTypeStr.LEVER_HOOK_GOU),this.hockArr.push(i,o),i.createListener(this.CbTypeStr.LEVER_HOOK_GOU,e),o.createListener(this.CbTypeStr.LEVER_HOOK_GOU,e),this.addTweenQuan(o)}}},{key:"initRulerBody",value:function(){this.rulerBody=new b;var t=new _(_.box(680,68));this.normalShape=t,t.set_sensorEnabled(!0),this.rulerBody.add(t),this.rulerBody.userData.view=this.rule,this.rulerBody.userData.notHockDrag=!0,this.addBodyToSpace(this.rulerBody,this.parent),this.rulerBody.set_compound(this.compo);var e=m.get(this.x+this.rule.x,this.y+this.rule.y);this.parent.addChild(this.rule),this.rule.x=e.get_x(),this.rule.y=e.get_y(),this.rulerBody.set_position(e),this.pj=this.JointUtil.createPivotJoint(this.rulerBody,this.body,e,e),this.pj.ignore=!1,this.pj.stiff=!1,this.pj.damping=8;var i=30*Math.PI/180;this.angleJoint=this.JointUtil.createAngleJoint(this.rulerBody,this.body,-i,i,1),this.angleJoint.set_frequency(1e5),this.angleJoint.set_stiff(!1),this.BodyUtil.setBodyFilter(this.rulerBody,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.pj.set_compound(this.compo),this.angleJoint.set_compound(this.compo)}},{key:"removed",value:function(){this.removedCursor(this.rule.leftlun),this.removedCursor(this.rule.rightlun),this.compo.breakApart(),this.compo.set_space(null),l.M.removeTouch(this.rule.leftlun,this.leftTouchid),l.M.removeTouch(this.rule.rightlun,this.rightTouchid);var t=0;for(t=0;this.hockArr.length>t;t++)this.hockArr[t].dragToolClick(),this.hockArr[t].dispose();this.BodyUtil.destoryBody(this.rulerBody),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"changePingHeng",value:function(t){this.rule.leftlun.x=-380,this.rule.rightlun.x=380,this.s1.set_localCOM(m.get(-380,0)),this.s2.set_localCOM(m.get(380,0)),this.onekeyph=!0}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.onekeyph=this.onekeyph,t.patternIndex=this.patternIndex,t.rulerBodyRot=this.rulerBody.get_rotation(),t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),1==t.onekeyph&&this.changePingHeng({checked:!0}),t.rulerBodyRot&&(this.rulerBody.rotation=t.rulerBodyRot),isNaN(t.patternIndex)||t.patternIndex==this.patternIndex||this.changePattern({showValue:this.patternValueArr[t.patternIndex]},!0)}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this);for(var t=this.hockArr.length,i=0;t>i;i++){var o=this.hockArr[i];if(o.get_userData().useing){var n=o.get_userData().bind;if(n&&n.get_body()&&n.get_body().userData.view){var s=n.get_body().userData.view;if(s instanceof p["default"]||s instanceof f["default"]){s.body.get_allowRotation()||s.body.set_allowRotation(!0)}}}}}},{key:"hideHock",value:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,i=0;if(t){var o=this.hockArr.length;for(i=0;o>i;i++){var n=this.hockArr[i];n.dragToolClick(),n.set_localCOM(m.weak(0,0)),this.rulerBody.remove(n)}}else{var s=0;for(i=0;10>i;i++){var a=this.hockArr[i],r=this.hockArr[i+1];this.rulerBody.add(a),this.rulerBody.add(r),a.translate(m.get(-60.3*(s+1)-2+e,22)),r.translate(m.get(60.3*(s+1)-2+e,22)),i++,s++}}}},{key:"changePattern",value:function(t,e){var i=t.checked;this.patternIndex!==i&&(this.hideHock(!0),0===i?(this.rulerBody.add(this.normalShape),this.rulerBody.remove(this.notNormalShape),this.rulerBody.align(),this.rulerBody.add(this.s1),this.rulerBody.add(this.s2),this.rule.pivot.x=0,this.rule.pivot.y=0,this.rule.kd.x=0,this.hideHock(!1),this.onekeyph=!1,this.pointIndex=0):(this.changePingHeng({checked:!0}),this.notNormalShape=new _([m.weak(-338.95,-50),m.weak(-338.95,54),m.weak(340,36),m.weak(340,-29)]),this.notNormalShape.set_sensorEnabled(!0),this.rulerBody.add(this.notNormalShape),this.rulerBody.remove(this.normalShape),this.rulerBody.remove(this.s1),this.rulerBody.remove(this.s2),this.hideHock(!1))),this.patternIndex=i,this.rule.mc.gotoAndStop(i),e||this.freshLibPan()}},{key:"changePointZhe",value:function(t){var e=t.checked;this.pointIndex=e,0==e?(this.hideHock(!0),this.notNormalShape.translate(m.weak(-this.zxX,-this.zxY)),this.hideHock(!1),this.rule.pivot.x=0,this.rule.pivot.y=0,this.rule.kd.x=0,this.rule.mc.gotoAndStop(1)):(this.hideHock(!0),this.rulerBody.align(),this.hideHock(!1),this.rule.pivot.x=-this.zxX,this.rule.pivot.y=-this.zxY,this.rule.kd.x=-this.zxX,this.rule.mc.gotoAndStop(2))}},{key:"clickLeveling",value:function(){this.changePingHeng()}},{key:"getConf",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr=[],this.patternValueArr=[this.language.getLocaleStr("uniformity"),this.language.getLocaleStr("inhomogeneity")],this.pointValueArr=[this.language.getLocaleStr("core"),this.language.getLocaleStr("barycenter")],0===this.patternIndex?t.confArr.push(this.ComponentProperty.getRadio(this.language.getLocaleStr("pattern"),this.patternIndex,this.patternValueArr,this.changePattern,this)):t.confArr.push(this.ComponentProperty.getRadio(this.language.getLocaleStr("pattern"),this.patternIndex,this.patternValueArr,this.changePattern,this),this.ComponentProperty.getRadio(this.language.getLocaleStr("zdwz"),this.pointIndex,this.pointValueArr,this.changePointZhe,this)),t}},{key:"getLocalBoundsElecs",value:function(){return[this,this.rule]}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function C(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:C(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(49),c=i(543),d=o(c),p=i(446),y=o(p),f=void 0,g=void 0,b=void 0,v=void 0,_=void 0,m=void 0,x=void 0,w=void 0,k=void 0,P=void 0,O=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return f=i.phy.nape,g=f.NbBody,b=f.phys.BodyType,v=f.geom.Vec2,_=f.shape.Polygon,m=f.callbacks.CbType,x=f.callbacks.InteractionType,w=f.callbacks.PreListener,k=f.callbacks.PreFlag,P=f.phys.Material,O=f.dynamics.ArbiterType,i.liqAlpha=.3,i.maskShape=null,i.selfmass=10,i.valueTxtxy={x:122,y:-284},i.WIDTH=106,i.HEIGHT=582,i.liquidW=212,i.totalRange=60,i.fullH=582,i.unitMl=0,i.boty=291,i.poshapexy={x:103,y:-300},i.pourxy={x:-2,y:-300},i.canPour=!0,i.barxy={x:130,y:-270},i.hasAo=!1,i.islock=!1,i.canIgnoreBuoyancy=!0,i.dragRects=[new l.Rectangle(4,-289,97,578),new l.Rectangle(-102,-173,113,58),new l.Rectangle(-102,-3,113,58)],i.liquidType=new m,i.rubberFilmArr=[],i.mlArr=["0mL","20mL","30mL","40mL","50mL","60mL"],i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_isBullet(!0),this.body.noallowRotation=!0,this.body.userData.cannotToolRot=!0,this.onPreCallBack=function(e){return t.onPre(e)},this.preListener=new w(x.get_ANY(),m.get_ANY_BODY(),this.liquidType,this.onPreCallBack),this.addNapeListeners(this.preListener),this.changeLock({checked:this.islock});var i=new T(this.paramObj,this,97,4,0),o=new T(this.paramObj,this,58,4,1),n=new T(this.paramObj,this,58,4,1),s=function(e,i){return t.body.localPointToWorld(v.get(e,i))},a=new l.Point(53,288);i.fixedTo(this.body,s(a.x,a.y-40),s(a.x,a.y),s(a.x,a.y+40));var r=new l.Point(-100,-144);o.fixedTo(this.body,s(r.x-30,r.y),s(r.x,r.y),s(r.x,r.y+30));var u=new l.Point(-100,26);n.fixedTo(this.body,s(u.x-30,u.y),s(u.x,u.y),s(u.x+30,u.y)),this.rubberFilmArr=[{mec:i,shape1:null,shape2:null,p1:new l.Point(8,288),p2:new l.Point(98,288)},{mec:o,shape1:null,shape2:null,p1:new l.Point(-100,-170),p2:new l.Point(-100,-118)},{mec:n,shape1:null,shape2:null,p1:new l.Point(-100,-0),p2:new l.Point(-100,52)}],this.skinGra=new PIXI.Graphics,this.addChild(this.skinGra),this.refreshRubberFilms()}},{key:"removed",value:function(){this.removeNapeListeners(this.preListener),this.onPreCallBack=null,this.rubberFilmArr.forEach(function(t){var e=t.mec;e.removeBodyFromSpace(e.body)}),this.rubberFilmArr=null,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"refreshRubberFilms",value:function(){var t=this,e=this.skinGra;e.clear(),e.lineStyle(1,12480029,1),this.rubberFilmArr.forEach(function(i){i.shape1&&t.body.remove(i.shape1),i.shape2&&t.body.remove(i.shape2);var o=i.mec,n=t.body.worldPointToLocal(o.body.get_position()),s=i.p1,a=new l.Point(n.get_x(),n.get_y()),r=i.p2,h=new l.Point(2*a.x-(s.x+r.x)/2,2*a.y-(s.y+r.y)/2);e.beginFill(12480029,1),e.moveTo(s.x,s.y),e.quadraticCurveTo(h.x,h.y,r.x,r.y),e.lineTo(r.x+1,r.y+1),e.lineTo(s.x+1,s.y+1),e.endFill();var u=function(t,e,i){var o=e.sub(t),n=new l.Point(o.y,-o.x);return n.normalize(i/2),[t.add(n),t.sub(n),e.sub(n),e.add(n)]};i.shape1=t.BodyUtil.createPolygonFromPoints(u(s,a,4),t.body),i.shape2=t.BodyUtil.createPolygonFromPoints(u(r,a,4),t.body)})}},{key:"update",value:function(){var t=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this);var i=this.liquid.get_bounds(),o=this.napeEngine.getGravity();this.rubberFilmArr.forEach(function(e){var n=e.mec,s=n.shape.get_bounds(),a=s.get_max().get_y()-i.get_min().get_y();if(a>0){n.f=t.liquid.density*o*a}}),this.rubberFilmArr.forEach(function(e){var i=e.mec;i.body.get_arbiters().foreach(function(e){if(O.get_FLUID()===e.get_type()&&e.get_shape1()===i.shape){var n=e.get_shape2();if(n===t.liquid)return;var s=n.get_bounds(),a=i.shape.get_bounds(),r=(a.get_max().get_y(),a.get_min().get_y(),a.get_max().get_y()-s.get_min().get_y());i.f+=-n.density*o*r}}),i.applyForce()}),this.refreshRubberFilms()}},{key:"onPre",value:function(t){return this.ignoreBuoyancy(t.get_arbiter())?k.get_IGNORE():k.get_ACCEPT()}},{key:"createBodyShape",value:function(){var t=this;this.verticesArr=this.Vec2Util.pointArrArrToVec2ArrArr([[{x:1.6,y:-286.1},{x:5.2,y:-287.9},{x:9.2,y:-279.9},{x:5.6,y:-278.1}],[{x:5.4,y:-279},{x:9.4,y:-279},{x:9.4,y:-178},{x:5.4,y:-178}],[{x:6.2,y:-179.6},{x:8.6,y:-176.4},{x:-1.4,y:-168.4},{x:-3.8,y:-171.6}],[{x:-2.6,y:-172},{x:-2.6,y:-168},{x:-94.6,y:-169},{x:-94.6,y:-173}],[{x:-93.4,y:-172.6},{x:-95.8,y:-169.4},{x:-102.8,y:-174.4},{x:-100.4,y:-177.6}],[{x:99.7,y:-288.1},{x:103.1,y:-285.9},{x:98.1,y:-277.9},{x:94.7,y:-280.1}],[{x:94.4,y:-279},{x:98.4,y:-279},{x:98.4,y:279},{x:94.4,y:279}],[{x:94.9,y:280.3},{x:97.9,y:277.6},{x:104.9,y:285.6},{x:101.9,y:288.3}],[{x:1.8,y:289.4},{x:-1,y:286.5},{x:7,y:278.5},{x:9.8,y:281.4}],[{x:10.4,y:279.9},{x:6.4,y:280},{x:5.4,y:61},{x:9.4,y:61}],[{x:8.8,y:59.6},{x:6,y:62.4},{x:-3,y:53.4},{x:-.2,y:50.6}],[{x:-1.5,y:50},{x:-1.7,y:54},{x:-93.7,y:51},{x:-93.5,y:47}],[{x:-94.9,y:47.5},{x:-92.3,y:50.5},{x:-100.3,y:57.5},{x:-102.9,y:54.5}],[{x:-99.2,y:-111.6},{x:-102,y:-114.4},{x:-96,y:-120.4},{x:-93.2,y:-117.6}],[{x:-94.6,y:-117},{x:-94.6,y:-121},{x:-2.6,y:-121},{x:-2.6,y:-117}],[{x:-4.2,y:-117.8},{x:-1,y:-120.2},{x:6,y:-111.2},{x:2.8,y:-108.8}],[{x:2.4,y:-110},{x:6.4,y:-110},{x:8.4,y:-6},{x:4.4,y:-6}],[{x:5.2,y:-7.6},{x:7.6,y:-4.4},{x:-1.4,y:2.6},{x:-3.8,y:-.6}],[{x:-2.6,y:-1},{x:-2.6,y:3},{x:-96.6,y:4},{x:-96.6,y:0}],[{x:-95,y:.8},{x:-98.2,y:3.2},{x:-103.2,y:-3.8},{x:-100,y:-6.2}]]),this.material=new P(0,.5,.6,2.4,.001),this.createShape();var e=new P(0,1,2,0,.001);this.dragRects.forEach(function(i){var o=new _(_.rect(i.x,i.y,i.width,i.height),e);t.body.add(o),o.set_filter(t.InteractionFilterManager.LIQUID_ONLY_GROUP)})}},{key:"hasBuoyancyAtPoint",value:function(t){return-1!==(0,u.findIndex)(this.dragRects,function(e){return e.containsPoint(t)})}},{key:"drawLiquid",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"drawLiquid",this).call(this,t),this.liquidShape.mask=this.maskShape.getChildAt(0)}},{key:"createLiquid",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createLiquid",this).call(this,t),this.liquid.addCbtype(this.liquidType)}},{key:"drawScale",value:function(){}},{key:"changeLiquidVolume",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"changeLiquidVolume",this).call(this,t),0===this.liquidArea&&(this.liquidArea=1)}},{key:"changeWaterAlpha",value:function(t){var e=l.M.getNumStr(t.showValue)-0;this.liqAlpha=l.M.getNumJie(e,1)}},{key:"changeDensity",value:function(t){var e=l.M.getNumStr(t.showValue)-0;this.liquid.density=l.M.getNumJie(e,1)}},{key:"getData",value:function(){return h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this)}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t)}},{key:"getConf",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this),i=t.confArr;return i.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("liquid_density"),!0,"g/cm³",13.6,.7,this.liquid.density,.1,this.changeDensity,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("alpha"),!0,"",.5,.1,this.liqAlpha,.1,this.changeWaterAlpha,this),this.ComponentProperty.getDropMenu(this.language.getLocaleStr("water_yield"),!0,"mL",l.M.getNumJie(this.getCurtMl(),1)+"mL",this.mlArr,this,this.changeLiquidVolume,50,0)),i.push(i[0]),i.shift(),t.confArr.push(),t}},{key:"getLocalBoundsElecs",value:function(){return[this.bg]}}]),e}(d["default"]);var T=function(t){function e(t,i,o,a,r){n(this,e);var h=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return h.w=o,h.h=a,h.hw=h.w/2,h.hh=h.h/2,h.dir=r,h.spring1=null,h.initFlag=!1,h.shape=null,h.f=0,h.orimass=.1,h.mScale=20,h.dir?(h.fScale=2e-4,h.frequency=1):(h.fScale=.02,h.frequency=6),i.addChild(h),h.init(),h}return a(e,t),r(e,[{key:"init",value:function(){if(!this.initFlag){this.initFlag=!0,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.shapes.clear();var t=new _(_.box(8,8));this.body.add(t),this.shape=t,this.orimass=this.body.get_mass()}}},{key:"applyForce",value:function(){if(0===this.dir&&this.f>0)this.f*=this.fScale,this.body.set_mass(this.force2mass());else{this.body.set_mass(this.orimass),this.f*=this.fScale;this.body.applyImpulse(this.dir?v.get(-this.f,0):v.get(0,this.f))}this.f=0}},{key:"force2mass",value:function(){return this.f*this.mScale}},{key:"fixedTo",value:function(t,e,i,o){var n=this.dir?v.get(1,0):v.get(0,1);this.body.set_position(i),this.joint1=this.JointUtil.createLineJoint(t,this.body,e,i,n,0,v.distance(e,o)),this.joint2=this.JointUtil.createPivotJoint(t,this.body,i,i),this.joint2.set_stiff(!1),this.joint2.set_damping(.8),this.joint2.set_frequency(this.frequency)}},{key:"removed",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this)}}]),e}(y["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function g(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:g(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(507),p=o(d),y=void 0,f=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.phys.BodyType,i.caizhi=0,i.mcxs=[.4,.2,.6,.8],i.czi=[i.language.getLocaleStr("none"),i.language.getLocaleStr("glass"),i.language.getLocaleStr("cotton"),i.language.getLocaleStr("towel")],i.divisionValueArr=["1mm","5mm","1cm"],i.divisionIndex=0,i.level=13,i.flag=0,i.txtW_=130,i.txtH_=40,i.wenP1_=null,i.wenP2_=null,i.pointA=null,i.pointB=null,i.pointC=null,i.firP_=null,i.secP_=null,i.firstLineSP=null,i.secondLineSP=null,i.txt=null,i.txt2=null,i.txtLine=null,i.deflong=1050,i.curtlong=1050,i.middleBoard=null,i.glassmd=null,i.cottonmd=null,i.towelmd=null,i.firstConBody=null,i.isOpenTrack=!1,i.prevscale=1,i.curtf=i.mcxs[0],i.boardX=-525,i.kd=new p["default"](i.paramObj),i.glass=null,i.cotton=null,i.towel=null,i}return a(e,t),r(e,[{key:"removed",value:function(){this.kd.removed(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"init",value:function(){this.bg.removeChildren(),this.points=[{x:-513.95,y:-8},{x:-521.95,y:35},{x:523,y:35},{x:514,y:-8}],this.material.set_density(.6),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.canfixtool=!0,this.BodyUtil.setBodyMaterial(this.body,{elasticity:0}),this.dragShape(),this.txtLine=new PIXI.Graphics,this.addChild(this.txtLine),this.firstLineSP=new PIXI.Graphics,this.addChild(this.firstLineSP),this.secondLineSP=new PIXI.Graphics,this.addChild(this.secondLineSP),this.firstLineSP.visible=this.secondLineSP.visible=!1,this.txt=new PIXI.Text("",{font:"25px Arial",fill:16711680,align:"center"}),this.addChild(this.txt),this.txt.y=40,this.txt2=new PIXI.Text("",{font:"25px Arial",fill:16711680,align:"center"}),this.addChild(this.txt2),this.initMaterial(),this.changeCaizhi(!1),this.initBoardLong()}},{key:"initMaterial",value:function(){this.glass=new PIXI.mesh.NineSlicePlane(PIXI.Texture.fromFrame("LongBoard/glass"),50,30,50,30),this.bg.addChild(this.glass),this.cotton=new PIXI.mesh.NineSlicePlane(PIXI.Texture.fromFrame("LongBoard/cotton"),50,50,50,50),this.bg.addChild(this.cotton),this.towel=new PIXI.mesh.NineSlicePlane(PIXI.Texture.fromFrame("LongBoard/towel"),50,50,50,50),this.bg.addChild(this.towel),this.glass.y=-13,this.cotton.y=-13,this.towel.y=-13}},{key:"initBoardLong",value:function(){this.board=new PIXI.mesh.NineSlicePlane(PIXI.Texture.fromFrame("LongBoard/longboard"),50,50,50,50),this.bg.addChildAt(this.board,0),this.bg.addChild(this.kd),this.kd.y=27,this.changBoardLong({showValue:"35"})}},{key:"setComponent",value:function(){var t=0>=arguments.length||arguments[0]===undefined||arguments[0];this.noRenderSelected=!0,this.iscomponent=t,this.body.userData.noDrag=!0}},{key:"dragShape",value:function(){var t=[{x:514,y:-43},{x:-513.95,y:-43},{x:-513.95,y:-8},{x:514,y:-8}],e=this.BodyUtil.createPolygonShape(t,this.material);this.body.add(e),e.set_sensorEnabled(!0)}},{key:"changeCaizhi",value:function(){var t=0>=arguments.length||arguments[0]===undefined||arguments[0];this.glass.visible=this.cotton.visible=this.towel.visible=!1,1==this.caizhi?this.glass.visible=!0:2==this.caizhi?this.cotton.visible=!0:3==this.caizhi&&(this.towel.visible=!0),this.curtf=this.mcxs[this.caizhi],this.setFriction(),t&&this.freshLibPan()}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.updateLine()}},{key:"updateLine",value:function(){var t=this;if(this.isOpenTrack){this.pointA=l.M.getSPPoint(this.toGlobalView(new l.Point(-521,0),this)),this.pointB=l.M.getSPPoint(this.toGlobalView(new l.Point(523,0),this)),this.pointC=l.M.getXianDianByDis(2e3,!1,this.pointA,this.pointB);var e=this.BodyUtil.getAllCollisionBodys(this.body),i=[];if(each(e,function(t,e){if(!(e.userData&&e.userData.view&&e.userData.iswall)){var o=this.pointA.x,n=this.pointA.y;(e.posx-o)*(this.pointB.y-n)/(this.pointB.x-o)-(e.posy-n)>0&&i.push(e)}},this),this.flag>0&&i.length>0&&(clearTimeout(this.flag),this.flag=0),i.length>0){var o=!1;if(this.getEngineTouchManager().getCurrentToolStatus()===this.ToolStatusStr.DRAG){var n=this.BodyUtil.getHandDragBodyFromArbiter(this.body),s=!0;try{n&&"SpringTension"===n.userData.view.parent.classname&&(s=!1)}catch(N){}if(n&&s){var a=n.connectedBodies();a.add(n);var r=void 0,h=a.get_length();for(r=0;h>r;r++){var u=a.at(r);if(l.ArrayUtil.arrayContainsValue(i,u)){this.firstConBody=n,o=!0;break}}}}if(this.firstConBody||(o=!0,this.firstConBody=i[0]),o){this.firP_=this.getLinkBodysX(this.firstConBody);var c=this.getDraw2PFromChuiP(this.firP_);if(c){this.wenP1_=c[2];var d=this.vc(c[0]),p=this.vc(c[1]);this.firstLineSP.visible=!0,this.firstLineSP.clear(),this.firstLineSP.lineStyle(3,16711680),l.M.drawDashed(this.firstLineSP,d,p)}}}if(this.firstConBody){this.secP_=this.getLinkBodysX(this.firstConBody);var y=this.getDraw2PFromChuiP(this.secP_);if(y){this.wenP2_=y[2];var f=this.vc(y[0]),g=this.vc(y[1]);this.secondLineSP.visible=!0,this.secondLineSP.clear(),this.secondLineSP.lineStyle(3,16711680),l.M.drawDashed(this.secondLineSP,f,g)}}if(0==i.length&&0==this.flag&&this.firstConBody&&(this.flag=setTimeout(function(){t.hadDestory||t.hideLineComp()},200)),this.firstLineSP.visible&&this.secondLineSP.visible){var b=void 0,v=void 0,_=void 0,m=void 0;this.wenP1_.x>this.wenP2_.x?(b=this.wenP2_,v=this.wenP1_,_=this.secP_,m=this.firP_):(b=this.wenP1_,v=this.wenP2_,_=this.firP_,m=this.secP_),this.txt.visible=!0,this.txt2.visible=!0,this.txtLine.visible=!0;var x=l.M.getCenP(b,v),w=l.M.getXianDianByDis(this.txtW_/2,!0,x,b),k=this.vc(w),P=l.M.getXianDianByDis(this.txtW_/2,!0,x,v),O=this.vc(P);this.txt.x=k.x+30;var T=l.M.getPointLen(b,v);if(this.txt.text=Math.round(T/this.NapeConst.SCALE_SPACE)+"mm",this.txtLine.clear(),T>this.txtW_){this.txtLine.lineStyle(2,65280);var C=this.vc(b),B=this.vc(v);this.txtLine.moveTo(C.x,C.y),this.txtLine.lineTo(k.x,k.y),this.txtLine.moveTo(O.x,O.y),this.txtLine.lineTo(B.x,B.y)}var S=new l.Point(_.x,m.y),M=new l.Point(m.x,_.y),L=this.vc(_),D=this.vc(m),I=this.vc(S),E=this.vc(M);l.M.drawDashed(this.txtLine,L,E,10,5),l.M.drawDashed(this.txtLine,I,D,10,5);var j=l.M.getCenP(_,S);w=l.M.getXianDianByDis(this.txtH_/2,!0,j,_),k=this.vc(w),P=l.M.getXianDianByDis(this.txtH_/2,!0,j,S),O=this.vc(P);var A=new l.Point(j.x-this.txtW_/2,j.y-this.txtH_/2),R=this.vc(A);this.txt2.x=R.x,this.txt2.y=R.y,this.txt2.rotation=-this.body.rotation;var F=l.M.getPointLen(_,S);this.txt2.text=Math.round(F/this.NapeConst.SCALE_SPACE)+"mm",T>this.txtH_&&(this.txtLine.lineStyle(2,65280),this.txtLine.moveTo(L.x,L.y),this.txtLine.lineTo(k.x,k.y),this.txtLine.moveTo(O.x,O.y),this.txtLine.lineTo(I.x,I.y))}}}},{key:"hideLineComp",value:function(){this.firstConBody=null,this.firstLineSP.visible=!1,this.secondLineSP.visible=!1,this.txt.visible=!1,this.txt2.visible=!1,this.txtLine.visible=!1,this.flag=0}},{key:"vc",value:function(t){return l.Point.vec2ToPoint(this.body.worldPointToLocal(this.Vec2Util.pointToVec2(t)))}},{key:"getDraw2PFromChuiP",value:function(t){if(t){var e=l.M.rotaPointFromP(this.pointB,this.pointA,-Math.PI/2);e=e.subtract(this.pointA);var i=l.M.getPointLen(e,new l.Point(0,0));e=new l.Point(e.x/i,e.y/i);var o=new l.Point(134*e.x,134*e.y),n=t.add(o),s=100,a=new l.Point(-e.x*s,-e.y*s),r=t.add(a);s=60,a=new l.Point(-e.x*s,-e.y*s);return[n,r,t.add(a)]}}},{key:"getLinkBodysX",value:function(t){var e=this,i=new y.phys.BodyList;t&&(i=t.connectedBodies(),i.add(t));var o=void 0;i.foreach(function(t){"HookWood"==t.userData.classType&&(o=t)});o&&(i.clear(),i.add(o));var n=void 0,s=void 0,a=0;return i.foreach(function(t){var i=t.userData.view,o=void 0;if(i.radius&&0!=i.radius){n=l.Point.vec2ToPoint(t.position),o=l.M.getGaoDianFrom3Dian(n,e.pointA,e.pointB);var r=e.pointB.subtract(e.pointA),h=l.M.getPointLen(r,new l.Point(0,0));r=new l.Point(r.x/h,r.y/h),r=new l.Point(r.x*i.radius,r.y*i.radius),o=o.add(r);var u=l.M.getPointLen(e.pointC,o);u>a&&(a=u,s=o)}else t.get_shapes().foreach(function(t){if(t.get_worldVerts){t.get_worldVerts().foreach(function(t){o=l.M.getGaoDianFrom3Dian(l.Point.vec2ToPoint(t),e.pointA,e.pointB);var i=l.M.getPointLen(e.pointC,o);i>a&&(a=i,s=o)})}})}),s}},{key:"setFriction",value:function(){var t=2*this.curtf;this.material.set_dynamicFriction(t),this.material.set_staticFriction(1.3*t),this.material.set_rollingFriction(this.curtf)}},{key:"switchCaizhi",value:function(t){var e=1>=arguments.length||arguments[1]===undefined||arguments[1];this.caizhi=this.czi.indexOf(t.showValue),this.changeCaizhi(e)}},{key:"changeOpenTrack",value:function(t){(this.isOpenTrack=t.checked)||this.hideLineComp()}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.cz=this.caizhi,t.track=this.isOpenTrack,t.f=this.curtf,t.lock=this.equlock,t["long"]=this.getlong(),t.divisionIndex=this.divisionIndex,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.cz!=this.caizhi&&this.switchCaizhi({showValue:this.czi[t.cz]},!1),1==t.track&&this.changeOpenTrack({checked:!0}),this.changef({showValue:t.f}),1==t.lock&&this.changelock({checked:!0}),isNaN(t["long"])||this.changBoardLong({showValue:t["long"]}),isNaN(t.divisionIndex)||(this.divisionIndex=t.divisionIndex,this.kd.changeLongBoardDivision(this.divisionValueArr[this.divisionIndex]))}},{key:"changef",value:function(t){this.curtf=l.M.getNumStr(t.showValue)-0,this.setFriction()}},{key:"changelock",value:function(t){if(this.equlock=t.checked){if(this.checkHaveFix())return this.equlock=!1,void this.showToolDatas();this.body.set_type(f.get_KINEMATIC()),this.BodyUtil.frezzBody(this.body)}else this.body.set_type(f.get_DYNAMIC())}},{key:"changBoardLong",value:function(t){var e=l.M.getNumStr(t.showValue)-0;this.curtlong=e*this.NapeConst.SCALE_SPACE*10+10,this.board.width=this.curtlong,this.glass.width=this.curtlong,this.cotton.width=this.curtlong,this.towel.width=this.curtlong,this.body.scaleShapes(1/this.prevscale,1);var i=this.curtlong/this.deflong;this.prevscale=i,this.body.scaleShapes(i,1),this.kd.initLongBoard(e),this.curtlong=e*this.NapeConst.SCALE_SPACE*10,this.refreshPivot()}},{key:"refreshPivot",value:function(){this.board.pivot=new l.Point(this.board.width/2,this.board.height/2),this.glass.pivot=new l.Point(this.glass.width/2,this.glass.height/2),this.cotton.pivot=new l.Point(this.cotton.width/2,this.cotton.height/2),this.towel.pivot=new l.Point(this.towel.width/2,this.towel.height/2),this.kd.x=-this.board.width/2}},{key:"refreshMiddle",value:function(t,e){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,o=this.curtlong/2,n=t.left,s=t.right;n.x=-o,s.x=o-s.width,e.width=this.curtlong-2*n.width,e.x=-o+n.width-i}},{key:"getlong",value:function(){return l.M.getNumJie(.1*Math.abs(this.curtlong)/this.NapeConst.SCALE_SPACE,0)-0}},{key:"selectRenderChild",value:function(){return this.updateTransform(),this.getBounds()}},{key:"checkHaveFix",value:function(){var t=this.body.get_constraints(),e=!1;return t.foreach(function(t){t.userData&&t.userData.toolView&&"WeldJointView"==t.userData.toolView.classname&&(e=!0)}),e}},{key:"weldFix",value:function(){this.equlock&&this.changelock({checked:!1})}},{key:"changeDivision",value:function(t){var e=t.showValue;this.divisionIndex=this.divisionValueArr.indexOf(e),this.kd.changeLongBoardDivision(e)}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.getScrollBar([this.getLocaleStr("roughness","粗糙程度"),!0,"",1,0,this.curtf,.1,this.changef,this]),this.getScrollBar([this.getLocaleStr("length","长度"),!0,"cm",100,20,this.getlong(),5,this.changBoardLong,this]),this.getDropMenu([this.getLocaleStr("dividing_value","分度值"),!1,"",this.divisionValueArr[this.divisionIndex],this.divisionValueArr,this,this.changeDivision,0,0]),this.getDropMenu([this.getLocaleStr("material","材质"),!1,"",this.currentMatrial,this.czi,this,this.switchCaizhi,1,0]),this.getSwitch([this.getLocaleStr("track","轨迹"),this.isOpenTrack,this.changeOpenTrack,this]),this.getSwitch([this.getLocaleStr("lock","锁定"),this.equlock,this.changelock,this])),t}},{key:"getTipMess",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.language.getLocaleStr("roughness")+": "+this.curtf+"\n    "+this.language.getLocaleStr("length")+": "+this.getlong()+"cm\n    "}},{key:"currentMatrial",get:function(){return this.czi[this.caizhi]}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function O(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:O(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(449),p=o(d),y=i(454),f=o(y),g=void 0,b=void 0,v=void 0,_=void 0,m=void 0,x=void 0,w=void 0,k=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return g=i.phy.nape,b=g.NbBody,v=g.callbacks.CbEvent,_=g.callbacks.InteractionType,m=g.callbacks.InteractionListener,x=g.geom.Vec2,w=g.shape.Polygon,k=g.callbacks.CbType,i.classType="PulleyLongBoard",i.level=12,i.jointArr=[],i.nbCar=null,i.linkP1=new x(-100,-28),i.linkP2=null,i.linkP3=null,i.carP=new x(-42,0),i.banShape=new PIXI.Graphics,i.carShape=new PIXI.Graphics,i.guPoint=new l.Point(-300,-50),i.isLink_=!1,i.curLinkNum_=1,i.jointLen=50,i.dangShape_=null,i.linekd=new PIXI.Graphics,i.zhu2P=null,i.tick=null,i.haveTick=!1,i.fparam=.5,i.lineJoint=null,i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;this.points=[{x:-513.95,y:-8},{x:-521.95,y:35},{x:523,y:35},{x:514,y:-8}],h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.addCbType(this.CbTypeStr.LONG_BOARD_TM),this.BodyUtil.setBodyMaterial(this.body,{elasticity:0,dynamicFriction:.5,rollingFriction:2}),this.body.set_isBullet(!0),this.dragShape(),this.guPoint=new l.Point(-300,-50),this.linkP2=new x(this.linkP1.get_x()+98,this.linkP1.get_y()-10),this.linkP3=new x(this.linkP1.get_x()+97,this.linkP1.get_y()+56),this.nbCar=new P(this.paramObj,this.carSkin),this.parent.addChild(this.nbCar),this.nbCar.x=this.x+this.carSkin.x,this.nbCar.y=this.y+this.carSkin.y,this.nbCar.init(),this.nbCar.addChild(this.carShape),this.addChild(this.banShape),this.dangShape_=this.BodyUtil.createRectShape(-200,-50,20,50),this.body.add(this.dangShape_),this.addChild(this.linekd),this.linekd.lineStyle(2,65280),this.linekd.moveTo(-185,20),this.linekd.lineTo(-185,-30),this.zhu2P=new l.Point(this.zhu2.x,this.zhu2.y),this.parent.addChild(this.zhu2),this.zhu2.x=this.x+this.zhu2P.x,this.zhu2.y=this.y+this.zhu2P.y,setTimeout(function(){t.hadDestory||t.BodyUtil.frezzBody(t.nbCar.body)},10),this.parent.addChild(this.startBtn),this.startBtn.x=this.x+23,this.startBtn.y=this.y-270,this.startBtn.visible=!1,this.startBtn.fontColor="#ffffff",this.startBtn.text="弹 射",this.startBtn["this"]=this,this.startBtn.tab=function(){t.nbCar.tic&&t.nbCar.weldJoint&&(t.nbCar.tic.var_powerIsOpen||(t.nbCar.tic.var_ispowerClick=!0,t.nbCar.tic.func_powerClick()),t.nbCar.breakWeldJoint())},this.addCursor(this.startBtn,"hand"),this.changeFri({showValue:"0.5"})}},{key:"addSubOneNbRubber",value:function(t){var e=this.body.localPointToWorld(this.linkP2);this.joint=this.funcCreateJoint(this.nbCar.body,this.body,this.nbCar.body.localPointToWorld(x.get(0,6)),e,this.jointLen)}},{key:"setComponent",value:function(){var t=0>=arguments.length||arguments[0]===undefined||arguments[0];this.noRenderSelected=!0,this.iscomponent=t,this.body.userData.noDrag=!0,this.nbCar.setComponent(),this.nbCar.board=this,this.parent.removeChild(this.startBtn)}},{key:"linkFrequency",value:function(){return.1*this.curLinkNum_}},{key:"funcCreateJoint",value:function(t,e,i,o,n){var s=this.JointUtil.createNBRubberJoint(t,e,i,o,n);return s.frequency=this.linkFrequency(),s.damping=0,s.space=t.space,s.space.constraints.add(s),s}},{key:"dragShape",value:function(){var t=[{x:514,y:-43},{x:-513.95,y:-43},{x:-513.95,y:-8},{x:514,y:-8}],e=this.BodyUtil.createPolygonShape(t,this.material);this.body.add(e),e.set_sensorEnabled(!0)}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.startBtn.parent&&(this.startBtn.x=this.x+23,this.startBtn.y=this.y-270,this.startBtn.visible=!!this.nbCar.weldJoint),this.zhu2.x=this.x+this.zhu2P.x,this.zhu2.y=this.y+this.zhu2P.y,this.zhu2.rotation=this.rotation,this.tick&&(this.tick.rotation=this.body.rotation,this.tick.func_changeXY());var t=this.body.worldPointToLocal(this.nbCar.body.localPointToWorld(this.carP)),i=this.nbCar.body.worldPointToLocal(this.body.localPointToWorld(this.linkP3.add(new x(5,-35)))),o=this.linkP2.add(new x(0,-11));this.banShape.clear(),this.carShape.clear();var n=this.curLinkNum_;if(t.get_x()<this.linkP2.get_x()){var s=this.nbCar.body.position,a=this.body.localPointToWorld(this.linkP3);this.isLink_||90>a.get_y()-s.get_y()&&a.get_y()-s.get_y()>20?(this.linkCar(!0),this.banShape.lineStyle(n,16711680),this.banShape.moveTo(t.get_x(),t.get_y()),this.banShape.lineTo(o.get_x()-2,o.get_y()),this.carShape.lineStyle(n+1,16711680),this.carShape.moveTo(i.get_x(),i.get_y()),this.carShape.lineTo(this.carP.get_x(),this.carP.get_y())):(this.banShape.lineStyle(n+1,16711680),this.banShape.moveTo(o.get_x(),o.get_y()),this.banShape.lineTo(this.linkP3.get_x()+5,this.linkP3.get_y()-35))}else this.linkCar(!1),this.banShape.lineStyle(n+1,16711680),this.banShape.moveTo(o.get_x(),o.get_y()),this.banShape.lineTo(this.linkP3.get_x()+5,this.linkP3.get_y()-35);if(this.joint){this.nbCar.body.userData.handJointFrequency=3;var r=this.nbCar.body.userData.dragManager;r&&r.handJoint.set_frequency(3)}else this.nbCar.body.userData.handJointFrequency=10}},{key:"linkCar",value:function(t){this.isLink_!=t&&(this.isLink_=t,this.isLink_?(this.nbCar.body.noallowRotation||(this.nbCar.body.set_rotation(this.body.get_rotation()),this.nbCar.body.noallowRotation=!0,this.BodyUtil.frezzBody(this.nbCar.body)),null==this.joint&&this.addSubOneNbRubber()):(this.nbCar.body.noallowRotation&&(this.nbCar.body.set_rotation(this.body.get_rotation()),this.nbCar.body.noallowRotation=!1),this.joint&&(this.BodyUtil.destoryJoint(this.joint),this.joint=null),this.lineJoint&&(this.BodyUtil.destoryJoint(this.lineJoint),this.lineJoint=null)))}},{key:"changeXPJ",value:function(t){this.curLinkNum_=l.M.getNumStr(t.showValue)-0;var e=Math.floor(this.curLinkNum_);e!=this.curLinkNum_&&(this.curLinkNum_=e,this.showToolDatas()),this.joint&&(this.joint.frequency=this.linkFrequency())}},{key:"weldPoint",value:function(){return this.toGlobalView(this.guPoint,this)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.car=this.nbCar.getData(),t.linkNum=this.curLinkNum_,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.nbCar.setData(t.car),this.changeXPJ({showValue:t.linkNum})}},{key:"changeFri",value:function(t){this.fparam=l.M.getNumStr(t.showValue)-0;var e=2*this.fparam;this.material.set_dynamicFriction(e),this.material.set_staticFriction(e),this.material.set_rollingFriction(this.fparam)}},{key:"removed",value:function(){this.removedCursor(this.startBtn),this.startBtn.destroy(),this.nbCar.removed(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getDropMenu(this.language.getLocaleStr("rubber_num"),!0,"",this.curLinkNum_+"",["1","2","3","4","5","10"],this,this.changeXPJ,10,1),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("roughness"),!0,"",1,0,this.fparam,.1,this.changeFri,this)),t}},{key:"getTipMess",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.language.getLocaleStr("roughness")+": "+this.fparam+"\n    "}}]),e}(c["default"]);var P=function(t){function e(t,i){n(this,e);var o=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.level=20,o.skin=i,o.weldJoint=null,o.tic=null,o.isWeldBoard=null,o.isUse=!1,o.board=null,o.working=null,o.cbtype=new k,o.lpj1=null,o.lpj2=null,o}return a(e,t),r(e,[{key:"init",value:function(){function t(t,e){var i=new g.shape.Circle(s,null,n),o=new b;return o.add(i),o.set_position(e.localPointToWorld(x.get(t.x,t.y))),o.userData.view=t,o}var i=this;this._width=86,this._height=55,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.addChild(this.skin),this.addCbType(this.cbtype),this.skin.x=0,this.skin.y=0;var o=new w(w.rect(-35,5,70,20));this.body.add(o),this.body.bullet=!0,this.body.userData.dragLevel=2,this.BodyUtil.setShapeMaterial(o,{density:10,elasticity:0,dynamicFriction:.01}),this.body.userData.handJointStiff=!1,this.body.userData.handJointFrequency=10;var n=new g.phys.Material(0,1,1,1,2),s=.5*this.skin.lun1.width;this.leftlun=t(this.skin.lun1,this.body),this.rightlun=t(this.skin.lun2,this.body),this.addBodyToSpace(this.leftlun,this.parent),this.addBodyToSpace(this.rightlun,this.parent),this.lpj1=this.JointUtil.createPivotJoint(this.leftlun,this.body,this.leftlun.position,this.leftlun.position),this.lpj2=this.JointUtil.createPivotJoint(this.rightlun,this.body,this.rightlun.position,this.rightlun.position),this.parent.addChild(this.skin.lun1),this.parent.addChild(this.skin.lun2),this.carBeginDrag=function(t){i.beginHandler(t)},this.carEndDrag=function(t){i.endHandler(t)},this.addEventListener(p["default"].BEGIN,this.carBeginDrag),this.addEventListener(p["default"].END,this.carEndDrag),this.boardInterListener=new m(v.get_ONGOING(),_.get_SENSOR(),this.cbtype,this.CbTypeStr.LONG_BOARD_TM,function(t){i.boardHitHandler(t)}),this.addNapeListeners(this.boardInterListener)}},{key:"setComponent",value:function(){this.noRenderSelected=!0,this.iscomponent=!0,this.removeNapeListeners(this.boardInterListener)}},{key:"boardHitHandler",value:function(t){if(!this.isWeldBoard&&!this.working){this.board=t.get_int2().userData.view}}},{key:"beginHandler",value:function(t){this.tic&&this.tic.var_powerIsOpen||this.weldJoint&&(this.weldJoint.active=!1,this.isWeldBoard=!1)}},{key:"endHandler",value:function(t){if(this.weldJoint){if(this.tic&&this.tic.var_powerIsOpen)return;this.weldJoint.anchor2=this.board.body.worldPointToLocal(this.body.position),this.weldJoint.active=!0}this.isUse||this.checkHitTickerPaper()}},{key:"checkHitTickerPaper",value:function(){for(var t=this,e=this.getChildrenByClass("HTickerTimer"),i=0;e.length>i;i++){var o=e[i];if(!o.var_hasCar&&!o.var_powerIsOpen){var n=o.getPaperRightP();if(n&&this.body.contains(x.get(n.x,n.y)))return this.tic=o,this.isUse=!0,this.weldCar(),this.ticEquFunc=function(e){t.tickPowerChange()},this.tic.addEventListener(f["default"].TICKER_POWER_CHANGE,this.ticEquFunc),!0}}return!1}},{key:"weldCar",value:function(){null!=this.board&&(this.weldJoint=this.JointUtil.createPivotJoint(this.body,this.board.body,this.body.position,this.body.position),this.isWeldBoard=!0,this.frezzTwoLun())}},{key:"frezzTwoLun",value:function(){var t=this.body.get_position();this.leftlun.set_position(t),this.rightlun.set_position(t),this.BodyUtil.frezzBody(this.leftlun),this.BodyUtil.frezzBody(this.rightlun)}},{key:"breakWeldJoint",value:function(){this.weldJoint&&(this.BodyUtil.destoryJoint(this.weldJoint),this.weldJoint=null)}},{key:"tickPowerChange",value:function(){this.tic&&this.tic.var_powerIsOpen?(this.working=!0,this.isWeldBoard=!1):this.working=!1}},{key:"update",value:function(){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),!this.napeEngine.play){this.leftlun.set_position(this.body.localPointToWorld(this.lpj1.get_anchor2()));this.rightlun.set_position(this.body.localPointToWorld(this.lpj2.get_anchor2()))}if(this.weldJoint&&this.body.get_rotation()!=this.board.body.get_rotation()&&this.body.set_rotation(this.board.body.get_rotation()),this.tic){var t=this.tic.getPaperRightP();if(null==t)return this.tic.removeEventListener(f["default"].TICKER_POWER_CHANGE,this.ticEquFunc),this.tic=null,this.isUse=!1,this.isWeldBoard=!1,void(this.weldJoint&&(this.BodyUtil.destoryJoint(this.weldJoint),this.weldJoint=null));var i=this.body.worldPointToLocal(x.get(t.x,t.y));if(Math.abs(i.get_y())>50){if(this.iscomponent&&!this.tic.var_powerIsOpen)return;this.tic.removeEventListener(f["default"].TICKER_POWER_CHANGE,this.ticEquFunc);var o=this.tic;this.tic=null,this.isUse=!1,this.isWeldBoard=!1,this.weldJoint&&(this.BodyUtil.destoryJoint(this.weldJoint),this.weldJoint=null),this.iscomponent&&o&&o.dispatchEvent(f["default"].TICKER_PAPER_AUTOMATIC_BREAK)}else{this.tic.func_changePaperXY(new l.Point(this.x-42,this.y))}}}},{key:"removed",value:function(){this.skin=null,this.tic=null,this.board=null,this.dispose(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"dispose",value:function(){this.removeEventListener(p["default"].BEGIN,this.carBeginDrag),this.removeEventListener(p["default"].END,this.carEndDrag),this.removeNapeListeners(this.boardInterListener),this.BodyUtil.destoryBody(this.body),this.BodyUtil.destoryBody(this.leftlun),this.BodyUtil.destoryBody(this.rightlun)}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function T(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:T(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(1076),p=o(d),y=i(449),f=o(y),g=void 0,b=void 0,v=void 0,_=void 0,m=void 0,x=void 0,w=void 0,k=void 0,P=void 0,O=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return g=i.phy.nape,b=g.NbBody,v=g.phys.BodyType,_=g.callbacks.InteractionListener,m=g.callbacks.InteractionType,x=g.callbacks.CbEvent,w=g.shape.Polygon,k=g.shape.Circle,P=g.geom.Vec2,O=g.callbacks.CbType,i.showStr=i.language.getLocaleStr("show"),i.mass1Arr=["5g","10g","15g"],i.mass2Arr=["5g","10g","15g"],i.ballBody1=null,i.ballBody2=null,i.weld=null,i.weld2=null,i.zhushape=null,i.banBody=null,i.twoBallNotHit=!0,i.twoBallInteraction=null,i.ball1AndBanInter=null,i.ball2AndBanInter=null,i.ball1Cbtype=new O,i.ball2Cbtype=new O,i.banCbtype=new O,i.isStart=!1,i.paper=null,i.paperI=null,i.ball2Pos={x:-60,y:-80},i.ball2PosOn=null,i.putBall2=!1,i}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.noallowRotation=!0,this.body.userData.dragLevel=-1,this.body.set_type(v.get_KINEMATIC()),this.topCtP1=new l.Point(this.xfz.x,this.xfz.y);var t=30*Math.PI/180;this.bottomCtP1=new l.Point(this.topCtP1.x+210*Math.cos(t),this.topCtP1.y+210*Math.sin(t)),this.ball2PosOn={x:this.glassball.x,y:this.glassball.y},this.initBaseShape(),this.initTrack(),this.initGdq(),this.initBall(),this.initBtn(),this.func_listeners(),this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.paper=new p["default"](this.paramObj),this.addChild(this.paper),this.paper.visible=!1,this.paper.x=350,this.paper.initFirstPoint(new P(-278,0)),this.paper.clear(this.getExpCount()),this.paperI=this.paper.paper,this.addCursor(this.glassball.ball,"hand"),this.addCursor(this.dragxfz,"qingxie")}},{key:"removed",value:function(){this.removedCursor(this.glassball.ball),this.removedCursor(this.dragxfz),this.removedCursor(this.startBtn),this.removedCursor(this.showBtn),this.removedCursor(this.paperBtn),this.removedCursor(this.resetBtn),this.removeNapeListeners(this.twoBallInteraction),this.removeNapeListeners(this.ball1AndBanInter),this.removeNapeListeners(this.ball2AndBanInter),this.BodyUtil.destoryBody(this.ballBody1),this.BodyUtil.destoryBody(this.ballBody2),this.BodyUtil.destoryBody(this.banBody),this.glassball.removeAllListeners(),this.paper.disposeIt(),l.M.removeTouch(this.dragxfz,this.xfzTouchid),this.startBtn.dispose(),this.showBtn.dispose(),this.paperBtn.dispose(),this.resetBtn.dispose(),this.paperI=null,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"getExpCount",value:function(){return this.ballBody1.mass+""+this.ballBody2.mass+this.xfz.x.toFixed()}},{key:"func_listeners",value:function(){var t=this,e=this.getMain();this.twoBallInteraction=new _(x.get_BEGIN(),m.get_COLLISION(),this.ball1Cbtype,this.ball2Cbtype,function(e){var i=t.BodyUtil.getBodyFromCb(e);i[0]==t.ballBody1&&i[1]==t.ballBody2&&(t.removeNapeListeners(t.twoBallInteraction,!0),t.zhushape.set_sensorEnabled(!0),TweenMax.to(t.stick,.5,{rotation:Math.PI/2}))}),this.ball1AndBanInter=new _(x.get_BEGIN(),m.get_COLLISION(),this.banCbtype,this.ball1Cbtype,function(i){var o=t.BodyUtil.getBodyFromCb(i);if(o[0]==t.banBody&&o[1]==t.ballBody1&&t.paperI.visible){var n=o[1],s=t.paper.toLocal(l.Point.vec2ToPoint(n.get_position()),e.view),a={};a.count=t.getExpCount(),a.vec2=t.Vec2Util.pointToVec2(s),a.type=t.putBall2?2:1,t.paper.addPoint(a),t.removeNapeListeners(t.ball1AndBanInter,!0)}}),this.ball2AndBanInter=new _(x.get_BEGIN(),m.get_COLLISION(),this.banCbtype,this.ball2Cbtype,function(i){var o=t.BodyUtil.getBodyFromCb(i);if(o[0]==t.banBody&&o[1]==t.ballBody2&&t.paperI.visible){var n=o[1],s=t.paper.toLocal(l.Point.vec2ToPoint(n.get_position()),e.view),a={};a.count=t.getExpCount(),a.vec2=t.Vec2Util.pointToVec2(s),a.type=3,t.paper.addPoint(a),t.removeNapeListeners(t.ball2AndBanInter,!0)}}),this.addNapeListeners(this.twoBallInteraction),this.addNapeListeners(this.ball1AndBanInter),this.addNapeListeners(this.ball2AndBanInter)}},{key:"initBtn",value:function(){this.startBtn["this"]=this,this.startBtn.fontColor="#ffffff",this.startBtn.text=this.language.getLocaleStr("start"),this.startBtn.tab=function(t){this.isStart||(this.isStart=!0,this.ballBody1.wake(),this.weld&&(this.BodyUtil.destoryJoint(this.weld),this.weld=null),this.putBall2&&this.weld2&&(this.BodyUtil.destoryJoint(this.weld2),this.weld2=null))},this.showBtn["this"]=this,this.showBtn.fontColor="#ffffff",this.showBtn.text=this.showStr,this.showBtn.tab=function(t){var e=this;this.showBtn.text===this.showStr?(this.paper.scale.y=.4,this.paper.scale.x=.9,this.paper.x=900,this.paper.y=254,this.addChildAt(this.paper,0),TweenMax.to(this.paperI,.5,{x:900,onComplete:function(){e.addChild(e.paper),e.addChild(e.paperBtn),e.paperI.x=0,e.paperI.visible=!0,e.paper.visible=!0,TweenMax.to(e.paper.scale,.5,{x:1,y:1}),TweenMax.to(e.paper,.5,{x:350,y:-100,onComplete:function(){e.paperBtn.visible=!0}})}}),this.showBtn.text=this.language.getLocaleStr("hide")):(this.paper.visible=!1,this.showBtn.text=this.showStr,this.paperI.visible=!0,this.paperBtn.visible=!1)},this.paperBtn["this"]=this,this.paperBtn.fontColor="#ffffff",this.paperBtn.text=this.language.getLocaleStr("trans_paper"),this.paperBtn.x=620,this.paperBtn.y=26,this.paperBtn.visible=!1,this.paperBtn.tab=function(t){this.paper.clear(this.getExpCount()),this.paper.visible=!1,this.paperI.visible=!0,this.showBtn.text=this.showStr,this.paperBtn.visible=!1},this.resetBtn["this"]=this,this.resetBtn.fontColor="#ffffff",this.resetBtn.text=this.language.getLocaleStr("reset"),this.resetBtn.tab=function(t){this.isStart&&(this.isStart=!1,this.zhushape.set_sensorEnabled(!1),this.resetBallJoint(),this.stick.rotation=this.putBall2?0:Math.PI/2,this.addNapeListeners(this.twoBallInteraction),this.addNapeListeners(this.ball1AndBanInter),this.addNapeListeners(this.ball2AndBanInter))},this.addCursor(this.startBtn,"hand"),this.addCursor(this.showBtn,"hand"),this.addCursor(this.paperBtn,"hand"),this.addCursor(this.resetBtn,"hand")}},{key:"initBall",value:function(){var t=this;this.ballBody1=new b;var e=new k(this.ball.width/2);this.ballBody1.add(e),this.ballBody1.userData.view=this.ball,this.addBodyToSpace(this.ballBody1,this),this.ballBody1.bullet=!0,this.ballBody1.mass=15,this.ballBody1.addCbType(this.ball1Cbtype),this.ballBody2=new b;var i=new k(this.glassball.ball.width/2);this.ballBody2.add(i),this.ballBody2.userData.view=this.glassball,this.ballBody2.bullet=!0,this.ballBody2.userData.dragLevel=1,this.addBodyToSpace(this.ballBody2,this),this.ballBody2.mass=5,this.ballBody2.addCbType(this.ball2Cbtype),this.BodyUtil.setShapeMaterial(e,{dynamicFriction:0,elasticity:1,rollingFriction:0,staticFriction:0}),this.BodyUtil.setShapeMaterial(i,{dynamicFriction:0,elasticity:1,rollingFriction:0,staticFriction:0}),this.resetBallJoint(),this.glassball.addEventListener(f["default"].BEGIN,function(e){t.putBall2=!t.putBall2,t.weldGlassBall(),t.glassball.ts.parent&&t.glassball.removeChild(t.glassball.ts)})}},{key:"resetBallJoint",value:function(){var t=P.get(this.x+this.xfz.x+37,this.y+this.xfz.y+22);this.ballBody1.set_position(t),this.weld=this.JointUtil.createWeldJoint(this.ballBody1,this.body,t,t),this.weldGlassBall()}},{key:"weldGlassBall",value:function(){this.weld2&&this.BodyUtil.destoryJoint(this.weld2);var t=void 0;this.putBall2?(this.stick.rotation=0,this.zhushape.set_sensorEnabled(!1),t=P.get(this.x+this.ball2PosOn.x,this.y+this.ball2PosOn.y)):(this.stick.rotation=Math.PI/2,this.zhushape.set_sensorEnabled(!0),t=P.get(this.x+this.ball2Pos.x,this.y+this.ball2Pos.y)),this.ballBody2.set_position(t),this.BodyUtil.frezzBody(this.ballBody2),this.weld2=this.JointUtil.createWeldJoint(this.ballBody2,this.body,t,t)}},{key:"update",value:function(){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.weld){var t=this.weld.get_anchor2();this.ball.x=t.get_x(),this.ball.y=t.get_y(),t=this.body.localPointToWorld(t),this.ballBody1.set_position(t)}if(this.weld2){var i=this.weld2.get_anchor2();this.glassball.x=i.get_x(),this.glassball.y=i.get_y(),i=this.body.localPointToWorld(i),this.ballBody2.set_position(i)}}},{key:"initGdq",value:function(){function t(t){o=this.getMouseXY(t),this.body.userData.noDrag=!0,this.xfz.ts1.parent&&this.xfz.removeChild(this.xfz.ts1)}function e(t){var e=this.getMouseXY(t),i=l.Point.distance(o,e),s=i*Math.cos(n),a=i*Math.sin(n);e.x>o.x?(this.dragxfz.x+=s,this.dragxfz.y+=a):(this.dragxfz.x-=s,this.dragxfz.y-=a),this.dragxfz.x=this.topCtP1.x>this.dragxfz.x?this.topCtP1.x:this.dragxfz.x,this.dragxfz.x=this.dragxfz.x>this.bottomCtP1.x?this.bottomCtP1.x:this.dragxfz.x,this.dragxfz.y=this.topCtP1.y>this.dragxfz.y?this.topCtP1.y:this.dragxfz.y,this.dragxfz.y=this.dragxfz.y>this.bottomCtP1.y?this.bottomCtP1.y:this.dragxfz.y,this.xfz.x=this.dragxfz.x,this.xfz.y=this.dragxfz.y,o=e,this.weld&&(this.weld.anchor2=P.get(this.dragxfz.x+37,this.dragxfz.y+22))}function i(t){this.body.userData.noDrag=!1,this.xfz.x=this.dragxfz.x,this.xfz.y=this.dragxfz.y}this.dragxfz.alpha=0,this.dragxfz.x=this.xfz.x,this.dragxfz.y=this.xfz.y,this.xfzTouchid=l.M.addTouch(this.dragxfz,{begin:t,move:e,end:i},this);var o=void 0,n=30*Math.PI/180}},{key:"initTrack",value:function(){this.createTrackShape(-280,-185,360,20,30*Math.PI/180),this.createTrackShape(-135.4,-112,186,20,0),this.zhushape=this.createTrackShape(this.stick.x-2,-112,4,20,0),this.banBody=new b,this.banBody.add(new w(w.rect(15,194,514,40))),this.addBodyToSpace(this.banBody),this.banBody.bullet=!0,this.banBody.set_position(this.body.get_position()),this.banBody.addCbType(this.banCbtype),this.BodyUtil.setBodyFilter(this.banBody,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.JointUtil.createWeldJoint(this.banBody,this.body,this.banBody.position,this.banBody.position)}},{key:"createTrackShape",value:function(t,e,i,o,n){var s=new w(w.box(i,o));return this.body.add(s),s.rotate(n),s.set_localCOM(P.get(t,e)),this.BodyUtil.setShapeMaterial(s,{dynamicFriction:0,elasticity:0,rollingFriction:0,staticFriction:0}),s}},{key:"initBaseShape",value:function(){this.body.shapes.clear(),this.body.add(new w(w.rect(-600,-160,600,400))),this.body.add(new w(w.rect(-60,132,700,150))),this.body.sensorEnabled(!0)}},{key:"selectRenderChild",value:function(){return this.unionRects([this.bg.getBounds(),this.track.getBounds(),this.paperBg.getBounds()])}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("left_mass"),!0,"g",15,10,this.ballBody1.mass,1,function(t){this.ballBody1.mass=l.M.getNumStr(t.showValue)},this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("right_mass"),!0,"g",5,1,this.ballBody2.mass,1,function(t){this.ballBody2.mass=l.M.getNumStr(t.showValue)},this)),t}},{key:"hideTips",value:function(){this.glassball.ts.visible=!1,this.xfz.ts1.visible=!1}},{key:"getLocalBoundsElecs",value:function(){return[this.bg,this.track,this.paperBg,this.startBtn]}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function m(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:m(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(1103),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.NbBody,g=y.phys.Compound,b=y.shape.Polygon,v=y.phys.BodyType,_=y.geom.Vec2,i.compo=new g,i.a=0,i.isMove=!1,i.speed=5,i.guanArr=[],i.kuanArr=[],i.isTweening=!1,i.moveStep=0,i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;this._width=70,this._height=560,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.compo.set_space(this.body.get_space()),this.body.set_type(v.get_KINEMATIC()),this.body.set_compound(this.compo),this.resetUserView(this.bg,this,!0),this.body.userData.dragtranslate=!0,this.bg.translateMove=function(e,i){t.translateMove(e,i)},this.move_x=this.bg.x-this.moveBtn.x,this.move_y=this.bg.y-this.moveBtn.y,this.rot_x=this.bg.x-this.rotBtn.x,this.rot_y=this.bg.y-this.rotBtn.y,this.a_move_x=this.bg.x-this.aMoveBtn.x,this.a_move_y=this.bg.y-this.aMoveBtn.y,this.initBtn(),this.initWater(),this.initWuKuai(),this.shadow=new PIXI.Sprite,this.addChildAt(this.shadow,0),this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.BodyUtil.setBodyFilter(this.water.body,this.InteractionFilterManager.LIQUID_GROUP)}},{key:"initWuKuai",value:function(){this.wkBody=new f,this.wkBody.add(new b(b.box(this.wk.width,this.wk.height))),this.wkBody.userData.view=this.wk,this.addBodyToSpace(this.wkBody,this),this.wkBody.set_compound(this.compo),this.BodyUtil.setBodyMaterial(this.wkBody,{density:1}),this.wkBody.set_position(this.body.get_position());var t=_.get(0,-223),e=_.get(0,272),i=e.sub(t),o=l.M.vec2Length(i);this.JointUtil.createLineJoint(this.body,this.wkBody,_.get(this.body.posx,this.body.posy-223),this.wkBody.position,i,0,o).set_compound(this.compo)}},{key:"initWater",value:function(){this.water=new p["default"](this.paramObj),this.water._width=70,this.water._height=580,this.water.init();var t=this.body.get_position();this.water.body.set_position(t),this.water.body.set_compound(this.compo),this.JointUtil.createWeldJoint(this.body,this.water.body,t,t).set_compound(this.compo)}},{key:"translateMove",value:function(t,e){this.compo.translate(_.get(t,e))}},{key:"initBtn",value:function(){var t=this;this.moveBtn.fontColor="#ffffff",this.moveBtn.text=this.language.getLocaleStr("uniform_speed"),this.moveBtn["this"]=this,this.aMoveBtn.fontColor="#ffffff",this.aMoveBtn.text=this.language.getLocaleStr("speed_up"),this.aMoveBtn["this"]=this,this.rotBtn.fontColor="#ffffff",this.rotBtn.text=this.language.getLocaleStr("rotate"),this.rotBtn["this"]=this,this.addCursor(this.moveBtn,"hand"),this.addCursor(this.rotBtn,"hand"),this.addCursor(this.aMoveBtn,"hand"),this.moveBtn.tab=function(e){t.isMove||(t.isMove=!0,t.shadow.removeChildren(),t.a=0,t.speed=5,t.moveStep=0,t.guanArr=[],t.kuanArr=[])},this.rotBtn.tab=function(e){if(!t.isTweening){var i=t.body.rotation+Math.PI,o={rot:t.body.get_rotation()};t.isTweening=!0,TweenMax.to(o,2,{rot:i,onUpdate:function(){t.body.set_rotation(o.rot)},onComplete:function(){t.isTweening=!1}})}},this.aMoveBtn.tab=function(e){t.isMove||(t.isMove=!0,t.shadow.removeChildren(),t.a=1.005,t.speed=5,t.moveStep=0,t.guanArr=[],t.kuanArr=[])}}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.moveBtn.x=this.bg.x-this.move_x,this.moveBtn.y=this.bg.y-this.move_y,this.rotBtn.x=this.bg.x-this.rot_x,this.rotBtn.y=this.bg.y-this.rot_y,this.aMoveBtn.x=this.bg.x-this.a_move_x,this.aMoveBtn.y=this.bg.y-this.a_move_y,this.isMove&&this.sgMoveHandler()}},{key:"sgMoveHandler",value:function(){if(this.body.get_position().get_x()>this.globalConfig.napeWallW-200)return this.isMove=!1,this.a=0,void(this.speed=5);this.compo.translate(_.get(this.speed,0)),this.a>0?(this.speed*=this.a,this.moveStep%10==0&&this.drawShadow()):this.moveStep%20==0&&this.drawShadow(),200>++this.moveStep||(this.isMove=!1,this.a=0,this.speed=5)}},{key:"drawShadow",value:function(){this.shadow.removeChildren(),this.guanArr.push({x:this.bg.x,y:this.bg.y,ro:this.bg.rotation}),this.kuanArr.push({x:this.wk.x,y:this.wk.y,ro:this.wk.rotation});var t=0;for(t=0;this.guanArr.length>t;t++){var e=new PIXI.RenderTexture(this.globalConfig.main.renderer,this.bg.width,this.bg.height),i=new PIXI.Matrix;i.translate(.5*this.bg.width,.5*this.bg.height),e.render(this.bg,i);var o=new PIXI.Sprite(e);o.pivot.x=o.width/2,o.pivot.y=o.height/2,o.x=this.guanArr[t].x,o.y=this.guanArr[t].y,o.rotation=this.guanArr[t].ro;var n=.1*t+.1;o.alpha=1>n?n:1,this.shadow.addChild(o)}for(t=0;this.kuanArr.length>t;t++){var s=new PIXI.RenderTexture(this.globalConfig.main.renderer,this.wk.width,this.wk.height),a=new PIXI.Matrix;a.translate(.5*this.wk.width,.5*this.wk.height),s.render(this.wk,a);var r=new PIXI.Sprite(s);r.pivot.x=r.width/2,r.pivot.y=r.height/2,r.x=this.kuanArr[t].x,r.y=this.kuanArr[t].y,r.rotation=this.kuanArr[t].ro;var h=.1*t+.1;r.alpha=1>h?h:1,this.shadow.addChildAt(r,0)}}},{key:"removed",value:function(){this.removedCursor(this.moveBtn),this.removedCursor(this.rotBtn),this.removedCursor(this.aMoveBtn),delete this.bg.translateMove,this.BodyUtil.destoryBody(this.wkBody),this.water.removed(),this.moveBtn.destroy(),this.rotBtn.destroy(),this.aMoveBtn.destroy(),this.compo.set_space(null),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"getLocalBoundsElecs",value:function(){return[this.bg]}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function C(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:C(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(449),p=o(d),y=i(454),f=o(y),g=void 0,b=void 0,v=void 0,_=void 0,m=void 0,x=void 0,w=void 0,k=void 0,P=void 0,O=void 0,T=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return g=i.phy.nape,b=g.NbBody,v=g.phys.Compound,_=g.callbacks.InteractionListener,m=g.callbacks.InteractionType,x=g.callbacks.CbEvent,w=g.callbacks.CbType,k=g.shape.Polygon,P=g.shape.Circle,O=g.geom.Vec2,T=g.shape.HockShapeBase,i.classType="NbCar",i.level=15,i._width=80,i._height=60,i.leftlun=null,i.rightlun=null,i.tic=null,i.hock=null,i.isWeldBoard=!1,i.weldJoint=null,i.var_boardInterListener=null,i.dangHit=null,i.cbtype=new w,i.compo=new v,i.weldCarBeforeFunc=null,i.isUse=!1,i.hockIsUse=!1,i.ticEquFunc=null,i.leftJoint=null,i.rightJoint=null,i}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.addCbType(this.cbtype),this.compo.set_space(this.body.get_space()),this.createLun(),this.initHock(),this.body.set_compound(this.compo),this.initListener(),this.setThisMass(100)}},{key:"setComponent",value:function(t){var e=this;this.noRenderSelected=!0,this.iscomponent=t,this.removeNapeListeners(this.var_boardInterListener),this.dangHit=new _(x.get_BEGIN(),m.get_COLLISION(),this.cbtype,this.CbTypeStr.PULL_LONG_DANG,function(t){if(e.board&&e.tic){t.get_int2().get_body()==e.board.body&&e.tic.dispatchEvent(f["default"].TICKER_PAPER_AUTOMATIC_BREAK)}}),this.addNapeListeners(this.dangHit)}},{key:"initListener",value:function(){var t=this;this.addEventListener(p["default"].BEGIN,function(e){t.beginHandler(e)}),this.addEventListener(p["default"].END,function(e){t.endHandler(e)}),this.var_boardInterListener=new _(x.get_ONGOING(),m.get_SENSOR(),this.cbtype,this.CbTypeStr.PULL_LONG_BOARD,function(e){t.boardHitHandler(e)}),this.addNapeListeners(this.var_boardInterListener)}},{key:"boardHitHandler",value:function(t){if(!this.isWeldBoard&&!this.working){var e=this.BodyUtil.getBodyFromCb(t),i=e[0].userData.view,o=void 0;o=e[1]instanceof k?e[1].get_body().userData.view:e[1].userData.view,i==this&&o&&(this.board=o)}}},{key:"beginHandler",value:function(t){this.tic&&this.tic.var_powerIsOpen||this.weldJoint&&(this.weldJoint.active=!1,this.isWeldBoard=!1)}},{key:"endHandler",value:function(t){if(this.weldJoint){if(this.tic&&this.tic.var_powerIsOpen)return;null!=this.weldCarBeforeFunc&&this.weldCarBeforeFunc();this.weldJoint.anchor2=this.board.body.worldPointToLocal(this.body.position),this.weldJoint.active=!0}this.isUse||this.func_checkHitTickerPaper()}},{key:"func_checkHitTickerPaper",value:function(){var t=this,e=this.getChildrenByClass("HTickerTimer"),i=0;for(i=0;e.length>i;i++){var o=e[i];if(!o.var_hasCar&&!o.var_powerIsOpen){var n=o.getPaperRightP();if(n&&this.body.contains(O.get(n.x,n.y)))return this.tic=o,o.bindCar=this,this.isUse=!0,this.func_weldCar(),this.ticEquFunc=function(e){t.func_tickPowerChange()},this.tic.addEventListener(f["default"].TICKER_POWER_CHANGE,this.ticEquFunc),!0}}return!1}},{key:"breakWeldJoint",value:function(){this.board&&!this.board.iscomponent&&this.weldJoint&&(this.board.startBtn.visible=!1),this.weldJoint&&(this.BodyUtil.destoryJoint(this.weldJoint),this.weldJoint=null)}},{key:"func_tickPowerChange",value:function(){this.tic.var_powerIsOpen?(this.working=!0,this.isWeldBoard=!1):this.working=!1}},{key:"getThisMass",value:function(){return this.body.get_mass()+this.leftlun.get_mass()+this.rightlun.get_mass()}},{key:"setThisMass",value:function(t){this.body.set_mass(t/5),this.leftlun.set_mass(t/2),this.rightlun.set_mass(3*t/10)}},{key:"func_weldCar",value:function(){null!=this.board&&(this.breakWeldJoint(),null!=this.weldCarBeforeFunc&&this.weldCarBeforeFunc(),this.body.set_rotation(this.board.body.get_rotation()),this.weldJoint=this.JointUtil.createWeldJoint(this.body,this.board.body,this.body.position,this.body.position),this.isWeldBoard=!0,!this.board.iscomponent&&this.weldJoint&&(this.board.startBtn.visible=!0))}},{key:"initHock",value:function(){this.hock=new T(15),this.hock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.hock),this.hock.translate(O.get(43,-4.5)),this.hock.addCbtype(this.CbTypeStr.PULLEY_TICK_CAR),this.addTweenQuan(this.hock)}},{key:"createLun",value:function(){function t(t,o){var n=new P(i,null,e),s=new b;return s.add(n),s.set_position(O.get(o.x+t.x,o.y+t.y)),s.userData.view=t,s.mass=2,s}var e=new g.phys.Material(.2,1,1,1,1.77),i=.5*this.left.width;this.leftlun=t(this.left,this),this.rightlun=t(this.right,this),this.addBodyToSpace(this.leftlun,this.parent),this.addBodyToSpace(this.rightlun,this.parent),this.leftlun.set_compound(this.compo),this.rightlun.set_compound(this.compo),this.parent.addChild(this.left),this.parent.addChild(this.right),this.leftJoint=this.JointUtil.createPivotJoint(this.leftlun,this.body,this.leftlun.position,this.leftlun.position),this.rightJoint=this.JointUtil.createPivotJoint(this.rightlun,this.body,this.rightlun.position,this.rightlun.position),this.leftJoint.set_compound(this.compo),this.rightJoint.set_compound(this.compo)}},{key:"update",value:function(){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.body.userData.dragManager&&this.body.set_angularVel(0),this.tic){var t=this.tic.getPaperRightP();if(null==t)return this.tic.removeEventListener(f["default"].TICKER_POWER_CHANGE,this.ticEquFunc),this.tic=null,this.isUse=!1,this.isWeldBoard=!1,void this.breakWeldJoint();var i=this.body.worldPointToLocal(O.get(t.x,t.y));if(Math.abs(i.get_y())>50)this.tic.removeEventListener(f["default"].TICKER_POWER_CHANGE,this.ticEquFunc),this.tic=null,this.isUse=!1,this.isWeldBoard=!1,this.breakWeldJoint();else{this.tic.func_changePaperXY(this.toGlobalView(new l.Point(this.bg.x-42,this.bg.y),this))}}if(this.leftJoint){this.leftlun.set_position(this.body.localPointToWorld(this.leftJoint.get_anchor2()))}if(this.rightJoint){this.rightlun.set_position(this.body.localPointToWorld(this.rightJoint.get_anchor2()))}}},{key:"func_setRollingFriction",value:function(t,e){this.BodyUtil.setBodyMaterial(t,{rollingFriction:e})}},{key:"translateCom",value:function(t,e){this.compo.translate(O.get(t,e))}},{key:"removed",value:function(){this.compo.set_space(null),this.compo.breakApart(),this.tic=null,this.board=null,this.removeNapeListeners(this.var_boardInterListener),this.dangHit&&this.removeNapeListeners(this.dangHit),this.removeAllListeners(),this.BodyUtil.destoryBody(this.leftlun),this.BodyUtil.destoryBody(this.rightlun),this.hock.dragToolClick(),this.hock.dispose(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this),this.leftlun=null,this.rightlun=null}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.mass=this.getThisMass(),this.board&&(t.boardUid=this.board.UID),this.tic&&(t.ticUid=this.tic.UID),t}},{key:"setData",value:function(t){var i=this;if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.setThisMass(t.mass),t.boardUid){this.board=this.getBodyFromUid(t.boardUid).userData.view}if(t.ticUid){var o=this.getChildByUID(t.ticUid);if(null==o)return;this.tic=o,o.bindCar=this,this.isUse=!0,this.func_weldCar(),this.ticEquFunc=function(t){i.func_tickPowerChange()},this.tic.addEventListener(f["default"].TICKER_POWER_CHANGE,this.ticEquFunc)}}},{key:"changeMass",value:function(t){this.setThisMass(l.M.getNumStr(t.showValue)-0)}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("mass"),!0,"g",500,50,this.getThisMass(),1,this.changeMass,this)),t}},{key:"getTipMess",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.language.getLocaleStr("mass")+": "+this.getThisMass()+"\n    "}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function v(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:v(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(449),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.geom.Vec2,g=y.phys.BodyType,b=y.shape.Polygon,i.level=10,i.classType="NbDesk",i.jointList=[],i.alignAfterScale=!1,i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;this.material=new y.phys.Material(0,1,2,.8,1),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.createAllBodyShape(),this.body.set_type(g.get_KINEMATIC()),this.body.userData.dragLevel=-2,this.BodyUtil.setBodyMaterial(this.body,{elasticity:0}),this.dragBeginCallBack=function(e){t.dragBegin(e)},this.dragEndCallBack=function(e){t.dragEnd(e)},this.addEventListener(p["default"].BEGIN,this.dragBeginCallBack),this.addEventListener(p["default"].END,this.dragEndCallBack)}},{key:"removed",value:function(){this.removeEventListener(p["default"].BEGIN,this.dragBeginCallBack),this.removeEventListener(p["default"].END,this.dragEndCallBack),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"setComponent",value:function(){this.iscomponent=0>=arguments.length||arguments[0]===undefined||arguments[0],this.noRenderSelected=!0}},{key:"createAllBodyShape",value:function(){this.body.get_shapes().clear();var t=[{x:-404,y:-38},{x:-404,y:201},{x:-319,y:86},{x:-319,y:-38}],e=[{x:327,y:-38},{x:327,y:86},{x:411,y:201},{x:411,y:-38}],i=[{x:430,y:-94},{x:411,y:-144},{x:-404,y:-144},{x:-423,y:-94},{x:-404,y:-38},{x:411,y:-38}],o=this.BodyUtil.createPolygonFromPoints(t,this.body,this.material),n=this.BodyUtil.createPolygonFromPoints(e,this.body,this.material);this.BodyUtil.createPolygonFromPoints(i,this.body,this.material),o.set_sensorEnabled(!0),n.set_sensorEnabled(!0);var s=new b(b.rect(-380,-200,760,60));s.set_sensorEnabled(!0),this.body.add(s)}},{key:"rightPi",value:function(){return this.body.localPointToWorld(f.get(410,-144))}},{key:"leftPi",value:function(){return this.body.localPointToWorld(f.get(-404,-144))}},{key:"dragBegin",value:function(t){var e=this,i=this.body;this.body.interactingBodies().foreach(function(t){var o=t.userData.view;if("WoodPad"==o.classType||"PulleyLongBoard"==o.classType){var n=e.JointUtil.createWeldJoint(i,t,t.get_position(),t.get_position());e.jointList.push(n)}})}},{key:"dragEnd",value:function(t){for(var e=0;this.jointList.length>e;e++)this.BodyUtil.destoryJoint(this.jointList[e]);this.jointList.length=0}},{key:"setScale",value:function(t,i){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setScale",this).call(this,t,i),this.bg.scale.x=t,this.bg.scale.y=i}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.body.transformShapes(this.transformN),this.scale.x=this.currentScale.x,this.scale.y=this.currentScale.y}},{key:"changeZoom",value:function(t){var e=t.showValue;this.setScale(e,e)}},{key:"getConf",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("scale"),!0,"",2,1,l.M.getNumJie(this.currentScale.x),.05,this.changeZoom,this)),t}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function T(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:T(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(446),u=o(l),c=i(451),d=o(c),p=void 0,y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0,m=void 0,x=void 0,w=void 0,k=void 0,P=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return p=i.phy.nape,y=p.geom.Vec2,f=p.shape.Polygon,g=p.shape.Circle,b=p.phys.BodyType,v=p.phys.Material,_=p.callbacks.PreListener,m=p.callbacks.InteractionListener,x=p.callbacks.InteractionType,w=p.callbacks.CbEvent,k=p.callbacks.CbType,P=p.callbacks.PreFlag,i.ball=null,i.qian=null,i.canReset=!0,i.islock=!0,i.ballArr=[],i.WIDTH=650,i.HEIGHT=480,i.BALL_R=32,i.BALL_NUM=5,i.BALL_R=30,i.SPACE_X=2*i.BALL_R+1e-6,i.START_X=-i.SPACE_X*(i.BALL_NUM-1)/2,i.START_Y=-210,i.LINE_LEN=220,i.lineGra=new PIXI.Graphics,i.addChild(i.lineGra),i.mode=1,i.modes=[i.language.getLocaleStr("ideal"),i.language.getLocaleStr("real")],i}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.removeChild(this.ball),this.body.noallowRotation=!0,this.body.userData.cannotToolRot=!0,this.body.userData.dragLevel=-1,this.body.get_shapes().clear();var t=new f(f.box(600,100));t.translate(y.get(0,190)),this.body.add(t);var i=new f(f.box(this.WIDTH,this.HEIGHT));this.body.add(i),i.set_sensorEnabled(!0),this.changeLock({checked:!0}),this.cbtype=new k;for(var o=this.body.posy+this.START_Y,n=0;this.BALL_NUM>n;n++){var s=new O(this.paramObj,this.BALL_R,this.cbtype);this.addChild(s),s.init(),this.initBallPosition(s,n),s.tx=this.START_X+n*this.SPACE_X,s.ty=this.START_Y,s.id=n,this.ballArr.push(s),this.JointUtil.createDistanceJoint(this.body,s.body,y.get(s.x,o),y.get(s.x,s.y-this.BALL_R),this.LINE_LEN,this.LINE_LEN)}this.addChild(this.qian),this.preListener=new _(x.get_COLLISION(),this.cbtype,this.cbtype,this.preHitHandler.bind(this)),this.addNapeListeners(this.preListener),this.hitListener=new m(w.get_END(),x.get_COLLISION(),this.cbtype,this.cbtype,this.ballHitHandler.bind(this)),this.addNapeListeners(this.hitListener),this.hitListener2=new m(w.get_BEGIN(),x.get_COLLISION(),this.cbtype,this.cbtype,this.ballHitHandler.bind(this)),this.addNapeListeners(this.hitListener2)}},{key:"reset",value:function(){this.resetClick()}},{key:"removed",value:function(){this.removeNapeListeners(this.preListener),this.removeNapeListeners(this.hitListener),this.removeNapeListeners(this.hitListener2);for(var t=0;this.ballArr.length>t;t++){var i=this.ballArr[t];i.removeBodyFromSpace(i.body)}this.ballArr=[],h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.lineGra.clear(),this.lineGra.lineStyle(4,12829635,1);for(var t=0;this.ballArr.length>t;t++){var i=this.ballArr[t],o=i.getP();this.lineGra.moveTo(o.x,o.y);var n=5*(t-(this.BALL_NUM-1)/2);if(this.lineGra.lineTo(i.tx+n,i.ty-15),this.lineGra.moveTo(o.x,o.y),this.lineGra.lineTo(i.tx-n,i.ty+18),i.correctPositionFlag){switch(i.correctPositionFlag=!1,this.toStaBody(i.body),this.mode){case 0:this.initBallPosition(i,i.id);break;case 2:var s=i.id,a=this.body.posx+this.START_X+s*this.SPACE_X,r=this.body.posy+this.START_Y+this.LINE_LEN+this.BALL_R;i.x=(a+i.body.posx)/2,i.y=(r+i.body.posy)/2,i.body.set_position(y.get(i.x,i.y))}i.update()}}this.body&&this.body.userData&&this.body.userData.dragManager&&this.resetClick()}},{key:"preHitHandler",value:function(t){var e=t.get_int1(),i=t.get_int2(),o=e.get_body(),n=i.get_body(),s=o.userData.view,a=n.userData.view,r=this.body.get_velocity().copy(),h=o.get_velocity().copy(),l=n.get_velocity().copy();return h=h.sub(r),l=l.sub(r),this.correctBallV(h),this.correctBallV(l),o.get_velocity().set_x(l.get_x()),o.get_velocity().set_y(l.get_y()),n.get_velocity().set_x(h.get_x()),n.get_velocity().set_y(h.get_y()),this.correctBallPosition(s),this.correctBallPosition(a),P.get_IGNORE()}},{key:"correctBallPosition",value:function(t){if(10>=t.body.get_velocity().get_length()){var e=t.id,i=this.body.posx+this.START_X+e*this.SPACE_X;30>Math.abs(t.body.posx-i)&&(t.correctPositionFlag=!0)}}},{key:"correctBallV",value:function(t){var e=t.get_x(),i=t.get_y();if(Math.abs(e/i)>20){var o=e>0?1:-1;e=t.get_length()*o,i=0,t.set_x(e),t.set_y(i)}}},{key:"ballHitHandler",value:function(t){var e=t.get_int1(),i=t.get_int2();e.get_body(),i.get_body()}},{key:"setBallDensity",value:function(t){for(var e=0;this.BALL_NUM>e;e++){this.ballArr[e].setDensity(t)}}},{key:"changeLock",value:function(t){this.islock=t.checked,this.islock?this.body.set_type(b.get_KINEMATIC()):(this.body.set_type(b.get_DYNAMIC()),this.body.set_allowRotation(!1))}},{key:"resetClick",value:function(){for(var t=0;this.ballArr.length>t;t++){var e=this.ballArr[t];this.initBallPosition(e,t),this.toStaBody(e.body),e.update()}}},{key:"toStaBody",value:function(t){t.set_rotation(0),t.set_velocity(y.get(0,0)),t.set_angularVel(0)}},{key:"initBallPosition",value:function(t,e){var i=this.body.posx+this.START_X+e*this.SPACE_X,o=this.body.posy+this.START_Y+this.LINE_LEN+this.BALL_R;t.x=i,t.y=o,t.body.set_position(y.get(i,o))}},{key:"modeChange",value:function(t){this.mode=t.checked}},{key:"getConf",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push(this.ComponentProperty.getRadio(this.language.getLocaleStr("simulation_model"),this.mode,this.modes,this.modeChange.bind(this))),t}}]),e}(u["default"]);var O=function(t){function e(t,i,o){n(this,e);var a=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.r=i,a.tx=0,a.ty=0,a.cbtype=o,a.id=0,a.correctPositionFlag=!1,a}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.get_shapes().clear();var t=new v(1,1,2,100,1e-4),i=new g(this.r,y.get(0,0),t);i.get_cbTypes().add(this.cbtype),this.body.add(i),this.shape=i;var o=new g(this.r-.001,y.get(0,0),t);this.body.add(o),this.shape2=o;var n=PIXI.Texture.fromFrame("NewtonsCradle/ball.png"),s=new PIXI.Sprite(n);this.addChild(s),s.x=-s.width/2,s.y=-s.height/2,this.body.set_isBullet(!0),this.body.set_disableCCD(!0),this.body.userData.allowMove=!1}},{key:"removed",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"setDensity",value:function(t){this.shape.get_material().set_density(t),this.shape2.get_material().set_density(t)}},{key:"getP",value:function(){return{x:this.x+this.r*Math.sin(this.rotation),y:this.y-this.r*Math.cos(this.rotation)}}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.parent&&(this.x=this.body.posx-this.parent.x,this.y=this.body.posy-this.parent.y)}}]),e}(d["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function f(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:f(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(610),u=o(l),c=i(543),d=o(c),p=void 0,y=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return p=i.phy.nape,y=p.geom.Vec2,i.k_areaToH=1,i.liquidW=322,i.halfW=i.liquidW/2,i.wallW=20,i.wallH=434,i.wallOfy=0,i.botH=12,i.boty=210,i.fullH=395,i.totalRange=120,i.isOverflow=!0,i.canReset=!0,i.valueTxtxy={x:200,y:-220},i.poshapexy={x:155,y:-237},i.hitxy={x:250,y:80},i.pourTest={x:250,y:-68},i}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.poshape&&this.body.remove(this.poshape),this._setOriLiquidVolume()}},{key:"_setOriLiquidVolume",value:function(){this.changeLiquidVolume({showValue:"90mL"})}},{key:"createpourshape",value:function(){this.pouringY=-86.1}},{key:"waterPouring",value:function(t){for(var e=this.body.localPointToWorld(y.get(this.hitxy.x,this.hitxy.y)),i=this.body.localPointToWorld(y.get(this.pourTest.x,this.pourTest.y)),o=this.space.bodiesUnderPoint(e),n=o.get_length(),s=0;n>s;s++){var a=o.at(s),r=a.userData.view;if(r&&r instanceof d["default"]){if(a.worldPointToLocal(i).get_y()<r.pouringY){return void r.waterFlooding(t,{density:this.liquid.density,alpha:this.liqAlpha})}}}}},{key:"reset",value:function(){this._setOriLiquidVolume()}},{key:"getConf",value:function(){var t={};return t.confArr=[],t}},{key:"dragBegin",value:function(t){}},{key:"dragEnd",value:function(t){}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this)}},{key:"getTipMess",value:function(t){return'    <font class="pre-tipmess-title">'+(t||this.elecLable)+"</font>"}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function b(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:b(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0,y=void 0,f=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.geom.Vec2,p=c.phys.BodyType,y=c.shape.HockShapeBase,f=c.phys.Compound,i.level=14,i.ring=null,i.spring=null,i.springLine=new PIXI.Graphics,i.data1={},i.data2={},i.data3={},i.minx=0,i.miny=0,i.maxx=0,i.maxy=0,i._w=900,i._h=900,i.lineSpace=100,i.txt1=new PIXI.Text("",{font:"25px Arial",fill:16750848}),i.txt2=new PIXI.Text("",{font:"25px Arial",fill:16750848}),i.txt3=new PIXI.Text("",{font:"25px Arial",fill:16750848}),i.txt4=new PIXI.Text("",{font:"25px Arial",fill:16750848}),i.txt5=new PIXI.Text("",{font:"25px Arial",fill:255}),i}return s(e,t),a(e,[{key:"init",value:function(){this._width=800,this._height=800,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_type(p.get_KINEMATIC()),this.body.set_sensorEnabled_at(0,!0),this.body.userData.dragLevel=-1,this.body.userData.dragtranslate=!0,this.ring=new g(this.paramObj),this.ring.init(),this.parent.addChild(this.ring),this.ring.body.posx=this.x+this.huan.x,this.ring.body.posy=this.y+this.huan.y,this.ring.addChild(this.huan),this.huan.x=this.huan.y=0,this.gh=new PIXI.Graphics,this.addChild(this.gh),this.addChild(this.springLine),this.addChild(this.txt1),this.addChild(this.txt2),this.addChild(this.txt3),this.addChild(this.txt4),this.addChild(this.txt5),this.initSpring(),this.addCompound()}},{key:"translateMove",value:function(t,e){this.compo&&this.compo.translate(d.get(t,e))}},{key:"addCompound",value:function(){this.compo=new f,this.compo.set_space(this.body.get_space()),this.body.set_compound(this.compo),this.ring.body.set_compound(this.compo),this.spring.set_compound(this.compo)}},{key:"initSpring",value:function(){var t=this.body.localPointToWorld(d.get(this.bg.ding.x,this.bg.ding.y)),e=Math.abs(this.ring.body.posy-t.get_y());this.spring=this.JointUtil.createDistanceJoint(this.ring.body,this.body,this.ring.body.position,t,e,e),this.spring.stiff=!1,this.spring.frequency=2,this.spring.damping=1}},{key:"update",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.updateTransform(),this.drawSpring(),this.BodyUtil.frezzBody(this.ring.body);var t=this.ring.hock1,i=this.ring.hock2;if(t.get_userData().useing&&i.get_userData().useing){this.setHockData(this.data1,t,this.txt1),this.setHockData(this.data2,i,this.txt2),this.txt1.text="F1("+this.data1.f+"N)",this.txt2.text="F2("+this.data2.f+"N)",this.txt4.visible=!0;var o=this.body.worldPointToLocal(this.ring.body.position);this.txt4.x=o.x,this.txt4.y=o.y}else t.get_userData().useing&&!i.get_userData().useing&&(this.setHockData(this.data3,t,this.txt3),this.txt3.text="F("+this.data3.f+"N)"),!t.get_userData().useing&&i.get_userData().useing&&(this.setHockData(this.data3,i,this.txt3),this.txt3.text="F("+this.data3.f+"N)");this.drawLine()}},{key:"drawLine",value:function(){var t=new d(-this._w/2,-this._h/2),e=new d(this._w/2,this._h/2);this.minx=t.x,this.miny=t.y,this.maxx=e.x,this.maxy=e.y;var i=this.gh;i.clear();var o=void 0,n=void 0;if(this.data1.add){o=this.data1.start,n=this.data1.end,i.lineStyle(2,16711680),this.gra0(i,o,n,this.data1.u);var s=this.Vec2Util.pointToVec2(h.M.rotaPointFromP(this.Vec2Util.vec2ToPoint(this.data1.u),new h.Point,7*Math.PI/6)),a=this.Vec2Util.pointToVec2(h.M.rotaPointFromP(this.Vec2Util.vec2ToPoint(this.data1.u),new h.Point,7*-Math.PI/6));this.gra(i,n,s,.2),this.gra(i,n,a,.2),i.lineStyle(2,16711680);var r=d.get(this.bg.ding.x,this.bg.ding.y),l=o.sub(r);this.gra0(i,r,o,0==l.get_length()?1:l.unit(),!0);var u=new d(n.get_x()+this.data2.u.get_x()*this.data2.f*this.lineSpace,n.get_y()+this.data2.u.get_y()*this.data2.f*this.lineSpace),c=u.sub(o),p=0==c.get_length()?1:c.unit();this.gra0(i,n,u,this.data2.u,!0),i.lineStyle(2,255),this.gra0(i,o,u,p),this.txt5.x=u.get_x(),this.txt5.y=u.get_y()+30,this.txt5.text="F("+h.M.getNumJie(d.distance(o,u)/this.lineSpace,2)+"N)";var s=this.Vec2Util.pointToVec2(h.M.rotaPointFromP(this.Vec2Util.vec2ToPoint(p),new h.Point,7*Math.PI/6)),a=this.Vec2Util.pointToVec2(h.M.rotaPointFromP(this.Vec2Util.vec2ToPoint(p),new h.Point,7*-Math.PI/6));this.gra(i,u,s,.2),this.gra(i,u,a,.2)}if(this.data2.add){o=this.data2.start,n=this.data2.end,i.lineStyle(2,16711680),this.gra0(i,o,n,this.data2.u);var s=this.Vec2Util.pointToVec2(h.M.rotaPointFromP(this.Vec2Util.vec2ToPoint(this.data2.u),new h.Point,7*Math.PI/6)),a=this.Vec2Util.pointToVec2(h.M.rotaPointFromP(this.Vec2Util.vec2ToPoint(this.data2.u),new h.Point,7*-Math.PI/6));this.gra(i,n,s,.2),this.gra(i,n,a,.2),i.lineStyle(1),this.gra0(i,n,d.get(n.get_x()+this.data1.u.get_x()*this.data1.f*this.lineSpace,n.get_y()+this.data1.u.get_y()*this.data1.f*this.lineSpace),this.data1.u,!0)}if(this.data3.add){o=this.data3.start,n=this.data3.end,i.lineStyle(2,16711680),this.gra0(i,o,n,this.data3.u);var s=this.Vec2Util.pointToVec2(h.M.rotaPointFromP(this.Vec2Util.vec2ToPoint(this.data3.u),new h.Point,7*Math.PI/6)),a=this.Vec2Util.pointToVec2(h.M.rotaPointFromP(this.Vec2Util.vec2ToPoint(this.data3.u),new h.Point,7*-Math.PI/6));this.gra(i,n,s,.2),this.gra(i,n,a,.2)}}},{key:"gra0",value:function(t,e,i,o,n){var s=h.M.vec2Length(e.sub(i)),a=void 0;for(a=0;s>a;a++){var r=e.get_x()+o.get_x()*a,l=e.get_y()+o.get_y()*a,u=a%6;this.minx>r||r>this.maxx||this.miny>l||l>this.maxy||0==a||3>u&&n?t.moveTo(r,l):t.lineTo(r,l)}}},{key:"gra",value:function(t,e,i,o,n){var s=void 0;for(s=0;o*this.lineSpace>s;s++){var a=e.get_x()+i.get_x()*s,r=e.get_y()+i.get_y()*s,h=s%6;this.minx>a||a>this.maxx||this.miny>r||r>this.maxy||0==s||3>h&&n?t.moveTo(a,r):t.lineTo(a,r)}}},{key:"setHockData",value:function(t,e,i){var o=e.get_userData().bind,n=o.get_body().userData.view.bindParent,s=n.force,a=n.body.position.sub(this.ring.body.position).unit();t.start=this.body.worldPointToLocal(d.get(this.ring.body.posx,this.ring.body.posy)),t.end=this.body.worldPointToLocal(d.get(this.ring.body.posx+a.get_x()*s*this.lineSpace,this.ring.body.posy+a.get_y()*s*this.lineSpace)),t.add=!0,t.u=a,t.f=s,i.x=t.end.get_x(),i.y=t.end.get_y()}},{key:"drawSpring",value:function(){this.springLine.clear(),this.springLine.lineStyle(7,14703885);var t=new h.Point(this.bg.ding.x,this.bg.ding.y);this.springLine.moveTo(t.x,t.y);var e=this.springLine.toLocal(new h.Point,this.ring),i=h.M.getXianDianByDis(16,!0,e,t);this.springLine.lineTo(i.x,i.y)}},{key:"removed",value:function(){this.ring.removed(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}}]),e}(u["default"]);var g=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.hock1=null,i.hock2=null,i}return s(e,t),a(e,[{key:"init",value:function(){var t=this;this.radius=30,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_isBullet(!0),this.body.noallowRotation=!0,this.hock1=new y(15),this.hock2=new y(15),this.hock1.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.hock2.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.hock1),this.body.add(this.hock2),this.hock1.addCbtype(this.CbTypeStr.PARALL_R_HOCK),this.hock2.addCbtype(this.CbTypeStr.PARALL_R_HOCK),this.hock1.createListener(this.CbTypeStr.SPRING_HOCK,this.CbTypeStr.PARALL_R_HOCK),this.hock2.createListener(this.CbTypeStr.SPRING_HOCK,this.CbTypeStr.PARALL_R_HOCK),this.addTweenQuan(this.hock1),this.addTweenQuan(this.hock2),this.hock1.breakClickCallback=function(){t.hock2.get_userData().useing||(t.hock1.var_isbreaking=!0,t.hock2.var_isbreaking=!0,setTimeout(function(){t.hadDestory||(t.hock1.var_isbreaking=!1,t.hock2.var_isbreaking=!1)},1e3))},this.hock2.breakClickCallback=function(){t.hock1.get_userData().useing||(t.hock1.var_isbreaking=!0,t.hock2.var_isbreaking=!0,setTimeout(function(){t.hadDestory||(t.hock1.var_isbreaking=!1,t.hock2.var_isbreaking=!1)},1e3))}}},{key:"removed",value:function(){this.hock1.dragToolClick(),this.hock2.dragToolClick(),this.hock1.dispose(),this.hock2.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function p(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:p(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.phys.BodyType,i.islocak=!1,i.deep=0,i.lockStr=i.getLocaleStr("lock","锁定"),i.unlockStr=i.getLocaleStr("unlock","解锁"),i.fdzarr=["1mm","5mm","1cm"],i.fzIndex=0,i.fluidDensity=1,i.redLine=null,i.guanSp=null,i.bgtouchid=null,i.touMask=new PIXI.Graphics,i.touline=new PIXI.Graphics,i}return s(e,t),a(e,[{key:"init",value:function(){this._width=580,this._height=880,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_type(d.get_KINEMATIC()),this.body.sensorEnabled(!0),this.redLine=new PIXI.Graphics,this.addChildAt(this.redLine,1),this.guanSp=new PIXI.Graphics,this.addChildAt(this.guanSp,4),this.initGan(),this.initBtn(),this.drawRedLine(),this.drawGuan(),this.glass.addChild(this.touMask),this.glass.mc.addChild(this.touline),this.touMask.x=this.glass.mc.x,this.touMask.y=this.glass.mc.y,this.glass.mc.mask=this.touMask,this.addCursor(this.btn,"hand"),this.addCursor(this.gan.bg,"shangxia"),this.fzdChange({showValue:"1mm"})}},{key:"drawMask",value:function(t){var e=60*t/518,i=this.glass.mc;this.touMask.clear(),this.touMask.lineStyle(1,16711680),this.touMask.beginFill(0,1),this.touMask.moveTo(0,0),this.touMask.lineTo(0,i.height),this.touMask.lineTo(i.width,i.height),this.touMask.lineTo(i.width,0),this.touMask.quadraticCurveTo(i.width/2,e,0,0),this.touline.clear(),this.touline.lineStyle(6,16777215),this.touline.moveTo(149,4),e=4>e?4:e,this.touline.quadraticCurveTo(i.width/2,e,10,4)}},{key:"initBtn",value:function(){var t=this;this.btn.fontColor="#ffffff",this.btn.text=this.lockStr,this.btn["this"]=this,this.btn.tab=function(e){t.islocak?(t.islocak=!1,t.btn.text=t.lockStr):(t.islocak=!0,t.btn.text=t.unlockStr),e.stopImmediatePropagation()}}},{key:"drawRedLine",value:function(){var t=this.deep*this.fluidDensity,e=t/370,i=h.M.getNumJie(10*e,0)-1;0>i&&(i=0),this.drawMask(t),this.redLine.clear(),this.redLine.lineStyle(17,15143723),this.redLine.moveTo(-180,-72-t/2),this.redLine.lineTo(-180,228),this.redLine.moveTo(-145,t/2-72),this.redLine.lineTo(-145,228)}},{key:"drawGuan",value:function(){switch(this.guanSp.clear(),this.guanSp.lineStyle(20,11248711),this.guanSp.moveTo(-147,-417),this.guanSp.lineTo(-147,-437),this.guanSp.moveTo(-150,-430),this.gan.tou.currentFrame%8){case 0:this.guanSp.quadraticCurveTo(-55,-550,-40,-424),this.guanSp.lineTo(20,this.gan.y+this.gan.height+20),this.guanSp.quadraticCurveTo(this.gan.x-85,this.gan.y+this.gan.height+100,this.gan.x-45,this.gan.y+this.gan.height-5);break;case 1:this.guanSp.quadraticCurveTo(-55,-550,-40,-424),this.guanSp.lineTo(20,this.gan.y+this.gan.height+20),this.guanSp.quadraticCurveTo(this.gan.x-85,this.gan.y+this.gan.height+100,this.gan.x-45,this.gan.y+this.gan.height-3);break;case 2:this.guanSp.quadraticCurveTo(-55,-550,-40,-424),this.guanSp.quadraticCurveTo(-30,-250,this.gan.x-65,this.gan.y+this.gan.height-80);break;case 3:this.guanSp.quadraticCurveTo(-55,-550,-40,-424),this.guanSp.lineTo(this.gan.x-55,this.gan.y+this.gan.height-40);break;case 4:this.guanSp.quadraticCurveTo(-55,-550,-40,-424),this.guanSp.lineTo(this.gan.x-40,this.gan.y+this.gan.height-30);break;case 5:this.guanSp.quadraticCurveTo(-55,-550,-40,-424),this.guanSp.lineTo(this.gan.x-40,this.gan.y+this.gan.height-40);break;case 6:this.guanSp.quadraticCurveTo(-55,-550,-40,-424),this.guanSp.lineTo(this.gan.x-35,this.gan.y+this.gan.height-40);break;case 7:this.guanSp.quadraticCurveTo(-55,-550,-40,-424),this.guanSp.lineTo(20,this.gan.y+this.gan.height+20),this.guanSp.quadraticCurveTo(this.gan.x-85,this.gan.y+this.gan.height+100,this.gan.x-45,this.gan.y+this.gan.height-5)}}},{key:"initGan",value:function(){function t(t){o=this.getMouseXY(t),this.body.userData.noDrag=!0;var e=this.gan.toLocal(o,s.view),i=new PIXI.Rectangle(36,-9,65,85);n=!!i.contains(e.x,e.y)}function e(t){var e=this.getMouseXY(t),i=e.y-o.y;if(n){if(this.gan.ts1.visible&&(this.gan.ts1.visible=!1),10>Math.abs(i))return;var s=this.gan.tou.currentFrame,a=this.gan.bg.mc.currentFrame;i>0?(s++,a++):(s--,a--),s>this.gan.tou.totalFrames&&(s=this.gan.tou.totalFrames-1),0>s&&(s=0),this.gan.tou.gotoAndStop(s),this.gan.bg.mc.totalFrames>a||(a=0),0>a&&(a=this.gan.bg.mc.totalFrames-1),this.gan.bg.mc.gotoAndStop(a),this.drawGuan()}else{if(this.islocak)return;this.gan.ts2.visible&&(this.gan.ts2.visible=!1),this.gan.y+=i,this.gan.y=-650>this.gan.y?-650:this.gan.y,this.gan.y=this.gan.y>-280?-280:this.gan.y,this.deep=650+this.gan.y,this.drawRedLine(),this.drawGuan()}o=e}function i(t){this.body.userData.noDrag=!1}this.bgtouchid=h.M.addTouch(this.gan.bg,{begin:t,move:e,end:i},this);var o=void 0,n=!1,s=this.getMain()}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.density=this.fluidDensity+"g/cm3",t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.fluidDensity=h.M.getNumStr(t.density)-0,this.drawRedLine()}},{key:"removed",value:function(){this.removedCursor(this.btn),this.removedCursor(this.gan.bg),this.btn.destroy(),h.M.removeTouch(this.gan.bg,this.bgtouchid),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"fzdChange",value:function(t){this.fzIndex=this.fdzarr.indexOf(t.showValue),this.top.kd.currentFrame=this.fzIndex}},{key:"getConf",value:function(){var t=this,e={};return e.confArr=[],e.confArr.push(this.getScrollBar([this.getLocaleStr("liquid_density","液体密度"),!0,"g/cm³",1.4,.8,this.fluidDensity,.1,function(e){var i=h.M.getNumStr(e.showValue)-0;t.fluidDensity=i,t.drawRedLine()},this])),e.confArr.push(this.getDropMenu(["盛液筒分度值",!1,"",this.fdzarr[this.fzIndex],this.fdzarr,this,this.fzdChange,0,0])),e}},{key:"getTipMess",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.getLocaleStr("liquid_density","液体密度")+": "+this.fluidDensity+"g/cm³\n    "}},{key:"hideTips",value:function(){this.gan.ts1.visible=!1,this.gan.ts2.visible=!1}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function C(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:C(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(572),p=o(d),y=i(677),f=o(y),g=i(1077),b=o(g),v=void 0,_=void 0,m=void 0,x=void 0,w=void 0,k=void 0,P=void 0,O=void 0,T=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return v=i.phy.nape,_=v.NbBody,x=v.callbacks.InteractionListener,k=v.callbacks.CbType,w=v.callbacks.InteractionType,P=v.phys.BodyType,O=v.shape.Polygon,T=v.geom.Vec2,m=v.callbacks.CbEvent,i.normalLine=new PIXI.Graphics,i.ballline=new PIXI.Graphics,i.top_y=11,i.ball=null,i.stopBtn=null,i.waveBtn=null,i.disJoint=null,i.wave=null,i.d_label=null,i.m_label=null,i.t_label=null,i.s_label=null,i.bailong=300,i.bailongtxt=300,i.ballmass=10,i.ballStart=!1,i.angDraw=!1,i.interactListener=null,i.fitstTime=0,i.steps=-1,i.dot=null,i.angleLabel=null,i.time=0,i.k=1.395,i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_type(P.get_KINEMATIC()),this.body.get_shapes().clear(),this.createDragShape(),this.resetUserView(this.bg,this,!0),this.initBtn(),this.bg.selectTarget=this.parent,this.createBall(),this.initText(),this.createDot(),this.resetJoint(),this.bg.addChild(this.normalLine),this.bg.addChild(this.ballline),this.angleLabel=new f["default"],this.bg.addChild(this.angleLabel),this.initWavePhoto(),this.bg.removeChild(this.bg.tt),this.bg.removeChild(this.bg.grid),this.bg.removeChild(this.bg.photo),this.interactListener=new x(m.get_BEGIN(),w.get_SENSOR(),this.ball.cbtype,this.dot.cbtype,function(e){t.completeOnceHandler(e)}),this.addNapeListeners(this.interactListener),this.changeBailong({showValue:"300cm"}),this.addCursor(this.bball,"zuoyou")}},{key:"removed",value:function(){this.removedCursor(this.stopBtn),this.removedCursor(this.waveBtn),this.removedCursor(this.bball),this.ball.removeEventListener(p["default"].BALL_DRAG_BEGIN,this.ballDragBeginCallBack),this.ball.removeEventListener(p["default"].BALL_START,this.ballStartCallBack),this.removeNapeListeners(this.interactListener),this.bball.removeAllListeners(),this.bball["this"]=null,this.ball.removed(),this.BodyUtil.destoryBody(this.dot),this.bg.removeChildren(),this.wave.removed(),this.stopBtn.dispose(),this.waveBtn.dispose(),this.angleLabel.removeChildren(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"initWavePhoto",value:function(){this.wave=new b["default"](this.paramObj),this.bg.addChildAt(this.wave,0),this.wave.x=500,this.wave.visible=!1}},{key:"createDot",value:function(){this.dot=new _;var t=new v.shape.Circle(3);this.dot.add(t),t.set_sensorEnabled(!0),this.dot.set_type(P.get_KINEMATIC()),this.addBodyToSpace(this.dot),this.dot.cbtype=new k,this.dot.cbTypes.add(this.dot.cbtype)}},{key:"completeOnceHandler",value:function(t){t.get_int1(),t.get_int2();this.ballStart&&(-1==this.steps&&(this.isFirstDi=!0,this.fitstTime=this.getCurrentTime()),this.steps++,this.writeSteps())}},{key:"setbailengAndBallMass",value:function(){this.d_label.text=this.language.getLocaleStr("pendulum_len")+this.bailongtxt+"cm",this.m_label.text=this.language.getLocaleStr("mass")+this.ballmass+"g"}},{key:"initText",value:function(){this.d_label=new PIXI.Text("",{font:"30px Arial",fill:16750848,align:"left"}),this.bg.addChild(this.d_label),this.m_label=new PIXI.Text("",{font:"30px Arial",fill:16750848,align:"left"}),this.bg.addChild(this.m_label),this.d_label.x=this.m_label.x=-145,this.d_label.y=-160,this.m_label.y=-95,this.setbailengAndBallMass(),this.s_label=new PIXI.Text("",{font:"22px Arial",fill:16750848,align:"left"}),this.bg.addChild(this.s_label),this.s_label.x=-145,this.s_label.y=-35,this.s_label.text=this.language.getLocaleStr("tv_frequency")+"n=0"+this.language.getLocaleStr("ci"),this.t_label=new PIXI.Text("",{font:"22px Arial",fill:16750848,align:"right"}),this.bg.addChild(this.t_label),this.t_label.text="00:00",this.t_label.x=this.stopBtn.x+this.stopBtn.width-this.t_label.width,this.t_label.y=-35}},{key:"initBtn",value:function(){var t=this.bg.stopup,e=this.bg.stopdown,i=this.bg.stopup;this.stopBtn=new this.Button({text:this.language.getLocaleStr("stopIt"),tab:this.tabstopfunc,fontColor:16777215,fontSize:30,disabledSkin:t,downSkin:e,upSkin:i});var o=this.bg.waveup,n=this.bg.wavedown,s=this.bg.waveup;this.waveBtn=new this.Button({text:this.language.getLocaleStr("image"),tab:this.tabwavefunc,fontColor:"#ffffff",fontSize:30,disabledSkin:o,downSkin:n,upSkin:s}),this.stopBtn["this"]=this.waveBtn["this"]=this,this.bg.addChild(this.stopBtn),this.bg.addChild(this.waveBtn),this.bg.removeChild(this.bg.wavedown),this.bg.removeChild(this.bg.stopdown),this.waveBtn.x=this.stopBtn.x=25,this.waveBtn.y=-170,this.stopBtn.y=-100,this.addCursor(this.stopBtn,"hand"),this.addCursor(this.waveBtn,"hand")}},{key:"tabwavefunc",value:function(){this.wave.visible=!this.wave.visible}},{key:"tabstopfunc",value:function(){this.fitstTime=0,this.isFirstDi=!1,this.ballStart=!1,this.angleLabel.clear(),this.BodyUtil.frezzBody(this.ball.body),this.wave.stopDraw(),this.resetJoint()}},{key:"resetJoint",value:function(){this.disJoint&&this.BodyUtil.destoryJoint(this.disJoint),this.ball.body.set_rotation(0);var t=T.get(this.body.posx,this.body.posy+this.bailong);this.ball.body.set_position(t);var e=T.get(this.body.posx,this.body.posy+this.top_y),i=this.ball.weldPy().get_y()-this.body.posy-this.top_y;this.disJoint=this.JointUtil.createDistanceJoint(this.ball.body,this.body,T.get(this.ball.body.posx,this.ball.weldPy().get_y()),e,0,i),this.disJoint.ignore=!0,this.disJoint.stiff=!0,this.disJoint.damping=0,this.disJoint.frequency=1e7,this.dot.set_position(t),this.drawNormalLine()}},{key:"createBall",value:function(){var t=this;this.ball=new p["default"](this.paramObj),this.ball.init(),this.ball.resetUserView(this.bball,this),this.ball.body.set_position(T.get(this.x+this.bball.x,this.y+this.bball.y)),this.ball.body.noallowRotation=!0,this.ball.body.set_mass(this.ballmass),this.addBodyToSpace(this.ball.body),this.ballDragBeginCallBack=function(e){t.ballDragHandler()},this.ballStartCallBack=function(e){t.ballStartHandler()},this.ball.addEventListener(p["default"].BALL_DRAG_BEGIN,this.ballDragBeginCallBack),this.ball.addEventListener(p["default"].BALL_START,this.ballStartCallBack)}},{key:"ballStartHandler",value:function(){this.ballStart=!0,this.isFirstDi=!1,this.angDraw=!1,this.wave.drawBegin(this.getBailong(),this.ballmass),this.angleLabel.clear(),this.time=this.getCurrentTime(),this.disJoint.stiff=!1}},{key:"ballDragHandler",value:function(){this.steps=-1,this.writeSteps(),this.t_label.text="00:00",this.angDraw=!0}},{key:"writeSteps",value:function(){var t=-1==this.steps?0:this.steps;this.s_label.text=this.language.getLocaleStr("tv_frequency")+"n="+l.M.getNumToInt(t/2)+this.language.getLocaleStr("ci")}},{key:"update",value:function(){(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.ball.body.set_rotation(-(.5*Math.PI-Math.atan2(this.ball.body.posy-this.body.posy+this.top_y,this.ball.body.posx-this.body.posx))),this.angDraw)&&this.angleLabel.update(new l.Point(this.body.posx,this.body.posy+this.bailong),new l.Point(this.body.posx,this.body.posy+this.top_y),l.Point.vec2ToPoint(this.ball.weldPy()),25,this.getMain().view);if(this.ballStart){this.wave.draw(this.writeTime(),this.ball.body.posx-this.body.posx)}var t=this.getMain(),i=this.ballline.toLocal(new l.Point(this.ball.weldPy().get_x(),this.ball.weldPy().get_y()),t.view);this.ballline.clear(),this.ballline.lineStyle(3,12829635),this.ballline.moveTo(0,this.top_y),this.ballline.lineTo(i.x,i.y)}},{key:"writeTime",value:function(){var t=this.getCurrentTime(),e=t-this.time;if(this.isFirstDi){var i=t-this.fitstTime,o=l.M.getNumToInt(i/1e3),n=Math.floor(.1*(i-1e3*o));this.t_label.text=(10>o?"0"+o:o)+":"+(10>n?"0"+n:n)}return e}},{key:"drawNormalLine",value:function(){this.normalLine.clear(),this.normalLine.lineStyle(3,16777215,.6);var t=this.bailong/10,e=void 0;for(e=0;t>e;e++)e%2==0&&(this.normalLine.moveTo(0,10*e+this.top_y),this.normalLine.lineTo(0,10*e+10+this.top_y))}},{key:"createDragShape",value:function(){var t=new O(O.box(300,220));t.set_localCOM(T.get(0,-80)),t.set_sensorEnabled(!0),this.body.add(t);var e=new PIXI.Graphics;e.beginFill(0,0),e.drawRect(-150,-110,300,220),e.endFill(),this.bg.addChildAt(e,0),e.y=-80}},{key:"changeBailong",value:function(t){var e=l.M.getNumStr(t.showValue);this.bailongtxt=e-0,this.bailong=e*this.k,this.setbailengAndBallMass(),this.ballStart?this.tabstopfunc():this.resetJoint()}},{key:"getBailong",value:function(){return l.M.getNumJie(this.bailong/this.k,0)}},{key:"changeBallMass",value:function(t){this.ballmass=l.M.getNumStr(t.showValue)-0,this.ball.body.mass=this.ballmass,this.setbailengAndBallMass(),this.ballStart?this.tabstopfunc():this.resetJoint()}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.mass=this.ballmass+"g",t.bai=this.getBailong()+"cm",t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.changeBailong({showValue:t.bai}),this.changeBallMass({showValue:t.mass})}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getDropMenu(this.language.getLocaleStr("pendulum_len"),!0,"cm",this.getBailong()+"cm",["100cm","200cm","300cm","500cm"],this,this.changeBailong,800,100),this.ComponentProperty.getDropMenu(this.language.getLocaleStr("mass"),!0,"g",this.ballmass+"g",["10","20","50","100"],this,this.changeBallMass,1e3,1)),t}},{key:"selectRenderChild",value:function(){return this.bg.ding.getBounds()}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function P(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:P(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(1058),c=o(u),d=i(1059),p=o(d),y=i(446),f=o(y),g=i(451),b=o(g),v=void 0,_=void 0,m=void 0,x=void 0,w=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return v=i.phy.nape,_=v.geom.Vec2,m=v.shape.Circle,x=v.phys.BodyType,w=v.phys.Material,i.level=16,i.funnel=null,i.ball=null,i.ballMec=null,i.verticesArr=i.Vec2Util.pointArrArrToVec2ArrArr([[{x:-17.2,y:13.4},{x:-159.65,y:213.05},{x:-156,y:215.7},{x:-13.55,y:16.05}],[{x:13.25,y:15.65},{x:156.5,y:214.65},{x:160.2,y:212.05},{x:16.95,y:13.05}],[{x:-17.45,y:-192.95},{x:-17.45,y:14.05},{x:-12.95,y:14.05},{x:-12.95,y:-192.95}],[{x:12.05,y:-211.15},{x:12.05,y:12.85},{x:16.55,y:12.85},{x:16.55,y:-211.15}],[{x:17.85,y:14.55},{x:-18.2,y:14.05},{x:-161.7,y:212.55},{x:162.3,y:212.55}],[{x:-16.95,y:-189.95},{x:-16.95,y:14.05},{x:17.55,y:14.05},{x:17.05,y:-214.45}]]),i.lineGra=null,i.source01=new p["default"],i.source02=new c["default"],i.sources=[i.source01,i.source02],i.lineTriangle=[{x:0,y:0},{x:-155,y:210},{x:155,y:210}],i.lineRect=new PIXI.Rectangle(-155,0,310,210),i.ballCircle={x:0,y:0,r:1},i.showAirFlowFlag=!0,i}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.dragLevel=-1;var t=this.body.get_shapes();t.at(0).set_sensorEnabled(!0),t.at(1).set_sensorEnabled(!0),this.ballMec=new k(this.paramObj,46,this.ball),this.ballMec.init(),this.ballMec.body.set_position(this.body.get_position().add(_.get(this.ball.x,this.ball.y))),this.addChildAt(this.ballMec,0),this.ball.x=0,this.ball.y=0,this.JointUtil.createDistanceJoint(this.ballMec.body,this.body,this.ballMec.body.get_position(),this.body.get_position().add(_.get(-155,210)),0,510).set_ignore(!1),this.addOneRoteShape(-141,201,22),this.addOneRoteShape(141,201,22),this.addOneRoteShape(1,-193,22),this.changeLock({checked:!0}),this.lineGra=new PIXI.Graphics,this.addChildAt(this.lineGra,0);var i=new PIXI.Graphics;i.beginFill(0,0),i.drawCircle(0,0,this.ball.width/2),i.endFill(),this.addChild(i),this.ballGra=i,this.body.set_rotation(Math.PI),this.ballMec.body.set_position(this.body.get_position().add(_.get(0,-150)))}},{key:"removed",value:function(){this.ballMec.removeBodyFromSpace(this.ballMec.body),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){var t=new PIXI.Point(this.ballMec.body.posx,this.ballMec.body.posy),i=this.toLocal(t,this.getMain().view);this.inTriangle(i)&&this.ballMec.body.applyImpulse(this.getForce(i),this.ballMec.body.get_position()),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.updateLine(),this.ballGra.x=this.ballMec.x,this.ballGra.y=this.ballMec.y,this.BodyUtil.dampingBodyVelocity(this.ballMec.body,.98,.98)}},{key:"getForce",value:function(t){var e=0,i=200*(t.y-75)/139,o=function(t){return 100*(100/(t*t)-1)},n=function(t){return o(30)+.05*(t-30)*(t-30)};if(e=30>i?o(i):100>i?n(i):function(t){var e=n(100);return e+e*(1/(.05*(t-80))-1)}(i),!this.fyScale){this.fyScale=.1,this.fxScale=.1}var s=-t.x;s*=this.fxScale,e*=this.fyScale;var a=-this.rotation,r=Math.cos(a),h=Math.sin(a),l=new PIXI.Point(0,0);return l.x=s*r+e*h,l.y=-s*h+e*r,_.get(l.x,l.y)}},{key:"rotateChange",value:function(t,e){}},{key:"selectRenderChild",value:function(){return this.updateTransform(),this.funnel.getBounds()}},{key:"updateLine",value:function(){this.lineGra.clear();if(this.lineGra.lineStyle(1,16750848,1),this.lineGra.moveTo(-155,210),this.lineGra.lineTo(this.ballMec.x,this.ballMec.y),this.showAirFlowFlag){this.lineGra.lineStyle(4/this.getGlobalScale(),1939455,1),this.source02.x=this.ballMec.x,this.source02.y=this.ballMec.y;var t=new PIXI.Point(this.ballMec.x,this.ballMec.y),e=Math.sqrt(t.x*t.x+t.y*t.y);this.source02.dir.x=0,this.source02.dir.y=1,this.ballCircle.x=this.ballMec.x,this.ballCircle.y=this.ballMec.y,this.ballCircle.r=this.ballMec.r,this.source02.enabled=!!this.isBallInLoudou(),this.mScale||(this.mScale=1);var i=this.ball.width/2;this.source02.M=this.mScale*this.source01.Q/(2*Math.PI)*(i*i)/(e+i);for(var o=0,n=58;125>n;n+=4){var s=n*Math.PI/180,a=Math.cos(s),r=Math.sin(s),h=new PIXI.Point(20*a,20*r);this.lineGra.moveTo(h.x,h.y),this.lineGra.lineTo(h.x,-207+o),o+=.9,this.drawLine(h)}}}},{key:"drawLine",value:function(t){if(this.inTriangle(t)){this.lineGra.moveTo(t.x,t.y);for(var e=0;;){if(t,t=this.getNextP(t),this.lineGra.lineTo(t.x,t.y),!this.inTriangle(t))break;if(++e>100)break}}}},{key:"isBallInLoudou",value:function(){if(210>this.ballCircle.y){return this.inTriangle(new l.Point(this.ballCircle.x,this.ballCircle.y))}return!0}},{key:"inBallCircle",value:function(t){var e=t.x-this.ballCircle.x,i=t.y-this.ballCircle.y;return 0>e*e+i*i-this.ballCircle.r*this.ballCircle.r}},{key:"inTriangle",value:function(t){return this.pointinTriangle(this.lineTriangle[0],this.lineTriangle[1],this.lineTriangle[2],t)}},{key:"pointinTriangle",value:function(t,e,i,o){var n=new PIXI.Point(i.x-t.x,i.y-t.y),s=new PIXI.Point(e.x-t.x,e.y-t.y),a=new PIXI.Point(o.x-t.x,o.y-t.y),r=this.dot,h=r(n,n),l=r(n,s),u=r(n,a),c=r(s,s),d=r(s,a),p=c*u-l*d,y=h*d-l*u,f=h*c-l*l;return p>=0&&y>=0&&0>=p+y-f}},{key:"dot",value:function(t,e){return t.x*e.x+t.y*e.y}},{key:"getNextP",value:function(t){var e=this.getV(t),i=Math.sqrt(e.x*e.x+e.y*e.y);e.x=3*e.x/i,e.y=3*e.y/i;var o=new PIXI.Point(t.x+e.x,t.y+e.y);if(this.lineRect.contains(o.x,o.y))if(this.inTriangle(o))this.inBallCircle(o);else{var n=null;0>o.x?(n=l.M.getGaoDianFrom3Dian(o,this.lineTriangle[0],this.lineTriangle[1]),n.x+=1):(n=l.M.getGaoDianFrom3Dian(o,this.lineTriangle[0],this.lineTriangle[2]),n.x-=1),o=n}return o}},{key:"getV",value:function(t){var e=new PIXI.Point;return this.sources.forEach(function(i){if(i.enabled){var o=i.getV(t.x,t.y);e.x+=o.x,e.y+=o.y}}),e}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.showAirFlowFlag=this.showAirFlowFlag,t.ballData=this.ballMec.getData(),t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.showAirFlowFlag=t.showAirFlowFlag,this.ballMec.setData(t.ballData)}},{key:"changeLock",value:function(t){this.islock=t.checked,this.islock?this.body.set_type(x.get_KINEMATIC()):(this.body.set_type(x.get_DYNAMIC()),this.body.set_allowRotation(!1))}},{key:"changeShowAirFlow",value:function(t){this.showAirFlowFlag=t.checked}},{key:"getConf",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push(this.ComponentProperty.getSwitch(this.language.getLocaleStr("display_airflow"),this.showAirFlowFlag,this.changeShowAirFlow,this)),t}}]),e}(f["default"]);var k=function(t){function e(t,i,o){n(this,e);var a=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.r=i,a.skin=o,a.addChild(o),a}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.get_shapes().clear();var t=new w(1,1,2,.01,1e-4),i=new m(this.r,_.get(0,0),t);this.body.add(i),this.shape=i,this.body.set_isBullet(!0)}},{key:"setDensity",value:function(t){this.shape.get_material().set_density(t)}},{key:"update",value:function(){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.parent){var t=this.parent.toLocal(new PIXI.Point(this.body.posx,this.body.posy),this.getMain().view);this.x=t.x,this.y=t.y}}}]),e}(b["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function O(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:O(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(449),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0,m=void 0,x=void 0,w=void 0,k=void 0,P=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.NbBody,g=y.callbacks.InteractionType,b=y.shape.Polygon,v=y.phys.BodyType,_=y.geom.Vec2,m=y.shape.Circle,x=y.phys.Material,w=y.callbacks.PreListener,k=y.callbacks.CbType,P=y.phys.Compound,i.topCtP1=null,i.bottomCtP1=null,i.ball1Body=null,i.weld=null,i.hgBody=null,i.hgWeld=null,i.hitListener=null,i.isHit=!1,i.ballcb=new k,i.gangcb=new k,i.paper=null,i.paperColor=16711680,i.saveData=[],i._currentDataObj=null,i.line=null,i.draw=!1,i.startPoint=new l.Point(-215,-284),i.isStart=!1,i.compo=null,i.trackBody=null,i.cweJoint=null,i}return a(e,t),r(e,[{key:"removed",value:function(){this.removedCursor(this.track.dragxfz),this.removedCursor(this.track.gq),this.removedCursor(this.hg),this.removedCursor(this.trackBtn),this.removedCursor(this.clearBtn),this.removedCursor(this.startBtn),this.removeNapeListeners(this.hitListener),this.BodyUtil.destoryBody(this.hgBody),this.BodyUtil.destoryBody(this.ball1Body),this.BodyUtil.destoryBody(this.trackBody),this.hg.removeAllListeners(),l.M.removeTouch(this.track.dragxfz,this.xfzTouchid),l.M.removeTouch(this.track.gq,this.gqTouchid),this.trackBtn.dispose(),this.clearBtn.dispose(),this.startBtn.dispose(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"init",value:function(){this._width=700,this._height=670,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.compo=new P,this.compo.set_space(this.body.get_space()),this.body.set_type(v.get_KINEMATIC()),this.body.sensorEnabled(!0),this.body.userData.cannotToolRot=!0,this.body.userData.dragLevel=-1,this.body.bullet=!0,this.body.set_compound(this.compo),this.body.userData.dragtranslate=!0,this.topCtP1=new l.Point(this.track.xfz.x,this.track.xfz.y);var t=37*Math.PI/180;this.bottomCtP1=new l.Point(this.topCtP1.x+160*Math.cos(t),this.topCtP1.y+160*Math.sin(t)),this.paper=new PIXI.Graphics,this.addChildAt(this.paper,1),this.line=new PIXI.Graphics,this.addChildAt(this.line,1),this.initBtn(),this.initTrack(),this.initGdq(),this.initBall(),this.initHengGang(),this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.addData(),this.addCursor(this.track.dragxfz,"qingxie"),this.addCursor(this.track.gq,"shangxia"),this.addCursor(this.hg,"shangxia"),this.addCursor(this.trackBtn,"hand"),this.addCursor(this.clearBtn,"hand"),this.addCursor(this.startBtn,"hand")}},{key:"translateMove",value:function(t,e){var i=arguments.length>2&&arguments[2]!==undefined&&arguments[2];this.compo.translate(_.get(t,e));var o=this.ball1Body.get_position(),n=this.getMain().view,s=this.track.toLocal(new l.Point(o.get_x(),o.get_y()),n);this.track.ball.x=s.x,this.track.ball.y=s.y,this.ball1Body.userData.view&&(this.ball1Body.userData.view=null),i&&(this.ball1Body.userData.view=this.track.ball)}},{key:"initHengGang",value:function(){var t=this;this.parent.addChild(this.hg),this.hg.x+=this.x,this.hg.y+=this.y,this.hgBody=new f;var e=new b(b.box(this.hg.width,this.hg.height));this.BodyUtil.setShapeMaterial(e,{density:.1,dynamicFriction:1,elasticity:0,rollingFriction:.1,staticFriction:2}),this.hgBody.add(e),this.hgBody.userData.view=this.hg,this.addBodyToSpace(this.hgBody,this.parent),this.hgBody.addCbType(this.gangcb),this.hgBody.noallowRotation=!0,this.hgBody.mass=1,this.hgBody.bullet=!0,this.hgBody.set_compound(this.compo),this.BodyUtil.setBodyFilter(this.hgBody,this.InteractionFilterManager.MEC_COMPONENT_FILTER);var i=_.get(this.hg.x,this.hg.y);this.hgBody.set_position(i),this.hgWeld=this.JointUtil.createWeldJoint(this.hgBody,this.body,i,i),this.hgWeld.set_compound(this.compo);var o=i.add(_.get(0,-420));this.JointUtil.createLineJoint(this.body,this.hgBody,o,this.hgBody.position,this.hgBody.position.sub(o),0,420).set_compound(this.compo),this.hg.addEventListener(p["default"].BEGIN,function(e){t.ts3.visible&&(t.ts3.visible=!1),t.hgWeld.active=!1,null==t.weld&&t.createBallJoint()}),this.hg.addEventListener(p["default"].END,function(e){t.isHit=!1,t.hgWeld.active=!0,t.hgWeld.anchor2=t.body.worldPointToLocal(_.get(t.hgBody.posx,t.hgBody.posy-.6))}),this.hitListener=new w(g.get_COLLISION(),this.ballcb,this.gangcb,function(e){if(!t.isHit){t.isHit=!0;var i=l.Point.vec2ToPoint(t.ball1Body.position),o=t.getMain();i=t.paper.toLocal(i,o.view),t.BodyUtil.frezzBody(t.ball1Body),t.paper.beginFill(t.paperColor),t.paper.drawCircle(i.x,i.y,4),t.paper.endFill(),t._currentDataObj.length++,t.isStart=!1,t.draw&&t.drawLine()}}),this.addNapeListeners(this.hitListener)}},{key:"drawLine",value:function(t){this.line.clear();for(var e=0;this.saveData.length>e;e++){var i=this.saveData[e];"hide"==t?i.line&&(i.line.visible=!1):i.line?i.line.visible=!0:this.showLine(i)}}},{key:"showLine",value:function(t){var e=new PIXI.Graphics;this.addChildAt(e,1),t.line=e,e.lineStyle(2,t.color),e.moveTo(this.startPoint.x,this.startPoint.y);var i=t.points,o=0,n=i.length,s=0,a=0;for(o=0;n>o;o++){var r=i[o];if(r.bx>this.startPoint.x){s=r.vx,a=r.vy;break}}var h=0,l=this.napeEngine.gravity.get_y();for(o=1;1e4>o;o++){h++;var u=a*h/s+.5*l*h*h/(s*s),c=this.startPoint.x+h,d=this.startPoint.y+u;if(e.lineTo(c,d),e.moveTo(c,d),d>195)return}}},{key:"addData",value:function(){var t={};t.color=this.paperColor,t.points=[],t.length=0,t.line=null,this.saveData.push(t),this._currentDataObj=t}},{key:"initBall",value:function(){this.ball1Body=new f;var t=new x(0,0,0,7.8,0);this.ball1Body.add(new m(8.95,null,t)),this.ball1Body.userData.view=this.track.ball,this.addBodyToSpace(this.ball1Body,this.track),this.ball1Body.addCbType(this.ballcb),this.ball1Body.bullet=!0,this.createBallJoint()}},{key:"createBallJoint",value:function(){var t=this.toGlobalView(new l.Point(this.track.xfz.x+18.65,this.track.xfz.y+14.45),this.track);this.ball1Body.set_position(_.get(t.x,t.y)),this.weld=this.JointUtil.createWeldJoint(this.ball1Body,this.trackBody,this.ball1Body.position,this.ball1Body.position),this.weld.set_compound(this.compo)}},{key:"initGdq",value:function(){function t(t){o=this.getMouseXY(t),this.body.userData.noDrag=!0,this.track.ts1.visible&&(this.track.ts1.visible=!1)}function e(t){var e=this.getMouseXY(t),i=l.Point.distance(o,e),s=i*Math.cos(n),a=i*Math.sin(n);e.x>o.x?(this.track.dragxfz.x+=s,this.track.dragxfz.y+=a):(this.track.dragxfz.x-=s,this.track.dragxfz.y-=a),this.track.dragxfz.x=this.topCtP1.x>this.track.dragxfz.x?this.topCtP1.x:this.track.dragxfz.x,this.track.dragxfz.x=this.track.dragxfz.x>this.bottomCtP1.x?this.bottomCtP1.x:this.track.dragxfz.x,this.track.dragxfz.y=this.topCtP1.y>this.track.dragxfz.y?this.topCtP1.y:this.track.dragxfz.y,this.track.dragxfz.y=this.track.dragxfz.y>this.bottomCtP1.y?this.bottomCtP1.y:this.track.dragxfz.y,this.track.xfz.x=this.track.dragxfz.x,this.track.xfz.y=this.track.dragxfz.y,o=e,this.weld&&(this.weld.anchor2=_.get(this.track.dragxfz.x+18.65,this.track.dragxfz.y+14.45))}function i(t){var e=l.M.getNumToInt(240*Math.random()),i=l.M.getNumToInt(255*Math.random()),o=l.M.getNumToInt(255*Math.random());this.body.userData.noDrag=!1,this.paperColor=l.M.generateFromRGBComponent([e,i,o]),this.track.xfz.x=this.track.dragxfz.x,this.track.xfz.y=this.track.dragxfz.y,this.addData()}this.track.dragxfz.x=this.track.xfz.x,this.track.dragxfz.y=this.track.xfz.y,this.xfzTouchid=l.M.addTouch(this.track.dragxfz,{begin:t,move:e,end:i},this);var o=void 0,n=37*Math.PI/180}},{key:"createTrackShape",value:function(t,e,i,o,n){var s=new b(b.box(i,o));this.trackBody.add(s),s.rotate(n),s.set_localCOM(_.get(t,e)),this.BodyUtil.setShapeMaterial(s,{dynamicFriction:0,elasticity:0,rollingFriction:0,staticFriction:0})}},{key:"initTrack",value:function(){function t(t){this.body.userData.noDrag=!0,n=this.getMouseXY(t)}function e(t){}function i(t){if(this.body.userData.noDrag=!1,n){var e=this.getMouseXY(t),i=!1;if(0>e.y-n.y?0==o.phase?(o.phase=.15,i=!0):-.15==o.phase&&(o.phase=0,i=!0):.15==o.phase?(o.phase=0,i=!0):0==o.phase&&(o.phase=-.15,i=!0),i){this.track.ts2.visible&&(this.track.ts2.visible=!1),this.weld&&(this.BodyUtil.destoryJoint(this.weld),this.weld=null,this.createBallJoint());var s=l.M.getNumToInt(240*Math.random()),a=l.M.getNumToInt(255*Math.random()),r=l.M.getNumToInt(255*Math.random());this.paperColor=l.M.generateFromRGBComponent([s,a,r]),this.addData()}}}this.trackBody=new f,this.createTrackShape(-183.25,-64.7,260,20,37*Math.PI/180),this.createTrackShape(-57.5,11.55,116,20,0),this.addBodyToSpace(this.trackBody),this.BodyUtil.setBodyFilter(this.trackBody,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.parent.addChild(this.track),this.track.x+=this.x,this.track.y+=this.y,this.trackBody.userData.view=this.track,this.trackBody.set_position(_.get(this.track.x,this.track.y)),this.trackBody.set_compound(this.compo),this.cweJoint=this.JointUtil.createWeldJoint(this.body,this.trackBody,this.trackBody.position,this.trackBody.position),this.cweJoint.set_compound(this.compo);var o=this.cweJoint,n=void 0;this.gqTouchid=l.M.addTouch(this.track.gq,{begin:t,move:e,end:i},this)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.phase=this.cweJoint.phase,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.cweJoint.phase=t.phase,this.weld&&(this.BodyUtil.destoryJoint(this.weld),this.weld=null,this.createBallJoint());var i=l.M.getNumToInt(240*Math.random()),o=l.M.getNumToInt(255*Math.random()),n=l.M.getNumToInt(255*Math.random());this.paperColor=l.M.generateFromRGBComponent([i,o,n]),this.saveData.length=0,this.addData()}},{key:"update",value:function(){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.isStart){var t=this.ball1Body.velocity,i=this.getMain();this._currentDataObj.points.push({bx:this.toLocal(l.Point.vec2ToPoint(this.ball1Body.position),i.view).x,vx:t.get_x(),vy:t.get_y()})}}},{key:"initBtn",value:function(){var t=this;this.trackBtn.fontColor="#ffffff",this.trackBtn.text=this.language.getLocaleStr("track"),this.trackBtn["this"]=this,this.trackBtn.tab=function(e){t.draw?(t.drawLine("hide"),t.draw=!1,t.trackBtn.text=t.language.getLocaleStr("track")):(t.drawLine(),t.draw=!0,t.trackBtn.text=t.language.getLocaleStr("hide"))},this.clearBtn.fontColor="#ffffff",this.clearBtn.text=this.language.getLocaleStr("clear"),this.clearBtn["this"]=this,this.clearBtn.tab=function(e){t.line.clear(),t.paper.clear();for(var i=0;t.saveData.length>i;i++){var o=t.saveData[i];o.line&&t.removeChild(o.line)}t.saveData=[],t.addData()},this.startBtn.fontColor="#ffffff",this.startBtn.text=this.language.getLocaleStr("start"),this.startBtn["this"]=this,this.startBtn.tab=function(e){t.ball1Body.wake(),t.isStart=!0,t._currentDataObj.points.length=0,t.weld&&(t.BodyUtil.destoryJoint(t.weld),t.weld=null)}}},{key:"hideTips",value:function(){this.ts3.visible=!1,this.track.ts1.visible=!1,this.track.ts2.visible=!1}},{key:"getLocalBoundsElecs",value:function(){return[this.bg,this.track]}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function c(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:c(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(226),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.lever=null,i.rod=null,i.piston=null,i.baffle01=null,i.baffle02=null,i.water02=null,i.waterMask=null,i.flowMask=null,i.waterFlowCon=null,i.hideMc=null,i.frontMc=null,i.waterPool=[],i.waterArr=[],i.dir=0,i.waterRot=.5,i.baffleLockFlag=!1,i.showInnerFlag=!1,i.pArr=[{x:-88.95,y:-187},{x:-89.15,y:-186.9},{x:-89.65,y:-186.7},{x:-90.4,y:-186.35},{x:-91.4,y:-185.85},{x:-92.65,y:-185.25},{x:-94.15,y:-184.45},{x:-95.9,y:-183.55},{x:-97.9,y:-182.4},{x:-100.15,y:-181.05},{x:-102.55,y:-179.5},{x:-105.15,y:-177.7},{x:-107.95,y:-175.6},{x:-110.9,y:-173.2},{x:-113.95,y:-170.5},{x:-117.05,y:-167.4},{x:-120.25,y:-163.9},{x:-123.4,y:-160.05},{x:-126.5,y:-155.75},{x:-129.55,y:-151},{x:-132.4,y:-145.85},{x:-135.1,y:-140.25},{x:-137.6,y:-134.25},{x:-139.85,y:-127.85},{x:-141.85,y:-121.05},{x:-143.55,y:-113.9},{x:-145,y:-106.35},{x:-146.15,y:-98.5},{x:-146.95,y:-90.35},{x:-147.5,y:-81.9},{x:-147.8,y:-73.2},{x:-148.45,y:-64.5},{x:-149.6,y:-55.6},{x:-151.45,y:-46.4},{x:-154.25,y:-37.1},{x:-158.25,y:-27.9},{x:-163.75,y:-19.05},{x:-170.95,y:-10.95},{x:-179.85,y:-4.25},{x:-190.25,y:.8},{x:-201.65,y:4.05},{x:-213.6,y:5.6},{x:-225.95,y:5.8},{x:-238.4,y:5.5},{x:-251.1,y:5.5},{x:-264.15,y:5.8},{x:-277.45,y:6.4},{x:-291.05,y:7.4},{x:-304.9,y:8.8},{x:-319,y:10.65},{x:-333.35,y:13.05},{x:-347.95,y:16},{x:-362.65,y:19.65},{x:-377.15,y:24.4},{x:-391.3,y:31.1},{x:-404.7,y:39.95},{x:-416.8,y:51},{x:-427.2,y:64.15},{x:-435.55,y:78.95},{x:-442.45,y:95.05}],i.pArr1=[{x:-88.95,y:-187},{x:-100.75,y:-181.9},{x:-111.3,y:-174.15},{x:-120,y:-164.4},{x:-126.75,y:-153.3},{x:-131.7,y:-141.55},{x:-135.25,y:-129.55},{x:-137.75,y:-117.5},{x:-139.4,y:-105.5},{x:-140.4,y:-93.65},{x:-140.85,y:-81.95},{x:-141.5,y:-70.8},{x:-142.95,y:-59.85},{x:-145.25,y:-49.15},{x:-148.55,y:-38.75},{x:-152.95,y:-28.95},{x:-158.55,y:-19.8},{x:-165.35,y:-11.65},{x:-173.25,y:-4.65},{x:-182,y:1.05},{x:-191.3,y:5.5},{x:-200.9,y:8.7},{x:-210.6,y:10.95},{x:-220.3,y:12.35},{x:-229.75,y:13.3},{x:-239.05,y:14.25},{x:-248.15,y:15.15},{x:-257.15,y:16},{x:-266,y:16.85},{x:-274.75,y:17.65},{x:-283.3,y:18.4},{x:-291.75,y:19.15},{x:-300.05,y:19.9},{x:-308.2,y:20.6},{x:-316.25,y:21.25},{x:-324.15,y:21.9},{x:-331.9,y:22.5},{x:-339.55,y:23.05},{x:-347,y:23.6},{x:-354.35,y:24.15},{x:-361.55,y:24.65},{x:-368.45,y:25.5},{x:-375.25,y:26.7},{x:-381.85,y:28.25},{x:-388.15,y:30.15},{x:-394.25,y:32.4},{x:-400.05,y:35},{x:-405.55,y:37.85},{x:-410.75,y:41},{x:-415.65,y:44.35},{x:-420.25,y:47.9},{x:-424.5,y:51.6},{x:-428.45,y:55.45},{x:-432.15,y:59.3},{x:-435.5,y:63.25},{x:-438.65,y:67.25},{x:-441.5,y:71.2},{x:-444.15,y:75.1},{x:-446.6,y:79},{x:-448.85,y:82.8}],i.canShowNei=!0,i}return s(e,t),a(e,[{key:"added",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.waterFlowCon=new PIXI.Container,this.addChild(this.waterFlowCon),this.addChild(this.frontMc),this.frontMc.visible=!this.showInnerFlag,this.hideMc.visible=!1,this.water02.mask=this.waterMask.getChildAt(0),this.waterFlowCon.mask=this.flowMask.getChildAt(0),this.rod.height=400,this.lever.handle.alpha=0,this.handleTouchid=h.M.addTouch(this.lever.handle,{begin:this.handleTouchBegin,move:this.handleTouchgMove,end:this.handleTouchEnd},this),this.updatePump()}},{key:"handleTouchBegin",value:function(t){this.cannotSystemDrag=!0;var e=this.getMouseXY(t);e=this.toLocal(e,this.getMain().view),this.downAng=Math.atan2(e.y-this.lever.y,e.x-this.lever.x),this.lastRota=this.downRota=this.lever.rotation}},{key:"handleTouchgMove",value:function(t){var e=this.getMouseXY(t);e=this.toLocal(e,this.getMain().view);var i=Math.atan2(e.y-this.lever.y,e.x-this.lever.x),o=i-this.downAng+this.downRota;o>-.47&&.3>o&&(this.lever.rotation=o,this.updatePump(),this.dir=o>this.lastRota?1:-1,this.lastRota=o)}},{key:"handleTouchEnd",value:function(t){this.cannotSystemDrag=!1}},{key:"updatePump",value:function(){var t=new PIXI.Point(this.lever.p.x,this.lever.p.y);t=this.toLocal(t,this.lever);var e=t.x-this.piston.x,i=Math.sqrt(190096-e*e),o=this.piston.y-(t.y+i);this.piston.y=t.y+i,this.rod.x=this.piston.x,this.rod.y=this.piston.y;var n=Math.atan2(i,e);this.rod.rotation=Math.PI/2-n,this.baffle01.y=this.piston.y+118,this.baffle01.rotation+=.1*this.dir,this.baffle02.rotation-=.1*this.dir,this.limitBaffleRotation(),1===this.dir&&(this.water02.height+=o)>920&&(this.water02.height=920)}},{key:"limitBaffleRotation",value:function(){this.baffle01.rotation>0&&(this.baffle01.rotation=0),-.7>this.baffle01.rotation&&(this.baffle01.rotation=-.7),this.baffle02.rotation>0&&(this.baffle02.rotation=0),-.7>this.baffle02.rotation&&(this.baffle02.rotation=-.7)}},{key:"update",value:function(){if(this.water02.height>782){var t=this.water02.height-782,e=1;e=.1*t,t-40>e?e=t-40:1>e&&(e=1),this.water02.height-=e,this.waterFlowOut(e)}for(var i=this.waterArr.length-1;i>=0;i--){var o=this.waterArr[i];o.index++,this.pArr.length>o.index?this.updateP(o):(this.waterArr.splice(i,1),this.waterPool.push(o),this.waterFlowCon.removeChild(o))}this.baffleLockFlag||(this.baffle01.rotation+=.01,this.baffle02.rotation+=.01,this.limitBaffleRotation())}},{key:"waterFlowOut",value:function(t){var e=4*t;(e=5+.5*e)>20&&(e=20);for(var i=0;e>i;i++){var o=this.getWaterSp();this.waterFlowCon.addChild(o),this.waterArr.push(o),o.index=0,o.id=Math.random()>.8?1:2,o.alpha=1,o.oalpha=.05*Math.random()+.02,o.offY=-i;var n=.5+.5*Math.random();n*=1+t/40,o.scale.x=o.scale.y=n,this.updateP(o)}}},{key:"updateP",value:function(t){var e=t.id,i=void 0;i=1===e?this.pArr[t.index]:this.pArr1[t.index],t.x=i.x,t.y=i.y+t.offY,2===e?16>t.index&&(t.alpha=t.oalpha*t.index/16):40>t.index&&(t.alpha=t.oalpha*t.index/40),t.offY*=.9}},{key:"getWaterSp",value:function(){var t=this.waterPool.pop();if(!t){var e=PIXI.Sprite.fromFrame("PistonPump/water3.png");e.x=-e.width/2,e.y=-e.height/2,t=new PIXI.Container,t.addChild(e)}return t}},{key:"removed",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this),this.tick&&(this.tick.stop(),this.tick=null)}},{key:"changeBaffleLock",value:function(t){this.baffleLockFlag=t.checked}},{key:"clickShowNei",value:function(t){t||(this.showInnerFlag=!this.showInnerFlag),this.frontMc.visible=!this.showInnerFlag}},{key:"getConf",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push(this.ComponentProperty.getSwitch(this.language.getLocaleStr("valve_locking"),this.baffleLockFlag,this.changeBaffleLock,this)),t}},{key:"selectRenderChild",value:function(){return this.updateTransform(),this.bg.getBounds()}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.showInnerFlag=this.showInnerFlag,t.baffleLockFlag=this.baffleLockFlag,t}},{key:"setData",value:function(t){this.showInnerFlag=t.showInnerFlag,this.clickShowNei(!0),this.changeBaffleLock({checked:t.baffleLockFlag||!1})}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function u(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:u(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(446),l=function(t){return t&&t.__esModule?t:{"default":t}}(h);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.verticesArr=i.Vec2Util.pointArrArrToVec2ArrArr([[{x:-2,y:-93},{x:-2,y:57},{x:2,y:57},{x:2,y:-93}],[{x:-0,y:81},{x:9,y:55},{x:-9,y:55}]]),i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this)}},{key:"update",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this)}},{key:"removed",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"getData",value:function(){return r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this)}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t)}},{key:"getConf",value:function(){return r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this)}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function T(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:T(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(1082),p=o(d),y=i(1081),f=o(y),g=i(1073),b=o(g),v=i(449),_=o(v),m=void 0,x=void 0,w=void 0,k=void 0,P=void 0,O=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return m=i.phy.nape,x=m.NbBody,w=m.phys.BodyType,k=m.shape.Polygon,P=m.geom.Vec2,O=m.shape.HockShapeBase,i.LINE_COLOR=16443297,i.ppey={PP1:{w:94,h:94},PP2:{w:71,h:71},PP3:{w:48,h:48}},i.pullBox=new PIXI.Sprite,i.topBox=new PIXI.Sprite,i.bottomBox=new PIXI.Sprite,i.topSkinBox=new PIXI.Sprite,i.bottomSkinBox=new PIXI.Sprite,i.trackFlag=0,i.pullOneArr=[],i.shang1=null,i.shang2=null,i.shang3=null,i.xia1=null,i.xia2=null,i.xia3=null,i.oriDis=0,i.topNum=1,i.bottomNum=1,i.linkType=0,i.danType=0,i.isOpenTrack=!1,i.gPArr=[],i.startPD1_=null,i.startP2_=null,i.hLen=300,i.startLen=0,i.lenNum=0,i.laP=null,i.allLen=750,i.lineSP=new PIXI.Graphics,i.laLineSP=new PIXI.Graphics,i.trackSP=new PIXI.Graphics,i.can_fresh_pullH=!1,i.nextP=null,i.gou1=null,i.gou2=null,i.bd=null,i.bdBody=null,i.pj=null,i.wj=null,i.lineJoint=null,i.moveH=300,i.k5n=i.NapeConst.k5n,i.startPD1_=null,i.startP2_=null,i.olm=1.6012823960077898,i.txt1=new PIXI.Text("100mm",{font:"25px Arial",fill:16750848}),i.txt2=new PIXI.Text("100mm",{font:"25px Arial",fill:16750848}),i.dhlMass=0,i.off_x=0,i.off_y=0,i.wugou=new PIXI.Graphics,i.addChild(i.wugou),i}return a(e,t),r(e,[{key:"init",value:function(){this.removeChild(this.shang1Skin),this.removeChild(this.shang2Skin),this.removeChild(this.shang3Skin),this.removeChild(this.xia1Skin),this.removeChild(this.xia2Skin),this.removeChild(this.xia3Skin),this.removeChild(this.tt),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_type(w.get_KINEMATIC()),this.body.set_mass(300),this.addChild(this.lineSP),this.addChild(this.laLineSP),this.addChild(this.trackSP),this.addChild(this.txt1),this.addChild(this.txt2),this.txt1.visible=!1,this.txt2.visible=!1,this.addChild(this.pullBox),this.pullBox.addChild(this.topBox),this.pullBox.addChild(this.bottomBox),this.pullBox.addChild(this.topSkinBox),this.pullBox.addChild(this.bottomSkinBox),this.initSXpull(),this.initGou(),this.initWugou(),this.freshPull(),this.createDragFeild()}},{key:"initWugou",value:function(){var t=this;this.bd=new O(20),this.bd.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.bd),this.body.userData.notHockDrag=!0,this.bd.get_userData().noDrag=!0,this.bd.addCbtype(this.CbTypeStr.PULL_WU_HOCK),this.bd.connectVec=P.get(0,13),this.bd.createListener(this.CbTypeStr.PULL_WU_HOCK,[this.CbTypeStr.SPRING_HOCK,this.CbTypeStr.HOOK_TOP_GOU,this.CbTypeStr.CEIL_HOOK]),this.addTweenQuan(this.bd),this.bd.wdmove=function(){if(t.bd.pivjoint&&1!==t.danType){var e=t.bd.pivjoint,i=t.bd.get_localCOM().add(t.bd.connectVec);e.get_body1()===t.body&&e.set_anchor1(i),e.get_body2()===t.body&&e.set_anchor2(i)}},this.bd.connectCallback=function(e,i){var o=!0;if(1!==t.danType)o=!1;else{var n=e.worldPointToLocal(i);t.pj.set_body4(e),t.pj.set_anchor4(n),t.gou2.set_allowMovement(!1),t.BodyUtil.frezzBody(t.gou2),t.bd.get_userData().isconnect=!0}return o},this.bd.breakClickCallback=function(e){1===t.danType&&(t.bd.get_userData().isconnect=!1,t.gou2.set_allowMovement(!0),t.pj.set_body4(t.gou2),t.pj.set_anchor4(P.get(0,0)))}}},{key:"createDragFeild",value:function(){var t=this,e=new k(k.rect(-100,0,200,200));this.body.add(e),this.body.userData.dragLevel=-2,this.body.userData.cannotToolRot=!0,e.set_sensorEnabled(!0),this.pullBeginDrag=function(e){if(!t.gou1.useing){var i=t.body.get_position(),o=t.gou1.body.get_position();t.off_x=i.get_x()-o.get_x(),t.off_y=i.get_y()-o.get_y()}},this.pullMoveDrag=function(e){if(!t.gou1.useing){var i=t.body.get_position(),o=i.get_x()-t.off_x,n=i.get_y()-t.off_y;t.gou1.body.set_position(P.weak(o,n)),t.gou1.guJ.anchor2=t.gou1.body.position}},this.pullEndDrag=function(e){if(!t.gou1.useing){var i=t.body.get_position(),o=i.get_x()-t.off_x,n=i.get_y()-t.off_y;t.gou1.body.set_position(P.weak(o,n)),t.gou1.guJ.anchor2=t.gou1.body.position}},this.addEventListener(_["default"].BEGIN,this.pullBeginDrag),this.addEventListener(_["default"].END,this.pullEndDrag),this.addEventListener(_["default"].MOVE,this.pullMoveDrag)}},{key:"initGou",value:function(){this.gou1=new b["default"](this.paramObj),this.parent.addChild(this.gou1),this.gou1.x=this.x-200,this.gou1.y=this.y,this.gou1.owner=this,this.gou1.init(),this.addBodyToSpace(this.gou1.body,this.parent,!0),this.gou1.body.set_allowRotation(!1),this.gou1.body.set_gravMass(0),this.gou2=new x;var t=new k(k.box(5,5));this.gou2.add(t),this.addBodyToSpace(this.gou2),this.gou2.set_allowRotation(!1),t.set_sensorEnabled(!0),this.gou2.set_position(this.body.get_position().add(P.get(0,10))),this.gou1.body.mass=1,this.gou2.mass=1}},{key:"initSXpull",value:function(){function t(t,e){var i=new f["default"],o=void 0;for(o=0;t.length>o;o++){i.addAndSetXY_xinArr(PIXI.Sprite.fromImage(t[o][0]),t[o][1],t[o][2])}return i.addBack(e),i}this.shang1=t([["PullComp/xin1.png",0,57]],this.shang1Skin),this.shang2=t([["PullComp/xin2.png",0,149],["PullComp/xin1.png",0,57]],this.shang2Skin),this.shang3=t([["PullComp/xin3.png",0,213],["PullComp/xin2.png",0,149],["PullComp/xin1.png",0,57]],this.shang3Skin),this.xia1=t([["PullComp/xin1.png",0,-2]],this.xia1Skin),this.xia2=t([["PullComp/xin2.png",0,-57],["PullComp/xin1.png",0,34]],this.xia2Skin),this.xia3=t([["PullComp/xin3.png",0,-90],["PullComp/xin2.png",0,-27],["PullComp/xin1.png",0,62]],this.xia3Skin)}},{key:"freshPull",value:function(t){var e=this;if(this.updateTransform(),this.topBox.removeChildren(),this.bottomBox.removeChildren(),this.topSkinBox.removeChildren(),this.bottomSkinBox.removeChildren(),this.shang1.clear(),this.shang2.clear(),this.shang3.clear(),this.xia1.clear(),this.xia2.clear(),this.xia3.clear(),!t){switch(this.topNum){case 0:this.moveH=200;break;case 1:this.shang1.pushOne(this.topBox.addChild(new p["default"](this.ppey.PP1,1,60,this.paramObj))),this.topSkinBox.addChild(this.shang1),this.moveH=300;break;case 2:this.shang2.pushOne(this.topBox.addChild(new p["default"](this.ppey.PP2,2,148,this.paramObj))),this.shang2.pushOne(this.topBox.addChild(new p["default"](this.ppey.PP1,1,60,this.paramObj))),this.topSkinBox.addChild(this.shang2),this.moveH=380;break;case 3:this.shang3.pushOne(this.topBox.addChild(new p["default"](this.ppey.PP3,3,212,this.paramObj))),this.shang3.pushOne(this.topBox.addChild(new p["default"](this.ppey.PP2,2,148,this.paramObj))),this.shang3.pushOne(this.topBox.addChild(new p["default"](this.ppey.PP1,1,60,this.paramObj))),this.topSkinBox.addChild(this.shang3),this.moveH=430}switch(this.bottomNum){case 0:break;case 1:this.xia1.pushOne(this.bottomBox.addChild(new p["default"](this.ppey.PP1,1,-75,this.paramObj))),this.bottomSkinBox.addChild(this.xia1);break;case 2:this.xia2.pushOne(this.bottomBox.addChild(new p["default"](this.ppey.PP2,2,-130,this.paramObj))),this.xia2.pushOne(this.bottomBox.addChild(new p["default"](this.ppey.PP1,1,-35,this.paramObj))),this.bottomSkinBox.addChild(this.xia2);break;case 3:this.xia3.pushOne(this.bottomBox.addChild(new p["default"](this.ppey.PP3,3,-165,this.paramObj))),this.xia3.pushOne(this.bottomBox.addChild(new p["default"](this.ppey.PP2,2,-100,this.paramObj))),this.xia3.pushOne(this.bottomBox.addChild(new p["default"](this.ppey.PP1,1,-10,this.paramObj))),this.bottomSkinBox.addChild(this.xia3)}this.updateTransform(),this.danType=1==this.topNum&&0==this.bottomNum?1:0==this.topNum&&1==this.bottomNum?2:0,this.freshLine(),this.freshJoin(),this.isOpenTrack&&(this.openTrack(!1),this.trackFlag>0&&clearTimeout(this.trackFlag),this.trackFlag=setTimeout(function(){e.hadDestory||(e.openTrack(!0),e.trackFlag=0)},800))}}},{key:"freshJoin",value:function(){if(this.laP){var t=this.toGlobalView(this.laP,this),e=this.Vec2Util.pointToVec2(t),i=this.body.position;if(0===this.danType)this.reCreateJoin(e,this.gou1.body.position,i,this.gou2.position);else if(1===this.danType){var o=this.topBox.getChildAt(0),n=o.gLeftP(),s=o.gRightP();this.reCreateJoin(this.Vec2Util.pointToVec2(n),this.gou1.body.position,this.Vec2Util.pointToVec2(s),this.gou2.position)}else if(2===this.danType){this.linkType=1;var a=this.bottomBox.getChildAt(0),r=a.gRightP();this.reCreateJoin(this.Vec2Util.pointToVec2(r),this.gou1.body.position,i,this.gou2.position)}}}},{key:"reCreateJoin",value:function(t,e,i,o,n){var s=this.danType;this.pj&&(this.bd.get_userData().isconnect&&(this.danType=1,this.bd.dragToolClick(),this.danType=s),this.BodyUtil.destoryJoint(this.pj)),this.lineJoint&&(this.BodyUtil.destoryJoint(this.lineJoint),this.lineJoint=null),this.bTobgou();var a=this.allLen;if(2==this.danType&&(a=2*this.allLen),this.pj=this.JointUtil.createPulleyJoint(this.body,this.gou1.body,this.body,this.gou2,t,e,i,o,a,a),this.pj.set_stiff(!1),1===this.danType){this.bd.get_userData().useing&&(this.bd.get_userData().bind.get_body(),this.bd.dragToolClick(!0));var r=this.bd.get_worldCOM().copy();this.gou2.add(this.bd),this.gou2.set_position(r),this.bd.set_localCOM(P.weak(0,0)),this.wj=!0}else{this.lineJoint=this.JointUtil.createLineJoint(this.body,this.gou2,this.body.get_position(),this.gou2.get_position(),P.weak(0,1),0,2e3)}}},{key:"bTobgou",value:function(){if(this.wj){var t=this.body.worldPointToLocal(this.gou2.get_position());this.body.add(this.bd),this.bd.set_localCOM(t),this.wj=!1}}},{key:"getWjBodyVec",value:function(){var t=this.bottomBox.getChildAt(this.bottomBox.children.length-1),e=t.gBottomP();return P.get(e.x,e.y+20)}},{key:"openTrack",value:function(t){this.isOpenTrack=t,this.isOpenTrack?this.txt1.visible=this.txt2.visible=!0:(this.startPD1_=null,this.startP2_=null,this.trackSP.clear(),this.txt1.visible=this.txt2.visible=!1,this.trackFlag>0&&(clearTimeout(this.trackFlag),this.trackFlag=0))}},{key:"freshLine",value:function(){this.laP=null,this.lineSP.clear(),this.can_fresh_pullH=!1;var t=this.getMain();this.updateFreshLine();var e=this.pullOneArr[this.pullOneArr.length-1];this.laP=e[this.nextP](),this.laP=this.toLocal(this.laP,t.view),1==this.danType&&(this.laP.x-=94),this.can_fresh_pullH=!0,this.lenNum=(this.gPArr.length-1)/2,this.lenaddFlag=!1,e.parent==this.bottomBox&&(this.lenaddFlag=!0),2==this.danType&&(this.lenNum=1),this.bottomBox.y=this.topBox.y+this.topBox.height+this.allLen/this.lenNum+this.moveH,this.ori_bottomBoxY=this.bottomBox.y,this.freshBottomSkinBoxY()}},{key:"freshBottomSkinBoxY",value:function(){this.bottomSkinBox.y=this.bottomBox.y-50-22}},{key:"updateFreshLine",value:function(){var t=this.getMain(),e=0;if(this.gPArr.length=0,this.pullOneArr.length=0,1==this.danType)this.pullOneArr.push(this.topBox.getChildAt(e));else if(2==this.danType)this.pullOneArr.push(this.bottomBox.getChildAt(e));else if(this.topNum==this.bottomNum)if(0==this.linkType)for(this.pullOneArr.push(this.topBox.getChildAt(e)),e=0;this.topNum>e;e++)this.pullOneArr.push(this.bottomBox.getChildAt(e)),this.pullOneArr.push(this.topBox.getChildAt(e));else for(this.pullOneArr.push(this.bottomBox.getChildAt(e)),e=0;this.topNum>e;e++)this.pullOneArr.push(this.topBox.getChildAt(e)),this.pullOneArr.push(this.bottomBox.getChildAt(e));else if(this.topNum>this.bottomNum){for(this.pullOneArr.push(this.bottomBox.getChildAt(e)),e=0;this.bottomNum>e;e++)this.pullOneArr.push(this.topBox.getChildAt(e)),this.pullOneArr.push(this.bottomBox.getChildAt(e));this.pullOneArr.push(this.topBox.getChildAt(this.topBox.children.length-1))}else{for(this.pullOneArr.push(this.topBox.getChildAt(e)),e=0;this.topNum>e;e++)this.pullOneArr.push(this.bottomBox.getChildAt(e)),this.pullOneArr.push(this.topBox.getChildAt(e));this.pullOneArr.push(this.bottomBox.getChildAt(this.bottomBox.children.length-1))}var i=0,o=this.pullOneArr.concat();for(o.shift(),e=o.length-1;e>=0;e--){o[e].set_rotationXi(Math.pow(.9,i)),i++}if(0===this.danType){for(e=0;this.pullOneArr.length>e;e++){var n=this.pullOneArr[e];0===e?(this.gPArr.push(this.pullOneArr[0].parent===this.topBox?this.localToLineSp(n.gBottomP_gou()):this.localToLineSp(n.gTopP_gou())),this.nextP=this.topNum===this.bottomNum?0===this.linkType?"gLeftP":"gRightP":this.topNum>this.bottomNum?"gRightP":"gLeftP"):(this.gPArr.push(this.localToLineSp(n[this.nextP]())),this.nextP="gLeftP"==this.nextP?"gRightP":"gLeftP",this.gPArr.push(this.localToLineSp(n[this.nextP]())))}for(this.lineSP.clear(),this.lineSP.lineStyle(2,this.LINE_COLOR),e=0;this.gPArr.length-1>e;e+=2){var s=this.gPArr[e],a=this.gPArr[e+1];this.lineSP.moveTo(s.x,s.y),this.lineSP.lineTo(a.x,a.y)}}else if(1===this.danType){this.nextP="gRightP",this.lineSP.clear(),this.lineSP.lineStyle(2,this.LINE_COLOR);var r=this.body.worldPointToLocal(this.gou1.body.position),h=this.topBox.getChildAt(0),l=this.toLocal(h.gLeftP(),t.view),u=this.toLocal(h.gRightP(),t.view),c=this.body.worldPointToLocal(this.gou2.position);this.lineSP.moveTo(r.get_x(),r.get_y()),this.lineSP.lineTo(l.x,l.y),this.lineSP.moveTo(c.get_x(),c.get_y()),this.lineSP.lineTo(u.x,u.y)}else if(2===this.danType){this.nextP="gRightP",this.lineSP.clear(),this.lineSP.lineStyle(2,this.LINE_COLOR);var d=this.body.worldPointToLocal(this.gou1.body.get_position()),p=this.bottomBox.getChildAt(0),y=this.toLocal(p.gLeftP(),t.view),f=this.toLocal(p.gRightP(),t.view),g=P.get(p.leftP.x,0);this.lineSP.moveTo(d.get_x(),d.get_y()),this.lineSP.lineTo(f.x,f.y),this.lineSP.moveTo(g.get_x(),g.get_y()),this.lineSP.lineTo(y.x,y.y)}}},{key:"localToLineSp",value:function(t){return this.lineSP.toLocal(t,this.getMain().view)}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.updateTransform();var t=this.getMain();if(this.freshLaLineSP(),this.freshPullH(),this.updateFreshLine(),this.pj&&this.pullOneArr&&this.pullOneArr.length>0&&this.pullOneArr[this.pullOneArr.length-1].parent==this.bottomBox){this.laP=this.pullOneArr[this.pullOneArr.length-1][this.nextP](),this.laP=this.toLocal(this.laP,t.view);this.pj.anchor1=this.Vec2Util.pointToVec2(this.laP)}if(1!==this.danType)this.bd.set_localCOM(this.body.worldPointToLocal(this.getWjBodyVec())),this.bd.wdmove();else{if(this.bd.get_userData().isconnect){this.BodyUtil.dampingBodyVelocity(this.pj.get_body4(),.9,.9)}if(this.pj){var i=this.pj.get_body4(),o=this.pj.get_anchor4();o=i.localPointToWorld(o),this.gou2.set_position(o)}}this.freshGou2Weight(),this.upDateRotPan(),this.freshTrackSP(),this.wugou.x=this.bd.get_localCOM().get_x(),this.wugou.y=this.bd.get_localCOM().get_y()}},{key:"test",value:function(t,e){this.grc||(this.grc=new PIXI.Graphics,this.addChild(this.grc)),this.grc.clear(),this.grc.beginFill(16711680),this.grc.drawCircle(t,e,5)}},{key:"freshTrackSP",value:function(){if(this.isOpenTrack&&this.pullOneArr&&0!==this.pullOneArr.length){var t=this.body.worldPointToLocal(this.gou1.body.get_position()),e=new l.Point(t.get_x(),t.get_y()),i=l.Point.vec2ToPoint(this.body.worldPointToLocal(this.bd.get_worldCOM())),o=this.pullOneArr[this.pullOneArr.length-1];i.x=this.pullOneArr[this.pullOneArr.length-1].parent==this.bottomBox?-this.hLen/2:this.hLen/2;var n=void 0;if(this.startPD1_)if(0===this.topNum&&1===this.bottomNum&&0===this.linkType&&(this.linkType=1),0==this.linkType)n=l.M.getXianDianByDis(this.startLen,!0,this.laP,e);else{var s=l.M.getPointLen(this.laP,this.startLaP),a=this.laP.y>this.startLaP.y?1:-1;n=l.M.getXianDianByDis(this.startLen+a*s,!0,this.laP,e)}else n=e,this.startPD1_=o.toLocal(e,this),this.startP2_=i,this.startLen=l.M.getPointLen(this.laP,n),this.startLaP=this.laP.clone();this.trackSP.clear(),this.trackSP.lineStyle(2),this.drawTxtLine(this.startP2_,i,11655613,this.txt2),this.drawTxtLine(n,e,15829121,this.txt1)}}},{key:"drawLineP",value:function(t,e,i){this.trackSP.lineStyle(2,i);var o=l.M.rotaPointFromP(e,t,Math.PI/2),n=l.M.getXianDianByDis(this.hLen/2,!1,t,o),s=new l.Point(2*t.x-n.x,2*t.y-n.y);l.M.drawDashed(this.trackSP,n,s)}},{key:"drawTxtLine",value:function(t,e,i,o){var n=void 0,s=void 0;e.y>t.y?(n=t,s=e):(n=e,s=t);var a=l.M.getPointLen(n,s),r=l.M.getCenP(n,s);this.drawLineP(n,s,i),this.drawLineP(s,n,i);if(40>a);else if(this.isOpenTrack){this.trackSP.lineStyle(2,12183796),this.trackSP.moveTo(n.x,n.y);var h=(l.M.getPointLen(n,s)-40)/2,u=l.M.getXianDianByDis(h,!0,n,s),c=l.M.getXianDianByDis(h,!0,s,n);this.trackSP.lineTo(u.x,u.y),this.trackSP.moveTo(c.x,c.y),this.trackSP.lineTo(s.x,s.y)}o.x=r.x+65,o.y=r.y-20;var d=a/this.NapeConst.SCALE_SPACE;if(o==this.txt1){var p=+this.txt2.text.replace("mm","");o.text=0==p?"0mm":l.M.getNumJie(Math.round(d/p)*p,1)+"mm"}else o.text=l.M.getNumJie(d,1)+"mm"}},{key:"upDateRotPan",value:function(){if(this.laP&&this.shang1){var t=l.Point.vec2ToPoint(this.body.worldPointToLocal(this.gou1.body.position)),e=l.M.getPointLen(this.laP,t),i=e-this.oriDis;this.oriDis=e;var o=i/35;this.shang1.fresh_rotation(o),this.shang2.fresh_rotation(o),this.shang3.fresh_rotation(o),this.xia1.fresh_rotation(o),this.xia2.fresh_rotation(o),this.xia3.fresh_rotation(o)}}},{key:"freshGou2Weight",value:function(){var t=this.lenNum;this.lenaddFlag&&t++;var e=this.pj.impulse().x(0,0);this.pj.set_active(!1);var i=1;if(1===this.danType)this.bd.get_userData().useing&&(i=e*this.k5n,.05>(i=Math.abs(i))&&(i=5));else{var o=.5>this.dhlMass?.5:this.dhlMass;if(this.bd.pivjoint){i=this.bd.pivjoint.impulse().x(1,0)*this.k5n,i=Math.abs(i),.05>i&&(i=5),i+=o}else this.gou2.mass=o,i=o}var n=0,s=this.body.localPointToWorld(this.pj.anchor1),a=l.Point.vec2ToPoint(s),r=l.Point.vec2ToPoint(this.gou1.body.localPointToWorld(this.pj.anchor2)),h=Math.atan2(r.y-a.y,r.x-a.x);0===this.danType?n=i/t:1===this.danType?(n=this.gou2.mass=i,this.gou2.mass=n):2===this.danType&&(n=i/2);var u=s.get_y()-this.bd.get_worldCOM().get_y();1!==this.danType&&(Math.abs(u)>100?1!==this.danType&&(n=i/t,h=Math.atan2(r.y-a.y,r.x-a.x),h%=90,this.gou2.set_mass(n)):0>h&&h>-Math.PI?(h%=90,this.gou2.mass=n/Math.sin(Math.abs(h))):this.gou2.mass=1),l.Point.distance(a,r)>20&&this.gou1.handRot(h),this.gou2.mass>0||(this.gou2.mass=1),this.pj.set_active(!0);var c=this.getGravity(),d=this.gou2.mass*c*.001;!this.bd.get_userData().useing&&.5>this.dhlMass&&(d=0,this.gou2.set_mass(.01)),this.gou1.txt.text=l.M.getNumJie(d,2)+"N"}},{key:"freshPullH",value:function(){if(this.can_fresh_pullH){var t=this.Vec2Util.pointToVec2(this.laP),e=this.body.worldPointToLocal(this.gou1.body.position);this.bottomBox.y=this.ori_bottomBoxY-l.M.vec2Length(t.sub(e))/this.lenNum,this.freshBottomSkinBoxY()}}},{key:"freshLaLineSP",value:function(){if(this.laP){var t=this.getMain(),e=this.body.worldPointToLocal(this.gou1.body.position),i=this.pullOneArr[this.pullOneArr.length-1],o=this.laLineSP.toLocal(i[this.nextP](),t.view);this.laLineSP.clear(),this.laLineSP.lineStyle(2,this.LINE_COLOR),0==this.danType&&(this.laLineSP.moveTo(o.x,o.y),this.laLineSP.lineTo(e.get_x(),e.get_y()))}}},{key:"eabaseDispose",value:function(t){for(var e=t.children,i=0;e.length>i;i++){e[i].removed&&remmc.removed()}}},{key:"removed",value:function(){this.pullBox.removeChildren(),this.topBox.removeChildren(),this.bottomBox.removeChildren(),this.topSkinBox.removeChildren(),this.bottomSkinBox.removeChildren(),this.eabaseDispose(this.topBox),this.eabaseDispose(this.bottomBox),this.pullOneArr.length=0,this.BodyUtil.destoryBody(this.gou2),this.gou1.removed(),this.bd.dragToolClick(),this.bd.wdmove=null,this.bd.dispose(),this.removeAllListeners(),this.pullOneArr.length=0,this.freshPull(!0),this.topBox=null,this.bottomBox=null,this.topSkinBox=null,this.bottomSkinBox=null,this.shang1.dispose(),this.shang2.dispose(),this.shang3.dispose(),this.xia1.dispose(),this.xia2.dispose(),this.xia3.dispose(),this.gou1=null,this.bd=null,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"changeTopPull",value:function(t){var e=l.M.getNumStr(t.showValue)-0;e-1>this.bottomNum?(this.bottomNum=e-1,this.toUp=!0):this.bottomNum>e+1&&(this.bottomNum=e+1,this.toUp=!0),0===this.bottomNum&&0===e&&(this.bottomNum=1,this.toUp=!0),this.topNum=e,this.showToolDatas(),this.freshPull()}},{key:"changeBottomPull",value:function(t){var e=l.M.getNumStr(t.showValue)-0;e-1>this.topNum?(this.topNum=e-1,this.toUp=!0):this.topNum>e+1&&(this.topNum=e+1,this.toUp=!0),0===this.topNum&&0===e&&(this.topNum=1,this.toUp=!0),this.bottomNum=e,this.showToolDatas(),this.freshPull()}},{key:"openTrackChange",value:function(t){this.openTrack(t.checked)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.topNum=this.topNum,t.bottomNum=this.bottomNum,t.track=this.isOpenTrack,t.linetype=this.linkType,t.allLen=this.allLen,t.dhlMass=this.dhlMass,t.lhock={x:this.gou1.body.posx,y:this.gou1.body.posy},1==this.danType&&(t.danhock={x:this.gou2.posx,y:this.gou2.posy}),t}},{key:"setData",value:function(t){var i=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.topNum!=this.topNum&&this.changeTopPull({showValue:t.topNum}),t.bottomNum!=this.bottomNum&&this.changeBottomPull({showValue:t.bottomNum}),t.lhock&&(this.gou1.body.set_position(P.get(t.lhock.x,t.lhock.y)),this.gou1.guJ.anchor2=P.get(t.lhock.x,t.lhock.y)),t.linetype!=this.linkType&&this.changelinktype({checked:t.linetype}),t.danhock&&this.gou2.set_position(P.get(t.danhock.x,t.danhock.y)),isNaN(t.dhlMass)||this.changeDongMass({showValue:t.dhlMass}),isNaN(t.allLen)||this.changeLineLong({showValue:t.allLen}),1==t.track&&setTimeout(function(){i.hadDestory||i.openTrack(!0)},1e3)}},{key:"changeLineLong",value:function(t){this.allLen=l.M.getNumStr(t.showValue)-0,this.freshPull()}},{key:"changeDongMass",value:function(t){this.dhlMass=l.M.getNumStr(t.showValue)-0}},{key:"changelinktype",value:function(t){this.linkType=t.checked?1:0,this.startPD1_=null,this.freshPull()}},{key:"freshEquipShows",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"freshEquipShows",this).call(this,t),this.gou1.txt.visible=t}},{key:"getConf",value:function(){var t={};t.confArr=[];var e=["0","1"];return t.confArr.push(this.ComponentProperty.getDropMenu(this.language.getLocaleStr("fix_pulleys_num"),!1,"",this.topNum,[0,1,2,3],this,this.changeTopPull),this.ComponentProperty.getDropMenu(this.language.getLocaleStr("mov_pulleys_num"),!1,"",this.bottomNum,[0,1,2,3],this,this.changeBottomPull),this.ComponentProperty.getRadio(this.language.getLocaleStr("connection_mode"),this.linkType,e,this.changelinktype.bind(this)),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("line_length"),!0,"",1500,500,this.allLen,10,this.changeLineLong,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("mov_pulley_mass"),!0,"g",50,0,this.dhlMass,1,this.changeDongMass,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("open_track"),this.isOpenTrack,this.openTrackChange,this)),t}},{key:"showGlowSP",value:function(t){if(t){this.showGlowIndex(this.bd.get_userData().useing?1:0)}else this.hideGlow()}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function v(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:v(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(676),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.geom.Vec2,g=y.phys.Material,b=y.phys.BodyType,i.level=12,i.classType="PulleyLongBoard",i.haveTick=!1,i.tick=null,i.tickPoint=null,i.guPoint=null,i.carHock=null,i.plHock=null,i.line=null,i.pull1=new l.Point(560,-43),i.pull2=new l.Point(588,8),i.isroll0=!1,i.pj=null,i.interhit=null,i.isSmooth=!1,i.fparam=.5,i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;this.material.set_density(.6),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.canfixtool=!0,this.createAllShape(),this.line=new PIXI.Graphics,this.addChild(this.line),this.createHock(),this.func_createJoint(),this.parent.addChild(this.startBtn),this.startBtn.x=this.x+23,this.startBtn.y=this.y-270,this.startBtn.visible=!1,this.startBtn.fontColor="#ffffff",this.startBtn.text=this.language.getLocaleStr("eject"),this.startBtn["this"]=this,this.startBtn.tab=function(){t.tick&&(t.tick.var_powerIsOpen||(t.tick.var_ispowerClick=!0,t.tick.func_powerClick()),t.tick.bindCar.weldJoint&&t.tick.bindCar.breakWeldJoint())},this.changeFri({showValue:this.fparam}),this.addCursor(this.startBtn,"hand")}},{key:"setComponent",value:function(){var t=0>=arguments.length||arguments[0]===undefined||arguments[0];this.noRenderSelected=!0,this.iscomponent=t,this.body.userData.noDrag=!0,this.parent.removeChild(this.startBtn)}},{key:"createAllShape",value:function(){this.body.get_shapes().clear(),this.material=new g(0,1,2,3,.5),this.BodyUtil.createPolygonFromPoints([{x:-510.95,y:-1},{x:-510.95,y:47},{x:528,y:47},{x:528,y:-1}],this.body,this.material).get_cbTypes().add(this.CbTypeStr.PULL_LONG_BOARD),this.BodyUtil.createPolygonFromPoints([{x:498.9,y:-42},{x:498.9,y:47},{x:548.9,y:47},{x:548.9,y:-42}],this.body).get_cbTypes().add(this.CbTypeStr.PULL_LONG_DANG);var t=[{x:517.9,y:-32},{x:-518.05,y:-32},{x:-518.05,y:0},{x:517.9,y:0}],e=this.BodyUtil.createPolygonFromPoints(t);e.get_cbTypes().add(this.CbTypeStr.PULL_LONG_BOARD),e.set_sensorEnabled(!0),this.body.add(e),this.BodyUtil.setBodyMaterial(this.body,{elasticity:0,rollingFriction:.5})}},{key:"createHock",value:function(){this.carHock=new p["default"](this.paramObj),this.parent.addChild(this.carHock),this.carHock.init(),this.addBodyToSpace(this.carHock.body),this.carHock.injectListenOption([this.CbTypeStr.PULLEY_TICK_CAR]),this.plHock=new p["default"](this.paramObj),this.parent.addChild(this.plHock),this.plHock.init(),this.plHock.injectListenOption([this.CbTypeStr.ALUMINUM_BLOCK,this.CbTypeStr.HOOK_TOP_GOU]),this.addBodyToSpace(this.plHock.body),this.carHock.body.set_position(f.get(this.x+200,this.y-43)),this.plHock.body.set_position(f.get(this.body.posx+560,this.body.posy+120)),this.plHock.body.noallowRotation=!0}},{key:"func_createJoint",value:function(){this.pj=this.JointUtil.createPulleyJoint(this.carHock.body,this.body,this.body,this.plHock.body,this.carHock.body.position,f.get(this.x+this.pull1.x,this.y+this.pull1.y),f.get(this.x+this.pull2.x,this.y+this.pull2.y),this.plHock.body.position,0,680),this.carHock.weld(this.body,this.carHock.body.position),this.pj.set_breakUnderForce(!0)}},{key:"func_readyGoBoMass",value:function(){return 10}},{key:"weldPoint",value:function(t){return this.toGlobalView(new l.Point(t||0,-50),this)}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.startBtn.parent&&(this.startBtn.x=this.x+53,this.startBtn.y=this.y-270),this.tick&&(this.tick.rotation=this.body.rotation,this.tick.func_changeXY());var t=this.getMain(),i=void 0,o=void 0;if(i=this.toLocal(new l.Point(this.carHock.body.posx,this.carHock.body.posy),t.view),this.carHock.useing){var n=this.carHock.hock.get_userData().bind;if(n){var s=n.get_worldCOM();i=this.toLocal(new l.Point(s.get_x(),s.get_y()),t.view)}}if(o=this.toLocal(new l.Point(this.plHock.body.posx,this.plHock.body.posy),t.view),this.line.clear(),this.line.lineStyle(3,16750848),this.line.moveTo(i.x,i.y),this.line.lineTo(this.pull1.x,this.pull1.y),this.line.moveTo(this.pull2.x,this.pull2.y),this.line.lineTo(o.x,o.y),this.carHock.isconnect){var a=this.pj.get_anchor1().copy();a=this.carHock.connectBody.localPointToWorld(a),this.carHock.body.set_position(a)}}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.plHock={x:this.plHock.body.posx,y:this.plHock.body.posy},t.carHock={x:this.carHock.body.posx,y:this.carHock.body.posy,jac:this.carHock.weldJoint.active},t.lock=this.equlock,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.plHock&&(this.plHock.body.set_position(f.get(t.plHock.x,t.plHock.y)),this.carHock.body.set_position(f.get(t.carHock.x,t.carHock.y)),!0===t.carHock.jac?this.carHock.updateWeld(!0):this.carHock.weldJoint.active=!1),!0===t.lock&&this.changelock({checked:!0})}},{key:"removed",value:function(){this.removedCursor(this.startBtn),this.tick&&(this.tick.var_bindLongBoard=null,this.tick=null),this.startBtn.destroy(),this.carHock.removed(),this.plHock.removed(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"changeFri",value:function(t){this.fparam=l.M.getNumStr(t.showValue)-0;var e=2*this.fparam;this.material.set_dynamicFriction(e),this.material.set_staticFriction(1.5*e),this.material.set_rollingFriction(this.fparam)}},{key:"changelock",value:function(t){if(this.equlock=t.checked){if(this.checkHaveFix())return this.equlock=!1,void this.showToolDatas();this.body.set_type(b.get_KINEMATIC()),this.BodyUtil.frezzBody(this.body)}else this.body.set_type(b.get_DYNAMIC())}},{key:"checkHaveFix",value:function(){var t=this.body.get_constraints(),e=!1;return t.foreach(function(t){t.userData&&t.userData.toolView&&"WeldJointView"==t.userData.toolView.classname&&(e=!0)}),e}},{key:"weldFix",value:function(){this.equlock&&this.changelock({checked:!1})}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("roughness"),!0,"",1,0,this.fparam,.1,this.changeFri,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("lock"),this.equlock,this.changelock,this)),t}},{key:"getTipMess",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.language.getLocaleStr("roughness")+": "+this.fparam+"\n    "}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function m(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:m(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(546),c=o(u),d=i(449),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.NbBody,g=y.phys.BodyType,b=y.geom.Geom,v=y.geom.Vec2,_=y.shape.Polygon,i.liquidW=138,i.halfW=i.liquidW/2,i.boty=228,i.fullH=470,i.totalRange=150,i.valueTxtxy={x:110,y:-600},i.pourxy={x:-74.45,y:-243.5},i.barxy={x:150,y:0},i.selfmass=50,i.pingShape=null,i.gaiShape=null,i.jingShape=null,i.gaiBody=null,i.originxy=null,i.weld=null,i.hasAo=!1,i.canPour=!1,i.currentLiquidType="水",i.labelMask=new PIXI.Graphics,i.mlArr=["0mL","20mL","30mL","40mL","50mL","80mL","100mL"],i.waterlan="水",i.alcoholan="酒精",i.kerosenelan="煤油",i.gasolinelan="汽油",i.brinelan="盐水",i.liquidlan="液体",i}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.originxy={x:this.gai.x,y:this.gai.y},this.pourPosShape&&this.body.remove(this.pourPosShape),this.removeChild(this.valueTxt),this.initListener(),this.label=this.language.getLocaleStr("par_water"),this.addChild(this.labelMask),this.labelMask.beginFill(16711680),this.labelMask.drawRect(0,0,260,160),this.labelMask.endFill(),this.labelMask.x=this.bq.x,this.labelMask.y=this.bq.y,this.bq.mask=this.labelMask,this.changeLiquidVolume({showValue:"100mL"}),this.addCursor(this.gai,"tuozhuai"),this.waterlan=this.language.getLocaleStr("par_water"),this.alcoholan=this.language.getLocaleStr("par_alcohol"),this.kerosenelan=this.language.getLocaleStr("par_kerosene"),this.gasolinelan=this.language.getLocaleStr("par_gasoline"),this.brinelan=this.language.getLocaleStr("par_brine"),this.liquidlan=this.language.getLocaleStr("liquid"),this.currentLiquidType=this.waterlan,this.changeLiquidType({showValue:this.waterlan})}},{key:"fieldWidth",value:function(){return 40}},{key:"drawScale",value:function(){}},{key:"createBodyShape",value:function(){function t(t){for(var e=[],i=0;t.length>i;i++)e.push(v.get(t[i].x,t[i].y));return e}var e=[{x:72,y:-146},{x:-73,y:-146},{x:-148,y:-70},{x:-148,y:249.95},{x:149,y:249.95},{x:149,y:-70}],i=[{x:87,y:-253.95},{x:-85,y:-253.95},{x:-73,y:-146},{x:72,y:-146}];this.addMask(e,i),this.body.get_shapes().clear(),this.pingShape=new _(t(e)),this.body.add(this.pingShape),this.jingShape=new _(t(i)),this.body.add(this.jingShape),this.gaiShape=new _(_.box(120,120)),this.gaiBody=new f,this.gaiBody.add(this.gaiShape),this.gaiShape.set_sensorEnabled(!0),this.addBodyToSpace(this.gaiBody,this.parent);var o=this.toGlobalView(new l.Point(this.gai.x,this.gai.y),this);this.parent.addChild(this.gai),this.gai.x=o.x,this.gai.y=o.y;var n=v.get(this.gai.x,this.gai.y);this.gaiBody.set_position(n),this.gaiBody.userData.view=this.gai,this.gaiBody.set_allowRotation(!1),this.gaiBody.userData.dragLevel=2,this.weld=this.JointUtil.createWeldJoint(this.body,this.gaiBody,n,n),this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.BodyUtil.setBodyFilter(this.gaiBody,this.InteractionFilterManager.MEC_COMPONENT_FILTER)}},{key:"addMask",value:function(t,e){var i=new PIXI.Graphics;this.addChild(i),i.lineStyle(1,16711680),i.beginFill(16711680);for(var o=0;t.length>o;o++)0==o&&i.moveTo(t[o].x,t[o].y),i.lineTo(t[o].x,t[o].y);i.lineTo(t[0].x,t[0].y);for(var n=0;e.length>n;n++)0==n&&i.moveTo(e[n].x,e[n].y),i.lineTo(e[n].x,e[n].y);i.lineTo(e[0].x,e[0].y),this.liquidShape.mask=i}},{key:"initListener",value:function(){var t=this;this.startp=null,this.gai.addEventListener(p["default"].BEGIN,function(e){t.startp=t.getMouseXY(e),t.weld.set_active(!1),t.gaiBody.set_allowRotation(!1),t.BodyUtil.frezzBody(t.gaiBody)}),this.gai.addEventListener(p["default"].END,function(e){b.intersects(t.gaiShape,t.jingShape)?(t.gaiBody.set_rotation(0),t.gaiBody.set_type(g.get_DYNAMIC()),t.weld.set_active(!0),t.canPour=!1):(t.gaiBody.set_rotation(Math.PI),t.gaiBody.set_type(g.get_KINEMATIC()),t.BodyUtil.frezzBody(t.gaiBody),t.canPour=!0)})}},{key:"bottomAddCbtype",value:function(){}},{key:"drawLiquid",value:function(t){this.liquidShape.clear(),this.liquidShape.lineStyle(1,0,0),this.liquidShape.beginFill(this.liquidColor,this.liqAlpha);var e=t[1].get_x()-t[0].get_x(),i=e/this.liquidW,o=280*i;if(t[0].set_x(-140),t[1].set_x(o-140),3===t.length){var n=l.M.getJiaoP(new l.Point(t[1].get_x(),t[1].get_y()),new l.Point(t[2].get_x(),t[2].get_y()),new l.Point(t[0].get_x(),t[0].get_y()),new l.Point(-140,t[2].get_y()));t[2].set_x(-140),t[2].set_y(n.y),t[1].get_x()<-this.halfW&&(t[0].subeq(v.get(0,390)),t[1].subeq(v.get(0,390)),t[2].subeq(v.get(0,390)))}else{t[2].set_x(o-140);var s=l.M.getJiaoP(new l.Point(t[2].get_x(),t[2].get_y()),new l.Point(t[3].get_x(),t[3].get_y()),new l.Point(t[0].get_x(),t[0].get_y()),new l.Point(-140,t[3].get_y()));t[3].set_x(-140),t[3].set_y(s.y)}for(var a=0;t.length>a;a++)0===a?this.liquidShape.moveTo(t[a].get_x(),t[a].get_y()):this.liquidShape.lineTo(t[a].get_x(),t[a].get_y());this.liquidShape.lineTo(t[0].get_x(),t[0].get_y())}},{key:"removed",value:function(){this.removedCursor(this.gai),this.BodyUtil.destoryBody(this.gaiBody),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.bq.x=this.bar.visible?this.labelMask.x+this.bq.width/2:this.labelMask.x}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.liquidType=this.currentLiquidType,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.liquidType&&this.changeLiquidType({showValue:t.liquidType})}},{key:"changeDensity",value:function(t,e){this.liquid.density=l.M.getNumStr(t.showValue)-0,e||this.currentLiquidType==this.liquidlan||(this.changeLiquidType({showValue:this.liquidlan},!0),this.showToolDatas())}},{key:"changeLiquidType",value:function(t,e){var i={};i[this.waterlan]=1,i[this.alcoholan]=.8,i[this.brinelan]=.8,i[this.gasolinelan]=.7,i[this.brinelan]=1.1,i[this.liquidlan]=l.M.getNumJie(.7+12.9*Math.random(),1),this.currentLiquidType=t.showValue;var o=i[this.currentLiquidType];this.label=this.currentLiquidType,e||(this.changeDensity({showValue:o},!0),this.showToolDatas())}},{key:"getConf",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this),i=t.confArr,o=[this.waterlan,this.alcoholan,this.gasolinelan,this.brinelan,this.liquidlan];return i.splice(2,0,this.ComponentProperty.getDropMenu(this.language.getLocaleStr("liquid"),!1,"",this.currentLiquidType,o,this,this.changeLiquidType,0,0)),t}},{key:"getTipMess",value:function(t){return'    <font class="pre-tipmess-title">'+(t||this.elecLable)+"</font>"}},{key:"label",set:function(t){this.bq.labelTxt.text=t}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function c(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:c(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(226),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.level=15,i.waterSurface=null,i.waterSurface2=null,i.crossBar=null,i.tube=null,i.funnelFront=null,i.hideMc=null,i.waterCon=null,i.waterCon2=null,i.waterArr=[],i.rho=1,i.isPause=!1,i.omega=0,i.realOmega=0,i.angle=0,i.stepAngle=2*Math.PI/48,i.tubeR=140,i.tubeS=10,i.waterHeight=0,i.resistance=0,i.pool=[],i}return s(e,t),a(e,[{key:"added",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.hideMc.visible=!1,this.waterOriginHeight=this.waterSurface.height,this.waterCon=new PIXI.Graphics,this.addChildAt(this.waterCon,this.children.length-3),this.waterCon2=new PIXI.Graphics,this.addChildAt(this.waterCon2,6),this.waterCon.interactiveChildren=this.waterCon.interactive=!1,this.waterCon2.interactiveChildren=this.waterCon2.interactive=!1,this.reset(),this.addCursor(this.funnelFront,"hand"),this.funnelTouchid=h.M.addTouch(this.funnelFront,{begin:this.funnelTouchBegin,move:this.funnelTouchgMove,end:this.funnelTouchEnd},this)}},{key:"funnelTouchBegin",value:function(t){this.resistance=5e4}},{key:"funnelTouchgMove",value:function(t){}},{key:"funnelTouchEnd",value:function(t){this.resistance=0}},{key:"removed",value:function(){this.removedCursor(this.funnelFront),h.M.removeTouch(this.funnelFront,this.funnelTouchid),this.funnelTouchid=null,this.waterCon.removeChildren(),this.waterCon2.removeChildren(),this.waterArr=[],this.pool=[],r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){if(!this.isPause&&this.moduleMain.napeEngine.play){var t=this.moduleMain.napeEngine.getGravity(),e=this.waterHeight-35,i=Math.sqrt(2*t*e),o=.5*this.tubeR*this.tubeS*this.rho*this.tubeR*this.tubeR,n=this.tubeR*this.omega,s=i-n;0>s&&(s=0);var a=this.rho*s*s*this.tubeS,r=(a-this.resistance)/o;this.omega+=r,this.omega*=.995,.02>this.omega&&0>=r&&(this.omega=0),this.angle+=this.omega,this.angle=this.angle%(2*Math.PI);var h=Math.floor(this.angle/this.stepAngle);this.crossBar.gotoAndStop(h),this.tube.gotoAndStop(h);var l=i*this.tubeS,u=149*e/206,c=void 0;c=u>0?l/(60*u):0;var d=e-c;0>d&&(d=0),this.setWaterHeight(d+35),this.waterSurface2.y-=.02*l/500,d&&0!==t&&this.flowWater(l,s);var p=t;5>p&&(p=5-.1*(5-p));for(var y=0;this.waterArr.length>y;y++){var f=this.waterArr[y];f.x+=f.speedX,f.y+=f.speedY,f.speedY+=.1*p,f.alpha-=.06,f.scale.x+=.04,f.scale.y+=.04,this.waterSurface2.y>=f.y&&f.alpha>0||(this.waterArr.splice(y,1),this.waterCon.containsChild(f)?this.waterCon.removeChild(f):this.waterCon2.containsChild(f)&&this.waterCon2.removeChild(f),this.pool.push(f),y--)}}}},{key:"flowWater",value:function(t,e){var i=35*-Math.PI/180,o=new h.Point(140*Math.cos(this.angle+i),132+44*Math.sin(this.angle+i)),n=new h.Point(140*Math.cos(this.angle),132+44*Math.sin(this.angle)),s=new h.Point(o.x-n.x,o.y-n.y);s.normalize(1);var a=new h.Point(-140*Math.cos(this.angle+i),132-44*Math.sin(this.angle+i)),r=new h.Point(-140*Math.cos(this.angle),132-44*Math.sin(this.angle)),l=new h.Point(a.x-r.x,a.y-r.y);l.normalize(1);for(var u=0;5>u;u++)this.addDrop(o,s,e,0),this.addDrop(a,l,e,0)}},{key:"addDrop",value:function(t,e,i,o){var n=this.getDrop();i*=.95+.1*Math.random(),n.speedX=.08*i*e.x,n.speedY=.08*i*e.y,n.x=t.x+o*e.x,n.y=t.y+o*e.y,this.waterArr.push(n),n.pId=1,n.alpha=1,n.scale.x=.2,n.scale.y=.1,n.y>132?(this.waterCon.addChild(n),n.pId=1):(this.waterCon2.addChild(n),n.pId=2)}},{key:"getDrop",value:function(){var t=this.pool.pop();if(!t){t=new PIXI.Container;var e=PIXI.Sprite.fromFrame("Recoil/water.png");t.addChild(e),e.x=-58,e.y=-66}return t}},{key:"setWaterHeight",value:function(t){this.waterSurface.scale.x=this.waterSurface.scale.y=t/this.waterOriginHeight,this.waterHeight=t}},{key:"reset",value:function(){this.crossBar.gotoAndStop(0),this.tube.gotoAndStop(0),this.crossBar.gotoAndStop(0),this.setWaterHeight(250),this.omega=0,this.waterCon.removeChildren(),this.waterSurface2.y=260}},{key:"changePause",value:function(t){this.isPause=t.checked}},{key:"selectRenderChild",value:function(){return this.updateTransform(),this.getBounds()}},{key:"getConf",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push(this.ComponentProperty.getButton("",this.language.getLocaleStr("reset"),this.reset,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("pause"),this.isPause,this.changePause,this)),t}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function c(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:c(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(226),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.lowest=null,i.hightest=null,i.orignHight=null,i.canReset=!0,i.lineMask=new PIXI.Graphics,i.speed=0,i.dir=1,i.line=new PIXI.Graphics,i.halfW=80,i.mw=35,i.hlen=280,i.frameindex=0,i.mcDir=1,i}return s(e,t),a(e,[{key:"added",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.componentBox.visible=!1,this.removeChild(this.componentBox),this.addChild(this.line),this.lowest=new h.Point(this.lun.x,this.lun.y),this.hightest=new h.Point(this.lun.x,this.lun.y-this.hlen),this.orignHight=new h.Point(this.hightest.x,this.hightest.y),this.lun.y=this.hightest.y,this.initMask()}},{key:"reset",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"reset",this).call(this),this.hightest.x=this.orignHight.x,this.hightest.y=this.orignHight.y,this.lun.y=this.hightest.y,this.speed=0,this.dir=1,this.frameindex=0,this.mcDir=1}},{key:"initMask",value:function(){this.lun.addChild(this.lineMask),this.lineMask.x=this.lun.xian.x,this.lineMask.y=this.lun.xian.y,this.lun.xian.mask=this.lineMask,this.speed=0}},{key:"get_g",value:function(){return.015*this.paramObj.moduleMain.napeEngine.getGravity()}},{key:"update",value:function(){if(this.moduleMain.napeEngine.play){var t=this.moduleMain.napeEngine.openAirRes?.02:1;this.speed+=this.get_g(),this.lun.y+=this.speed,this.lun.y>this.lowest.y&&1==this.dir&&(this.dir=-1,this.speed*=-1,this.lun.y=this.lowest.y),0>this.speed&&-1===this.dir&&1!=t&&(this.speed+=t),0>this.speed||-1!=this.dir||(this.dir=1,1!==t?this.hightest.y=this.lun.y:this.lun.y=this.hightest.y,this.speed=0,this.mcDir*=-1);var e=.13*Math.abs(this.speed);1==this.mcDir?(this.frameindex+=e,this.lun.mc.totalFrames>this.frameindex||(this.frameindex=0)):0>(this.frameindex-=e)&&(this.frameindex=this.lun.mc.totalFrames-1),this.lun.mc.gotoAndStop(this.frameindex);this.drawMaskAndLine(1-(this.lun.y-this.orignHight.y)/this.hlen)}}},{key:"removed",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"drawMaskAndLine",value:function(t){var e=this.mw*t,i=this.line.toLocal(new h.Point(0,0),this.bg.lp),o=this.line.toLocal(new h.Point(0,0),this.bg.rp),n=this.line.toLocal(new h.Point(-this.halfW-this.mw+e,0),this.lun.xian),s=this.line.toLocal(new h.Point(this.halfW+this.mw-e,0),this.lun.xian);this.line.clear(),this.line.lineStyle(2,12238270),this.line.moveTo(i.x,i.y),this.line.lineTo(n.x,n.y),this.line.moveTo(o.x,o.y),this.line.lineTo(s.x,s.y),this.lineMask.clear(),this.lineMask.beginFill(0),this.lineMask.drawRect(-this.halfW-this.mw+e,-20,-100,40),this.lineMask.drawRect(this.halfW+this.mw-e,-20,100,40),this.lineMask.endFill()}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.phys.BodyType,p=c.geom.Vec2,i.ruler1=null,i.ruler2=null,i.ruler3=null,i.selectIndex=0,i.currentBg=null,i.through=!0,i.isOpendefRot=!1,i.rulerStr=i.language.getLocaleStr("ruler"),i.rightStr=i.language.getLocaleStr("right_ruler"),i.isoscStr=i.language.getLocaleStr("isosceles_ruler"),i.po=null,i.rotlist=[],i.rotShapeList=[],i.divisionValueArr=["1mm","5mm","1cm"],i.divisionIndex=0,i.rangeValue=20,i.scaleGra=new PIXI.Graphics,i.pxPmm=3,i.rulerSca=1,i.rulerShape=null,i.traiTypes=[i.rulerStr,i.language.getLocaleStr("triang_ruler")+1,i.language.getLocaleStr("triang_ruler")+2],i.canRotate=!1,i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.ruler1.removeChild(this.ruler1.bgr),this.ruler1.bgr=new PIXI.mesh.NineSlicePlane(PIXI.Texture.fromFrame("Ruler/zhichi.png"),15,15,15,15),this.ruler1.addChildAt(this.ruler1.bgr,0),this.ruler1.bgr.pivot.y=this.ruler1.bgr.height/2,this.ruler1.kdContainer=new PIXI.Container,this.ruler1.addChild(this.ruler1.kdContainer),this.ruler1.kdc.pivot.y=-3,this.ruler1.kdContainer.addChild(this.ruler1.kdc);var t=new PIXI.Graphics;this.ruler1.kdMask=t,this.ruler1.kdContainer.addChild(t),this.ruler1.kdc.mask=t,this.ruler1.kdc.x=0,this.ruler1.kdc.y=0,this.ruler1.kdContainer.y=-this.ruler1.bgr.height/2,this.currentBg=this.ruler1,this.body.set_type(d.get_KINEMATIC()),this.body.set_mass(1),this.body.userData.pivotDrag=!0,this.changeStatus(this.selectIndex,!0),this.refreshRange()}},{key:"removed",value:function(){var t=this;this.rotlist.forEach(function(e){t.removedCursor(e)}),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"changeStatus",value:function(t,e){if(e||this.selectIndex!==t){for(var i=0;this.rotlist.length>i;i++){this.removedCursor(this.rotlist[i])}this.rulerSca=1,this.rotlist=[],this.rotShapeList=[],this.selectIndex=t,this.body.get_shapes().clear(),0===t?(this.ruler1.visible=!0,this.ruler2.visible=!1,this.ruler3.visible=!1,this.currentBg=this.ruler1,this.po=this.BodyUtil.createRectShape(-this.ruler1.bgr.width/2,-this.ruler1.bgr.height/2,this.ruler1.bgr.width,this.ruler1.bgr.height),this.addOneRoteShape(-this.ruler1.bgr.width/2+20,0,50),this.addOneRoteShape(this.ruler1.bgr.width/2-20,0,50),this.rulerShape=this.po):1==t?(this.ruler1.visible=!1,this.ruler2.visible=!0,this.ruler3.visible=!1,this.currentBg=this.ruler2,this.po=this.BodyUtil.createPolygonShape([{x:-181.85,y:105.05},{x:181.15,y:-107.3},{x:-181.85,y:-107.3}]),this.addOneRoteShape(-181,105,40),this.addOneRoteShape(181,-107,40),this.addOneRoteShape(-181,-107,40)):(this.ruler1.visible=!1,this.ruler2.visible=!1,this.ruler3.visible=!0,this.currentBg=this.ruler3,this.po=this.BodyUtil.createPolygonShape([{x:-181,y:-92.8},{x:.1,y:89.25},{x:182.1,y:-92.8}]),this.addOneRoteShape(-181,-92,40),this.addOneRoteShape(0,89,40),this.addOneRoteShape(181,-92,40)),this.body.add(this.po),this.through&&this.throughRul({checked:!0})}}},{key:"addOneRoteShape",value:function(t,i,o){var n=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"addOneRoteShape",this).call(this,t,i,o);this.rotShapeList.push(n);var s=new PIXI.Graphics;return s.beginFill(16711680,0),s.drawCircle(0,0,o),s.endFill(),this.addChild(s),s.x=t,s.y=i,this.addCursor(s,"xuanzhuan"),this.rotlist.push(s),n}},{key:"throughRul",value:function(t){this.through=t.checked,this.body.set_shape_sensorEnabled(this.body.shapesAt(0),this.through)}},{key:"rotaChange",value:function(){this.showToolDatas()}},{key:"menuRotaChange",value:function(t){this._rotateHandleFunc("menuChange",h.M.getNumStr(t.showValue)*Math.PI/180)}},{key:"changeRulerType",value:function(t){t.showValue===this.rulerStr?this.changeStatus(0):t.showValue===this.rightStr?this.changeStatus(1):t.showValue===this.isoscStr&&this.changeStatus(2),this.freshLibPan()}},{key:"getCurrentType",value:function(){var t="";return 0===this.selectIndex?t=this.rulerStr:1===this.selectIndex?t=this.rightStr:2===this.selectIndex&&(t=this.isoscStr),t}},{key:"createTxt",value:function(t,e,i,o,n,s){var a=new PIXI.Text(o,{font:n+"px Arial",fill:s});return t.addChild(a),a.x=e,a.y=i,a}},{key:"refreshRange",value:function(){var t=600*this.rangeValue/20+40,e=t/this.ruler1.bgr.width;this.ruler1.bgr.width=t;var i=this.rotShapeList[0],o=this.rotShapeList[1];i&&i.set_localCOM(p.weak(-t/2+20,0)),o&&o.set_localCOM(p.weak(t/2-20,0)),this.rulerShape&&this.rulerShape.scale(e,1);var n=.5*t-15;this.ruler1.kdContainer.x=-n,this.ruler1.bgr.pivot.x=t/2,this.ruler1.kdMask.clear(),this.ruler1.kdMask.lineStyle(1,0,0),this.ruler1.kdMask.beginFill(16711680),this.ruler1.kdMask.moveTo(0,0),this.ruler1.kdMask.lineTo(2*n,0),this.ruler1.kdMask.lineTo(2*n,10),this.ruler1.kdMask.lineTo(2*n+10,10),this.ruler1.kdMask.lineTo(2*n+10,100),this.ruler1.kdMask.lineTo(0,100),this.ruler1.kdMask.lineTo(0,0)}},{key:"changeDivision",value:function(t){this.divisionIndex=this.divisionValueArr.indexOf(t.showValue),this.currentBg.kdc&&this.currentBg.kdc.gotoAndStop(this.divisionIndex)}},{key:"update",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this)}},{key:"changeRangeValue",value:function(t){this.rangeValue=t.showValue,this.refreshRange()}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.selectType=this.getCurrentType(),t.through=this.through,t.divisionIndex=this.divisionIndex,t.rangeValue=this.rangeValue,t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t);var i=t.selectType;this.divisionIndex=t.divisionIndex||0,this.rangeValue=t.rangeValue||20,this.changeRulerType({showValue:i}),0==t.through&&this.throughRul({checked:!1}),this.currentBg.kdc&&this.currentBg.kdc.gotoAndStop(this.divisionIndex),this.refreshRange()}},{key:"getConf",value:function(){var t=this,e={};return e.confArr=[],e.confArr.push({type:this.ComponentProperty.TYPE_LIST_RULER,name:this.language.getLocaleStr("type"),value:this.traiTypes,checked:this.selectIndex,callBack:function(e){t.changeStatus(e.checked),t.freshLibPan()}},this.ComponentProperty.getSwitch(this.language.getLocaleStr("can_penetrate"),this.through,this.throughRul,this)),0===this.selectIndex&&e.confArr.push(this.ComponentProperty.getDropMenu(this.language.getLocaleStr("dividing_value"),!1,"",this.divisionValueArr[this.divisionIndex],this.divisionValueArr,this,this.changeDivision,0,0),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("range"),!0,"cm",100,20,this.rangeValue,5,this.changeRangeValue,this)),e}},{key:"getTipMess",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.language.getLocaleStr("type")+": "+this.traiTypes[this.selectIndex]+"\n    "+this.language.getLocaleStr("dividing_value")+": "+this.divisionValueArr[this.divisionIndex]+"\n    "+this.language.getLocaleStr("range")+": "+this.rangeValue+"cm\n    "}},{key:"getLocalBoundsElecs",value:function(){return 0===this.selectIndex?[this.ruler1]:1===this.selectIndex?[this.ruler2]:[this.ruler3]}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=i(670),r=function(t){return t&&t.__esModule?t:{"default":t}}(a);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.radius=28.8,i}return s(e,t),e}(r["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function x(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:x(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(492),p=o(d),y=i(463),f=o(y),g=void 0,b=void 0,v=void 0,_=void 0,m=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return g=i.phy.nape,b=g.NbBody,v=g.shape.Polygon,_=g.geom.Vec2,m=g.phys.BodyType,i.leftMirr=null,i.rightMirr=null,i.ray=null,i.rulerBody=null,i.isYa=!1,i.biBody=null,i.btnTouchid=null,i}return a(e,t),r(e,[{key:"init",value:function(){this.points=[{x:414.25,y:-210},{x:-425.6,y:-210},{x:-425.6,y:-40},{x:414.25,y:-40}],h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.sensorEnabled(!0),this.body.mass=3,this.body.set_type(m.get_KINEMATIC()),this.body.userData.dragLevel=-1,this.body.userData.weldDrag=!0,this._shape.set_filter(this.NBOpticsStr.filters),this.resetUserView(this.bg,this,!0),this.initMirr(),this.initRay(),this.initRuler(),this.touchDown(),this.addCursor(this.bg.touchBtn,"hand")}},{key:"touchDown",value:function(){var t=this;this.btnTouchid=l.M.addTouch(this.bg.touchBtn,{begin:function(e){t.body.userData.noDrag=!0,t.bg.zi.visible=!1,t.isYa=!1,t.btnClick(),TweenMax.to(t.leftMirr,1,{rotation:.005}),TweenMax.to(t.rightMirr,1,{rotation:-.005})},end:function(e){t.body.userData.noDrag=!1,t.isYa=!0,t.btnClick(),TweenMax.to(t.leftMirr,1,{rotation:0}),TweenMax.to(t.rightMirr,1,{rotation:0}),e.stopPropagation()}},this)}},{key:"btnClick",value:function(){this.isYa?TweenMax.to(this.bg.f,1,{y:-245}):TweenMax.to(this.bg.f,1,{y:-206})}},{key:"initRuler",value:function(){this.rulerBody=new b;var t=new v(v.box(this.ruler.width,this.ruler.height));t.set_sensorEnabled(!0),this.rulerBody.add(t),this.rulerBody.set_type(m.get_KINEMATIC()),this.rulerBody.userData.view=this.ruler,this.addBodyToSpace(this.rulerBody,this),this.rulerBody.set_position(_.get(this.x+this.ruler.x,this.y+this.ruler.y))}},{key:"initRay",value:function(){var t=new b;this.biBody=t,t.add(new v(v.box(30,30))),t.set_sensorEnabled_at(0,!0),t.userData.view=this.bg.pen,this.addBodyToSpace(t,this.bg);var e=_.get(this.x+this.bg.x+this.bg.pen.x,this.y+this.bg.y+this.bg.pen.y);t.set_position(e),this.bg.pen.rotation=t.rotation=-11*Math.PI/180,t.noallowRotation=!0,this.JointUtil.createWeldJoint(t,this.body,e,e),this.ray=new p["default"](t,1.513,16711680,this.paramObj),this.ray.lineStart=[117,0],this.bg.pen.addChild(this.ray),this.ray.init()}},{key:"initMirr",value:function(){var t=new f["default"](!0,!1,1);t.var_open_angle=!1,t.var_show_direction=!1,this.leftMirr=new b;var e=new v(v.box(40,123));e.set_sensorEnabled(!0),e.get_userData().vo=t,this.leftMirr.add(e),this.addBodyToSpace(this.leftMirr),this.leftMirr.noallowRotation=!0;var i=_.get(this.x-282,this.y-375);this.leftMirr.set_position(i),this.JointUtil.createPivotJoint(this.leftMirr,this.body,i,i),this.rightMirr=new b;var o=new v(v.box(40,123));o.set_sensorEnabled(!0),o.get_userData().vo=t,this.rightMirr.add(o),this.addBodyToSpace(this.rightMirr),this.rightMirr.noallowRotation=!0;var n=_.get(this.x+293,this.y-312);this.rightMirr.set_position(n),this.JointUtil.createPivotJoint(this.rightMirr,this.body,n,n)}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.ray&&this.ray.update()}},{key:"removed",value:function(){this.removedCursor(this.bg.touchBtn),TweenMax.killAll(),this.bg.pen.removeChild(this.ray),this.ray.removed(),this.BodyUtil.destoryBody(this.leftMirr),this.BodyUtil.destoryBody(this.rightMirr),this.BodyUtil.destoryBody(this.biBody),this.BodyUtil.destoryBody(this.rulerBody),l.M.removeTouch(this.bg.touchBtn,this.btnTouchid),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this),this.ray.destroy()}},{key:"hideTips",value:function(){this.bg.zi.visible=!1}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function k(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:k(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(611),p=o(d),y=i(613),f=o(y),g=i(612),b=o(g),v=void 0,_=void 0,m=void 0,x=void 0,w=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return v=i.phy.nape,_=v.phys.BodyType,m=v.geom.Vec2,x=v.shape.Polygon,w=v.geom.Ray,i.r1=null,i.r2=null,i.r1Number=0,i.isLocked=!1,i.maxV=1e4,i.maxH=40*i.NapeConst.SCALE_SPACE,i.sv0=new f["default"](t),i.sh0=new b["default"](t),i.svcon=new PIXI.Sprite,i.sv=null,i.sh=null,i.svh=null,i.bangshape=null,i.originBangX=null,i.txt=new PIXI.Text("0.000mm",{font:"25px Arial",fill:16777215}),i}return a(e,t),r(e,[{key:"init",value:function(){this.points=[{x:67,y:-170},{x:-30.95,y:-170},{x:-30.95,y:-56},{x:-38.95,y:-17},{x:-53.95,y:10},{x:-74.95,y:32},{x:-97.95,y:48},{x:-122.95,y:59},{x:-185.95,y:59},{x:-205.95,y:48},{x:-231.95,y:32},{x:-249.95,y:10},{x:-262.95,y:-17},{x:-269.95,y:-36.5},{x:-269.95,y:-94},{x:-249.95,y:-94},{x:-249.95,y:-132.5},{x:-259.95,y:-132.5},{x:-269.95,y:-132.5},{x:-269.95,y:-145},{x:-315.95,y:-145},{x:-315.95,y:-94},{x:-329.95,y:-71},{x:-347.95,y:-56},{x:-347.95,y:-17},{x:-341.95,y:10},{x:-329.95,y:48},{x:-315.95,y:81},{x:-298.5,y:109.5},{x:-269.95,y:132.95},{x:-231.95,y:155.95},{x:-185.95,y:168.95},{x:-122.95,y:168.95},{x:-74.95,y:155.95},{x:-30.95,y:132.95},{x:-17.6,y:121.4},{x:-4.55,y:109.5},{x:15,y:81},{x:20.9,y:70},{x:26.45,y:59},{x:41,y:10},{x:41,y:-56},{x:67,y:-56},{x:67,y:-71},{x:413,y:-71},{x:413,y:-161},{x:67,y:-161}],h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.bg.pivotX=348,this.bg.pivotY=170,this.body.set_type(_.get_KINEMATIC()),this.bg.addChild(this.txt),this.txt.x=67,this.txt.y=-20,this.txt.visible=!1,this.bangshape=new x(x.box(418,36)),this.body.add(this.bangshape),this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.originBangX=this.bg.bang.x,this.bangshape.set_localCOM(m.get(this.bg.bang.x,this.bg.bang.y)),this.initRoller(),this.initScaleRuler(),this.sv.updata(this.r1Number),this.suo.rotation=-30*Math.PI/180,this.suoId=l.M.addTouch(this.suo,{tab:this.shouClick},this,{time:300,dis:15}),this.freshEquipShows(this.globalConfig.SHOWEQUVALUE),this.addCursor(this.r1,"shangxia"),this.addCursor(this.r2,"shangxia"),this.addCursor(this.suo,"hand")}},{key:"removed",value:function(){this.removedCursor(this.r1,"shangxia"),this.removedCursor(this.r2,"shangxia"),this.removedCursor(this.suo,"hand"),this.r1.removeEventListener("rolling",this.r1RollingFunc),this.r2.removeEventListener("rolling",this.r2RollingFunc),this.r1.removeEventListener("rollend",this.rRollendFunc),this.r2.removeEventListener("rollend",this.rRollendFunc),delete this.sh0.mask,delete this.sv0.mask,this.quanda.removeChildren(),this.svcon.removeChildren(),this.svh.removeChildren(),this.r1.removed(),this.r2.removed(),this.sv0.removed(),this.sh0.removed(),this.sh.removed(),this.sv.removed(),this.r1=null,this.r2=null,this.sv0=null,this.sh0=null,this.sh=null,l.M.removeTouch(this.suo,this.suoId),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"shouClick",value:function(t){this.isLocked=!this.isLocked,this.txt.visible=!this.txt.visible,this.svh.visible=!this.svh.visible,this.suo.rotation=this.svh.visible?30*Math.PI/180:-30*Math.PI/180}},{key:"initScaleRuler",value:function(){this.svh=this.quanda.scaleRuler,this.svh.visible=!1,this.svcon.addChild(this.sh0),this.svcon.addChild(this.sv0),this.svh.addChildAt(this.svcon,1),this.sv0.added(),this.sh0.added(),this.sv0.updata(0),this.sv0.reScaleTxt(.5),this.sh0.reScaleTxt(.5),this.svcon.y=-133,this.svcon.x=-21,this.svcon.scale.x=this.svcon.scale.y=3,this.sh0.mask=this.quanda.scaleRuler.scale2.mask1.getChildAt(0),this.sv0.mask=this.quanda.scaleRuler.scale2.mask2.getChildAt(0),this.sh=new b["default"](this.paramObj),this.addChildAt(this.sh,2),this.sh.x=this.quanda.x-160,this.sh.y=this.quanda.y,this.sh.added(),this.sv=new f["default"](this.paramObj),this.quanda.addChild(this.sv),this.sv.updata(0),this.sv.x=-160,this.sv.added();var t=new PIXI.Graphics;t.beginFill(16711680,.3),t.drawRect(0,0,46,88),t.endFill(),this.quanda.addChild(t),t.x=-161,t.y=-45,this.sv.mask=t}},{key:"initRoller",value:function(){var t=this,e=PIXI.Sprite.fromFrame("SpiralMicrometer/zhaobig");e.pivot.x=.5*e.width,e.pivot.y=.5*e.height,this.r1=new p["default"](e,this.quanda.wenda,this.quanda.zheda,this.paramObj),this.r1.x=this.quanda.zheda.x,this.r1.y=this.quanda.zheda.y,this.quanda.addChild(this.r1),this.quanda.zheda.x=this.quanda.zheda.y=0,this.quanda.wenda.x=this.quanda.wenda.y=0,this.r1.init();var i=PIXI.Sprite.fromFrame("SpiralMicrometer/zhaobig");i.pivot.x=.5*i.width,i.pivot.y=.5*i.height,i.scale.x=.79,this.r2=new p["default"](i,this.quanda.wenxiao,this.quanda.zhexiao,this.paramObj),this.r2.x=this.quanda.zhexiao.x,this.r2.y=this.quanda.zhexiao.y,this.quanda.addChild(this.r2),this.r1.$target=this.r2.$target=this,this.quanda.wenxiao.x=this.quanda.zhexiao.x=this.quanda.wenxiao.y=this.quanda.zhexiao.y=0,this.r2.init(),this.r1RollingFunc=function(e){t.r1Rolling(e)},this.r2RollingFunc=function(e){t.r2Rolling(e)},this.rRollendFunc=function(e){t.rollend(e)},this.r1.addEventListener("rolling",this.r1RollingFunc),this.r2.addEventListener("rolling",this.r2RollingFunc),this.r1.addEventListener("rollend",this.rRollendFunc),this.r2.addEventListener("rollend",this.rRollendFunc)}},{key:"rollend",value:function(t){this.body.userData.noDrag=!1}},{key:"rayHitTest",value:function(t){var e=this.bangshape.get_bounds(),i=m.get(e.get_x(),e.get_y()+e.get_height()/2),o=new w(i,m.get(-1,0)),n=this.body.get_space().rayCast(o);return n.get_shape().get_body()!==this.body&&n.get_distance()<t}},{key:"r1Rolling",value:function(t){if(!this.isLocked){this.body.userData.noDrag=!0;var e=t.upordown;if(e){if(this.r1Number>this.maxV+500)return;this.r1Number+=12}else{if(0>this.r1Number-12)return;if(this.rayHitTest(1))return;this.r1Number-=12}this.changeData()&&this.r1.updata(e),this.sv.updata(this.r1Number)}}},{key:"r2Rolling",value:function(t){var e=t.upordown;if(!this.isLocked){if(e)this.maxV+500>this.r1Number&&(this.r1Number+=1);else{if(this.rayHitTest(.5))return;0>this.r1Number-1||(this.r1Number-=1)}this.sv.updata(this.r1Number)}this.r2.updata(e),this.isLocked||this.changeData()}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.rNumber=this.r1Number,t.lock=this.isLocked,t.roll1s1Y=this.r1.s1.y,t.roll1s2Y=this.r1.s2.y,t.roll2s1Y=this.r2.s1.y,t.roll2s2Y=this.r2.s2.y,t.gangX=this.bg.bang.x,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.roll1s1Y&&(this.r1Number=t.rNumber,this.r1.s1.y=t.roll1s1Y,this.r1.s2.y=t.roll1s2Y,this.r2.s1.y=t.roll2s1Y,this.r2.s2.y=t.roll2s2Y,this.sv.updata(this.r1Number),this.sv.updata(this.r1Number),this.changeData(),this.bg.bang.x=t.gangX,this.bangshape.set_localCOM(m.get(this.bg.bang.x,this.bg.bang.y)),1==t.lock&&this.shouClick(null))}},{key:"changeData",value:function(){var t=this.r1Number/this.maxV*this.maxH/2;this.sv0.updata(this.r1Number),this.sh0.x=-t,this.quanda.x=275.75+t,this.bg.bang.x=this.originBangX+t,this.bangshape.set_localCOM(m.get(this.bg.bang.x,this.bg.bang.y));var e=l.M.getNumJie(this.r1Number/500,3)+"",i=e.split(".");return 1==i.length?e="0.000":0==i[1].length?e+="000":1==i[1].length?e+="00":2==i[1].length&&(e+="0"),this.txt.text=e+" mm",!0}},{key:"freshEquipShows",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"freshEquipShows",this).call(this,t),this.txt.alpha=t?1:0}},{key:"toRandomValue",value:function(){this.isLocked||(this.r1Number=500+Math.round(7e3*Math.random()),this.r1Rolling({upordown:!0}))}},{key:"getConf",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push(this.ComponentProperty.getButton("","随机示数",this.toRandomValue,this)),t}},{key:"backgroundColorChange",value:function(t){this.txt.style.fill="#"+t.toString(16);var e=this.txt.text;this.txt.text="",this.txt.text=e}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function d(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:d(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(226),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.isOpen=!1,i.dingZ1Obj={mc:null,isup:!0,yiNum:1},i.dingZ2Obj={mc:null,isup:!1,yiNum:1},i.ma1Obj={id:1,mc:null,sudu:0,maPY:0,gupin:25,isup:!1,dingObj:i.dingZ1Obj},i.ma2Obj={id:2,mc:null,sudu:0,maPY:0,gupin:15,isup:!1,dingObj:i.dingZ2Obj},i.gunMaxNum=-315,i.gunMinNum=-330,i.zhenMax=150,i.dingSudu=null,i.quanNum=10,i.xianInd1=0,i.xianSu1=10,i.xianInd2=0,i.xianSu2=10,i.xianGap=10,i.xianSInd1=0,i.xianSInd2=0,i.xianColor=6710886,i.xian1=new PIXI.Graphics,i.xian2=new PIXI.Graphics,i.startRotP=null,i.spring1=null,i.spring2=null,i.spring3=null,i.spring4=null,i}return s(e,t),a(e,[{key:"added",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.componentBox.visible=!1,this.removeChild(this.componentBox),this.removeChild(this.img),this.addChild(this.xian1),this.addChild(this.xian2),this.xian1.x=9.5,this.xian1.y=-270,this.xian2.x=22,this.xian2.y=-330,this.dingZ1Obj.mc=this.leftDing,this.dingZ2Obj.mc=this.rightDing,this.ma1Obj.mc=this.small,this.ma2Obj.mc=this.big,this.initBtn(),this.txt.text=this.language.getLocaleStr("speed")+":"+this.quanNum,this.spring1=new c(new h.Point(this.leftDing.x,this.leftDing.y+145),new h.Point(this.small.x,this.small.y+15)),this.spring2=new c(new h.Point(this.small.x,this.small.y+30),new h.Point(-113,275)),this.spring3=new c(new h.Point(this.rightDing.x,this.rightDing.y+145),new h.Point(this.big.x,this.big.y+15)),this.spring4=new c(new h.Point(this.big.x,this.big.y+45),new h.Point(113,275)),this.addChildAt(this.spring1,1),this.addChildAt(this.spring2,1),this.addChildAt(this.spring3,1),this.addChildAt(this.spring4,1),this.addCursor(this.btn,"zuoyou"),this.addCursor(this.power,"hand")}},{key:"removed",value:function(){this.removedCursor(this.btn),this.removedCursor(this.power),this.dingZ1Obj.mc=null,this.dingZ2Obj.mc=null,this.ma1Obj.mc=null,this.ma2Obj.mc=null,h.M.removeTouch(this.power,this.powerTouchid),h.M.removeTouch(this.btn,this.btnTouchid),this.spring1.disposeAll(),this.spring2.disposeAll(),this.spring3.disposeAll(),this.spring4.disposeAll(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this),this.spring1=null,this.spring2=null,this.spring3=null,this.spring4=null}},{key:"initBtn",value:function(){var t=this;this.powerTouchid=h.M.addTouch(this.power,{tab:function(e){t.isOpen=!t.isOpen,t.power.gotoAndStop(t.isOpen?1:0),t.freshGlow()}},this);var e=void 0;this.btnTouchid=h.M.addTouch(this.btn,{begin:function(i){t.cannotSystemDrag=!0,t.startRotP=t.getMouseXY(i),e=t.quanNum},move:function(i){var o=t.getMouseXY(i);t.quanNum=e+h.M.getNumToInt((o.x-t.startRotP.x)/10),t.quanNum=0>t.quanNum?0:t.quanNum,t.quanNum=t.quanNum>40?40:t.quanNum,t.txt.text=t.language.getLocaleStr("speed")+":"+t.quanNum},end:function(e){t.cannotSystemDrag=!1}},this)}},{key:"update",value:function(){this.paramObj.moduleMain.napeEngine.play&&(this.animationDingZ(this.dingZ1Obj),this.animationDingZ(this.dingZ2Obj),this.cacuMa(this.ma1Obj),this.cacuMa(this.ma2Obj),this.freshSpring(),this.freshLRXian())}},{key:"cacuMa",value:function(t){var e=t.mc;if(e&&0!=this.quanNum){if(!this.isOpen)return void(Math.abs(e.y-t.maPY)>3?e.y+=.1*(t.maPY-e.y):e.y=t.maPY);var i=t.gupin,o=.2+this.quanNum/50*9.8;o=2*this.zhenMax/t.dingObj.yiNum,o*=Math.pow(1-Math.abs(this.quanNum-i)/50,10);t.dingObj.isup?t.maPY+this.zhenMax>e.y+o?e.y+=o:(e.y=t.maPY+this.zhenMax,t.isup=!1):e.y-o>t.maPY-this.zhenMax?e.y-=o:(e.y=t.maPY-this.zhenMax,t.isup=!0)}}},{key:"animationDingZ",value:function(t){var e=t.mc;if(e){this.dingSudu=.2+this.quanNum/50*9.8,0==this.quanNum&&(this.dingSudu=0),this.isOpen||(this.dingSudu=0);t.yiNum=(this.gunMaxNum-this.gunMinNum)/this.dingSudu,t.isup?this.gunMaxNum>e.y+this.dingSudu?e.y+=this.dingSudu:(e.y=this.gunMaxNum,t.isup=!1):e.y-this.dingSudu>this.gunMinNum?e.y-=this.dingSudu:(e.y=this.gunMinNum,t.isup=!0)}}},{key:"freshLRXian",value:function(){if(0!=this.quanNum&&this.isOpen){this.xianSu1=40/(this.quanNum+10),this.xianSu1=Math.max(1,this.xianSu1),this.xianSu2=2*this.xianSu1,this.xianSInd1+=2;var t=void 0;if(this.xianSInd1>=this.xianSu1)for(this.xianSInd1=0,this.xian1.clear(),this.xian1.lineStyle(1,this.xianColor),this.xianInd1+=3,this.xianGap>this.xianInd1||(this.xianInd1=0),t=this.xianInd1;44>t;t+=this.xianGap)this.xian1.moveTo(0,t),this.xian1.lineTo(6,t);if((this.xianSInd2+=2)>=this.xianSu2)for(this.xianSInd2=0,this.xian2.clear(),this.xian2.lineStyle(1,this.xianColor),this.xianInd2+=2,this.xianGap>this.xianInd2||(this.xianInd2=0),t=this.xianInd2;86>t;t+=this.xianGap)this.xian2.moveTo(0,t),this.xian2.lineTo(6,t)}}},{key:"freshSpring",value:function(){this.spring1.fresh(new h.Point(this.leftDing.x,this.leftDing.y+145),new h.Point(this.small.x,this.small.y+15)),this.spring2.fresh(new h.Point(this.small.x,this.small.y+30),new h.Point(-113,275)),this.spring3.fresh(new h.Point(this.rightDing.x,this.rightDing.y+145),new h.Point(this.big.x,this.big.y+15)),this.spring4.fresh(new h.Point(this.big.x,this.big.y+45),new h.Point(113,275))}},{key:"selectRenderChild",value:function(){return this.bg.getBounds()}}]),e}(u["default"]);var c=function(t){function e(t,i){o(this,e);var s=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return s.startP=t,s.endP=i,s.hh_=33,s.ww_=3,s.count=Math.floor(i.subtract(t).length/8),s.container=new PIXI.Sprite,s.addChild(s.container),s.freshSJ(),s}return s(e,t),a(e,[{key:"disposeAll",value:function(){this.container.removeChildren(),this.destroy()}},{key:"freshSJ",value:function(){this.container.removeChildren();var t=new h.Point(this.startP.x,this.startP.y),e=new h.Point(this.endP.x,this.endP.y),i=h.M.getPointLen(t,e),o=i/this.count,n=[],s=Math.sqrt(h.M.sq(this.hh_/2)-h.M.sq(o/2)),a=void 0;for(a=1;this.count>=a;a++){var r=h.M.getXianDianByDis(o*a-o/2,!0,t,e);n.push(h.M.getXianDuanGaoXianDian(r,t,s+2,a%2!=0))}n.unshift(new h.Point(2*t.x-n[0].x,2*t.y-n[0].y));var l=void 0,u=void 0,c=void 0;for(l=2;n.length-1>l;l++)l%2==0&&(u=n[l],c=n[l+1],this.addQuadBatchdata("hou",c,u));for(l=0;n.length-1>l;l++)l%2!=0&&(u=n[l],c=n[l+1],this.addQuadBatchdata("qian",c,u))}},{key:"fresh",value:function(t,e){this.startP=t,this.endP=e,this.freshSJ()}},{key:"addQuadBatchdata",value:function(t,e,i){var o=void 0;o="hou"==t?new PIXI.Sprite.fromImage("SpringSystem/hou"):new PIXI.Sprite.fromImage("SpringSystem/qian"),o.pivot.x=o.width/2,o.pivot.y=o.height/2,o.x=(e.x+i.x)/2,o.y=(e.y+i.y)/2;var n=h.M.getAngleP(i,e)-90;o.rotation=h.M.toHu(n),this.container.addChild(o)}},{key:"showGlowSP",value:function(t){if(t){this.showGlowIndex(this.isOpen?0:1)}else this.hideGlow()}}]),e}(PIXI.Container)},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function k(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:k(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(1075),p=o(d),y=i(449),f=o(y),g=i(1074),b=o(g),v=void 0,_=void 0,m=void 0,x=void 0,w=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return v=i.phy.nape,_=v.NbBody,m=v.geom.Vec2,x=v.shape.Polygon,w=v.phys.Compound,i.compo=new w,i.biaoBody=null,i.springJoint=null,i.biaoOriY=0,i.frequency=16.075,i.springHock=null,i.headPj=null,i.unitKey=[1/200.25,5/200.25,10/200.25,20/200.25],i.handDraging=!1,i.valueTxt=null,i.valueTypeIndex=0,i.movedistance=0,i.dirLeftStr=i.language.getLocaleStr("horizontal_to_left"),i.dirRightStr=i.language.getLocaleStr("horizontal_to_right"),i.dirTopStr=i.language.getLocaleStr("vertical_to_top"),i.dirBottomStr=i.language.getLocaleStr("vertical_to_bottom"),i.dirAnyStr=i.language.getLocaleStr("none"),i.dirArr=[i.dirAnyStr,i.dirLeftStr,i.dirRightStr,i.dirTopStr,i.dirBottomStr],i.lockDir=i.dirAnyStr,i.isLock=!1,i.showGlass=!1,i.showudbtn=!1,i.kindex=1,i.fAry=[11.755,26.2369,37.105,52.47455],i.rangeArr=[1,5,10,20],i.rangeArrStr=["1N","5N","10N","20N"],i.force=0,i.line=new PIXI.Graphics,i.maxLine=-1e5,i.openLine=!1,i.speed=0,i.tl=5-l.M.getNumJie(10*Math.random(),3),i.lineJoint=null,i.dropLock=!0,i.headgou=null,i.tltouch=null,i.bgtouchid=null,i.tiaoMask=null,i.txtColor=0,i.nosetbodyxy=!0,i.photoxy=null,i.hideTime=null,i.stopTween=null,i.btnGroupId1=null,i.btnGroupId2=null,i.btnDownFlag=!1,i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;this._width=78,this._height=350,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.handJointFrequency=50,this.body.userData.cannotToolRot=!0,this.body.set_mass(.3),this.compo.set_space(this.body.get_space()),this.body.set_compound(this.compo),this.bg.addChild(this.line),this.body.userData.moveCompo=!0,this.line.y=-72,this.resetUserView(this.bg,this,!0),this.body.sensorEnabled(!0),this.bg.selectTarget=this,this.bg.translateMove=function(e,i){t.translateMove(e,i)},this.initBiao(),this.initSpringHock(),this.valueTxt=new PIXI.Text("0N",{font:"30px Arial",fill:this.txtColor,align:"center"}),this.valueTxtBox=new PIXI.Container,this.valueTxtBox.addChild(this.valueTxt),this.bg.addChild(this.valueTxtBox),this.valueTxtBox.y=-195,this.valueTxt.y=-this.valueTxt.height,this.valueTxt.visible=this.globalConfig.SHOWEQUVALUE;var i=this.getWorldBody(),o=m.get(this.body.posx,this.body.posy-110);this.headPj=this.JointUtil.createPivotJoint(this.body,i,o,o),this.headPj.frequency=1e9,this.headPj.set_compound(this.compo),this.body.set_allowRotation(!1),this.setRange({showValue:"5N"}),this.initTiaoling(),this.initListener(),this.addCursor(this.tiaoMask,"hand"),this.freshTxtColor()}},{key:"added",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this);var t=new PIXI.Graphics;t.beginFill(16711680,.3),t.drawCircle(0,0,150),this.bubble.addChild(t),this.bubble.big.mask=t,t.x=this.bubble.bb.x-5,this.bubble.interactiveChildren=!1,this.bubble.interactive=!1,this.bubble.visible=!1,this.btnGroup.visible=!1}},{key:"backgroundColorChange",value:function(t){this.txtColor=t,this.valueTxt&&(this.valueTxt.style.fill=t,this.valueTxt.updateText())}},{key:"setComponent",value:function(){this.iscomponent=0>=arguments.length||arguments[0]===undefined||arguments[0],this.noRenderSelected=!0}},{key:"translateMove",value:function(t,e){this.compo.translate(m.get(t,e)),this.refreshHeadPJ()}},{key:"refreshHeadPJ",value:function(){this.headPj.anchor2=this.body.localPointToWorld(m.get(0,-110))}},{key:"initTiaoling",value:function(){this.tiaoMask=new PIXI.Graphics,this.tiaoMask.beginFill(0),this.tiaoMask.drawRect(0,0,35,25),this.tiaoMask.endFill(),this.tiaoMask.x=-18,this.tiaoMask.y=-156,this.bg.addChild(this.tiaoMask),this.bg.tiao.mask=this.tiaoMask,this.bg.tiao.y+=this.tl,this.biao.getChildAt(0).y+=this.tl,this.tltouch=l.M.addTouch(this.tiaoMask,{end:this.revertTiaoLing},this)}},{key:"revertTiaoLing",value:function(t){this.bg.tiao.y-=this.tl,this.biao.getChildAt(0).y-=this.tl,this.tl=0,l.M.removeTouch(this.tiaoMask,this.tltouch),this.removedCursor(this.tiaoMask,"hand")}},{key:"initListener",value:function(){var t=this;this.bgtouchid=l.M.addTouch(this.bg,{tab:function(e){t.speed=0}},this),this.bg.addEventListener(f["default"].BEGIN,function(e){t.headgou.isUseing||(t.headPj.active=!1,t.handDraging=!0,t.isLock||(t.body.set_allowRotation(t.springHock.isUseing?!0:!1),t.BodyUtil.frezzBody(t.body)))}),this.bg.addEventListener(f["default"].END,function(e){t.headgou.isUseing||(t.handDraging=!1,t.correctHeadPJ(),t.dropLock&&(t.headPj.active=!0))}),this.springHock.addEventListener(f["default"].BEGIN,function(e){t.springHock.isUseing||(t.handDraging=!0,t.body.set_allowRotation(!0),t.isLock=!1)}),this.springHock.addEventListener(f["default"].END,function(e){t.springHock.isUseing||t.headgou.isUseing||(t.lockDir=t.language.getLocaleStr("none"),t.body.set_allowRotation(!1),t.BodyUtil.frezzBody(t.body),t.handDraging=!1)}),this.btnGroupId1=l.M.addTouch(this.btnGroup.upBtn,{begin:function(e){t.speed=.3,t.stopTween=null,t.btnDownFlag=!0},end:function(e){t.stopTween=!0,e.stopPropagation(),e.stopImmediatePropagation(),t.btnDownFlag=!1}}),this.btnGroupId2=l.M.addTouch(this.btnGroup.downBtn,{begin:function(e){t.speed=-.3,t.stopTween=null,t.btnDownFlag=!0},end:function(e){t.stopTween=!0,e.stopPropagation(),e.stopImmediatePropagation(),t.btnDownFlag=!1}})}},{key:"initSpringHock",value:function(){var t=this;this.springHock=new p["default"](this.paramObj,30,30),this.springHock.init(),this.springHock.bindParent=this,this.springHock.body.set_position(m.get(this.body.get_position().get_x(),this.gou.y+this.y)),this.addChildAt(this.springHock,0),this.springHock.body.userData.noSelectlayer=!0,this.springHock.addChild(this.gou),this.springHock.resetUserView(this.springHock,this),this.springHock.body.set_compound(this.compo),this.springHock.body.userData.nomoveTool=!0,this.gou.x=0,this.gou.y=0,this.gou.visible=!1,setTimeout(function(){t.hadDestory||(t.gou.visible=!0)},30);var e=this.biaoBody.get_position(),i=this.springHock.body.get_position(),o=l.M.vec2Length(i.sub(e));this.JointUtil.createDistanceJoint(this.springHock.body,this.biaoBody,i,e,o,o).set_compound(this.compo);var n=this.body.get_position(),s=i;this.JointUtil.createLineJoint(this.body,this.springHock.body,s,s,m.get(s.get_x(),s.get_y()-30).sub(n),0,240).set_compound(this.compo),this.headgou=new b["default"](this.paramObj),this.headgou.init(),this.headgou.body.set_position(n.sub(m.get(0,170))),this.headgou.bindParent=this,this.headgou.body.userData.noSelectlayer=!0,this.headgou.springhock=this.springHock,this.headgou.body.set_compound(this.compo),this.headgou.body.userData.nomoveTool=!0;var a=this.headgou.body.get_position();this.JointUtil.createWeldJoint(this.body,this.headgou.body,a,a).set_compound(this.compo)}},{key:"removeHockCbtype",value:function(){this.headgou.removeHockCbtype(),this.springHock.removeHockCbtype()}},{key:"initBiao",value:function(){var t=this.body.get_position();this.biaoOriY=this.bg.toLocal(new l.Point(this.biao.x,this.biao.y),this).y,this.biaoBody=new _,this.biaoBody.add(new x(x.box(this.biao.width,this.biao.height))),this.biaoBody.userData.noSelectlayer=!0,this.biaoBody.set_gravMass(0);var e=new PIXI.Container;this.addChild(e),e.x=this.biao.x,e.y=this.biao.y,this.biaoBody.userData.view=e;var i=t.add(m.get(0,this.biao.y));this.biaoBody.set_position(i),this.biaoBody.sensorEnabled(!0),this.biaoBody.userData.noDrag=!0,this.addBodyToSpace(this.biaoBody,this),this.biaoBody.set_allowRotation(!1),this.biaoBody.set_mass(.5),this.biaoBody.set_compound(this.compo),this.biaoBody.userData.nomoveTool=!0,this.springJoint=this.JointUtil.createDistanceJoint(this.biaoBody,this.body,i,i,0,0),this.springJoint.set_stiff(!1),this.springJoint.set_frequency(this.frequency),this.springJoint.set_damping(8),this.springJoint.set_compound(this.compo);var o=i.copy();this.lineJoint=this.JointUtil.createLineJoint(this.body,this.biaoBody,o,o,this.body.position.sub(o),0,210),this.lineJoint.set_compound(this.compo),e.addChild(this.biao),this.biao.x=0,this.biao.y=0}},{key:"update",value:function(){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.biaoBody.set_rotation(this.body.get_rotation()),this.springHock.body.set_rotation(this.body.get_rotation()),!this.btnDownFlag){var t=this.toLocal(new l.Point(80,-50),this.bg);this.btnGroup.x=t.x,this.btnGroup.y=t.y,this.btnGroup.rotation=this.bg.rotation}if(this.dropLock){var i=this.body.get_angularVel();.01>Math.abs(i)&&(i=0),this.body.set_angularVel(.2*i)}if(this.openLine){this.line.clear(),this.line.lineStyle(4,16711680);var o=this.line.toLocal(new l.Point(this.biao.x,this.biao.y),this.biao.parent);o.y>this.maxLine&&(this.maxLine=o.y),this.line.moveTo(0,0),this.line.lineTo(0,this.maxLine)}this.handDraging||this.headgou.isUseing||this.isLock||!this.dropLock||this.springHock.isUseing&&!this.body.get_allowRotation()&&this.body.set_allowRotation(!0),this.headgou.isUseing&&(this.headPj.active=!1,this.body.set_allowRotation(!0));var n=this.springHock.connectBody;if(0==this.speed&&n&&n.get_compound()&&(n.set_compound(null),n.set_space(this.space)),0!=this.speed&&this.systemPlayStatus()){if(this.stopTween&&(this.speed*=.9,1e-4>Math.abs(this.speed)&&(this.speed=0,this.stopTween=null)),n&&!n.get_compound()){this.checkInLiquid(n)&&n.set_compound(this.compo)}var s=l.Point.vec2ToPoint(this.body.get_position()),a=l.Point.vec2ToPoint(this.headgou.body.get_position()),r=Math.atan2(a.y-s.y,a.x-s.x),u=this.speed*Math.cos(r),c=this.speed*Math.sin(r),d=m.get(u,c);this.movedistance+=d.get_length(),this.compo.translate(d);this.headPj.anchor2=this.body.localPointToWorld(m.get(0,-110)),this.iscomponent&&this.dispatchEvent("springMove",this.movedistance)}if(this.springJoint){var p=this.bg.toLocal(new l.Point(this.biao.x,this.biao.y),this.biao.parent),y=p.y-this.biaoOriY+this.tl,f=this.unitKey[this.kindex]*y;if(this.updateValueTxt(f,50*f/.49),this.bubble.visible){this.bubble.rotation!==this.bg.rotation&&(this.bubble.rotation=this.bg.rotation);var g=this.toLocal({x:-45,y:0},this.bg);this.bubble.x=g.x,this.bubble.y=g.y,this.gotoBigValue(this.force)}}}},{key:"checkInLiquid",value:function(t){var e=t.arbiters,i=!1;return e.foreach(function(t){var e=t.get_body1(),o=t.get_body2();try{var n=e.userData.view,s=o.userData.view;n&&!isNaN(n.liquidArea)&&(i=!0),s&&!isNaN(s.liquidArea)&&(i=!0)}catch(a){}}),i}},{key:"updateValueTxt",value:function(t,e){if(1==this.valueTypeIndex){var i=l.M.getNumJie(t,2)-0;this.valueTxt.text=l.M.getNumJie(50*i/.49,2)+"g"}else this.valueTxt.text=l.M.getNumJie(t,2)+"N",this.force=l.M.getNumStr(this.valueTxt.text)-0,this.valueTxt.pivot.x=this.valueTxt.width>>1}},{key:"getForceBydistance",value:function(t){return this.unitKey[this.kindex]*t}},{key:"getRange",value:function(){return this.rangeArr[this.kindex]}},{key:"setRange",value:function(t){this.kindex=this.rangeArr.indexOf(l.M.getNumStr(t.showValue))||0,this.springJoint.frequency=this.frequency=this.fAry[this.kindex],this.bg.gotoAndStop(this.kindex),this.bubble.big.gotoAndStop(this.kindex)}},{key:"valueTypeChange",value:function(t){this.valueTypeIndex=t.checked}},{key:"lockDirChange",value:function(t){if(!this.springHock.isUseing){var e=t.showValue;this.lockDir=e;var i=this.body.get_rotation();e==this.dirAnyStr?this.isLock=!1:e==this.dirLeftStr?(this.isLock=!0,this.compo.rotate(this.body.get_position(),Math.PI/2-i)):e==this.dirRightStr?(this.isLock=!0,this.compo.rotate(this.body.get_position(),-Math.PI/2-i)):e==this.dirTopStr?(this.isLock=!0,this.compo.rotate(this.body.get_position(),Math.PI-i)):e==this.dirBottomStr&&(this.isLock=!0,this.compo.rotate(this.body.get_position(),-i)),e!=this.dirAnyStr&&(this.bg.rotation=this.body.get_rotation(),this.correctHeadPJ())}}},{key:"correctHeadPJ",value:function(){this.headPj.anchor2=this.body.localPointToWorld(m.get(0,-110))}},{key:"removed",value:function(){delete this.bg.selectTarget,this.compo.breakApart(),this.compo.set_space(null),this.springHock.bindParent=null,this.headgou.bindParent=null,this.headgou.springhock=null,l.M.removeTouch(this.btnGroup.upBtn,this.btnGroupId1),l.M.removeTouch(this.btnGroup.downBtn,this.btnGroupId2),l.M.removeTouch(this.tiaoMask,this.tltouch),l.M.removeTouch(this.bg,this.bgtouchid),this.bg.removeAllListeners(),delete this.bg.translateMove,this.headgou.removed(),this.springHock.removed(),this.BodyUtil.destoryBody(this.biaoBody),this.springHock.destroy(),this.headgou.destroy(),this.headgou=null,this.springHock=null,this.headPj=null,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"closeLineTrack",value:function(t){(this.openLine=t.checked)||(this.clearLineTrack(),this.maxLine=-1e7)}},{key:"clearLineTrack",value:function(){this.line.clear()}},{key:"setSpeed",value:function(t){this.movedistance=0;var e=this.speed;this.speed=l.M.getNumStr(t.showValue)-0,e!==this.speed&&0===this.speed?(this.stopTween=!0,this.speed=e):this.stopTween=null}},{key:"changeDropLock",value:function(t){this.dropLock=t.checked,this.dropLock?(this.headPj.active=!0,this.body.sensorEnabled(!0),this.correctHeadPJ()):(this.headPj.active=!1,this.body.sensorEnabled(!1))}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);t.tl=this.tl,t.lockDir=this.dirArr.indexOf(this.lockDir),t.range=this.getRange(),t.trackLine=this.openLine,t.droplock=this.dropLock,t.valuetype=this.valueTypeIndex,t.springhock=this.springHock.getData();var i=this.biaoBody.get_position();return t.biao={x:i.get_x(),y:i.get_y()},t}},{key:"setData",value:function(t){var i=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t);var o=this.body.get_position();this.translateMove(t.posx-o.get_x(),t.posy-o.get_y());try{if(0===t.tl&&this.revertTiaoLing(),isNaN(t.lockDir)){this.lockDirChange({showValue:this.dirArr[{"无":0,"水平向左":1,"水平向右":2,"竖直向上":3,"竖直向下":4}[t.lockDir]]})}else this.lockDirChange({showValue:this.dirArr[t.lockDir]});this.setRange({showValue:t.range}),this.changeDropLock({checked:t.droplock}),this.valueTypeChange({checked:t.valuetype}),this.springHock.setData(t.springhock),t.biao&&this.biaoBody.set_position(m.weak(t.biao.x,t.biao.y)),setTimeout(function(){i.hadDestory||i.closeLineTrack({checked:t.trackLine})},2e3)}catch(n){}}},{key:"freshEquipShows",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"freshEquipShows",this).call(this,t),this.valueTxt.visible=t}},{key:"gotoBigValue",value:function(t){this.bubble.big.y=600/[1,5,10,20][this.kindex]*-t-1}},{key:"glassChange",value:function(t){this.speed>0||(this.showGlass=t.checked,this.showGlass?(this.bubble.visible=!0,this.gotoBigValue(this.force)):this.bubble.visible=!1)}},{key:"showudbtnChange",value:function(t){this.showudbtn=t.checked,this.btnGroup.visible=this.showudbtn}},{key:"getConf",value:function(){var t=this,e={};e.confArr=[],this.springHock.isUseing||e.confArr.push(this.ComponentProperty.getDropMenu(this.language.getLocaleStr("lock_direction"),!1,"",this.lockDir,this.dirArr,this,this.lockDirChange,1,0));var i=[this.language.getLocaleStr("force"),this.language.getLocaleStr("mass")];return e.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("move_speed"),!0,"",4,-4,0,.1,this.setSpeed,this),this.ComponentProperty.getDropMenu(this.language.getLocaleStr("range"),!1,"N",this.getRange()+"N",this.rangeArrStr,this,this.setRange,1,0),this.ComponentProperty.getSwitch(this.language.getLocaleStr("open_track"),this.openLine,this.closeLineTrack,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("lock"),this.dropLock,this.changeDropLock,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("magnifier"),this.showGlass,this.glassChange,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("updownBtn"),this.showudbtn,this.showudbtnChange,this),this.ComponentProperty.getRadio(this.language.getLocaleStr("show_type"),this.valueTypeIndex,i,function(e){t.valueTypeChange(e)})),e}},{key:"selectRenderChild",value:function(){return this.updateTransform(),this.bg.getBounds()}},{key:"freshTxtSize",value:function(){this.valueTxtBox.scale.x=1/this.main.view.scale.x*this.getTextZoomScale(),this.valueTxtBox.scale.y=this.valueTxtBox.scale.x}},{key:"viewZoomComplete",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"viewZoomComplete",this).call(this),this.freshTxtSize()}},{key:"showGlowSP",value:function(t){if(t){this.showGlowIndex(this.springHock.hock.get_userData().useing?1:0)}else this.hideGlow()}},{key:"getTipMess",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.language.getLocaleStr("range")+": "+this.getRange()+"N\n    "}},{key:"textValue",get:function(){return l.M.getNumStr(this.valueTxt.text)}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function C(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:C(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(572),p=o(d),y=i(1079),f=o(y),g=i(1078),b=o(g),v=i(515),_=o(v),m=i(449),x=o(m),w=void 0,k=void 0,P=void 0,O=void 0,T=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));w=i.phy.nape,k=w.phys.BodyType,P=w.shape.Polygon,O=w.geom.Vec2,T=w.phys.Compound,i.ballBody=null,i.top_y=11,i.ballStart=!1,i.time=null,i.jo=null,i.jL=null,i.wave=null,i.shadowStep=null,i.shadow=null,i.damping=0,i.var_k=.5,i.ballR=23.5,i.c=.135,i.sview=null,i.dragRect=new PIXI.Graphics,i.lineGra=new PIXI.Graphics,i.pointGra=new PIXI.Graphics,i.rotateViewCon=new PIXI.Graphics;var o=new PIXI.Text("O",{font:"20px Arial",fill:16777215});i.pointGra.addChild(o),i.pointGra.tfPo=o;var a=new PIXI.Text("B",{font:"20px Arial",fill:16711680});i.pointGra.addChild(a),i.pointGra.tfPb=a;var r=new PIXI.Text("A",{font:"20px Arial",fill:65280});return i.pointGra.addChild(r),i.pointGra.tfPa=r,i.stFlag=!0,i.vtFlag=!1,i.atFlag=!1,i.ftFlag=!1,i.horizonFlag=!1,i.compound=new T,i.rot=0,i.minLen=40,i.freeLen=220,i.maxLenH=400,i.maxLenV=500,i.ballOp=new PIXI.Point(0,0),i.tScale=1.481,i.autoGrid=!0,i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.horizonArr=[this.language.getLocaleStr("par_horizontal"),this.language.getLocaleStr("par_vertical")],this.bg.wallBottom.y=500,this.body.set_type(k.get_KINEMATIC()),this.resetUserView(this.bg,this,!0),this.body.userData.dragtranslate=!0,this.bg.translateMove=function(e,i){t.compound.translate(O.weak(e,i))},this.wave=new f["default"](this.paramObj),this.bg.addChildAt(this.wave,0),this.wave.x=550,this.wave.y=0,this.wave.visible=!1,this.initButton(),this.ballBody=new p["default"](this.paramObj),this.ballBody.init(),this.ballBody.type=2,this.ballBody.body.noallowRotation=!0,this.wave.m=this.ballBody.body.mass=50,this.ballBody.resetUserView(this.ball,this),this.addBodyToSpace(this.ballBody.body),this.ballBody.body.get_shapes().at(0).set_sensorEnabled(!0),this.ballR=this.ballBody.weldPy(!0),this.sview=new _["default"](this.paramObj),this.sview.count=26,this.createDragShape(),this.createJoint(),this.initLinstener(),this.bg.removeChild(this.bg.grid),this.bg.removeChild(this.bg.photo),this.bg.removeChild(this.bg.tt),this.shadow=new b["default"](this.paramObj),this.shadow.visible=!1,this.bg.selectTarget=this.parent,this.compound.set_space(this.space),this.body.set_compound(this.compound),this.ballBody.body.set_compound(this.compound),this.jo.set_compound(this.compound),this.jL.set_compound(this.compound),this.horizonFlag?this.initHorizontal():this.initVertical(),this.addChildAt(this.ball,0),this.addChildAt(this.pointGra,0),this.addChildAt(this.lineGra,0),this.lineGra.rotation=-Math.PI/2,this.bg.addChildAt(this.rotateViewCon,0),this.rotateViewCon.addChild(this.bg.ding),this.rotateViewCon.addChild(this.dragRect),this.rotateViewCon.addChild(this.bg.wallTop),this.rotateViewCon.addChild(this.bg.wallBottom),this.rotateViewCon.addChild(this.shadow),this.rotateViewCon.addChild(this.sview),this.addCursor(this.bg.guijiBtn,"hand"),this.addCursor(this.bg.waveBtn,"hand"),this.addCursor(this.bg.stopBtn,"hand"),this.addCursor(this.ball,"shangxia"),this.waveCallBack=function(e){t.stFlag=t.wave.getWaveVisible(0),t.vtFlag=t.wave.getWaveVisible(1),t.atFlag=t.wave.getWaveVisible(2),t.ftFlag=t.wave.getWaveVisible(3),t.freshLibPan()},this.wave.addEventListener(f["default"].WAVE_VISIBLE_CHANGED,this.waveCallBack),this.p0=new l.Point,this.dp=new l.Point,this.dragMove=function(e){t.dp.x=t.body.posx-t.p0.x,t.dp.y=t.body.posy-t.p0.y,t.dp.length>10&&t.ballStart&&t.stopClick()},this.dragBegin=function(e){t.p0.x=t.body.posx,t.p0.y=t.body.posy},this.bg.addEventListener(x["default"].MOVE,this.dragMove),this.bg.addEventListener(x["default"].BEGIN,this.dragBegin),this.wave.showWave(0,this.stFlag),this.wave.showWave(1,this.vtFlag),this.wave.showWave(2,this.atFlag),this.wave.showWave(3,this.ftFlag)}},{key:"initHorizontal",value:function(){this.horizonFlag=!0,this.pointGra.visible=this.lineGra.visible=this.bg.wallBottom.visible=!0,this.bg.guijiBtn.x=this.bg.waveBtn.x=this.bg.stopBtn.x=-120,this.bg.stopBtn.y=-145,this.bg.waveBtn.y=-25,this.bg.guijiBtn.y=95,this.bg.ding.scale.y=1.4,this.bg.ding.y=-54,0===this.rot&&(this.compound.rotate(this.body.get_position(),-Math.PI/2),this.rot=-Math.PI/2),this.shadow.scale.x=-1,this.jL.set_jointMax(this.maxLenH),this.ballBody.body.set_rotation(this.rot),this.removedCursor(this.ball),this.addCursor(this.ball,"zuoyou"),this.updateBallBalanceP(),this.pointGra.clear(),this.pointGra.tfPo.visible=this.pointGra.tfPb.visible=this.pointGra.tfPa.visible=!1}},{key:"initVertical",value:function(){this.horizonFlag=!1,this.pointGra.visible=this.lineGra.visible=this.bg.wallBottom.visible=!1,this.bg.stopBtn.x=58,this.bg.waveBtn.x=-49,this.bg.guijiBtn.x=-157,this.bg.guijiBtn.y=this.bg.waveBtn.y=this.bg.stopBtn.y=-76,this.bg.ding.scale.y=1,this.bg.ding.y=-30,0!==this.rot&&(this.compound.rotate(this.body.get_position(),-this.rot),this.rot=0),this.shadow.scale.x=1,this.jL.set_jointMax(this.maxLenV),this.ballBody.body.set_rotation(this.rot),this.removedCursor(this.ball),this.addCursor(this.ball,"shangxia")}},{key:"initLinstener",value:function(){var t=this;this.ballCallBack=function(e){t.ballStartHandler(e)},this.ballBody.addEventListener(p["default"].BALL_START,this.ballCallBack)}},{key:"waveClick",value:function(){this.wave.visible=!this.wave.visible}},{key:"ballStartHandler",value:function(){this.ballStart=!0,this.shadowStep=0,this.shadow.clear(),this.wave.reset(),this.time=this.getCurrentTime(),this.jo.damping=this.damping,this.wave.setPeriod(this.tScale*Math.PI*2*Math.sqrt(this.ballBody.body.mass/this.jo.frequency)),this.wave.setPeriod(this.autoGrid?this.tScale*Math.PI*2*Math.sqrt(this.ballBody.body.mass/this.jo.frequency):100),this.updatePoint()}},{key:"initButton",value:function(){this.bg.guijiBtn.fontColor="#ffffff",this.bg.guijiBtn.text=this.language.getLocaleStr("track"),this.bg.waveBtn.fontColor="#ffffff",this.bg.waveBtn.text=this.language.getLocaleStr("image"),this.bg.stopBtn.fontColor="#ffffff",this.bg.stopBtn.text=this.language.getLocaleStr("stopIt"),this.bg.stopBtn.tab=this.stopClick,this.bg.stopBtn["this"]=this,this.bg.waveBtn["this"]=this,this.bg.waveBtn.tab=this.waveClick,this.bg.guijiBtn["this"]=this,this.bg.guijiBtn.tab=this.trackClick}},{key:"trackClick",value:function(){this.shadow.visible?(this.shadow.visible=!1,this.shadow.clear(),this.shadowStep=0):this.shadow.visible=!0}},{key:"updateBallBalanceP",value:function(){if(this.horizonFlag)this.ballOp.x=this.freeLen+this.top_y+this.ballR,this.ballOp.y=0;else{var t=this.getGravity(),e=this.ballBody.body.mass*t/this.jo.frequency;this.ballOp.x=0,this.ballOp.y=this.freeLen+.03*e+this.top_y+this.ballR}}},{key:"stopClick",value:function(){this.ballStart=!1,this.BodyUtil.frezzBody(this.ballBody.body),this.updateBallBalanceP();var t=O.get(this.ballOp.x,this.ballOp.y);this.ballBody.body.set_position(this.body.get_position().add(t)),this.ballBody.body.set_rotation(this.horizonFlag?-Math.PI/2:0),this.shadowStep=0,this.jo.damping=1,this.shadow.clear()}},{key:"createJoint",value:function(){var t=O.get(this.body.posx,this.body.posy+this.top_y);this.sview.rotation=0,this.ballBody.body.posx=this.body.posx,this.ballBody.body.posy=this.body.posy+this.top_y+this.freeLen+this.ballR;var e=O.get(this.ballBody.body.posx,this.ballBody.body.posy-this.ballR);this.jo=this.JointUtil.createSpringJoint(this.body,this.ballBody.body,t,e,this.freeLen),this.jo.damping=1,this.jo.frequency=this.var_k,this.sview.joint=this.jo,this.jo.userData.view=this.sview,this.jL=this.JointUtil.createLineJoint(this.body,this.ballBody.body,t,e,O.get(0,1),this.minLen,this.maxLenH)}},{key:"writeTime",value:function(){return this.getCurrentTime()-this.time}},{key:"update",value:function(){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),!this.moduleMain.napeEngine.play)return void(this.bg.rotation=0);if(this.jo.update(),this.rotateViewCon.rotation=this.bg.rotation,this.bg.rotation=0,this.ballStart){var t=this.writeTime(),i=void 0;if(this.horizonFlag)i=this.ballBody.body.posx-this.body.posx-this.freeLen-this.top_y-this.ballR,i=-i;else{i=this.ballBody.body.posy-this.body.posy-this.freeLen-this.top_y-this.ballR-.03*(this.ballBody.body.mass*this.getGravity()/this.jo.frequency)}this.wave.draw(t,i),this.shadow.visible&&(this.jo.frequency>.3&&.6>=this.jo.frequency?++this.shadowStep%2==0&&this.shadow.draw(this.ballBody):this.jo.frequency>.3?this.shadow.draw(this.ballBody):++this.shadowStep%3==0&&this.shadow.draw(this.ballBody))}this.lineGra.x=this.pointGra.x=this.bg.x,this.lineGra.y=this.pointGra.y=this.bg.y}},{key:"removed",value:function(){this.bg.removeEventListener(x["default"].MOVE,this.dragMove),this.dragMove=null,this.bg.removeEventListener(x["default"].BEGIN,this.dragBegin),this.dragBegin=null,this.removedCursor(this.bg.guijiBtn),this.removedCursor(this.bg.waveBtn),this.removedCursor(this.bg.stopBtn),this.removedCursor(this.ball),this.wave.removeEventListener(f["default"].WAVE_VISIBLE_CHANGED,this.waveCallBack),this.ballBody.removeEventListener(p["default"].BALL_START,this.ballCallBack),this.bg.selectTarget=null,this.ballBody.removed(),this.ball.removeAllListeners(),this.bg.stopBtn.tab=null,this.bg.stopBtn["this"]=null,this.bg.waveBtn["this"]=null,this.bg.waveBtn.tab=null,this.bg.guijiBtn["this"]=null,this.bg.guijiBtn.tab=null,this.sview.joint=null,this.jo.userData.view=null,this.sview.destroy(),this.sview=null,this.wave.disposeAll(),this.wave=null,this.shadow.destroy(),this.shadow=null,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this),this.ball.destroy(),this.ballBody.destroy()}},{key:"createDragShape",value:function(){this.body.get_shapes().clear();var t=new P(P.box(300,120));t.set_localCOM(O.get(0,-20)),t.set_sensorEnabled(!0),this.body.add(t),this.dragRect.clear(),this.dragRect.beginFill(0,0),this.dragRect.drawRect(-150,-80,300,120),this.dragRect.endFill(),this.lineGra.lineStyle(3,16777215,1),this.lineGra.moveTo(0,5),this.lineGra.lineTo(0,this.bg.wallBottom.y-5)}},{key:"updatePoint",value:function(){this.pointGra.tfPo.visible=this.pointGra.tfPb.visible=this.pointGra.tfPa.visible=!0;var t=new PIXI.Point(this.ballOp.x,this.ballOp.y),e=new PIXI.Point,i=new PIXI.Point;this.horizonFlag?e.x=this.ballBody.body.posx-this.body.posx:e.y=this.ballBody.body.posy-this.body.posy,i.x=2*t.x-e.x,i.y=2*t.y-e.y,this.pointGra.clear(),this.pointGra.lineStyle(3,16777215,1),this.pointGra.beginFill(16777215,1),this.pointGra.drawCircle(t.x,t.y,10),this.pointGra.endFill(),this.pointGra.beginFill(16711680,1),this.pointGra.drawCircle(e.x,e.y,10),this.pointGra.endFill(),this.pointGra.beginFill(65280,1),this.pointGra.drawCircle(i.x,i.y,10),this.pointGra.endFill(),this.pointGra.tfPo.x=t.x-8,this.pointGra.tfPo.y=t.y+20,this.pointGra.tfPb.x=e.x-8,this.pointGra.tfPb.y=e.y+20,this.pointGra.tfPa.x=i.x-8,this.pointGra.tfPa.y=i.y+20}},{key:"changeDam",value:function(t){this.damping=.1*(l.M.getNumStr(t.showValue)-0),this.ballStart&&(this.jo.damping=this.damping)}},{key:"changeMass",value:function(t){this.ballBody.body.mass=t.showValue,this.wave.m=this.ballBody.body.mass}},{key:"changeNM",value:function(t){this.var_k=(l.M.getNumStr(t.showValue)-0)/100,this.jo.frequency=this.var_k}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.k=100*this.var_k+"N/m",t.da=10*this.damping,t.horizonFlag=this.horizonFlag,t.showWave=this.wave.visible,t.showShadow=this.shadow.visible,t.stFlag=this.stFlag,t.vtFlag=this.vtFlag,t.atFlag=this.atFlag,t.ftFlag=this.ftFlag,t.autoGrid=this.autoGrid,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.k&&(this.changeNM({showValue:t.k}),this.changeDam({showValue:t.da})),"undefined"!=typeof t.stFlag&&(this.stFlag=t.stFlag,this.vtFlag=t.vtFlag,this.atFlag=t.atFlag,this.ftFlag=t.ftFlag,this.wave.showWave(0,this.stFlag),this.wave.showWave(1,this.vtFlag),this.wave.showWave(2,this.atFlag),this.wave.showWave(3,this.ftFlag)),this.wave.visible=t.showWave,this.shadow.visible=t.showShadow,this.wave.m=this.ballBody.body.mass,this.body.set_rotation(0),this.horizonFlag=t.horizonFlag,this.horizonFlag?this.initHorizontal():this.initVertical(),this.autoGrid=t.autoGrid||!1}},{key:"changeStWave",value:function(t){this.stFlag=t.checked,this.wave.showWave(0,this.stFlag)}},{key:"changeVtWave",value:function(t){this.vtFlag=t.checked,this.wave.showWave(1,this.vtFlag)}},{key:"changeAtWave",value:function(t){this.atFlag=t.checked,this.wave.showWave(2,this.atFlag)}},{key:"changeFtWave",value:function(t){this.ftFlag=t.checked,this.wave.showWave(3,this.ftFlag)}},{key:"changeDirection",value:function(t){this.stopClick(),this.horizonFlag=0===t.checked,this.horizonFlag?this.initHorizontal():this.initVertical()}},{key:"changeTscale",value:function(t){this.tScale=t.showValue,this.wave.setPeriod(this.tScale*Math.PI*2*Math.sqrt(this.ballBody.body.mass/this.jo.frequency))}},{key:"changeAutoGrid",value:function(t){this.autoGrid=t.checked}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getRadio(this.language.getLocaleStr("direction"),this.horizonFlag?0:1,this.horizonArr,this.changeDirection.bind(this)),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("elastic_coefficient"),!0,"N/m",200,10,100*this.var_k,1,this.changeNM,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("damping"),!0,"",1,0,10*this.damping,.1,this.changeDam,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("sm_ball_mass"),!0,"g",100,10,this.ballBody.body.mass,1,this.changeMass,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("pos_wave_form"),this.stFlag,this.changeStWave,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("speed_wave_form"),this.vtFlag,this.changeVtWave,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("acce_waveform"),this.atFlag,this.changeAtWave,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("sm_ballforce_waveform"),this.ftFlag,this.changeFtWave,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("auto_grid"),this.autoGrid,this.changeAutoGrid,this)),t}},{key:"selectRenderChild",value:function(){return this.bg.ding.getBounds()}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function f(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:f(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0,y=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.callbacks.CbType,p=c.geom.Vec2,y=c.shape.HockShapeBase,i.canRotate=!1,i.useDragSetCurElec=!0,i.points1=[{x:28.75,y:-13.5},{x:23.5,y:-17.75},{x:18,y:-21.5},{x:10.5,y:-25.75},{x:-1.5,y:-29},{x:-8.75,y:-29},{x:-16.25,y:-28},{x:-24.25,y:-26.25},{x:-32,y:-22},{x:-36.75,y:-15.5},{x:-39.75,y:-9.5},{x:-40.5,y:-2.75},{x:-38.25,y:6},{x:-32,y:14.5},{x:-25.75,y:19.75},{x:-9,y:26.5},{x:4.75,y:26.25},{x:26.25,y:22.5},{x:31.5,y:21},{x:35.5,y:18.75},{x:38.5,y:15.5},{x:39.25,y:10.75},{x:38.5,y:4},{x:36,y:-2}],i.points2=[{x:7,y:-35.5},{x:-.25,y:-35.5},{x:-7,y:-38.25},{x:-14.25,y:-36.5},{x:-23.5,y:-38},{x:-31.75,y:-35.25},{x:-46.25,y:-27},{x:-47.75,y:-21.25},{x:-51.5,y:-16.25},{x:-53.75,y:-8.5},{x:-54.75,y:-3},{x:-51.75,y:8.75},{x:-46.75,y:18.5},{x:-36.5,y:27.75},{x:-28,y:32.75},{x:-16,y:35.75},{x:-7.25,y:38.75},{x:2.25,y:38.25},{x:36.25,y:32.25},{x:42.5,y:30.75},{x:50.25,y:26.75},{x:54.5,y:19},{x:54.25,y:8.25},{x:50.5,y:.75},{x:44.25,y:-10},{x:34.25,y:-19},{x:17,y:-30.75}],i.points3=[{x:1.25,y:-46.5},{x:-11.75,y:-48.5},{x:-30.75,y:-48},{x:-42.25,y:-45.25},{x:-51.5,y:-38.25},{x:-58.5,y:-35.5},{x:-61.5,y:-27.25},{x:-69,y:-12.25},{x:-67.25,y:2.5},{x:-63.75,y:12},{x:-58.5,y:21},{x:-50,y:27.75},{x:-42.75,y:35},{x:-35.25,y:35.25},{x:-27.5,y:40},{x:-17.5,y:47},{x:-6.5,y:49},{x:3.25,y:48.25},{x:29,y:41.75},{x:40.25,y:40.5},{x:46.25,y:40.25},{x:55.75,y:38},{x:64.25,y:34.75},{x:69,y:24.5},{x:68.25,y:9.75},{x:64.5,y:.5},{x:59.5,y:-9},{x:52.5,y:-20.25},{x:42,y:-25.5},{x:32.25,y:-34},{x:22,y:-40.75},{x:12.75,y:-45.25}],i.points4=[{x:16,y:-33.75},{x:-4.5,y:-26.5},{x:-25.75,y:-13.5},{x:-43.25,y:-5.25},{x:-43.75,y:1.25},{x:-37.25,y:7},{x:-31,y:11},{x:-15.25,y:25},{x:-9.25,y:29.25},{x:.5,y:31.25},{x:20,y:33},{x:32,y:32.5},{x:40.25,y:28.5},{x:42,y:17.5},{x:41.5,y:6.75},{x:33.5,y:-4.5},{x:27.75,y:-14.75},{x:24.25,y:-26}],i.points5=[{x:23,y:-45.5},{x:12.5,y:-42.75},{x:5,y:-38.5},{x:-4.75,y:-35.75},{x:-15.75,y:-29.5},{x:-34.25,y:-17.75},{x:-59,y:-6.5},{x:-58.25,y:3.5},{x:-44.75,y:15.25},{x:-35.75,y:20.25},{x:-11.25,y:40.5},{x:2.5,y:40.75},{x:11.5,y:43},{x:27,y:43.75},{x:44.5,y:43.5},{x:50,y:40.25},{x:58.25,y:36.75},{x:59,y:11},{x:55.5,y:1.75},{x:40.5,y:-18.75},{x:35.5,y:-32.75}],i.points6=[{x:16.25,y:-52.75},{x:9,y:-48.75},{x:-7.75,y:-43.75},{x:-16.25,y:-39.25},{x:-41.5,y:-22.25},{x:-72.5,y:-8.25},{x:-73.75,y:2.75},{x:-31.75,y:35},{x:-11.75,y:51.75},{x:5.75,y:51.5},{x:14.5,y:56},{x:34.75,y:55},{x:54,y:54.75},{x:60.25,y:50.5},{x:71,y:47.75},{x:74,y:23.75},{x:70,y:5},{x:56.5,y:-11.5},{x:45.75,y:-29.75},{x:42,y:-43.75},{x:26.25,y:-56.75}],i.pArr=[i.points1,i.points2,i.points3,i.points4,i.points5,i.points6],i.defMass=[17,30,50,17,30,50],i.selectIndex=0,i.material=new c.phys.Material(.3,.5,.6,4,.001),i.tophock=null,i.bothock=null,i.maxDen=10,i.minDen=.5,i.firstAdd=!0,i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this);var t=new c.phys.Material(0,0,0,.001,0);this.tophock=new y(15,null,t),this.tophock.addCbtype(this.CbTypeStr.STONE_HOCK),this.bothock=new y(15,null,t),this.bothock.addCbtype(this.CbTypeStr.STONE_HOCK),this.body.add(this.tophock),this.body.add(this.bothock),this.tophock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.bothock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.tophock.createListener(this.CbTypeStr.STONE_HOCK,this.CbTypeStr.GALLOON_HOCK),this.bothock.createListener(this.CbTypeStr.STONE_HOCK,this.CbTypeStr.GALLOON_HOCK),this.changeSkin(this.selectIndex),this.addTweenQuan(this.tophock),this.addTweenQuan(this.bothock)}},{key:"changeSkin",value:function(t){this.body.shapes.clear(),this.BodyUtil.BodyFromArray(this.pArr[t],this.body),this.bg.gotoAndStop(t),this.line.gotoAndStop(t),this.line.visible=!1,this.body.add(this.tophock),this.body.add(this.bothock);var e=0;0===t?e=25:1===t?e=33:2===t?e=43:3===t?e=24:4===t?e=32:5===t&&(e=40),this.tophock.set_localCOM(p.get(0,-e)),this.bothock.set_localCOM(p.get(0,e)),this.changeMass({showValue:this.defMass[t]})}},{key:"update",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.line.visible=!(!this.tophock.get_userData().useing&&!this.bothock.get_userData().useing)}},{key:"change_type",value:function(t){this.selectIndex=t.showValue-1,this.changeSkin(this.selectIndex),this.showToolDatas()}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.type=this.selectIndex,t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.selectIndex=t.type,this.changeSkin(this.selectIndex)}},{key:"changeForceAnalysis",value:function(t){(this.openF_analysis=t.checked)||this.removeForceAnalysis()}},{key:"changeDensity",value:function(t){var e=h.M.getNumStr(t.showValue)-0;this.body.mass=this.area*e*.001,this.BodyUtil.setMaterial(this.material,"density",e),this.showToolDatas()}},{key:"changeMass",value:function(t){var e=h.M.getNumStr(t.showValue)-0;this.body.set_mass(e),this.BodyUtil.setMaterial(this.material,"density",1e3*e/this.area),this.firstAdd?this.firstAdd=!1:this.showToolDatas()}},{key:"removed",value:function(){this.tophock.dragToolClick(),this.bothock.dragToolClick(),this.tophock.dispose(),this.bothock.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"getMaxMass",value:function(){return h.M.getNumJie(this.maxDen*this.area*.001,1)}},{key:"getMinMass",value:function(){return h.M.getNumJie(this.minDen*this.area*.001,1)}},{key:"getConf",value:function(){var t={};t.confArr=[];var e=this;return t.confArr.push(this.getDropMenu([this.getLocaleStr("type","类型"),!1,"",this.selectIndex+1+"",["1","2","3","4","5","6"],this,this.change_type,1,0]),this.getScrollBar([this.getLocaleStr("density","密度"),!0,"g/cm³",this.maxDen,this.minDen,{get value(){return e.body?h.M.getNumJie(e.material.get_density(),1):null},set value(t){e.changeDensity({showValue:t})}},.1,this.changeDensity,this]),this.getScrollBar([this.getLocaleStr("mass","质量"),!0,"g",this.getMaxMass(),this.getMinMass(),{get value(){return e.body?h.M.getNumJie(e.body.get_mass(),1):null},set value(t){e.changeMass({showValue:t})}},.1,this.changeMass,this]),this.getSwitch([this.getLocaleStr("force_analysis","受力分析"),this.openF_analysis,this.changeForceAnalysis,this])),t}},{key:"getTipMess",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.getLocaleStr("mass","质量")+": "+h.M.getNumJie(this.body.get_mass(),1)+"g\n    "+this.getLocaleStr("density","密度")+": "+h.M.getNumJie(this.material.get_density(),1)+"g/cm³\n    "}},{key:"area",get:function(){return this.BodyUtil.getBodyArea(this.body)}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function g(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:g(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(446),l=function(t){return t&&t.__esModule?t:{"default":t}}(h),u=void 0,c=void 0,d=void 0,p=void 0,y=void 0,f=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return u=i.phy.nape,f=u.geom.Vec2,p=u.callbacks.InteractionListener,c=u.callbacks.CbEvent,d=u.callbacks.InteractionType,y=u.callbacks.CbType,i.inter1=null,i.inter2=null,i.water=null,i.levelrScal=.1,i.leverMask=new PIXI.Graphics,i.originMass=-1,i.fullMl=10,i.curtMl=0,i.onesMl=1,i.owner=null,i.cbtype=null,i.liquidDens=.7,i}return s(e,t),a(e,[{key:"init",value:function(){this.points=[{x:-95.66000000000001,y:-.32000000000000006},{x:-98.76,y:10.520000000000001},{x:-95.66000000000001,y:23.540000000000003},{x:-88.54,y:31.900000000000002},{x:-82.04,y:36.86000000000001},{x:-58.52000000000001,y:42.42},{x:37.160000000000004,y:42.42},{x:37.160000000000004,y:36.86000000000001},{x:51.080000000000005,y:31.900000000000002},{x:84.82000000000001,y:31.900000000000002},{x:84.82000000000001,y:23.540000000000003},{x:95.66000000000001,y:23.540000000000003},{x:95.66000000000001,y:-3.7200000000000006},{x:84.82000000000001,y:-3.7200000000000006},{x:76.48,y:-10.840000000000002},{x:57.900000000000006,y:-8.68},{x:51.080000000000005,y:-10.840000000000002},{x:37.160000000000004,y:-16.419999999999998},{x:22.6,y:-21.36},{x:16.1,y:-21.36},{x:16.1,y:-26.939999999999998},{x:5.58,y:-26.939999999999998},{x:5.58,y:-37.78},{x:-3.4000000000000004,y:-37.78},{x:-3.4000000000000004,y:-45.52},{x:-18.26,y:-45.52},{x:-18.26,y:-37.78},{x:-29.72,y:-37.78},{x:-29.72,y:-26.939999999999998},{x:-39.94,y:-26.939999999999998},{x:-39.94,y:-21.36},{x:-58.52000000000001,y:-21.36},{x:-74.3,y:-16.419999999999998},{x:-88.54,y:-10.840000000000002}],this.material.set_density(.7),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.noallowRotation=!0,this.body.bullet=!0,this.bg.pivot.y-=10,this.up.y-=15,this.down.y-=15,this.up.visible=this.down.visible=!1,this.bg.addChild(this.leverMask),this.leverMask.x=this.bg.lever.x,this.leverMask.y=this.bg.lever.y,this.leverMask.beginFill(0),this.leverMask.drawRect(.5*-this.bg.lever.width-5,0,this.bg.lever.width+20,-this.bg.lever.height),this.leverMask.endFill(),this.bg.lever.mask=this.leverMask,this.initListenerHitLiquid(),this.up["this"]=this,this.up.tab=this.upup,this.down["this"]=this,this.down.tab=this.downd,this.originMass=this.body.get_mass(),this.changeView(),this.addCursor(this.up,"hand"),this.addCursor(this.down,"hand")}},{key:"initListenerHitLiquid",value:function(){var t=this;this.cbtype=new y,this.addCbType(this.cbtype),this.inter1=new p(c.get_BEGIN(),d.get_FLUID(),this.cbtype,this.CbTypeStr.LIQUID_SHAPE,function(e){t.beginHit(e)}),this.addNapeListeners(this.inter1),this.inter2=new p(c.get_END(),d.get_FLUID(),this.cbtype,this.CbTypeStr.LIQUID_SHAPE,function(e){t.endHit(e)}),this.addNapeListeners(this.inter2)}},{key:"removed",value:function(){this.removedCursor(this.up),this.removedCursor(this.down),this.removeNapeListeners(this.inter1),this.removeNapeListeners(this.inter2),this.up.destroy(),this.down.destroy(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"endHit",value:function(t){this.owner&&(this.owner=null,this.up.visible=this.down.visible=!1)}},{key:"beginHit",value:function(t){if(this.owner=t.get_int2().get_body().userData.view){if(!this.owner.waterFlooding)return void(this.owner=null);this.up.visible=this.down.visible=!0}}},{key:"downd",value:function(t){if(this.owner){var e=this.fullMl-this.curtMl,i=e>this.onesMl?this.onesMl:e,o=this.owner.dropperInlet(i);this.liquidDens=o.density,this.curtMl+=o.ml,this.changeView()}}},{key:"upup",value:function(t){if(this.owner){var e=this.curtMl>this.onesMl?this.onesMl:this.curtMl;this.curtMl-=e,this.owner.waterFlooding(e),this.changeView()}}},{key:"changeView",value:function(t){this.leverMask.scale.y=this.curtMl/this.fullMl,this.body.mass=this.originMass+this.curtMl*this.liquidDens}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.curtMl=this.curtMl,t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.curtMl&&t.curtMl!==this.curtMl&&(this.curtMl=t.curtMl,this.changeView())}},{key:"update",value:function(){if(r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.owner&&this.up.visible){var t=this.owner.body,i=t.get_bounds(),o=f.weak(i.get_x()+i.get_width()+10,0),n=this.body.worldPointToLocal(o);this.up.x=n.get_x(),this.down.x=n.get_x()}}},{key:"changeForceAnalysis",value:function(t){(this.openF_analysis=t.checked)||this.removeForceAnalysis()}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.getSwitch([this.getLocaleStr("force_analysis","受力分析"),this.openF_analysis,this.changeForceAnalysis,this])),t}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function c(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:c(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(226),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i}return s(e,t),a(e,[{key:"added",value:function(){function t(t){this.paramObj.moduleMain.napeEngine.play&&this.func_playAndStop(!this.var_isPlay)}r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.componentBox.visible=!1,this.removeChild(this.componentBox),this.func_playAndStop(!1),this.touchid=h.M.addTouch(this,{tab:t},this);var i=new PIXI.Graphics;i.beginFill(255),i.drawRect(-100,-150,200,300),i.endFill(),i.alpha=0,this.addChild(i),this.addCursor(this,"hand")}},{key:"func_playAndStop",value:function(t){this.var_isPlay=t;var e=this.bg.children.length,i=void 0;for(i=0;e>i;i++)this.bg.getChildAt(i).gotoAndStop&&(this.bg.getChildAt(i).animationSpeed=.5,t?this.bg.getChildAt(i).play():this.bg.getChildAt(i).gotoAndStop(0))}},{key:"removed",value:function(){this.removedCursor(this),h.M.removeTouch(this,this.touchid),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){!this.paramObj.moduleMain.napeEngine.play&&this.var_isPlay&&this.func_playAndStop(!1)}},{key:"selectRenderChild",value:function(){return this.bg.kx.getBounds()}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function c(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:c(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(226),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.cateid=5,i.var_lineSp=new PIXI.Sprite,i.caoMask=null,i.guanMask=null,i.xuying=null,i.canReset=!0,i.hadPut=!1,i.firstShow=!0,i.movetouchid=null,i.rottouchid=null,i.glasstouchid=null,i.curGuanScale=1,i.curPressureScale=1,i.topBreakFlag=!1,i.inCaoFlag=!1,i.pxmm=.67,i.SY_MAX_HEIGHT=1485,i.syHeight=i.SY_MAX_HEIGHT,i}return s(e,t),a(e,[{key:"added",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.tdyd.visible=!1,this.tdbd.visible=!1,this.componentBox.visible=!1,this.removeChild(this.componentBox),this.lineSp=new PIXI.Graphics,this.addChild(this.lineSp),this.lineSp.x=-250,this.lineSp.y=-20,this.caoMask=new PIXI.Graphics,this.lineSp.addChild(this.caoMask),this.lineSp.tf=new PIXI.Text("76cm",{font:"24px Arial",fill:16750848,align:"left"}),this.lineSp.addChild(this.lineSp.tf),this.lineSp.visible=!1,this.lineSp.interactive=!1,this.lineSp.interactiveChildren=!1,this.xuying.visible=!1,this.xuying.alpha=.3,this.xuying.interactive=!1,this.xuying.interactiveChildren=!1,this.guanMask=new PIXI.Graphics,this.guan.addChildAt(this.guanMask,0),this.guanMask.rotation=-this.guan.rotation,this.guan.sy.mask=this.guanMask,this.guanMask.visible=!0,this.guan.upDownBtn.visible=!1,this.guanMask.interactive=!1,this.guanMask.interactiveChildren=!1,this.guan.glass.gotoAndStop(0),this.xuying.glass.gotoAndStop(0),this.updateSyMask(),this.initGuan(),this.addCursor(this.guan.moveBtn,"zuoyou"),this.addCursor(this.guan.rotBtn,"xuanzhuan"),this.addCursor(this.guan.upDownBtn,"shangxia")}},{key:"initGuan",value:function(){function t(t){u=this.getMouseXY(t),this.cannotSystemDrag=!0,this.guan.tdyd.visible&&(this.guan.tdyd.visible=!1,this.guan.tdxz.visible=!1)}function e(t){var e=this.getMouseXY(t);this.guan.x+=e.x-u.x,this.guan.y+=e.y-u.y,u=e}function i(t){this.cannotSystemDrag=!1;var e=new h.Point(this.bg.x,this.bg.y),i=new h.Point(this.guan.x,this.guan.y),o=45*Math.PI/180;if(h.M.getValidHu(this.guan.rotation)>Math.PI-o&&h.M.getValidHu(this.guan.rotation)<Math.PI+o&&200>h.Point.distance(e,i)){this.guan.x=this.bg.x,this.guan.y=d,this.guan.hand.visible=!1,this.guan.moveBtn.visible=!1,this.addChildAt(this.guan,2),this.lineSp.visible=!0,this.guan.sy.mask=this.caoMask,this.guanMask.visible=!1,this.guan.upDownBtn.visible=!0,c=!0,this.hadPut=!0,this.guan.rotation=Math.PI,this.xuying.visible=!0,this.xuying.sy.mask=this.caoMask,this.xuying.x=this.guan.x,this.xuying.y=this.guan.y,this.inCaoFlag=!0;if(this.setSyHeight(this.calculateSyHeight(),!0),this.freshLibPan(),this.firstShow){this.firstShow=!1,this.tdyd.visible=!0,this.tdbd.visible=!0;var n=this.guan.toLocal(new h.Point(this.tdyd.x,this.tdyd.y),this);this.guan.addChildAt(this.tdyd,2),this.tdyd.x=n.x,this.tdyd.y=n.y;var s=this.guan.toLocal(new h.Point(this.tdbd.x,this.tdbd.y),this);this.guan.addChildAt(this.tdbd,2),this.tdbd.x=s.x,this.tdbd.y=s.y,this.tdyd.rotation=Math.PI,this.tdbd.rotation=Math.PI}}this.guanMask.rotation=-this.guan.rotation,this.updateSyMask(),this.freshGlow()}function o(t){var e=this.getMouseXY(t);f=this.toGlobalView(new h.Point(this.guan.x,this.guan.y),this),p=this.guan.rotation+Math.PI,y=Math.atan2(e.y-f.y,e.x-f.x),this.cannotSystemDrag=!0,this.guan.tdyd.visible&&(this.guan.tdyd.visible=!1,this.guan.tdxz.visible=!1),this.tdyd.visible&&(this.tdyd.visible=!1,this.tdbd.visible=!1)}function n(t){var e=this.getMouseXY(t);this.guan.rotation=Math.atan2(e.y-f.y,e.x-f.x)-p+y;var i=160*Math.PI/180,o=200*Math.PI/180;h.M.getValidHu(this.guan.rotation)<i&&(this.guan.rotation=i),h.M.getValidHu(this.guan.rotation)>o&&(this.guan.rotation=o),this.guanMask.rotation=-this.guan.rotation,this.updateSyMask()}function s(t){this.cannotSystemDrag=!1}function a(t){if(c){if(u=this.getMouseXY(t),!(b=this.hitTestViewPoint(this.guan.glass,u)))return;g=u.clone(),this.cannotSystemDrag=!0,this.tdyd.visible&&(this.tdyd.visible=!1,this.tdbd.visible=!1)}}function r(t){if(c){if(!b)return;var e=this.getMouseXY(t);this.guan.y+=e.y-u.y,30>this.guan.y&&(this.guan.y=30),this.guan.y>90&&(this.guan.y=90),u.y>e.y&&h.Point.distance(e,g)>150&&(c=!1,b=!1,this.guan.moveBtn.visible=!0,this.guan.hand.visible=!0,this.addChild(this.guan),this.lineSp.visible=!1,this.xuying.visible=!1,this.guan.sy.mask=this.guanMask,this.guanMask.visible=!0,this.inCaoFlag=!1,this.guan.upDownBtn.visible=!1,this.updateSyMask(),this.freshLibPan(),this.cannotSystemDrag=!1),u=e,this.xuying.x=this.guan.x,this.xuying.y=this.guan.y,this.updateSyMask()}}function l(t){this.cannotSystemDrag=!1,this.freshGlow()}this.movetouchid=h.M.addTouch(this.guan.moveBtn,{begin:t,move:e,end:i},this);var u=void 0,c=!1,d=66;this.rottouchid=h.M.addTouch(this.guan.rotBtn,{begin:o,move:n,end:s},this);var p=void 0,y=void 0,f=void 0;this.glasstouchid=h.M.addTouch(this.guan.upDownBtn,{begin:a,move:r,end:l},this);var g=void 0,b=!1}},{key:"removed",value:function(){this.removedCursor(this.guan.moveBtn),this.removedCursor(this.guan.rotBtn),this.removedCursor(this.guan.upDownBtn),h.M.removeTouch(this.guan.moveBtn,this.movetouchid),h.M.removeTouch(this.guan.rotBtn,this.rottouchid),h.M.removeTouch(this.guan.upDownBtn,this.glasstouchid),this.guan.sy.mask=null,this.removeAllListeners(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"calculateSyHeight",value:function(){return this.topBreakFlag?0:this.mm2px(760*this.curPressureScale)}},{key:"setSyHeight",value:function(t,e){var i=this;if(e){var o=Math.abs(t-this.syHeight)/1e3;TweenLite.to(this,o,{syHeight:t,onUpdate:function(){i.updateSyMask()}})}else this.syHeight=t,this.updateSyMask()}},{key:"updateSyMask",value:function(){var t=this.syHeight;if(this.inCaoFlag){this.caoMask.clear(),this.caoMask.beginFill(16750848,1),this.caoMask.drawRect(-500,-t,1500,t),this.caoMask.endFill();var e=-this.guan.y+this.lineSp.y-this.guan.glass.height*Math.cos(this.guan.rotation);this.syHeight>e&&(t=e),this.lineSp.tf.x=5;var i=t;65>t&&(i=65),this.lineSp.tf.y=65-i,this.lineSp.tf.text=h.M.getNumJie(this.px2mm(t)/10,1)+"cm",this.lineSp.clear(),this.lineSp.lineStyle(2,16750848,1),this.lineSp.moveTo(-600,-t),this.lineSp.lineTo(1e3,-t),this.lineSp.moveTo(0,-t),this.lineSp.lineTo(0,65-i),this.lineSp.moveTo(0,100-i),this.lineSp.lineTo(0,0)}else{var o=Math.abs(t*Math.cos(this.guan.rotation));this.guanMask.clear(),this.guanMask.beginFill(0,1),this.guanMask.drawRect(-600,-o,1200,o),this.guanMask.endFill()}}},{key:"px2mm",value:function(t){return t*this.pxmm}},{key:"mm2px",value:function(t){return t/this.pxmm}},{key:"changeGuanScale",value:function(t){this.curGuanScale=t.showValue,this.xuying.scale.x=this.curGuanScale,this.guan.glass.scale.x=this.curGuanScale,this.guan.sy.scale.x=this.curGuanScale}},{key:"changePressureScale",value:function(t){if(this.curPressureScale=t.showValue,this.inCaoFlag&&!this.topBreakFlag){this.setSyHeight(this.calculateSyHeight(),!1)}}},{key:"breakTop",value:function(t){if(!this.topBreakFlag){this.topBreakFlag=!0,this.guan.glass.gotoAndStop(1),this.xuying.glass.gotoAndStop(1);this.setSyHeight(this.calculateSyHeight(),!0)}}},{key:"reset",value:function(t){this.topBreakFlag=!1,this.guan.glass.gotoAndStop(0),this.xuying.glass.gotoAndStop(0),this.setSyHeight(this.inCaoFlag?this.calculateSyHeight():this.SY_MAX_HEIGHT,!1)}},{key:"selectRenderChild",value:function(){return this.bg.getBounds()}},{key:"getConf",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);if(this.inCaoFlag){var i=this.language.getLocaleStr("bei");t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("tube_thickness"),!1,i,2,1,this.curGuanScale,.1,this.changeGuanScale,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("atmos"),!1,i,1.5,.8,this.curPressureScale,.01,this.changePressureScale,this),this.ComponentProperty.getButton(this.language.getLocaleStr("apical_opening"),this.language.getLocaleStr("opening"),this.breakTop,this))}return t}},{key:"hideTips",value:function(){this.tdyd.visible=!1,this.tdbd.visible=!1,this.tdbd.removeChildren(),this.tdyd.removeChildren(),this.guan.tdyd.visible=!1,this.guan.tdxz.visible=!1}},{key:"showGlowSP",value:function(t){if(t){this.showGlowIndex(this.guan.hand.visible?0:1)}else this.hideGlow()}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function d(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:d(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(226),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.wheel=null,i.wheelUp=null,i.rods=null,i.bg=null,i.lineGra=null,i.lineGra2=null,i.rope=null,i.lambda=500,i.A=110,i.phiT=0,i.targetPhiT=0,i.tweenTargetPhi=0,i.circlePintsArr=[],i.tfPool=[],i.tfArr=[],i.lableId=1,i.autoAdsorbFlag=!0,i.STEP=8,i.ROPE_LEN=1e3,i.MIN_A=20,i.MAX_A=110,i.MIN_LAMBDA=200,i.MAX_LANBDA=800,i.canReset=!0,i}return s(e,t),a(e,[{key:"added",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.wheelUp.interactive=this.wheelUp.interactiveChildren=!1,this.hideMc.visible=!1,this.bg=new PIXI.Graphics,this.addChildAt(this.bg,0),this.bg.lineStyle(1,0,0),this.bg.drawRect(-400,-250,1500,500),this.lineGra=new PIXI.Graphics,this.addChild(this.lineGra);for(var t=[],i=0;this.ROPE_LEN>=i;i++)t.push(new PIXI.Point(i,0));this.rope=new c(PIXI.Texture.fromFrame("TransverseWaveFormation/rope01.png"),t),this.addChild(this.rope),this.lineGra2=new PIXI.Graphics,this.addChild(this.lineGra2),this.addCursor(this.wheel,"xuanzhuan"),this.addCursor(this.rods.p,"hand"),this.wheelTouchId=h.M.addTouch(this.wheel,{begin:this.wheelTouchBegin,move:this.wheelTouchMove,end:this.wheelTouchEnd},this),this.rodTouchId=h.M.addTouch(this.rods.p,{begin:this.rodTouchBegin,move:this.rodTouchMove,end:this.rodTouchEnd},this),this.updateTf()}},{key:"wheelTouchBegin",value:function(t){this.cannotSystemDrag=!0;var e=this.getMouseXY(t);e=this.toLocal(e,this.getMain().view),this.wheelOriRot=Math.atan2(e.y-this.wheel.y,e.x-this.wheel.x)}},{key:"wheelTouchMove",value:function(t){var e=this.getMouseXY(t);e=this.toLocal(e,this.getMain().view);var i=Math.atan2(e.y-this.wheel.y,e.x-this.wheel.x),o=i-this.wheelOriRot;o%=2*Math.PI,o>Math.PI?o-=2*Math.PI:o<-Math.PI&&(o+=2*Math.PI),this.targetPhiT-=o,this.tweenTargetPhi=this.targetPhiT,this.wheelOriRot=i,this.update()}},{key:"wheelTouchEnd",value:function(t){if(this.cannotSystemDrag=!1,this.autoAdsorbFlag){var e=8*this.STEP/360,i=2*Math.PI/this.STEP,o=this.targetPhiT/i,n=Math.round(o);o!==n&&Math.abs(n-o)<e&&(this.targetPhiT=n*i,this.tweenTargetPhi=this.targetPhiT)}}},{key:"rodTouchBegin",value:function(t){this.cannotSystemDrag=!0}},{key:"rodTouchMove",value:function(t){var e=this.getMouseXY(t);e=this.toLocal(e,this.getMain().view);var i=new PIXI.Point(e.x-this.wheel.x,e.y-this.wheel.y),o=new PIXI.Point(this.rods.x-this.wheel.x,this.rods.y-this.wheel.y),n=Math.sqrt(o.x*o.x+o.y*o.y);o.x/=n,o.y/=n;var s=i.x*o.x+i.y*o.y;this.MIN_A>s&&(s=this.MIN_A),s>this.MAX_A&&(s=this.MAX_A),this.A=s,this.update()}},{key:"rodTouchEnd",value:function(t){this.cannotSystemDrag=!1}},{key:"removed",value:function(){this.removedCursor(this.wheel),this.removedCursor(this.rods.p),h.M.removeTouch(this.wheel,this.wheelTouchId),this.wheelTouchId=null,h.M.removeTouch(this.rods.p,this.rodTouchId),this.rodTouchId=null,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){if(this.phiT!==this.targetPhiT){this.updateWheel();var t=this.rope.points,e=2*Math.PI/this.lambda;if(this.targetPhiT>this.phiT)for(;this.targetPhiT>this.phiT+e;){this.phiT+=e;var i=this.getYi(this.phiT);t.unshift(new PIXI.Point(0,i)),t.pop()}else for(;this.phiT-e>this.targetPhiT;){this.phiT-=e;var o=this.getYi(this.phiT);t.unshift(new PIXI.Point(0,o)),t.pop()}for(var n=0;this.ROPE_LEN>n;n++)t[n].x=n;this.updateLine(),this.updateCircle()}}},{key:"updateWheel",value:function(){this.wheel.rotation=-this.phiT;var t=new PIXI.Point(this.A*Math.cos(-this.phiT),this.A*Math.sin(-this.phiT));this.rods.x=this.wheel.x+t.x,this.rods.y=this.wheel.y+t.y;var e=-this.rods.x,i=(e-64)/2;this.rods.rod2.width=i,this.rods.rod3.width=i,this.rods.rod3.x=i+64}},{key:"updateLine",value:function(){this.rope.refresh()}},{key:"updateCircle",value:function(){this.lineGra.clear();for(var t=this.rope.points,e=this.lambda/8,i=e,o=1;this.ROPE_LEN>=i;){this.drawCircle(this.lineGra,i,t[Math.round(i)].y,6,15381043,!0),this.drawCircle(this.lineGra,i,0,4,16711680,!1),i+=e,o++}}},{key:"updateTf",value:function(){var t=this;this.tfArr.forEach(function(e){t.tfPool.push(e),t.lineGra2.removeChild(e)}),this.tfArr.length=0;for(var e=this.lambda/8,i=e,o=1;this.ROPE_LEN>=i;){var n=this.getTf();this.lineGra2.addChild(n),this.tfArr.push(n),n.text=o+"",n.x=i-n.width/2,n.y=10,i+=e,o++}}},{key:"getTf",value:function(){var t=this.tfPool.pop();return t||(t=new PIXI.Text("",{font:"25px Arial",fill:16711680,align:"center"})),t}},{key:"getYi",value:function(t){return-this.A*Math.sin(t)}},{key:"drawCircle",value:function(t,e,i,o,n,s){s?(t.lineStyle(1,n,1),t.beginFill(n),t.drawCircle(e,i,o),t.endFill()):(t.lineStyle(1,n,1),t.drawCircle(e,i,o))}},{key:"getData",value:function(){return r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this)}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.updateTf()}},{key:"selectRenderChild",value:function(){return this.updateTransform(),this.bg.getBounds()}},{key:"changeLambda",value:function(t){this.lambda=t.showValue,this.updateTf()}},{key:"changeA",value:function(t){this.A=t.showValue,this.updateWheel()}},{key:"reset",value:function(){this.tweenTargetPhi=this.targetPhiT=this.phiT=0,this.A=110,this.lambda=300,this.rope.points.forEach(function(t){t.y=0}),this.circlePintsArr.forEach(function(t){t.x=0,t.y=0}),this.lableId=1,this.updateWheel(),this.updateLine(),this.updateCircle(),this.updateTf()}},{key:"preStep",value:function(t){var e=2*Math.PI/this.STEP;if(this.autoAdsorbFlag){var i=Math.ceil((this.tweenTargetPhi-1e-6)/e);i--,this.tweenTargetPhi=e*i}else this.tweenTargetPhi-=e;this.tweenTo(this.tweenTargetPhi)}},{key:"nextStep",value:function(t){var e=2*Math.PI/this.STEP;if(this.autoAdsorbFlag){var i=Math.floor((this.tweenTargetPhi+1e-6)/e);i++,this.tweenTargetPhi=e*i}else this.tweenTargetPhi+=e;this.tweenTo(this.tweenTargetPhi)}},{key:"tweenTo",value:function(t){TweenLite.to(this,.5,{targetPhiT:t})}},{key:"changeAutoAdsorb",value:function(t){this.autoAdsorbFlag=t.checked}},{key:"getConf",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this),i=this;return t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("wave_length"),!0,"cm",this.MAX_LANBDA,this.MIN_LAMBDA,this.lambda,10,this.changeLambda,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("amplitude"),!0,"cm",this.MAX_A,this.MIN_A,{get value(){return h.M.getNumJie(i.A,0)},set value(t){i.A=t}},1,this.changeA,this),this.ComponentProperty.getButton("",this.language.getLocaleStr("clockwise"),this.preStep,this),this.ComponentProperty.getButton("",this.language.getLocaleStr("anticlockwise"),this.nextStep,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("auto_adsorption"),this.autoAdsorbFlag,this.changeAutoAdsorb,this)),t}}]),e}(u["default"]);var c=function(t){function e(t,i){return o(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return s(e,t),a(e,[{key:"refresh",value:function(){var t=this.points;if(t.length>=1&&this._texture._uvs){var e=this.uvs,i=this.indices,o=this.colors,n=this._texture._uvs,s=new PIXI.Point(n.x0,n.y0),a=new PIXI.Point(n.x2-n.x0,n.y2-n.y0);e[0]=0+s.x,e[1]=0+s.y,e[2]=0+s.x,e[3]=1*a.y+s.y,o[0]=1,o[1]=1,i[0]=0,i[1]=1;for(var r=t.length,h=void 0,l=void 0,u=0,c=[],d=1;r>d;d++){var p=t[d-1],y=t[d],f=y.x-p.x,g=y.y-p.y,b=Math.sqrt(f*f+g*g);c[d-1]=b,u+=b}for(var v=0,_=1;r>_;_++){t[_],h=4*_;v+=c[_-1],l=v/u,e[h]=l*a.x+s.x,e[h+1]=0+s.y,e[h+2]=l*a.x+s.x,e[h+3]=1*a.y+s.y,h=2*_,o[h]=1,o[h+1]=1,h=2*_,i[h]=h,i[h+1]=h+1}this.dirty=!0}}}]),e}(PIXI.mesh.Rope)},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function w(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:w(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(572),p=o(d),y=i(677),f=o(y),g=i(1080),b=o(g),v=void 0,_=void 0,m=void 0,x=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return v=i.phy.nape,_=v.phys.BodyType,m=v.shape.Polygon,x=v.geom.Vec2,i.top_y=11,i.leftBody=null,i.rightBody=null,i.ball_r=23,i.disJoint1=null,i.disJoint2=null,i.bailong=null,i.ballStart=!1,i.angDraw=!1,i.anglineAry=[],i.time=null,i.massA=50,i.massB=50,i.wave=null,i.line=null,i.normalLine=null,i.angleBall1=null,i.angleBall2=null,i}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_type(_.get_KINEMATIC()),this.createDragShape(),this.resetUserView(this.bg,this,!0),this.bg.selectTarget=this.parent,this.bg.waveBtn.fontColor="#ffffff",this.bg.waveBtn.text=this.language.getLocaleStr("image"),this.bg.stopBtn.fontColor="#ffffff",this.bg.stopBtn.text=this.language.getLocaleStr("stopIt"),this.normalLine=new PIXI.Graphics,this.bg.addChildAt(this.normalLine,0),this.line=new PIXI.Graphics,this.bg.addChild(this.line),this.angleBall1=new f["default"],this.angleBall2=new f["default"],this.bg.addChild(this.angleBall1),this.bg.addChild(this.angleBall2),this.initBall(),this.updateJoint(),this.initBallListener(this.leftBody),this.initBallListener(this.rightBody),this.bg.waveBtn["this"]=this,this.bg.waveBtn.tab=this.waveClick,this.bg.stopBtn["this"]=this,this.bg.stopBtn.tab=this.stopBall,this.bg.removeChild(this.bg.tt),this.bg.removeChild(this.bg.grid),this.bg.removeChild(this.bg.photo),this.wave=new b["default"](this.paramObj),this.bg.addChildAt(this.wave,0),this.wave.x=500,this.wave.visible=!1,this.addCursor(this.bg.waveBtn,"hand"),this.addCursor(this.bg.stopBtn,"hand"),this.addCursor(this.leftball,"zuoyou"),this.addCursor(this.rightball,"zuoyou"),this.changeMassA({showValue:50}),this.changeMassB({showValue:50})}},{key:"removed",value:function(){this.removedCursor(this.bg.waveBtn),this.removedCursor(this.bg.stopBtn),this.removedCursor(this.leftball),this.removedCursor(this.rightball),this.bg.removeChildren(),this.bg.waveBtn.dispose(),this.bg.stopBtn.dispose(),this.leftBody.removed(),this.rightBody.removed(),this.leftball.removeAllListeners(),this.rightball.removeAllListeners(),this.wave.removed(),this.angleBall1.removeChildren(),this.angleBall2.removeChildren(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"initBallListener",value:function(t){var e=this;t.addEventListener(p["default"].BALL_DRAG_BEGIN,function(t){e.ballDragHandler(t)}),t.addEventListener(p["default"].BALL_START,function(t){e.ballStartHandler(t)})}},{key:"waveClick",value:function(){this.wave.visible=!this.wave.visible}},{key:"stopBall",value:function(){this.ballStart=!1,this.angDraw=!1,this.anglineAry=[],this.angleBall1.clear(),this.angleBall2.clear(),this.BodyUtil.frezzBody(this.leftBody.body),this.BodyUtil.frezzBody(this.rightBody.body),this.leftBody.body.posx=this.body.posx-this.ball_r,this.leftBody.body.posy=this.body.posy+this.bailong,this.rightBody.body.posx=this.body.posx+this.ball_r,this.rightBody.body.posy=this.body.posy+this.bailong}},{key:"ballDragHandler",value:function(t){this.angDraw=!0,this.anglineAry.push(t)}},{key:"ballStartHandler",value:function(){this.ballStart=!0,this.wave.reset(),this.anglineAry=[this.leftBody,this.rightBody],this.angleBall1.clear(),this.angleBall2.clear(),this.time=this.getCurrentTime(),this.disJoint1.stiff=!1,this.disJoint1.stiff=!1}},{key:"initBall",value:function(){this.leftBody=new p["default"](this.paramObj),this.leftBody.init(),this.leftBody.resetUserView(this.leftball,this);var t=this.x+this.leftball.x,e=this.y+this.leftball.y;this.leftBody.body.set_position(x.get(t,e)),this.leftBody.body.noallowRotation=!0,this.leftball.x=t,this.leftball.y=e,this.rightBody=new p["default"](this.paramObj),this.rightBody.init(),this.rightBody.resetUserView(this.rightball,this);var i=this.x+this.rightball.x,o=this.y+this.rightball.y;this.rightBody.body.set_position(x.get(i,o)),this.rightBody.body.noallowRotation=!0,this.rightball.x=i,this.rightball.y=o,this.bailong=this.leftBody.body.posy-this.body.posy,this.leftBody.body.mass=this.massA,this.rightBody.body.mass=this.massB}},{key:"updateJoint",value:function(){this.leftBody.body.rotation=0;var t=x.get(this.leftBody.body.posx,this.leftBody.weldPy().get_y()),e=x.get(this.body.posx-this.ball_r,this.body.posy+this.top_y),i=x.distance(t,e);this.disJoint1=this.JointUtil.createDistanceJoint(this.body,this.leftBody.body,e,t,i,i),this.disJoint1.ignore=!0,this.disJoint1.stiff=!0,this.disJoint1.damping=0,this.disJoint1.frequency=1e8,this.rightBody.body.rotation=0;var o=x.get(this.rightBody.body.posx,this.rightBody.weldPy().get_y()),n=x.get(this.body.posx+this.ball_r,this.body.posy+this.top_y),s=x.distance(o,n);this.disJoint2=this.JointUtil.createDistanceJoint(this.body,this.rightBody.body,n,o,s,s),this.disJoint2.ignore=!0,this.disJoint2.stiff=!0,this.disJoint2.damping=0,this.disJoint2.frequency=1e7,this.drawNormalLine()}},{key:"drawNormalLine",value:function(){this.normalLine.clear(),this.normalLine.lineStyle(3,16777215,.6);var t=this.bailong/10,e=void 0;for(e=0;t>e;e++)e%2==0&&(this.normalLine.moveTo(-this.ball_r,10*e+this.top_y),this.normalLine.lineTo(-this.ball_r,10*e+10+this.top_y),this.normalLine.moveTo(this.ball_r,10*e+this.top_y),this.normalLine.lineTo(this.ball_r,10*e+10+this.top_y))}},{key:"update",value:function(){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.angDraw){var t=void 0;for(t=0;this.anglineAry.length>t;t++){var i=void 0,o=void 0;this.anglineAry[t]==this.leftBody?(i=-this.ball_r,o=this.angleBall1):(i=this.ball_r,o=this.angleBall2);o.update(new l.Point(this.body.posx+i,this.body.posy+this.bailong),new l.Point(this.body.posx+i,this.body.posy+this.top_y),l.Point.vec2ToPoint(this.anglineAry[t].weldPy()),25,this.getMain().view)}}if(this.ballStart){var n=this.writeTime();this.wave.draw(0,n,this.leftBody.body.posx-this.body.posx+this.ball_r);this.wave.draw(1,n,this.rightBody.body.posx-this.body.posx-this.ball_r)}this.leftBody.body.rotation=-(.5*Math.PI-Math.atan2(this.leftBody.body.posy-this.body.posy+this.top_y,this.leftBody.body.posx-this.body.posx+this.ball_r)),this.rightBody.body.rotation=-(.5*Math.PI-Math.atan2(this.rightBody.body.posy-this.body.posy+this.top_y,this.rightBody.body.posx-this.body.posx-this.ball_r));var s=this.getMain();this.updateTransform();var a=this.line.toLocal(l.Point.vec2ToPoint(this.leftBody.weldPy()),s.view),r=this.line.toLocal(l.Point.vec2ToPoint(this.rightBody.weldPy()),s.view);this.line.clear(),this.line.lineStyle(3,12829635),this.line.moveTo(-this.ball_r,this.top_y),this.line.lineTo(a.x,a.y),this.line.moveTo(this.ball_r,this.top_y),this.line.lineTo(r.x,r.y)}},{key:"writeTime",value:function(){return this.getCurrentTime()-this.time}},{key:"createDragShape",value:function(){this.body.get_shapes().clear();var t=new m(m.box(300,220));t.set_localCOM(x.get(0,-80)),t.set_sensorEnabled(!0),this.body.add(t);var e=new PIXI.Graphics;e.beginFill(0,0),e.drawRect(-150,-110,300,220),e.endFill(),this.bg.addChildAt(e,0),e.y=-80}},{key:"changeMassA",value:function(t){var e=l.M.getNumStr(t.showValue);this.leftBody.body.mass=e-0,this.bg.aTxt.text="A "+this.language.getLocaleStr("ball_mass")+e+"g",this.stopBall()}},{key:"changeMassB",value:function(t){var e=l.M.getNumStr(t.showValue);this.rightBody.body.mass=e-0,this.bg.bTxt.text="B "+this.language.getLocaleStr("ball_mass")+e+"g",this.stopBall()}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.leftMass=this.leftBody.body.mass+"g",t.rightMass=this.rightBody.body.mass+"g",t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.changeMassA({showValue:t.leftMass}),this.changeMassB({showValue:t.rightMass})}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getDropMenu("A"+this.language.getLocaleStr("ball_mass"),!0,"g",this.leftBody.body.mass+"g",["10g","20g","50g","100g","200g"],this,this.changeMassA,1e3,10),this.ComponentProperty.getDropMenu("B"+this.language.getLocaleStr("ball_mass"),!0,"g",this.rightBody.body.mass+"g",["10g","20g","50g","100g","200g"],this,this.changeMassB,1e3,10)),t}},{key:"selectRenderChild",value:function(){return this.bg.ding.getBounds()}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function x(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:x(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(1100),p=o(d),y=i(1098),f=o(y),g=i(454),b=o(g),v=void 0,_=void 0,m=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return v=i.phy.nape,_=v.phys.BodyType,m=v.geom.Vec2,i.paper=null,i.powerOpen=!1,i.sound=null,i.vPaper=null,i.fxz=null,i.channel=null,i.var_startP=null,i.stt=null,i.readygo=!1,i.iscomponent=!1,i}return a(e,t),r(e,[{key:"init",value:function(){this.points=[{x:85,y:-59},{x:-25.95,y:18},{x:-33.95,y:-70},{x:-255.95,y:-70},{x:-255.95,y:53},{x:-174.95,y:54},{x:-19.95,y:64},{x:113,y:18},{x:266,y:15},{x:264,y:-73},{x:91,y:-73}],h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.removeChild(this.dian),this.body.set_type(_.get_KINEMATIC()),this.body.sensorEnabled(!0),this.paper=new p["default"](this.paramObj),this.paper.pa=this.zhi,this.parent.addChild(this.paper),this.parent.addChild(this.top),this.top.x=this.x+101,this.top.y=this.y-60,this.paper.thisRoot=this,this.paper.init(),this.paper.addChildAt(this.zhi,0),this.zhi.x=0,this.zhi.y=0,this.addBodyToSpace(this.paper.body),this.fxz=new f["default"](this.paramObj),this.parent.addChild(this.fxz),this.fxz.init(),this.addBodyToSpace(this.fxz.body),this.fxzImg.alpha=0,this.fxz.addChild(this.fxzImg),this.fxzImg.x=0,this.fxzImg.y=0,this.fxz.thisRoot=this,this.fxz.body.set_position(this.fxzpos),this.paper.body.set_position(this.fxzpos),this.btn.gotoAndStop(1),this.createJoint(),this.initListener(),this.setPaperDefPos(),this.addCursor(this.btn,"hand"),this.addCursor(this.paper,"shangxia")}},{key:"setPaperDefPos",value:function(){this.showPaper(this.body.get_position().get_y()-.5*this.zhi.height*.618)}},{key:"setComponent",value:function(){this.iscomponent=!0,this.noRenderSelected=!0,this.removedCursor(this.paper)}},{key:"initListener",value:function(){var t=this;this.btnId=l.M.addTouch(this.btn,{tab:this.powerClick},this),this.linkBreakFucn=function(e){t.neibuPaperJointBreak(e)},this.powerChange=function(e){t.neipaperControlPower(e)},this.paper.addEventListener(b["default"].NEI_BU_LINEJOINT_BREAK,this.linkBreakFucn),this.paper.addEventListener(b["default"].TICKER_POWER_CHANGE,this.powerChange)}},{key:"neipaperControlPower",value:function(t){event.data&&"close"===event.data.type&&this.powerClick()}},{key:"neibuPaperJointBreak",value:function(t){var e=this,i=l.Point.vec2ToPoint(this.paper.body.get_position());if(this.vPaper){var o=this.vPaper;this.vPaper=null,this.dispatchEvent(b["default"].NEI_BU_LINEJOINT_BREAK,{pos:m.get(i.x,i.y),dat:t}),this.iscomponent&&this.dispatchEvent(b["default"].SCALE_BIG_PAPER,o)}else this.addComp([{name:"VpaperTicker",p:new l.Point(0,0)}],function(o){var n=o[0];n.neibuPaperJointBreak({pos:m.get(i.x,i.y),dat:t}),n.allowSave=!0,e.iscomponent&&e.dispatchEvent(b["default"].SCALE_BIG_PAPER,n)})}},{key:"powerClick",value:function(){this.powerOpen?(this.powerOpen=!1,this.paper.working=!1,this.btn.gotoAndStop(1),this.freshVolume(),this.paper.canDrag=!0):(this.powerOpen=!0,this.btn.gotoAndStop(0),this.readygo=!0,this.freshVolume(),this.paper.canDrag=!1),this.freshGlow()}},{key:"freshVolume",value:function(){this.powerOpen&&1==this.globalConfig.VOLUME?this.sound||(this.sound=this.globalConfig.SoundTool.play(this.SoundStr.TICKER_TIME,!0)):this.sound&&(this.globalConfig.SoundTool.stopT(this.sound),this.sound=null)}},{key:"timerStartHandler",value:function(){this.readygo&&!this.paper.working&&(this.readygo=!1,this.paper.working=!0,this.paper.dadian()),this.paper.visible&&this.paper.working&&this.paper.addDot(this.fxzpos)}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.top.x=this.x+101,this.top.y=this.y-60,this.powerOpen&&this.timerStartHandler(null)}},{key:"removed",value:function(){this.removedCursor(this.btn),this.removedCursor(this.paper),l.M.removeTouch(this.btn,this.btnId),this.paper.removeEventListener(b["default"].NEI_BU_LINEJOINT_BREAK,this.linkBreakFucn),this.paper.removeEventListener(b["default"].TICKER_POWER_CHANGE,this.powerChange),this.paper.removed(),this.fxz.removed(),this.sound&&(this.globalConfig.SoundTool.stopT(this.sound),this.sound=null),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.paperVisible=this.paper.visible,t.nei_x=this.paper.body.posy,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),(this.paper.visible=t.paperVisible)&&this.showPaper(t.nei_x)}},{key:"showPaper",value:function(t){this.paper.show(t,this.fxzpos)}},{key:"createJoint",value:function(){this.paper.createJoint(this.fxzpos),this.JointUtil.createWeldJoint(this.body,this.fxz.body,this.fxzpos,this.fxzpos)}},{key:"showGlowSP",value:function(t){if(t){this.showGlowIndex(this.powerOpen?1:0)}else this.hideGlow()}},{key:"fxzpos",get:function(){return m.get(this.x+this.bg.x+225,this.y+this.bg.y-25)}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function w(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:w(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(1102),p=o(d),y=i(1101),f=o(y),g=i(449),b=o(g),v=void 0,_=void 0,m=void 0,x=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return v=i.phy.nape,_=v.phys.BodyType,m=v.geom.Vec2,x=v.phys.Compound,i.points=[{x:-341.95,y:-98},{x:-354.95,y:-123},{x:-354.95,y:-61},{x:-382.95,y:-61},{x:-382.95,y:57},{x:-359.95,y:151.95},{x:-332.95,y:177.95},{x:-332.95,y:24},{x:385,y:24},{x:385,y:-38},{x:-332.95,y:-38},{x:-332.95,y:-61}],i.compo=new x,i.top=null,i.bottom=null,i.weld=null,i.precision=0,i}return a(e,t),r(e,[{key:"removed",value:function(){this.removedCursor(this.body_top.lock),this.removedCursor(this.top.view),this.compo.breakApart(),this.compo.set_space(null),this.top.removed(),this.bottom.removed(),this.body_top.removeAllListeners(),this.top.tar=null,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_type(_.get_KINEMATIC()),this.body.set_position(m.weak(this.x+this.bg.x,this.y+this.bg.y)),this.body.mass=5,this.compo.set_space(this.body.get_space()),this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.initTop(),this.createJoint(),this.initListener(),this.top.precision(this.precision),this.addCursor(this.body_top.lock,"hand"),this.addCursor(this.top.view,"zuoyou")}},{key:"initTop",value:function(){this.top=new p["default"](this.paramObj),this.top.view=this.body_top,this.top.tar=this,this.top.init(),this.top.orgX=Math.abs(this.body_top.x),this.top.resetUserView(this.body_top,this.parent),this.BodyUtil.setBodyFilter(this.top.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.top.body.set_position(m.weak(this.x+this.body_top.x,this.y+this.body_top.y)),this.parent.addChild(this.body_top),this.addBodyToSpace(this.top.body),this.top.body.set_compound(this.compo),this.bottom=new f["default"](this.paramObj),this.bottom.init(),this.BodyUtil.setBodyFilter(this.bottom.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.bottom.body.set_position(m.weak(this.x+this.body_bottom.x,this.y+this.body_bottom.y)),this.bottom.resetUserView(this.body_bottom,this.parent),this.parent.addChildAt(this.body_bottom,0),this.addBodyToSpace(this.bottom.body),this.bottom.body.set_compound(this.compo)}},{key:"createJoint",value:function(){var t=this.top.body.position,e=m.get(t.get_x()+520,t.get_y()),i=e.sub(t);this.JointUtil.createLineJoint(this.top.body,this.body,t,e,i,0,l.M.vec2Length(i)).set_compound(this.compo),this.JointUtil.createWeldJoint(this.top.body,this.bottom.body,t,t).set_compound(this.compo),this.weld=this.JointUtil.createWeldJoint(this.body,this.top.body,t,t),this.weld.set_compound(this.compo)}},{key:"initListener",value:function(){var t=this;this.body_top.addEventListener(b["default"].BEGIN,function(e){t.top.islock||(t.weld.active=!1)}),this.body_top.addEventListener(b["default"].END,function(e){t.top.islock||(t.weld.active=!0,t.weld.anchor1.set(t.body.worldPointToLocal(t.top.body.position)))})}},{key:"getPrecision",value:function(){var t="0.1mm";return 0==this.precision?t="0.1mm":1==this.precision?t="0.05mm":2==this.precision&&(t="0.02mm"),t}},{key:"changePrecision",value:function(t){var e=t.showValue;"0.1mm"==e?this.precision=0:"0.05mm"==e?this.precision=1:"0.02mm"==e&&(this.precision=2),this.top.precision(this.precision)}},{key:"freshEquipShows",value:function(t){this.top.txt.visible=t}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.precision=this.getPrecision(),t.topX=this.top.body.posx,t.lock=this.top.islock,t}},{key:"setData",value:function(t){var i=this;if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.precision){this.changePrecision({showValue:t.precision});var o=this.top.body.get_position();o.set_x(t.topX),this.top.body.set_position(o),this.weld.active=!0,this.weld.anchor1.set(this.body.worldPointToLocal(o)),t.lock&&setTimeout(function(){i.hadDestory||(i.updateTransform(),i.top.lockClick(null))},300)}}},{key:"toRandomValue",value:function(){if(!this.top.islock){var t=400*Math.random();this.weld.set_anchor1(m.get(-225+t,0))}}},{key:"getConf",value:function(){var t=this,e={};e.confArr=[];var i=["0.1","0.05","0.02"];return e.confArr.push(this.ComponentProperty.getRadio(this.language.getLocaleStr("accuracy")+"(mm)",this.precision,i,function(e){t.precision=e.checked,t.top.precision(t.precision)})),e.confArr.push(this.ComponentProperty.getButton("","随机示数",this.toRandomValue,this)),e}},{key:"getTipMess",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.language.getLocaleStr("accuracy")+": "+this.getPrecision()+"\n    "}},{key:"backgroundColorChange",value:function(t){this.top&&this.top.backgroundColorChange(t)}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function k(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:k(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(449),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0,m=void 0,x=void 0,w=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,m=y.NbBody,f=y.phys.BodyType,g=y.callbacks.InteractionListener,b=y.geom.Vec2,v=y.shape.Polygon,_=y.callbacks.CbType,x=y.callbacks.CbEvent,w=y.callbacks.InteractionType,i.baiBody=null,i.chuiBody=null,i.leftBall=null,i.rightBall=null,i.origonP=null,i.leftweld=null,i.rightweld=null,i.baiCb=new _,i.chuiCb=new _,i.draw1=!1,i.draw2=!1,i.leftline=new PIXI.Graphics,i.rightline=new PIXI.Graphics,i.leftold=null,i.rightold=null,i.listener=null,i.chuiRotate=0,i.needReset=!1,i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;this.points=[{x:50.55,y:-308.5},{x:-63.45,y:-307.5},{x:-177.45,y:-306.5},{x:-191.8,y:-291.35},{x:-205.45,y:-275.5},{x:-205.45,y:9},{x:-205.45,y:293.5},{x:.55,y:289},{x:206.55,y:284.5},{x:205.55,y:188},{x:204.55,y:91.45},{x:157.55,y:91.95},{x:110.55,y:92.45},{x:80.55,y:-108}],this.origonP=[this.leftb.x,this.leftb.y,this.rightb.x,this.rightb.y],h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_type(f.get_KINEMATIC()),this.body.sensorEnabled(!0),this.resetUserView(this.bg,this,!0),this.BodyUtil.setBodyFilter(this.body,this.InteractionFilterManager.MEC_COMPONENT_FILTER),this.bg.addChild(this.leftline),this.bg.addChild(this.rightline),this.leftline.x=this.leftb.x,this.leftline.y=this.leftb.y,this.rightline.x=this.rightb.x,this.rightline.y=this.rightb.y,this.body.mass=5,this.bg.resetBtn.fontColor="#ffffff",this.bg.resetBtn.text=this.language.getLocaleStr("reset"),this.bg.resetBtn["this"]=this,this.bg.resetBtn.tab=this.resetAll,this.baiBody=new m,this.baiBody.add(new v(v.rect(12,0,12,420))),this.baiBody.userData.view=this.bai,this.addBodyToSpace(this.baiBody,this),this.baiBody.posx=this.x+this.bai.x,this.baiBody.posy=this.y+this.bai.y,this.baiBody.addCbType(this.baiCb),this.chuiBody=this.BodyUtil.BodyFromArray([{x:-59,y:351.95},{x:60,y:351.95},{x:60,y:298.95},{x:7,y:298.95},{x:7,y:-38},{x:-8,y:-38},{x:-8,y:298.95},{x:-59,y:298.95}]),this.chuiBody.userData.view=this.chui,this.chuiBody.userData.dragLevel=1,this.addBodyToSpace(this.chuiBody,this),this.chuiBody.posx=this.x+this.chui.x,this.chuiBody.posy=this.y+this.chui.y,this.chuiBody.addCbType(this.chuiCb),this.leftBall=this.createBall(this.leftb),this.rightBall=this.createBall(this.rightb),this.createJoint(),this.listener=new g(x.get_BEGIN(),w.get_COLLISION(),this.baiCb,this.chuiCb,function(e){t.listenCallBack(e)}),this.chui.addEventListener(p["default"].END,function(){t.leftweld.active&&(t.listener=new g(x.get_BEGIN(),w.get_COLLISION(),t.baiCb,t.chuiCb,function(e){t.listenCallBack(e)}),t.addNapeListeners(t.listener),t.chuiRotate=t.chuiBody.rotation)}),this.addCursor(this.bg.resetBtn,"hand"),this.addCursor(this.chui,"xuanzhuan")}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this);var t=this.getMain();if(this.draw1)if(0>this.leftBall.velocity.get_y())this.draw1=!1;else{var i=l.Point.vec2ToPoint(this.leftBall.position);i=this.leftline.toLocal(i,t.view),this.leftline.moveTo(this.leftold.x,this.leftold.y),this.leftline.lineTo(i.x,i.y),this.leftold=i}if(this.draw2)if(0>this.rightBall.velocity.get_y())this.draw2=!1;else{var o=l.Point.vec2ToPoint(this.rightBall.position);o=this.rightline.toLocal(o,t.view),this.rightline.moveTo(this.rightold.x,this.rightold.y),this.rightline.lineTo(o.x,o.y),this.rightold=o}}},{key:"listenCallBack",value:function(t){this.removeNapeListeners(this.listener),this.needReset||(this.needReset=!0,this.leftweld.active=!1,this.rightweld.active=!1,this.leftBall.velocity=b.get(500*this.chuiRotate,0),this.chuiBody.rotation=0,this.BodyUtil.frezzBody(this.chuiBody),this.leftline.lineStyle(3,16750848),this.rightline.lineStyle(3,16750848),this.leftold=new l.Point,this.rightold=new l.Point,this.draw1=!0,this.draw2=!0)}},{key:"createBall",value:function(t){var e=new m;return e.add(new y.shape.Circle(.5*t.width)),e.userData.view=t,e.userData.dragLevel=1,this.addBodyToSpace(e,this),e}},{key:"removed",value:function(){this.removedCursor(this.bg.resetBtn),this.removedCursor(this.chui),this.bg.resetBtn.dispose(),this.BodyUtil.destoryBody(this.baiBody),this.BodyUtil.destoryBody(this.chuiBody),this.BodyUtil.destoryBody(this.leftBall),this.BodyUtil.destoryBody(this.rightBall),this.removeNapeListeners(this.listener),this.chui.removeAllListeners(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"createJoint",value:function(){this.JointUtil.createWeldJoint(this.baiBody,this.body,this.baiBody.position,this.baiBody.position),this.JointUtil.createPivotJoint(this.chuiBody,this.body,this.chuiBody.position,this.chuiBody.position),this.JointUtil.createAngleJoint(this.chuiBody,this.body,-.7,2,1);var t=b.get(this.x+this.origonP[0],this.y+this.origonP[1]),e=b.get(this.x+this.origonP[2],this.y+this.origonP[3]);this.leftBall.posx=t.get_x(),this.leftBall.posy=t.get_y(),this.rightBall.posx=e.get_x(),this.rightBall.posy=e.get_y(),this.leftweld=this.JointUtil.createWeldJoint(this.leftBall,this.body,t,t),this.rightweld=this.JointUtil.createWeldJoint(this.rightBall,this.body,e,e)}},{key:"resetAll",value:function(){this.chuiBody.rotation=0,this.BodyUtil.frezzBody(this.chuiBody),this.BodyUtil.frezzBody(this.leftBall),this.BodyUtil.frezzBody(this.rightBall),this.leftweld.active=!0,this.rightweld.active=!0,this.leftline.clear(),this.rightline.clear(),this.draw1=!1,this.draw2=!1,this.needReset=!1}},{key:"getLocalBoundsElecs",value:function(){return[this.bg.skin]}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function g(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:g(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(667),u=o(l),c=i(454),d=o(c),p=void 0,y=void 0,f=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return p=i.phy.nape,y=p.phys.BodyType,f=p.shape.Polygon,i.skinName="VpaperTicker",i}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.total_scale.skinName=this.skinName,this.body.cbTypes.remove(this.CbTypeStr.H_PAPER_TICKER),this.body.rotation=.5*Math.PI}},{key:"hpaperDragEnd",value:function(){var t=this;if(!this.isUsed){this.body.arbiters.foreach(function(e){var i=t.BodyUtil.getBodyFromAbter(e),o=i[0].userData.view,n=i[1].userData.view,s=void 0;o&&"TickerCarbon"==o.classtype&&(s=o),n&&"TickerCarbon"==n.classtype&&(s=n),s&&(t.bindTicker=s.thisRoot,t.bindTicker.showPaper(t.body.posy),t.visible=!1,t.removeBodyFromSpace(t.body),t.allowSave=!1,s.thisRoot.vPaper=t,t.AA=function(e){t.bindTicker.removeEventListener(d["default"].NEI_BU_LINEJOINT_BREAK,t.AA),t.neibuPaperJointBreak(e)},t.bindTicker.addEventListener(d["default"].NEI_BU_LINEJOINT_BREAK,t.AA))})}}},{key:"neibuPaperJointBreak",value:function(t){var e=this;this.body.rotation=0,this.allowSave=!0;var i=t.pos;this.visible=!0,null==this.body.space&&(this.addBodyToSpace(this.body),this.body.set_type(y.get_KINEMATIC()),this.body.wake()),this.body.set_position(i),this.body.rotation=.5*Math.PI,this.bindTicker&&(this.bindTicker=null);var o=t.dat.arr;o.length>0&&(this.isUsed=!0,this.dotCon=new PIXI.Sprite,this.addChild(this.dotCon),this.showSmallDot(o),this.body.rotation=.5*Math.PI,this.paperBig.visible=!0,this.paperBig.alpha=0,this.paperBig.width=this.paperXiaoW,this.paperBig.height=this.paperXiao.height,TweenMax.to(this.body,.7,{rotation:Math.PI,onComplete:function(){e.paperXiao.visible=!1,e.paperBig.alpha=1,e.body.rotation=0,e.dotCon.removeChildren();e.showDot(o),e.dotCon.scale.x=e.paperBig.scale.x,e.dotCon.scale.x=e.paperBig.scale.y;var t=new f(f.box(e.paperBig.width/e.paperBig.scale.x,e.paperBig.height/e.paperBig.scale.y),e.material);t.set_sensorEnabled(!0),e.body.shapes.clear(),e.body.shapes.add(t),TweenMax.to(e.paperBig.scale,.5,{x:1,y:1,onUpdate:function(){e.hadDestory||(e.dotCon.scale.x=e.paperBig.scale.x,e.dotCon.scale.x=e.paperBig.scale.y)},onComplete:function(){e.hadDestory||e.showRuler()}})}}))}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function d(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:d(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=(i(1),i(610)),l=function(t){return t&&t.__esModule?t:{"default":t}}(h),u=void 0,c=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return u=i.phy.nape,c=u.shape.Polygon,i.k_areaToH=1,i.liquidW=235,i.halfW=i.liquidW/2,i.wallW=20,i.wallH=280,i.wallOfy=18,i.botH=10,i.boty=149,i.fullH=225,i.totalRange=50,i.valueTxtxy={x:140,y:-170},i.poshapexy={x:112,y:-171},i.barxy={x:150,y:0},i.pourxy={x:-148,y:-126},i.drawObj={interval:5,nobooksize:24,logoX:-130,lcsize:28,lcX:-120},i.selfmass=30,i.mlArr=["0mL","20mL","30mL","40mL","50mL"],i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.changeLiquidVolume({showValue:"40mL"})}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function f(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:f(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(226),c=o(u),d=i(494),p=o(d);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.canReset=!0,i.bg=null,i.baffleCon=new PIXI.Container,i.baffle01=null,i.baffle02=null,i.waterSource01=null,i.waterSource02=null,i.waterSource03=null,i.INTERFERENCE=0,i.DIFFRACTION=1,i.WATER_WIDTH=404,i.WATER_HEIGHT=358,i.WATER_SIZE=i.WATER_WIDTH*i.WATER_HEIGHT,i.WATER_DATA_LEN=4*i.WATER_SIZE,i.waterSp=null,i.water=null,i.waveSource01=null,i.waveSource02=null,i.waveSource03=null,i.weakLineGra=null,i.strengthLineGra=null,i.pxcm=2,i.slitHsca=199/189,i.slitH=0,i.t=0,i.lastT=0,i.t0=0,i.tSca=.05,i.pauseT=0,i.A=64,i.T=1,i.speed=15,i.slitLevel=25,i.sourceOffX=0,i.sourceSpace=100,i.lightGainCache=1,i.lightGain=1,i.showPrinciple=!1,i.isSamePhase=!0,i.isPause=!1,i.isPause2=!1,i.showBg=!0,i.updateLineFlag=!0,i.updateCacheDataFlag=!0,i.updateBaffleFlag=!0,i.showWeakLine=!1,i.showStrengthLine=!1,i.firstLoop=!0,i.type=i.INTERFERENCE,i.types=[i.language.getLocaleStr("interference"),i.language.getLocaleStr("diffraction")],i.curLightId=0,i.lightTypes=[i.language.getLocaleStr("red_light"),i.language.getLocaleStr("yellow_light"),i.language.getLocaleStr("green_light"),i.language.getLocaleStr("less_blue_light"),i.language.getLocaleStr("blue_light"),i.language.getLocaleStr("violet_light"),i.language.getLocaleStr("white_light")],i.lightColors=[16711680,16776960,65280,65535,255,16711935,16777215],i.lightX=200,i.lightY=180,i.lightOpen=!1,i.lightR=360,i.bgImgBase64=null,i.bitmapDataBaffle=[],i.bitmapDataLight=null,i.bitmapDataWater01=[],i.bitmapDataWater02=null,i.bitmapDataAmp01=[],i.bitmapDataAmp02=[],i.tn=0,i}return a(e,t),r(e,[{key:"added",value:function(){var t=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.surpportWebgl=this.main.renderer.type===PIXI.RENDERER_TYPE.WEBGL,this.surpportWebgl=!1,this.slitH=this.baffle01.height/this.slitHsca,this.removeChildAt(0);var i=this.getChildAt(0);i.alpha=0,this.baffleCon.addChild(i),this.baffleCon.addChild(this.baffle01),this.baffleCon.addChild(this.baffle02),this.waterSp=new p["default"](this.WATER_WIDTH,this.WATER_HEIGHT),this.waterSp.setFrame(this.main.renderer,"WaterWaveInterference/waterBottom.png",!1),this.lightSp=new p["default"](this.WATER_WIDTH,this.WATER_HEIGHT),this.bitmapDataLight=this.lightSp.context.getImageData(0,0,this.WATER_WIDTH,this.WATER_HEIGHT),this.filterCon=new PIXI.Sprite,this.filterCon.addChild(this.waterSp),this.filterCon.addChild(this.lightSp),this.waterSp.blendMode=PIXI.BLEND_MODES.SCREEN,this.lightSp.blendMode=PIXI.BLEND_MODES.SCREEN,this.water=new p["default"](this.WATER_WIDTH,this.WATER_HEIGHT),this.bitmapDataWater02=this.water.context.getImageData(0,0,this.WATER_WIDTH,this.WATER_HEIGHT),this.renderTexture=new PIXI.RenderTexture(this.main.renderer,this.WATER_WIDTH,this.WATER_HEIGHT),this.renderSp=new PIXI.Sprite(this.renderTexture),this.addChild(this.renderSp),this.renderSp.x=400,this.renderSp.y=400,this.waveSource01=new y(this.waterSource01,this.A,this.T,0,this.WATER_WIDTH,this.WATER_HEIGHT,this.speed),this.waveSource02=new y(this.waterSource02,this.A,this.T,0,this.WATER_WIDTH,this.WATER_HEIGHT,this.speed),this.waveSource03=new y(this.waterSource03,this.A,this.T,0,this.WATER_WIDTH,this.WATER_HEIGHT,this.speed),this.waveSource02.phiT0=this.isSamePhase?0:Math.PI,this.weakLineGra=new PIXI.Graphics,this.strengthLineGra=new PIXI.Graphics,this.addChildAt(this.strengthLineGra,0),this.addChildAt(this.weakLineGra,0),this.addChildAt(this.baffleCon,0),this.addChildAt(this.water,0),this.addChild(this.filterCon),this.filterCon.visible=!1,this.surpportWebgl&&(this.displacementFilter=new PIXI.filters.DisplacementFilter(this.water)),this.sourceSpace=Math.abs(Math.round(this.waterSource02.x-this.waterSource03.x)),this.initInterference(),this.updateLightSp(),this.updateBitmapDataWater01(),this.updateSlit(),setTimeout(function(){t.hadDestory||t.updateBitmapDataWater01()},100)}},{key:"removed",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){if(this.isPause?this.moduleMain.napeEngine.play&&this.changePause({checked:!1}):this.moduleMain.napeEngine.play||this.changePause({checked:!0}),!(this.isPause||this.isPause2)||this.firstLoop){this.tn++,this.updateBaffleFlag&&this.tn%5==1&&(this.updateBitmapDataBaffle(),this.updateBaffleFlag=!1),this.updateCacheDataFlag&&this.tn%5==1&&(this.waveSource01.updateCacheData(),this.waveSource02.updateCacheData(),this.waveSource03.updateCacheData(),this.updateCacheDataFlag=!1),this.firstLoop=!1;var t=(new Date).getTime(),e=t-this.t;this.t0+=t-this.lastT,this.lastT=t,this.waveSource01.updatePhi(e),this.waveSource02.updatePhi(e),this.waveSource03.updatePhi(e),this.waveSpread(),this.mapDistance(),this.water.context.putImageData(this.bitmapDataWater02,0,0),this.water.updateTexture(),this.updateLineFlag&&(this.updateLineFlag=!1,this.updateWeakAndStrenthLines())}}},{key:"updateWeakAndStrenthLines",value:function(){var t=(this.waterSource02.x+this.waterSource03.x)/2,e=(this.waterSource02.y+this.waterSource03.y)/2,i=this.speed*this.T,o=this.waterSource02.x-this.waterSource03.x,n=this.waterSource02.y-this.waterSource03.y,s=Math.sqrt(o*o+n*n),a=i/2,r=i/4;Math.round(s/i);this.strengthLineGra.clear();Math.round(s/a);this.weakLineGra.clear();var h=s/2,l=h*h,u=void 0,c=void 0,d=void 0,p=void 0,y=void 0;this.isSamePhase?(u=this.strengthLineGra,c=this.weakLineGra,d=0,p=0,y=!1):(u=this.weakLineGra,c=this.strengthLineGra,d=0,p=0,y=!0);for(var f=0,g=0;;){var b=Math.sqrt(l-f*f);if(!b&&0!==b)break;g%2==0?this.hyperbola(u,f,b,d,y,t,e):this.hyperbola(c,f,b,p,!y,t,e),f+=r,g++}}},{key:"waveSpread",value:function(){if(this.type===this.INTERFERENCE)for(var t=0;this.WATER_WIDTH>t;t++)for(var e=0;this.WATER_HEIGHT>e;e++){var i=this.waveSource02.getValue(t,e)+this.waveSource03.getValue(t,e);this.bitmapDataAmp01[t+e*this.WATER_WIDTH]=i}else{this.tSca=.75/this.speed;for(var o=1e3*this.T*this.tSca,n=0;this.t0>o;){if(++n>10){this.t0=this.t0%o;break}this.t0-=o,this.addHit(this.waveSource01);for(var s=this.bitmapDataAmp01,a=this.bitmapDataAmp02,r=1;this.WATER_WIDTH-1>r;r++)for(var h=1;this.WATER_HEIGHT-1>h;h++){var l=r+h*this.WATER_WIDTH;0===this.bitmapDataBaffle[l]?a[l]=0:(a[l]=.5*(s[l-1]+s[l+1]+s[l-this.WATER_WIDTH]+s[l+this.WATER_WIDTH])-a[l],a[l]-=.01*a[l])}this.bitmapDataAmp01=a,this.bitmapDataAmp02=s}}}},{key:"resetData",value:function(t,e){for(var i=0;e>i;i++)t[i]=0}},{key:"addHit",value:function(t){for(var e=Math.round(t.sp.x),i=Math.round(t.sp.y),o=e-5;e+5>=o;o++)for(var n=i-5;i+5>=n;n++){var s=o-e,a=n-i,r=Math.sqrt(s*s+a*a);if(5>=r){var h=o+n*this.WATER_WIDTH,l=t.getValue(o,n);this.bitmapDataAmp01[h]=l}}}},{key:"setData1",value:function(t,e,i){for(var o=0;this.WATER_WIDTH>o;o++)for(var n=0;this.WATER_HEIGHT>n;n++){var s=o+n*this.WATER_WIDTH,a=t[s]*i;s*=4,e[s]=a,e[s+1]=a,e[s+2]=a,e[s+3]=255}}},{key:"mapDistance",value:function(){var t=this.bitmapDataAmp01,e=this.bitmapDataWater01,i=this.bitmapDataWater02.data;if(this.showPrinciple)this.setData1(t,i,this.lightGain),this.water.visible=!0,this.filterCon.visible=!1,this.filterCon.filters=null;else{if(this.surpportWebgl)return this.setData1(t,i,this.lightGain),this.filterCon.visible=!0,this.water.visible=!1,void(this.filterCon.filters=[this.displacementFilter]);for(var o=1;this.WATER_WIDTH-1>o;o++)for(var n=1;this.WATER_HEIGHT-1>n;n++){var s=t[o-1+n*this.WATER_WIDTH]-t[o+1+n*this.WATER_WIDTH];s>>=0;var a=t[o+(n-1)*this.WATER_WIDTH]-t[o+(n+1)*this.WATER_WIDTH];a>>=0;var r=o+s,h=n+a;1>r&&(r=1),r>this.WATER_WIDTH-1&&(r=this.WATER_WIDTH-1),1>h&&(h=1),h>this.WATER_HEIGHT-1&&(h=this.WATER_HEIGHT-1);var l=4*(o+n*this.WATER_WIDTH),u=4*(r+h*this.WATER_WIDTH);i[l]=e[u],i[l+1]=e[u+1],i[l+2]=e[u+2],i[l+3]=e[u+3]}}}},{key:"updateBitmapDataBaffle",value:function(){var t=this.slitH,e=new PIXI.Rectangle(this.baffle01.x-15,this.baffle01.y,30,t),i=new PIXI.Rectangle(this.baffle02.x-15,this.baffle02.y-t,30,t);this.bitmapDataBaffle.length=0;for(var o=0;this.WATER_WIDTH>o;o++)for(var n=0;this.WATER_HEIGHT>n;n++){var s=o+n*this.WATER_WIDTH;this.bitmapDataBaffle[s]=e.contains(o,n)||i.contains(o,n)?0:1}}},{key:"updateLightSp",value:function(){for(var t=this.bitmapDataLight.data,e=this.lightColors[this.curLightId],i=this.lightOpen?16777215:0,o=e>>16&255,n=e>>8&255,s=255&e,a=i>>16&255,r=i>>8&255,h=255&i,l=this.lightX,u=this.lightY,c=this.lightR,d=0;this.WATER_WIDTH>d;d++)for(var p=0;this.WATER_HEIGHT>p;p++){var y=d+p*this.WATER_WIDTH,f=d-l,g=p-u,b=Math.sqrt(f*f+g*g),v=b/c;0>v&&(v=0),v>1&&(v=1);var _=o+(a-o)*v,m=n+(r-n)*v,x=s+(h-s)*v;y*=4,t[y]=_,t[y+1]=m,t[y+2]=x,t[y+3]=255}this.lightSp.context.putImageData(this.bitmapDataLight,0,0),this.lightSp.updateTexture()}},{key:"updateBitmapDataWater01",value:function(){var t=this.filterCon.visible;this.filterCon.visible=!0,this.renderTexture=this.main.renderer.generateTexture(this.filterCon,PIXI.SCALE_MODES.DEFAULT,1),this.bitmapDataWater01=this.main.renderer.extract.pixels(this.renderTexture),this.filterCon.visible=t}},{key:"hyperbola",value:function(t,e,i,o,n,s,a){var r=this.WATER_WIDTH,h=this.WATER_HEIGHT,l=e*e,u=i*i;t.lineStyle(1,o,1);for(var c=[],d=[],p=!1,y=0;h>y;y++){var f=y-a,g=l*(1+f*f/u),b=Math.sqrt(g);if(r>s+b)p=!0,c[y]=s+b,d[y]=s-b;else if(p)break}n?(this.drawDashLine(t,o,c),this.drawDashLine(t,o,d)):(this.drawLine(t,o,c),this.drawLine(t,o,d))}},{key:"drawDashLine",value:function(t,e,i){t.lineStyle(1,e,1);for(var o=i.length,n=0;o>n;n++){var s=i[n];0===n?t.moveTo(s,n):3>n%6?t.lineTo(s,n):t.moveTo(s,n)}}},{key:"drawLine",value:function(t,e,i){t.lineStyle(1,e,1);for(var o=i.length,n=0;o>n;n++){var s=i[n];0===n?t.moveTo(s,n):t.lineTo(s,n)}}},{key:"initInterference",value:function(){this.waterSource01.visible=!1,this.waterSource02.visible=!0,this.waterSource03.visible=!0,this.baffleCon.visible=!1,this.type=this.INTERFERENCE,this.resetData(this.bitmapDataAmp01,this.WATER_SIZE),this.freshLibPan(),this.lastT=this.t=(new Date).getTime(),this.t0=0,this.weakLineGra.visible=this.showWeakLine,this.strengthLineGra.visible=this.showStrengthLine,this.lightGain=1,this.firstLoop=!0}},{key:"initDiffraction",value:function(){this.weakLineGra.visible=this.strengthLineGra.visible=!1,this.waterSource01.visible=!0,this.waterSource02.visible=!1,this.waterSource03.visible=!1,this.baffleCon.visible=!0,this.type=this.DIFFRACTION,this.resetData(this.bitmapDataAmp01,this.WATER_SIZE),this.resetData(this.bitmapDataAmp02,this.WATER_SIZE),this.freshLibPan(),this.lastT=this.t=(new Date).getTime(),this.t0=0,this.lightGain=this.lightGainCache,this.firstLoop=!0,this.updateBaffleFlag=!0}},{key:"updateSlit",value:function(){this.slitH=(this.WATER_HEIGHT-this.slitLevel)/2,this.baffle02.height=this.baffle01.height=this.slitH*this.slitHsca,this.updateBaffleFlag=!0}},{key:"updateSource",value:function(){var t=this.WATER_WIDTH/2,e=this.sourceSpace/2;this.waterSource03.x=t-e,this.waterSource02.x=t+e,this.updateCacheDataFlag=!0}},{key:"setArr",value:function(t,e,i){for(var o=0;i>o;o++)t[o]=e[o]}},{key:"setImgData",value:function(t,e,i){for(var o=0,n=void 0,s=void 0,a=void 0,r=void 0,h=void 0,l=0;i>l;l++)n=e[l],h=n>>24&255,s=n>>16&255,a=n>>8&255,r=255&n,t[o]=h,t[o+1]=s,t[o+2]=a,t[o+3]=r,o+=4}},{key:"changeShowPrinciple",value:function(t){this.showPrinciple=t.checked,this.freshLibPan()}},{key:"changePause",value:function(t){var e=this.isPause||this.isPause2;this.isPause=t.checked,this.updatePause(e,this.isPause||this.isPause2),this.freshLibPan()}},{key:"changePause2",value:function(t){var e=this.isPause||this.isPause2;this.isPause2=t.checked,this.updatePause(e,this.isPause||this.isPause2),this.freshLibPan()}},{key:"updatePause",value:function(t,e){if(t){if(!e){var i=(new Date).getTime(),o=i-this.pauseT;this.t+=o,this.lastT=i}}else e&&(this.pauseT=(new Date).getTime())}},{key:"changA",value:function(t){this.A=128*t.showValue,this.waveSource01.A=this.A,this.waveSource02.A=this.A,this.waveSource03.A=this.A}},{key:"changSpeed",value:function(t){this.speed=t.showValue/this.pxcm,this.waveSource01.speed=this.speed,this.waveSource02.speed=this.speed,this.waveSource03.speed=this.speed,this.updateLineFlag=!0,this.updateCacheDataFlag=!0}},{key:"changT",value:function(t){this.T=t.showValue,this.waveSource01.T=this.T,this.waveSource02.T=this.T,this.waveSource03.T=this.T,this.updateLineFlag=!0,this.updateCacheDataFlag=!0}},{key:"reset",value:function(t){this.waveSource01.reset(),this.waveSource02.reset(),this.waveSource03.reset(),this.A=this.waveSource01.A,this.T=this.waveSource01.T,this.speed=this.waveSource01.speed,this.lastT=this.t=(new Date).getTime(),this.t0=0,this.updateLineFlag=!0,this.freshLibPan()}},{key:"changeType",value:function(t){switch(t.checked){case 0:this.initInterference();break;case 1:this.initDiffraction()}}},{key:"changeSlitLevel",value:function(t){this.slitLevel=t.showValue/this.pxcm,this.updateSlit()}},{key:"changeSourceSpace",value:function(t){this.sourceSpace=t.showValue/this.pxcm,this.updateSource(),this.updateLineFlag=!0}},{key:"changSourceX",value:function(t){this.sourceOffX=t.showValue/this.pxcm,this.waveSource01.translate(this.sourceOffX,0)}},{key:"changeLight",value:function(t){this.curLightId=t.checked,this.updateLightSp(),this.updateBitmapDataWater01()}},{key:"changLightX",value:function(t){this.lightX=t.showValue,this.updateLightSp(),this.updateBitmapDataWater01()}},{key:"changLightY",value:function(t){this.lightY=t.showValue,this.updateLightSp(),this.updateBitmapDataWater01()}},{key:"changLightR",value:function(t){this.lightR=t.showValue,this.updateLightSp(),this.updateBitmapDataWater01()}},{key:"changeLightOpen",value:function(t){this.lightOpen=t.checked,this.updateLightSp(),this.updateBitmapDataWater01()}},{key:"changeSamePhase",value:function(t){this.isSamePhase=!t.checked,this.waveSource02.phiT0=this.isSamePhase?0:Math.PI,this.updateLineFlag=!0}},{key:"changeLightGain",value:function(t){this.lightGainCache=this.lightGain=t.showValue}},{key:"changeShowBg",value:function(t){this.showBg=t.checked,this.waterSp.visible=this.showBg,this.updateBitmapDataWater01()}},{key:"changeShowStrengthLine",value:function(t){this.showStrengthLine=t.checked,this.strengthLineGra.visible=this.showStrengthLine}},{key:"changeShowWeakLine",value:function(t){this.showWeakLine=t.checked,this.weakLineGra.visible=this.showWeakLine}},{key:"importImg",value:function(){var t=this,e=document.getElementById("waterWaveInput");e||(e=document.createElement("input"),e.id="waterWaveInput",e.type="file",e.style.display="none",document.body.appendChild(e),e.accept="image/png,image/gif,image/jpg,image/jpeg");var i=function(e){t.change2base64Bg(e.target.result)};e.onchange=function(t){var o=e.files[0];if(o){var n=new FileReader;n.onload=i,n.readAsDataURL(o)}},e.click()}},{key:"change2base64Bg",value:function(t){var e=this,i=document.createElement("img");i.src=t,i.onload=function(t){e.waterSp.setImg(i,!0),e.updateBitmapDataWater01(),e.bgImgBase64=e.waterSp.canvas.toDataURL()}}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.type=this.type,t.curLightId=this.curLightId,t.showPrinciple=this.showPrinciple,t.isPause2=this.isPause2,t.A=this.A,t.T=this.T,t.speed=this.speed,t.showStrengthLine=this.showStrengthLine,t.showWeakLine=this.showWeakLine,t.isSamePhase=this.isSamePhase,t.sourceSpace=this.sourceSpace,t.sourceOffX=this.sourceOffX,t.slitLevel=this.slitLevel,t.lightGainCache=this.lightGainCache,t.lightGain=this.lightGain,this.bgImgBase64&&(t.bgImgBase64=this.bgImgBase64),t}},{key:"setData",value:function(t){this.changeLight({checked:t.curLightId}),this.showPrinciple=t.showPrinciple,this.changePause2({checked:t.isPause2}),this.changA({showValue:t.A/128}),this.changT({showValue:t.T}),this.changSpeed({showValue:t.speed*this.pxcm}),this.changeShowStrengthLine({checked:t.showStrengthLine}),this.changeShowWeakLine({checked:t.showWeakLine}),this.changeSamePhase({checked:t.isSamePhase}),this.changeSourceSpace({showValue:t.sourceSpace*this.pxcm}),this.changSourceX({showValue:t.sourceOffX*this.pxcm}),this.changeSlitLevel({showValue:t.slitLevel*this.pxcm}),this.changeLightGain({showValue:t.lightGainCache}),this.changeType({checked:t.type}),t.bgImgBase64&&(this.bgImgBase64=t.bgImgBase64,this.change2base64Bg(this.bgImgBase64)),this.firstLoop=!0}},{key:"getLocalBoundsElecs",value:function(){return[this.bg]}},{key:"getConf",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push(this.ComponentProperty.getRadio(this.language.getLocaleStr("type"),this.type,this.types,this.changeType.bind(this)),this.ComponentProperty.getDropMenu(this.language.getLocaleStr("light_type"),!1,"",this.lightTypes[this.curLightId],this.lightTypes,this,this.changeLight,0,0),this.ComponentProperty.getSwitch(this.language.getLocaleStr("principle"),this.showPrinciple,this.changeShowPrinciple,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("pause"),this.isPause2,this.changePause2,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("amplitude"),"false","",1,.1,l.M.getNumJie(this.A/128,2),.01,this.changA,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("oscillating_period"),"false","s",1,.1,l.M.getNumJie(this.T,2),.01,this.changT,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("propagation_speed"),"false","cm/s",200,20,Math.round(this.pxcm*this.speed),1,this.changSpeed,this),this.ComponentProperty.getButton(this.language.getLocaleStr("import_image"),this.language.getLocaleStr("import"),this.importImg,this)),this.type===this.INTERFERENCE?t.confArr.push(this.ComponentProperty.getSwitch(this.language.getLocaleStr("strengthen_posi"),this.showStrengthLine,this.changeShowStrengthLine,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("abate_posi"),this.showWeakLine,this.changeShowWeakLine,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("skewing")+"π",!this.isSamePhase,this.changeSamePhase,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("wave_space"),!1,"cm",400,100,Math.round(this.pxcm*this.sourceSpace),1,this.changeSourceSpace,this)):(t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("wave_posi"),"false","cm",160,-100,Math.round(this.pxcm*this.sourceOffX),1,this.changSourceX,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("seam_space"),!1,"cm",100,10,Math.round(this.pxcm*this.slitLevel),1,this.changeSlitLevel,this)),this.showPrinciple&&t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("display_gain"),!1,"",50,1,this.lightGain,1,this.changeLightGain,this))),t}}]),e}(c["default"]);var y=function(){function t(e,i,o,s,a,r,h){n(this,t),this.sp=e,this.A=i,this.T=o,this.phiT0=s,this.phiT=s,this.w=a,this.h=r,this.d=Math.max(a,r),this.speed=h,this.ox=this.sp.x,this.oy=this.sp.y,this.oA=this.A,this.oT=this.T,this.oSpeed=this.speed,this.cacheData=[],this.updateCacheData()}return r(t,[{key:"reset",value:function(){this.sp.x=this.ox,this.sp.y=this.oy,this.A=this.oA,this.T=this.oT,this.speed=this.oSpeed,this.updateCacheData()}},{key:"translate",value:function(t,e){this.sp.x=this.ox+t,this.sp.y=this.oy+e,this.updateCacheData()}},{key:"updatePhi",value:function(t){this.phiT=this.phiT0+2*Math.PI*t*.001/this.T}},{key:"updateCacheData",value:function(){var t=this.w,e=this.h,i=this.speed,o=this.sp.x,n=this.sp.y,s=i*this.T;this.cacheData.length=0;for(var a=0;t>a;a++)for(var r=0;e>r;r++){var h=a-o,l=r-n,u=Math.sqrt(h*h+l*l),c=-2*Math.PI*u/s,d=(this.d-u)/this.d;0>d&&(d=0);var p=2*(a+r*t);this.cacheData[p]=c,this.cacheData[p+1]=d}}},{key:"getValue",value:function(t,e){var i=2*(t+e*this.w),o=this.cacheData[i]+this.phiT;return this.cacheData[i+1]*this.A*(Math.sin(o)+1)}}]),t}()},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function f(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:f(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(226),c=o(u),d=i(1105),p=o(d);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.wheelRods1=null,i.board1=null,i.wheelRods2=null,i.board2=null,i.touchWheelAndRods1=null,i.touchWheelAndRods2=null,i.bg=new PIXI.Graphics,i.bg.beginFill(0,0),i.bg.drawRect(-400,-200,1600,400),i.addChild(i.bg),i.waveD1=null,i.A1=80,i.T1=2,i.Phi1=0,i.PhiT1=0,i.A2=80,i.T2=2,i.Phi2=0,i.PhiT2=0,i.speed=60,i.openFlag2=!0,i.circleFlag=!1,i}return a(e,t),r(e,[{key:"added",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.hideMc.visible=!1,this.componentBox.visible=!1,this.removeChild(this.componentBox),this.removeChild(this.skin);this.waveD1=new p["default"](this.paramObj,6684672,1),this.addChild(this.waveD1),this.waveD1.x=0,this.waveD1.y=0,this.touchWheelAndRods1=new y(this.paramObj,this.wheelRods1,this,this.wheelRodsMove1),this.addChild(this.touchWheelAndRods1),this.touchWheelAndRods2=new y(this.paramObj,this.wheelRods2,this,this.wheelRodsMove2),this.addChild(this.touchWheelAndRods2),this.updateParam(),this.time=l.M.addTicker(this.enterFrame,this);var t=PIXI.Sprite.fromFrame("Wave3Btn/btnup"),i=PIXI.Sprite.fromFrame("Wave3Btn/btndown"),o=PIXI.Sprite.fromFrame("Wave3Btn/btnup");this.resetbtn=new this.Button({text:this.language.getLocaleStr("reset"),tab:this.reset,fontColor:16777215,fontSize:30,disabledSkin:t,downSkin:i,upSkin:o}),this.resetbtn["this"]=this,this.resetbtn.x=150,this.resetbtn.y=-180,this.addChild(this.resetbtn),this.addCursor(this.resetbtn,"hand")}},{key:"removed",value:function(){this.waveD1.disposeAll(),this.removedCursor(this.resetbtn),this.resetbtn.destroy(),this.time&&(this.time.stop(),this.time=null),this.touchWheelAndRods1.removed(),this.touchWheelAndRods2.removed(),this.touchWheelAndRods1=null,this.touchWheelAndRods2=null,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"wheelRodsMove1",value:function(t,e){switch(t){case"A":this.A1=Math.round(e);break;case"Phi":this.Phi1=Math.round(180*e/Math.PI)}this.updateParam()}},{key:"wheelRodsMove2",value:function(t,e){switch(t){case"A":this.A2=Math.round(e);break;case"Phi":this.Phi2=Math.round(180*e/Math.PI)}this.updateParam()}},{key:"enterFrame",value:function(){this.PhiT1=this.waveD1.lineC.PhiT1,this.PhiT2=this.waveD1.lineC.PhiT2,this.updateWheelAndRods()}},{key:"updateWheelAndRods",value:function(){this.updateOneWheelAndRods(this.wheelRods1,this.A1,-this.PhiT1,this.board1),this.updateOneWheelAndRods(this.wheelRods2,this.A2,-this.PhiT2,this.board2)}},{key:"updateOneWheelAndRods",value:function(t,e,i,o){var n=t.wheel,s=t.rods;n.rotation=i;var a=new PIXI.Point(e*Math.cos(i),e*Math.sin(i));s.x=n.x+a.x,s.y=n.y+a.y;var r=Math.abs(o.x-t.x)-s.x,h=(r-64)/2;s.rod2.width=h,s.rod3.width=h,s.rod3.x=h+64}},{key:"selectRenderChild",value:function(){return this.updateTransform(),this.getBounds()}},{key:"changeA1",value:function(t){this.A1=t.showValue,this.updateParam()}},{key:"changeT1",value:function(t){this.T1=t.showValue,this.updateParam()}},{key:"changePhi1",value:function(t){this.Phi1=t.showValue,this.touchWheelAndRods1.targetPhiT=this.Phi1*Math.PI/180,this.updateParam()}},{key:"changeA2",value:function(t){this.A2=t.showValue,this.updateParam()}},{key:"changeT2",value:function(t){this.T2=t.showValue,this.updateParam()}},{key:"changePhi2",value:function(t){this.Phi2=t.showValue,this.touchWheelAndRods2.targetPhiT=this.Phi2*Math.PI/180,this.updateParam()}},{key:"changeSpeed",value:function(t){this.speed=t.showValue,this.updateParam()}},{key:"updateParam",value:function(){this.waveD1.pause(),this.waveD1.lineC.A1=this.A1,this.waveD1.lineC.T1=this.T1,this.waveD1.lineC.Phi1=this.Phi1,this.waveD1.lineC.A2=this.A2,this.waveD1.lineC.T2=this.T2,this.waveD1.lineC.Phi2=this.Phi2,this.waveD1.lineC.speed=this.speed,this.waveD1.lineC.circleFlag=this.circleFlag,this.waveD1.lineC.openFlag2=this.openFlag2,this.waveD1.lineC.initLine(),this.updateWheelAndRods()}},{key:"nextStep",value:function(t){this.waveD1.isPause&&this.waveD1.lineC.nextFrame()}},{key:"preStep",value:function(t){this.waveD1.isPause&&this.waveD1.lineC.preFrame()}},{key:"changeCircleFlag",value:function(t){this.circleFlag=t.checked,this.updateParam()}},{key:"changeOpenFlag2",value:function(t){this.openFlag2=t.checked,this.wheelRods2.visible=this.board2.visible=this.openFlag2,this.updateParam(),this.freshLibPan()}},{key:"reset",value:function(){this.updateParam()}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.A1=this.A1,t.T1=this.T1,t.Phi1=this.Phi1,t.A2=this.A2,t.T2=this.T2,t.Phi2=this.Phi2,t.speed=this.speed,t.circleFlag=this.circleFlag,t.openFlag2=this.openFlag2,t}},{key:"setData",value:function(t){this.A1=t.A1,this.T1=t.T1,this.Phi1=t.Phi1,this.A2=t.A2,this.T2=t.T2,this.Phi2=t.Phi2,this.speed=t.speed,this.circleFlag=t.circleFlag,this.openFlag2=t.openFlag2,this.wheelRods2.visible=this.board2.visible=this.openFlag2,this.touchWheelAndRods1.targetPhiT=this.Phi1*Math.PI/180,this.touchWheelAndRods2.targetPhiT=this.Phi2*Math.PI/180,this.updateParam()}},{key:"getConf",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this),i=this;return t.confArr.push(this.ComponentProperty.getButton("",this.language.getLocaleStr("reset"),this.reset,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("open_wave_source")+"2",this.openFlag2,this.changeOpenFlag2,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("propagation_speed"),!0,"cm/s",100,50,this.speed,1,this.changeSpeed,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("amplitude")+"1",!0,"cm",110,20,{get value(){return i.A1},set value(t){i.A1=t}},1,this.changeA1,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("cycle")+"1",!0,"s",4,1,this.T1,.1,this.changeT1,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("initial_phase")+"1",!0,"°",360,0,{get value(){return i.Phi1},set value(t){i.Phi1=t}},1,this.changePhi1,this)),this.openFlag2&&t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("amplitude")+"2",!0,"cm",110,20,{get value(){return i.A2},set value(t){i.A2=t}},1,this.changeA2,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("cycle")+"2",!0,"s",4,1,this.T2,.1,this.changeT2,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("initial_phase")+"2",!0,"°",360,0,{get value(){return i.Phi2},set value(t){i.Phi2=t}},1,this.changePhi2,this)),t}}]),e}(c["default"]);var y=function(t){function e(t,i,o,a){n(this,e);var r=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.MIN_A=20,r.MAX_A=110,r.STEP=8,r.targetPhiT=0,r.autoAdsorbFlag=!0,r.eq=o,r.wheelRods=i,r.moveCallBack=a,r.wheel=i.wheel,r.rods=i.rods,r.wheelRods.wheelUp.interactive=r.wheelRods.wheelUp.interactiveChildren=!1,r.addChild(i),r.eq.addCursor(r.wheel,"xuanzhuan"),r.eq.addCursor(r.rods.p,"hand"),r.wheelTouchId=l.M.addTouch(r.wheel,{begin:r.wheelTouchBegin,move:r.wheelTouchMove,end:r.wheelTouchEnd},r),r.rodTouchId=l.M.addTouch(r.rods.p,{begin:r.rodTouchBegin,move:r.rodTouchMove,end:r.rodTouchEnd},r),r}return a(e,t),r(e,[{key:"added",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.cannotSystemDrag=!0}},{key:"wheelTouchBegin",value:function(t){this.eq.cannotSystemDrag=!0;var e=this.getMouseXY(t);e=this.wheelRods.toLocal(e,this.getMain().view),this.wheelOriRot=Math.atan2(e.y-this.wheel.y,e.x-this.wheel.x)}},{key:"wheelTouchMove",value:function(t){var e=this.getMouseXY(t);e=this.wheelRods.toLocal(e,this.getMain().view);var i=Math.atan2(e.y-this.wheel.y,e.x-this.wheel.x),o=i-this.wheelOriRot;o%=2*Math.PI,o>Math.PI?o-=2*Math.PI:o<-Math.PI&&(o+=2*Math.PI),this.targetPhiT-=o,this.wheelOriRot=i,this.targetPhiT=this.targetPhiT%(2*Math.PI),0>this.targetPhiT&&(this.targetPhiT+=2*Math.PI),this.moveCallBack&&this.moveCallBack.call(this.eq,"Phi",this.targetPhiT)}},{key:"wheelTouchEnd",value:function(t){if(this.eq.cannotSystemDrag=!1,this.autoAdsorbFlag){var e=8*this.STEP/360,i=2*Math.PI/this.STEP,o=this.targetPhiT/i,n=Math.round(o);o!==n&&Math.abs(n-o)<e&&(this.targetPhiT=n*i)}this.targetPhiT=this.targetPhiT%(2*Math.PI),0>this.targetPhiT&&(this.targetPhiT+=2*Math.PI),this.moveCallBack&&this.moveCallBack.call(this.eq,"Phi",this.targetPhiT)}},{key:"rodTouchBegin",value:function(t){this.eq.cannotSystemDrag=!0}},{key:"rodTouchMove",value:function(t){var e=this.getMouseXY(t);e=this.wheelRods.toLocal(e,this.getMain().view);var i=new PIXI.Point(e.x-this.wheel.x,e.y-this.wheel.y),o=new PIXI.Point(this.rods.x-this.wheel.x,this.rods.y-this.wheel.y),n=Math.sqrt(o.x*o.x+o.y*o.y);o.x/=n,o.y/=n;var s=i.x*o.x+i.y*o.y;this.MIN_A>s&&(s=this.MIN_A),s>this.MAX_A&&(s=this.MAX_A),this.moveCallBack&&this.moveCallBack.call(this.eq,"A",s)}},{key:"rodTouchEnd",value:function(t){this.eq.cannotSystemDrag=!1}},{key:"removed",value:function(){this.eq.removedCursor(this.wheel),this.eq.removedCursor(this.rods.p),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this),this.wheelTouchId&&(l.M.removeTouch(this.wheel,this.wheelTouchId),this.wheelTouchId=null),this.rodTouchId&&(l.M.removeTouch(this.rods,this.rodTouchId),this.rodTouchId=null),this.moveCallBack=null,this.eq=null,this.wheelRods=null,this.wheel=null,this.rods=null}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function v(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:v(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0,y=void 0,f=void 0,g=void 0,b=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.phys.Material,p=c.shape.Polygon,y=c.shape.Circle,f=c.geom.Vec2,g=c.shape.HockShapeBase,b=c.phys.BodyType,i.useDragSetCurElec=!0,i.bg=null,i.line=null,i.needle=null,i.points3=[{x:33.05,y:-21.45},{x:24.8,y:-26.95},{x:11.55,y:-32.45},{x:1.05,y:-33.45},{x:-24.2,y:-28.45},{x:-38.95,y:-12.2},{x:-43.2,y:13.55},{x:-27.2,y:29.3},{x:-12.95,y:34.05},{x:8.55,y:34.05},{x:27.55,y:28.05},{x:35.8,y:20.3},{x:43.05,y:4.3},{x:39.55,y:-8.45}],i.material=new d(0,.5,.6,.9,.001),i.material0=new d(0,.5,.6,0,.001),i.tophock=null,i.bothock=null,i.hocks=[],i.selectIndex=0,i.hockLocalCOMs=[[{x:0,y:-34},{x:0,y:33}],[{x:0,y:-34.5},{x:0,y:34.5}],[{x:0,y:-34},{x:0,y:34}]],i.skinTypes=[i.language.getLocaleStr("cube"),i.language.getLocaleStr("sphere"),i.language.getLocaleStr("irregular_body")],i.density=.9,i.needleMec=null,i.needleJoint=null,i.isPress=!1,i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.changeSkin(this.selectIndex),this.skinCon.addChild(this.bg),this.addChild(this.line);var t=new u["default"](this.paramObj);this.needleMec=t;var i=new p(p.rect(-4,-357,8,357));t.x=this.body.posx+this.needle.x,t.y=this.body.posy+this.needle.y,this.offP=new h.Point(this.needle.x,this.needle.y),t.init(),t.body.add(i),this.needle.x=0,this.needle.y=0,this.addChildAt(t,0),t.body.noallowRotation=!0,t.body.userData.cannotToolRot=!0,t.body.userData.dragLevel=-1,t.body.set_type(b.get_KINEMATIC()),t.getConfJumpTarget=this;var o=f.get(t.body.posx,t.body.posy);this.needleJoint=this.JointUtil.createWeldJoint(this.body,this.needleMec.body,o,o),this.changePress({checked:this.isPress}),this.setScale(1.5,1.5)}},{key:"removed",value:function(){this.needleMec.removeBodyFromSpace(this.needleMec.body),this.removeHocks(),this.needleMec&&this.needleMec.getConfJumpTarget&&(this.needleMec.getConfJumpTarget=null),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.line.visible=!(!this.tophock.get_userData().useing&&!this.bothock.get_userData().useing),this.updateNeedleSkin()}},{key:"updateNeedleSkin",value:function(){this.needle.rotation=-this.rotation}},{key:"setScale",value:function(t,i){t===i&&(r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setScale",this).call(this,t,i),this.scaleSkin())}},{key:"setLocalScale",value:function(t,i){t===i&&(r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setLocalScale",this).call(this,t,i),this.scaleSkin())}},{key:"scaleSkin",value:function(){this.skinCon.scale.x=this.currentScale.x,this.skinCon.scale.y=this.currentScale.y,this.line.scale.y=this.currentScale.y,this.hocks.forEach(function(t){t.dragToolClick()})}},{key:"removeHocks",value:function(){0!==this.hocks.length&&(this.hocks.forEach(function(t){t.dragToolClick(),t.dispose()}),this.hocks.length=0)}},{key:"initHock",value:function(t){this.removeHocks(),this.tophock=new g(15,null,this.material0),this.tophock.registerClass(this.paramObj.moduleMain),this.tophock.addCbtype(this.CbTypeStr.WAX_BLOCK_HOCK),this.bothock=new g(15,null,this.material0),this.bothock.registerClass(this.paramObj.moduleMain),this.bothock.addCbtype(this.CbTypeStr.WAX_BLOCK_HOCK),this.body.add(this.tophock),this.body.add(this.bothock);var e=this.hockLocalCOMs[t];this.tophock.set_localCOM(f.get(e[0].x,e[0].y)),this.bothock.set_localCOM(f.get(e[1].x,e[1].y)),this.tophock.createListener(this.CbTypeStr.WAX_BLOCK_HOCK,this.CbTypeStr.GALLOON_HOCK),this.bothock.createListener(this.CbTypeStr.WAX_BLOCK_HOCK,this.CbTypeStr.GALLOON_HOCK),this.hocks=[this.tophock,this.bothock],this.addTweenQuan(this.tophock),this.addTweenQuan(this.bothock)}},{key:"changeSkin",value:function(t){this.body.shapes.clear();var e=void 0;switch(t){case 0:e=new p(p.box(66,67),this.material),this.body.add(e);break;case 1:e=new y(34.5,null,this.material),this.body.add(e);break;case 2:this.BodyUtil.BodyFromArray(this.points3,this.body,this.material)}this.bg.gotoAndStop(t),this.line.gotoAndStop(t),this.line.visible=!1,this.initHock(t),this.body.transformShapes(this.transformN)}},{key:"changeType",value:function(t){this.selectIndex=t.checked,this.changeSkin(this.selectIndex),this.showToolDatas()}},{key:"changeForceAnalysis",value:function(t){(this.openF_analysis=t.checked)||this.removeForceAnalysis()}},{key:"changeScale",value:function(t){var e=t.showValue/this.currentScale.x;1!==e&&this.setLocalScale(e,e)}},{key:"densityChanged",value:function(t){var e=this;this.density=t.showValue,this.body.shapes.foreach(function(t){-1===e.hocks.indexOf(t)&&t.get_material().set_density(e.density)})}},{key:"changePress",value:function(t){if(this.isPress=t.checked){if(!this.needleMec.space){this.needleMec.space=this.space,this.needle.visible=!0,this.needleMec.visible=!0;var e=this.body.localPointToWorld(f.get(this.offP.x,this.offP.y));this.needleMec.body.set_rotation(0),this.needleMec.body.set_position(e),this.updateTransform(),this.needleJoint.set_active(!0);var i=-this.body.rotation;this.needleJoint.set_phase(i)}}else this.needleMec.space&&(this.needleJoint.set_active(!1),this.needleMec.space=null,this.needle.visible=this.needleMec.visible=!1,this.needleMec.body.posx=1e4*Math.random()+1e6)}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.type=this.selectIndex,t.density=this.density,t.isPress=this.isPress,t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.selectIndex=t.type||0,this.changeSkin(this.selectIndex),this.scaleSkin(),this.density=t.density||.9,this.densityChanged({showValue:this.density}),this.isPress=t.isPress||!1,this.changePress({checked:this.isPress})}},{key:"getConf",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push({type:this.ComponentProperty.TYPE_LIST_WAX_BLOCK,name:this.language.getLocaleStr("type"),value:this.skinTypes,checked:this.selectIndex,callBack:this.changeType.bind(this)},this.ComponentProperty.getScrollBar(this.language.getLocaleStr("size_dx"),!0,"",2,1,h.M.getNumJie(this.currentScale.x,2),.01,this.changeScale,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("density"),!0,"g/cm³",1,.8,this.density,.01,this.densityChanged,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("force_analysis"),this.openF_analysis,this.changeForceAnalysis,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("press"),this.isPress,this.changePress,this)),t}},{key:"getLocalBoundsElecs",value:function(){return this.needle.visible?[this.bg,this.needle]:[this.bg]}},{key:"getTipMess",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.language.getLocaleStr("density")+": "+this.density+"'g/cm³\n    "}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function k(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:k(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(49),u=i(1),c=i(446),d=o(c),p=i(449),y=o(p),f=void 0,g=void 0,b=void 0,v=void 0,_=void 0,m=void 0,x=void 0,w=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return f=i.phy.nape,g=f.NbBody,b=f.geom.Vec2,v=f.phys.BodyType,_=f.callbacks.CbType,m=f.callbacks.InteractionListener,x=f.callbacks.CbEvent,w=f.callbacks.InteractionType,i.canRotate=!1,i.points=[{x:212,y:-22},{x:212,y:3},{x:-210.95,y:3},{x:-210.95,y:-22},{x:-226.95,y:-22},{x:-226.95,y:16},{x:228,y:16},{x:228,y:-22}],i.box5=null,i.box10=null,i.box20_1=null,i.box20_2=null,i.box50=null,i.box100_1=null,i.box100_2=null,i.box200=null,i.wjArr=[],i.cbtype=new _,i.hitListener=null,i.endhitListener=null,i.curdrag=null,i.hitTuoPan=null,i.dragBox=null,i.shadowShape=null,i.pivotP=null,i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_type(v.get_KINEMATIC()),this.body.userData.view=this.bg,this.body.userData.coordinateField=this,this.body.userData.bindupdate={field:this,func:this.update},this.body.userData.allowMove=!1,this.body.mass=300,this.initWeight(),this.bg.addEventListener(y["default"].BEGIN,function(e){t.dragBottomBegin(e)}),this.bg.addEventListener(y["default"].END,function(e){t.dragBottomEnd(e)}),this.nie.visible=!1,this.bg.selectTarget=this.parent}},{key:"dragBottomBegin",value:function(t){var e=this;this.body.arbiters.foreach(function(t){var i=t.get_body1(),o=t.get_body2();if(i===e.body||o===e.body){var n=i===e.body?o:i;if(e.body.posy>=n.posy&&n.userData.classType&&"weight"===n.userData.classType){var s=e.JointUtil.createWeldJoint(n,e.body,n.position,n.position);e.wjArr.push(s)}}})}},{key:"dragBottomEnd",value:function(t){for(var e=0;this.wjArr.length>e;e++){var i=this.wjArr[e];i.body1=null,i.body2=null,this.napeEngine.space.constraints.remove(i)}}},{key:"addCompound",value:function(t){this.body.set_compound(t),this.box5.set_compound(t),this.box10.set_compound(t),this.box20_1.set_compound(t),this.box20_2.set_compound(t),this.box50.set_compound(t),this.box100_1.set_compound(t),this.box100_2.set_compound(t),this.box200.set_compound(t)}},{key:"initWeight",value:function(){var t=this;this.box5=this.tpbody(this,this.b5,5),this.addBodyToSpace(this.box5,this),this.box10=this.tpbody(this,this.b10,10),this.addBodyToSpace(this.box10,this),this.box20_1=this.tpbody(this,this.b20_1,20),this.addBodyToSpace(this.box20_1,this),this.box20_2=this.tpbody(this,this.b20_2,20),this.addBodyToSpace(this.box20_2,this),this.box50=this.tpbody(this,this.b50,50),this.addBodyToSpace(this.box50,this),this.box100_1=this.tpbody(this,this.b100_1,100),this.addBodyToSpace(this.box100_1,this),this.box100_2=this.tpbody(this,this.b100_2,100),this.addBodyToSpace(this.box100_2,this),this.box200=this.tpbody(this,this.b200,200),this.addBodyToSpace(this.box200,this),this.hitListener=new m(x.get_BEGIN(),w.get_SENSOR(),this.cbtype,this.CbTypeStr.BALANCE_PAN,function(e){t.hitTuoPan=e.get_int2().get_body(),t.dragBox=e.get_int1().get_body()}),this.endhitListener=new m(x.get_END(),w.get_SENSOR(),this.cbtype,this.CbTypeStr.BALANCE_PAN,function(e){t.hitTuoPan=null,t.removeBoxShadow(),t.dragBox=null})}},{key:"resetAllOriginPosition",value:function(){var t=this;(0,l.forEach)([this.box5,this.box10,this.box20_1,this.box20_2,this.box50,this.box100_1,this.box100_2,this.box200],function(e,i){var o=e.userData.originxy;e.set_position(t.body.localPointToWorld(b.get(o.x,o.y)))})}},{key:"tpbody",value:function(t,e,i){var o=this,n=new g,s=void 0;return"b5"===e.name?(s=[{x:-15,y:-5},{x:-15,y:24},{x:15,y:24},{x:15,y:-5},{x:-.85,y:-18.5}],e.texturename="5.png"):"b10"===e.name?(s=[{x:.2,y:-25.45},{x:-18,y:-8},{x:-18,y:31},{x:18,y:31},{x:18,y:-8}],e.texturename="10.png"):"b20_1"===e.name||"b20_2"===e.name?(s=[{x:-21,y:-13},{x:-21,y:36},{x:20,y:36},{x:20,y:-13},{x:-.25,y:-28.45}],e.texturename="20.png"):"b50"===e.name?(s=[{x:0,y:-29},{x:-25,y:-16},{x:-25,y:42},{x:24,y:42},{x:24,y:-16}],e.texturename="50.png"):"b100_1"===e.name?(s=[{x:-30,y:-17},{x:-30,y:49},{x:29,y:49},{x:29,y:-17},{x:-1,y:-34}],e.texturename="100.png"):"b100_2"===e.name?(s=[{x:-30,y:-17},{x:-30,y:49},{x:29,y:49},{x:29,y:-17},{x:-1,y:-34}],e.texturename="100.png"):"b200"===e.name&&(s=[{x:0,y:-44},{x:-39,y:-22},{x:-39,y:65},{x:39,y:65},{x:39,y:-22}],e.texturename="200.png"),this.BodyUtil.createPolygonFromPoints(s,n).get_cbTypes().add(this.cbtype),n.set_allowRotation(!1),n.set_position(b.weak(t.x+e.x,t.y+e.y)),n.userData.originxy={x:e.x,y:e.y},n.mass=i,n.userData.view=e,n.userData.cannotToolRot=!0,n.userData.classType="weight",n.userData.allowMove=!1,n.userData.dragBegin=function(){o.nie.visible=!0,o.nie.x=e.x,o.nie.y=e.y-.5*e.height,n.sensorEnabled(!0),o.addNapeListeners(o.hitListener),o.addNapeListeners(o.endhitListener)},n.userData.dragMove=function(){if(o.nie.x=e.x,o.nie.y=e.y-.5*e.height,o.hitTuoPan&&o.dragBox){var t=o.hitTuoPan.get_bounds(),i=o.dragBox.userData.view,n=o.dragBox.get_position().get_x(),s=t.get_y();o.shadowShape||(o.shadowShape=PIXI.Sprite.fromImage("WeightBox/"+i.texturename),o.shadowShape.pivot=new u.Point(o.shadowShape.width/2,o.shadowShape.height/2),o.addChild(o.shadowShape),o.shadowShape.alpha=.3);var a=o.toLocal(new u.Point(n,s),o.getMain().view),r=o.shadowShape.height;a.y-=r/2,o.shadowShape.x=a.x,o.shadowShape.y=a.y,o.pivotP=new u.Point(n,s-r/2)}},n.userData.dragEnd=function(){o.curdrag=null,o.nie.x=e.x,o.nie.y=e.y-.5*e.height,o.nie.visible=!1,o.hitTuoPan&&o.dragBox&&o.pivotP&&o.dragBox.set_position(b.get(o.pivotP.x,o.pivotP.y)),o.hitTuoPan=null,n.sensorEnabled(!1),o.removeNapeListeners(o.hitListener),o.removeNapeListeners(o.endhitListener),o.removeBoxShadow(),o.dragBox=null},e.addEventListener(y["default"].BEGIN,n.userData.dragBegin),e.addEventListener(y["default"].MOVE,n.userData.dragMove),e.addEventListener(y["default"].END,n.userData.dragEnd),n}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.curdrag&&(this.nie.x=this.curdrag.x,this.nie.y=this.curdrag.y-.5*this.curdrag.height)}},{key:"removeBoxShadow",value:function(){this.shadowShape&&(this.removeChild(this.shadowShape),this.shadowShape=null)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.p5={x:this.box5.posx,y:this.box5.posy},t.p10={x:this.box10.posx,y:this.box10.posy},t.p20_1={x:this.box20_1.posx,y:this.box20_1.posy},t.p20_2={x:this.box20_2.posx,y:this.box20_2.posy},t.p50={x:this.box50.posx,y:this.box50.posy},t.p100_1={x:this.box100_1.posx,y:this.box100_1.posy},t.p100_2={x:this.box100_2.posx,y:this.box100_2.posy},t.p200={x:this.box200.posx,y:this.box200.posy},t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.p5&&(this.box5.set_position(b.get(t.p5.x,t.p5.y)),this.box10.set_position(b.get(t.p10.x,t.p10.y)),this.box20_1.set_position(b.get(t.p20_1.x,t.p20_1.y)),this.box20_2.set_position(b.get(t.p20_2.x,t.p20_2.y)),this.box50.set_position(b.get(t.p50.x,t.p50.y)),this.box200.set_position(b.get(t.p200.x,t.p200.y))),t.p100&&this.box100_1.set_position(b.get(t.p100.x,t.p100.y)),t.p100_1&&this.box100_1.set_position(b.get(t.p100_1.x,t.p100_1.y)),t.p100_2&&this.box100_2.set_position(b.get(t.p100_2.x,t.p100_2.y))}},{key:"removed",value:function(){this.removeNapeListeners(this.hitListener),this.removeNapeListeners(this.endhitListener),this.bg.removeAllListeners();for(var t=[this.box5,this.box10,this.box20_1,this.box20_2,this.box50,this.box100_1,this.box100_2,this.box200],i=0;t.length>i;i++){var o=t[i],n=o.userData;n.view.removeEventListener(y["default"].BEGIN,n.dragBegin),n.view.removeEventListener(y["default"].MOVE,n.dragMove),n.view.removeEventListener(y["default"].END,n.dragEnd),delete n.dragBegin,delete n.dragMove,delete n.dragEnd,this.BodyUtil.destoryBody(o)}h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"getLocalBoundsElecs",value:function(){return[this.bg]}}]),e}(d["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(226),c=o(u),d=i(229),p=o(d);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.jiyi=null,i.angleArr=["-3.5°","0°","6°","12°","18°","24°"],i.fArr=[[0,5],[35,10],[70,20],[135,35],[100,80],[70,100]],i.angleId=0,i.forceUpFlag=!0,i.forceRightFlag=!0,i.pauseFlag=!1,i.fU=0,i.fR=0,i.framerate=24,i.bg=new PIXI.Graphics,i.addChildAt(i.bg,0),i.bg.alpha=0,i.bg.drawRect(0,-50,1e3,470),i.dragBtn=new PIXI.Graphics,i.addChild(i.dragBtn),i.dragBtn.beginFill(16711680,0),i.dragBtn.drawCircle(0,0,70),i.dragBtn.x=620,i.dragBtn.y=170,i.addCursor(i.dragBtn,"hand"),i.cp=new l.Point(431,172),i.dragAngle=[-3.5,0,6,12,18,24],i.dragId=l.M.addDrag(i.dragBtn,null,{begin:function(t){i.cannotSystemDrag=!0},move:function(t){var e=i.dragBtn.x-i.cp.x,o=i.dragBtn.y-i.cp.y,n=Math.atan2(o,e),s=Math.floor((180*n/Math.PI+9)/6);0>s&&(s=0),s>5&&(s=5),s!=i.angleId&&i.angleChanged({checked:s})},end:function(t){i.cannotSystemDrag=!1;var e=i.dragAngle[i.angleId]*Math.PI/180;i.dragBtn.x=i.cp.x+190*Math.cos(e),i.dragBtn.y=i.cp.y+190*Math.sin(e)}},i),i.dragBtn.getMScale=i.getMScale.bind(i),i.main.setAnimateAssets(p["default"].assets),PIXI.animate.load(p["default"],i,function(t){i.jiyi=t,i.addChild(i.dragBtn),i.refresh()}),i}return a(e,t),r(e,[{key:"added",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this)}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.jiyi&&this.jiyi.airflow.getChildAt(0).framerate!=this.framerate&&(this.jiyi.airflow.getChildAt(0).framerate=this.framerate)}},{key:"removed",value:function(){this.removedCursor(this.dragBtn),l.M.removeDrag(this.dragBtn,this.dragId),this.dragBtn.getMScale=null,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"updateLabel",value:function(){this.jiyi.label.text=this.language.getLocaleStr("wing_model_label").replace("%s",this.angleArr[this.angleId])}},{key:"updateForce",value:function(){var t=this.angleArr[this.angleId];t=t.replace("°",""),t=parseFloat(t)||0,t=t*Math.PI/180;var e=this.jiyi.airflow.x-50*Math.cos(t),i=this.jiyi.airflow.y-50*Math.sin(t);this.jiyi.forceUp.x=e,this.jiyi.forceUp.y=i,this.jiyi.forceRight.x=e+8,this.jiyi.forceRight.y=i-8;var o=this.fArr[this.angleId][0];this.jiyi.forceUp.arrowBody.height=o,this.jiyi.forceUp.arrowHead.y=-o;var n=this.fArr[this.angleId][1];this.jiyi.forceRight.arrowBody.width=n,this.jiyi.forceRight.arrowHead.x=n,this.jiyi.forceRight.label.x=n+50,this.jiyi.forceRight.label.y=-22}},{key:"refresh",value:function(){if(this.jiyi){this.jiyi.airflow.gotoAndStop(this.angleId);var t=this.jiyi.airflow.getChildAt(0);this.pauseFlag?t.stop():t.play(),this.jiyi.forceUp.visible=this.forceUpFlag&&0!==this.fArr[this.angleId][0],this.jiyi.forceRight.visible=this.forceRightFlag&&0!==this.fArr[this.angleId][1],this.updateLabel(),this.updateForce()}}},{key:"angleChanged",value:function(t){this.angleId=t.checked,this.refresh()}},{key:"forceUpChanged",value:function(t){this.forceUpFlag=t.checked,this.refresh()}},{key:"forceRightChanged",value:function(t){this.forceRightFlag=t.checked,this.refresh()}},{key:"stopChanged",value:function(t){this.pauseFlag=t.checked,this.refresh()}},{key:"framerateChanged",value:function(t){this.framerate=t.showValue}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.angleId=this.angleId,t.forceUpFlag=this.forceUpFlag,t.forceRightFlag=this.forceRightFlag,t.pauseFlag=this.pauseFlag,t.framerate=this.framerate,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.angleId=t.angleId||0,this.forceUpFlag=!!t.forceUpFlag,this.forceRightFlag=!!t.forceRightFlag,this.pauseFlag=!!t.pauseFlag,this.framerate=t.framerate||24,this.refresh()}},{key:"getConf",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.confArr.push(this.ComponentProperty.getDropMenu(this.language.getLocaleStr("angle"),!1,"",this.angleArr[this.angleId],this.angleArr,this,this.angleChanged),this.ComponentProperty.getSwitch(this.language.getLocaleStr("pause")+"/"+this.language.getLocaleStr("play"),this.pauseFlag,this.stopChanged,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("lift"),this.forceUpFlag,this.forceUpChanged,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("zuli"),this.forceRightFlag,this.forceRightChanged,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("speed"),!1,"",60,1,this.framerate,1,this.framerateChanged,this)),t}},{key:"getLocalBoundsElecs",value:function(){return[this.bg]}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function b(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:b(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(449),p=o(d),y=void 0,f=void 0,g=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.shape.Polygon,g=y.geom.Vec2,i.classType="WoodPad",i.level=11,i.longB=null,i.angL=0,i.pivotJoint=null,i.ticker=null,i.beginFunc=null,i.endFunc=null,i.mat=null,i}return a(e,t),r(e,[{key:"init",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.get_shapes().clear();var t=[{x:-53,y:-14},{x:-53,y:43},{x:44,y:43},{x:44,y:-14}];this.mat=new y.phys.Material(.5,1,2,.7),this.BodyUtil.createPolygonFromPoints(t,this.body,this.mat),this.body.noallowRotation=!0,this.body.userData.handJointFrequency=20;var i=new y.phys.Material(.5,1,2,.3),o=new f(f.box(82,35),i);this.body.add(o),o.set_sensorEnabled(!0),o.translate(g.get(0,-30)),this.initListener()}},{key:"removed",value:function(){this.disposeListener(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"setComponent",value:function(){var t=0>=arguments.length||arguments[0]===undefined||arguments[0];this.noRenderSelected=!0,this.iscomponent=t,t&&this.disposeListener()}},{key:"disposeListener",value:function(){this.removeEventListener(p["default"].BEGIN,this.beginFunc),this.removeEventListener(p["default"].END,this.endFunc)}},{key:"initListener",value:function(){var t=this;this.beginFunc=function(e){t.beginhandler(e)},this.endFunc=function(e){t.engHandler(e)},this.addEventListener(p["default"].BEGIN,this.beginFunc),this.addEventListener(p["default"].END,this.endFunc)}},{key:"beginhandler",value:function(t){this.BodyUtil.setBodyMaterial(this.body,{dynamicFriction:0,staticFriction:0});var e=this.body.arbiters;this.longB=null;var i=e.get_length(),o=void 0;for(o=0;i>o;o++){var n=this.BodyUtil.getBodyFromAbter(e.at(o)),s=n[0].userData.view,a=n[1].userData.view,r=void 0;if("PulleyLongBoard"===s.classType&&(r=s),"PulleyLongBoard"===a.classType&&(r=a),r){var h=this.body.get_position(),u=r.body.get_position();if(h.get_y()<u.get_y())return;this.longB=r;try{r.changelock({checked:!1})}catch(p){}var c=this.findDesk(r);if(c){var d=void 0;return d=c.body.posx>this.body.posx?c.rightPi():c.leftPi(),this.angL=r.body.rotation,this.pivotJoint=this.JointUtil.createPivotJoint(r.body,c.body,d,d),void(this.ticker=l.M.addTicker(this.enterframe,this))}}}}},{key:"enterframe",value:function(){if(this.longB){var t=this.body.get_position(),e=this.longB.body.get_position();if(t.get_y()<e.get_y())return void this.engHandler(null);this.angL>0?this.longB.rotation>0||this.engHandler(null):0>this.longB.rotation||this.engHandler(null)}}},{key:"findDesk",value:function(t){var e=t.body.arbiters,i=e.zpp_gl(),o=void 0;for(o=0;i>o;o++){var n=this.BodyUtil.getBodyFromAbter(e.at(o)),s=n[0].userData.view;if("PulleyLongBoard"==s.classType&&(s=n[1].userData.view),s&&"NbDesk"==s.classType)return s}return null}},{key:"engHandler",value:function(t){this.BodyUtil.setBodyMaterial(this.body,{dynamicFriction:18,staticFriction:20}),this.longB=null,this.pivotJoint&&(this.BodyUtil.destoryJoint(this.pivotJoint),this.pivotJoint=null),l.M.removeTicker(this.ticker)}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function _(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:_(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(507),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0,v=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.geom.Vec2,g=y.shape.Polygon,b=y.phys.BodyType,v=y.phys.Material,i.caizhi=0,i.mcxs=[.4,.2,.6,1],i.czi=[i.getLocaleStr("none","无"),i.getLocaleStr("glass","玻璃"),i.getLocaleStr("cotton","棉布"),i.getLocaleStr("towel","毛巾")],i.divisionValueArr=["1mm","5mm","1cm"],i.divisionIndex=0,i.level=14,i.firstLine=null,i.secondLine=null,i.txtLine=null,i.firstConBody=null,i.flag=0,i.startD=-271,i.txtW_=130,i.txt=null,i.deflong=1500,i.curtlong=1500,i.isOpenTrack=!1,i.floorshape=null,i.shapeStartX=null,i.prevscale=1,i.xplong=0,i.curtf=i.mcxs[0],i.horizantalMaterial=new y.phys.Material(0,.5,.5,.6,.5),i.kd=new p["default"](i.paramObj),i}return a(e,t),r(e,[{key:"removed",value:function(){this.kd.removed(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"init",value:function(){this.points=[{x:-271,y:30},{x:-566,y:-61},{x:-755,y:-61},{x:-755,y:94},{x:-271,y:94}],this.material=v.wood(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_allowRotation(!1),this.body.userData.cannotToolRot=!0,this.shapeStartX=-271,this.floorshape=new g(g.rect(this.shapeStartX,30,1021,64),this.horizantalMaterial),this.xplong=this.deflong-1021,this.body.add(this.floorshape),this.firstLine=new PIXI.Graphics,this.addChild(this.firstLine),this.secondLine=new PIXI.Graphics,this.addChild(this.secondLine),this.firstLine.visible=this.secondLine.visible=!1,this.firstLine.lineStyle(3,65280),this.secondLine.lineStyle(3,16711680),l.M.drawDashed(this.firstLine,new l.Point(0,80),new l.Point(0,-200),10,5),l.M.drawDashed(this.secondLine,new l.Point(0,80),new l.Point(0,-200),10,5),this.txtLine=new PIXI.Graphics,this.addChild(this.txtLine),this.txt=new PIXI.Text("",{font:"25px Arial",fill:16777215,align:"center"}),this.addChild(this.txt),this.txt.y=60,this.initMaterial(),this.initBoardLong(),this.changeCaizhi(!1)}},{key:"initMaterial",value:function(){this.glass.removeChildren(),this.cotton.removeChildren(),this.towel.removeChildren(),this.glassmd=new PIXI.mesh.NineSlicePlane(PIXI.Texture.fromFrame("WoodSlopesPlane/boli"),15,15,15,15),this.glass.addChild(this.glassmd),this.cottonmd=new PIXI.mesh.NineSlicePlane(PIXI.Texture.fromFrame("WoodSlopesPlane/mianbu"),15,15,15,15),this.cotton.addChild(this.cottonmd),this.towelmd=new PIXI.mesh.NineSlicePlane(PIXI.Texture.fromFrame("WoodSlopesPlane/maojin"),15,15,15,15),this.towel.addChild(this.towelmd)}},{key:"initBoardLong",value:function(){this.bg.middle.removeChildren(),this.middleBoard=new PIXI.mesh.NineSlicePlane(PIXI.Texture.fromFrame("WoodSlopesPlane/board_body"),15,15,15,15),this.bg.middle.addChild(this.middleBoard),this.bg.addChild(this.kd),this.kd.x=this.bg.middle.x-24.5,this.kd.y=this.bg.left.y+.5*this.bg.left.height-25,this.changBoardLong({showValue:"50"})}},{key:"update",value:function(){var t=this;if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.isOpenTrack){var i=this.BodyUtil.getAllCollisionBodys(this.body),o=0;for(o=0;i.length>o;o++)i[o].isDynamic()?i[o].userData.originKinematicType&&(i.splice(o,1),o--):(i.splice(o,1),o--);var n=[];for(o=0;i.length>o;o++){var s=i[o];if(s.userData&&s.userData.view&&s.userData.iswall)return;n.push(s)}if(this.flag>0&&n.length>0&&(clearTimeout(this.flag),this.flag=0),n.length>0){var a=!1;if(this.getEngineTouchManager().getCurrentToolStatus()==this.ToolStatusStr.DRAG){var r=this.BodyUtil.getHandDragBodyFromArbiter(this.body);if(r){var u=r.connectedBodies();u.add(r);var c=void 0,d=u.get_length();for(c=0;d>c;c++){var p=u.at(c);if(l.ArrayUtil.arrayContainsValue(n,p)){this.firstConBody=r,a=!0;break}}}}if(this.firstConBody||(a=!0,this.firstConBody=n[0]),a){var y=this.getLinkBodysX(this.firstConBody);this.startD>y?this.firstLine.x=this.startD:(this.firstLine.visible=!0,this.firstLine.x=y)}}if(this.firstConBody){var f=this.getLinkBodysX(this.firstConBody);this.firstLine.visible?(this.secondLine.visible=!0,this.secondLine.x=f):this.startD>f||(this.firstLine.visible=!0,this.secondLine.visible=!0,this.secondLine.x=f)}0==n.length&&0==this.flag&&this.firstConBody&&(this.flag=setTimeout(function(){t.hadDestory||(t.firstConBody=null,t.firstLine.visible=!1,t.secondLine.visible=!1,t.txt.visible=!1,t.txtLine.visible=!1,t.flag=0)},200)),this.firstLine.visible&&this.secondLine.visible&&(this.txt.visible=!0,this.txtLine.visible=!0,this.txt.text=Math.abs(Math.round((this.secondLine.x-this.firstLine.x)/this.NapeConst.SCALE_SPACE))+"mm",this.txt.x=(this.firstLine.x+this.secondLine.x)/2-50,this.txtLine.clear(),Math.abs(this.firstLine.x-this.secondLine.x)>100&&(this.txtLine.lineStyle(2,16777215),this.secondLine.x>this.firstLine.x?(this.txtLine.moveTo(this.firstLine.x+1,60),this.txtLine.lineTo(this.txt.x,60),this.txtLine.moveTo(this.txt.x+this.txtW_,60),this.txtLine.lineTo(this.secondLine.x,60)):(this.txtLine.moveTo(this.secondLine.x+1,60),this.txtLine.lineTo(this.txt.x,60),this.txtLine.moveTo(this.txt.x+this.txtW_,60),this.txtLine.lineTo(this.firstLine.x,60))))}}},{key:"getLinkBodysX",value:function(t){if(!t)return 0;var e=t.connectedBodies();e.add(t);var i=-1e4;return e.foreach(function(t){i=Math.max(i,t.posx+t.bounds.get_width()/2)}),i=this.body.worldPointToLocal(new f(i,0)).get_x()}},{key:"changeCaizhi",value:function(){var t=0>=arguments.length||arguments[0]===undefined||arguments[0];this.glass.visible=this.cotton.visible=this.towel.visible=!1,0==this.caizhi||(1==this.caizhi?this.glass.visible=!0:2==this.caizhi?this.cotton.visible=!0:3==this.caizhi&&(this.towel.visible=!0)),this.curtf=this.mcxs[this.caizhi],this.setFriction(),t&&this.freshLibPan()}},{key:"setFriction",value:function(){var t=2*this.curtf;this.BodyUtil.setMaterial(this.horizantalMaterial,"dynamicFriction",t),this.BodyUtil.setMaterial(this.horizantalMaterial,"staticFriction",t),this.BodyUtil.setMaterial(this.horizantalMaterial,"rollingFriction",this.curtf)}},{key:"switchCaizhi",value:function(t){var e=1>=arguments.length||arguments[1]===undefined||arguments[1];this.caizhi=this.czi.indexOf(t.showValue),this.changeCaizhi(e)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.cz=this.caizhi,t.f=this.curtf,t.track=this.isOpenTrack,t.lock=this.equlock,t["long"]=this.getlong(),t.divisionIndex=this.divisionIndex,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.cz!==this.caizhi&&this.switchCaizhi({showValue:this.czi[t.cz]},!1),this.changef({showValue:t.f}),t.track&&this.changeOpenTrack({checked:!0}),!0===t.lock&&this.changelock({checked:!0}),isNaN(t["long"])||this.changBoardLong({showValue:t["long"]}),isNaN(t.divisionIndex)||(this.divisionIndex=t.divisionIndex,this.kd.changeLongBoardDivision(this.divisionValueArr[this.divisionIndex]))}},{key:"changef",value:function(t){this.curtf=l.M.getNumStr(t.showValue)-0,this.setFriction()}},{key:"changeOpenTrack",value:function(t){(this.isOpenTrack=t.checked)||this.lineComp()}},{key:"lineComp",value:function(){this.firstConBody=null,this.firstLine.visible=!1,this.secondLine.visible=!1,this.txt.visible=!1,this.txtLine.visible=!1,this.flag=0}},{key:"changelock",value:function(t){this.equlock=t.checked,this.equlock?(this.body.set_type(b.get_KINEMATIC()),this.BodyUtil.frezzBody(this.body)):this.body.set_type(b.get_DYNAMIC())}},{key:"changBoardLong",value:function(t){var e=l.M.getNumStr(t.showValue)-0;this.curtlong=e*this.NapeConst.SCALE_SPACE*10+5,this.refreshMiddle();var i=this.floorshape.get_localCOM(),o=this.floorshape.get_bounds(),n=new g(g.box(this.curtlong,o.get_height()),this.horizantalMaterial);this.body.add(n),this.body.remove(this.floorshape),this.floorshape=n,o=n.get_bounds(),this.floorshape.set_localCOM(f.get(this.shapeStartX+.5*o.get_width(),i.get_y())),this.kd.initLongBoard(e),this.curtlong-=5}},{key:"refreshMiddle",value:function(){var t=this.curtlong;this.middleBoard.width=t,this.glassmd.width=t,this.towelmd.width=t,this.cottonmd.width=t}},{key:"getlong",value:function(){return l.M.getNumJie(.1*Math.abs(this.curtlong)/this.NapeConst.SCALE_SPACE,0)-0}},{key:"selectRenderChild",value:function(){return this.updateTransform(),this.getBounds()}},{key:"changeDivision",value:function(t){var e=t.showValue;this.divisionIndex=this.divisionValueArr.indexOf(e),this.kd.changeLongBoardDivision(e)}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.getScrollBar([this.getLocaleStr("roughness","粗糙程度"),!0,"",1,0,this.curtf,.1,this.changef,this]),this.getScrollBar([this.getLocaleStr("length","长度"),!0,"cm",100,40,this.getlong(),5,this.changBoardLong,this]),this.getDropMenu([this.getLocaleStr("dividing_value","分度值"),!1,"",this.divisionValueArr[this.divisionIndex],this.divisionValueArr,this,this.changeDivision,0,0]),this.getDropMenu([this.getLocaleStr("material","材质"),!1,"",this.czi[this.caizhi],this.czi,this,this.switchCaizhi,1,0]),this.getSwitch([this.getLocaleStr("track","轨迹"),this.isOpenTrack,this.changeOpenTrack,this]),this.getSwitch([this.getLocaleStr("lock","锁定"),this.equlock,this.changelock,this])),t}},{key:"getTipMess",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return t+="\n    "+this.getLocaleStr("roughness","粗糙程度")+": "+this.curtf+"\n    "+this.getLocaleStr("length","长度")+": "+this.getlong()+"cm\n    "+this.getLocaleStr("dividing_value","分度值")+": "+this.divisionValueArr[this.divisionIndex]+"cm\n    "}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(672),h=function(t){return t&&t.__esModule?t:{"default":t}}(r);e["default"]=function(t){function e(){o(this,e);var t=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.M=10,t}return s(e,t),a(e,[{key:"getPhi",value:function(t,e){var i=this.toLocal(t,e),o=Math.sqrt(i.x*i.x+i.y*i.y);return-this.M*i.y/(o*o)}},{key:"getPsi",value:function(t,e){var i=this.toLocal(t,e),o=Math.sqrt(i.x*i.x+i.y*i.y);return this.M*i.x/(o*o)}},{key:"getV",value:function(t,e){var i=this.toLocal(t,e),o=i.x*i.x+i.y*i.y,n=2*Math.atan2(i.y,i.x);return this.deltaToGlobal(-this.M*Math.cos(n)/o,-this.M*Math.sin(n)/o)}}]),e}(h["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(672),h=function(t){return t&&t.__esModule?t:{"default":t}}(r);e["default"]=function(t){function e(){o(this,e);var t=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Q=10,t}return s(e,t),a(e,[{key:"getPhi",value:function(t,e){var i=this.toLocal(t,e);return Math.atan2(i.y,i.x)*this.Q/(2*Math.PI)}},{key:"getPsi",value:function(t,e){var i=this.toLocal(t,e),o=Math.sqrt(i.x*i.x+i.y*i.y);return Math.log(o)*this.Q/(2*Math.PI)}},{key:"getV",value:function(t,e){var i=this.toLocal(t,e),o=Math.sqrt(i.x*i.x+i.y*i.y),n=this.Q/(2*Math.PI*o);return new PIXI.Point(n*i.x/o,n*i.y/o)}}]),e}(h["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function g(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:g(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0,y=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.geom.Vec2,p=c.phys.BodyType,y=c.shape.Polygon,i.tuo=null,i.level=14,i.modelIndex=0,i.modelArr=["台秤","电子称"],i.k=i.NapeConst.k5n,i.off_fc=0,i.oldRot=0,i.tempArr=[],i.isupdate=!1,i.lcIndex=0,i.txtColor=16777215,i.prevMass=0,i.txt=new PIXI.Text("0N\n0g",{font:"25px Arial",fill:i.txtColor}),i.plShape=null,i.elShape=null,i.elIsMass=!0,i.qpvalue=0,i.rdqu=!1,i}return s(e,t),a(e,[{key:"init",value:function(){this._width=this.bg.width,this._height=this.bg.height,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.addChild(this.txt),this.txt.x=this.bg.width/2+15,this.txt.y=-this.bg.height/2,this.body.allowRotation=!1,this.body.set_type(p.get_KINEMATIC()),this.body.sensorEnabled(!0),this.plShape=this.body.get_shapes().at(0),this.tuo=new f(this.paramObj),this.parent.addChildAt(this.tuo,0),this.tuo.init(),this.tuo.body.posx=this.x+this.tuopan.x,this.tuo.body.posy=this.y+this.tuopan.y,this.tuopan.x=0,this.tuopan.y=0,this.tuo.addChild(this.tuopan),this.createJoint(),this.freshEquipShows(this.globalConfig.SHOWEQUVALUE),this.freshTxtColor(),this.modelChange({showValue:this.modelArr[this.modelIndex]}),this.initElBanlance()}},{key:"initElBanlance",value:function(){var t=this;this.swTouchId=h.M.addTouch(this.electron.mswitch,{tab:function(){t.switchMassAndForce()}}),this.switchMassAndForce(1),this.qpTouchId=h.M.addTouch(this.electron.exceptPi,{tab:function(){t.rdqu=!0}}),this.tlTouchId=h.M.addTouch(this.electron.tZero,{tab:function(){t.qpvalue=0,t.rdqu=!1}})}},{key:"switchMassAndForce",value:function(){this.elIsMass=arguments.length>0||!this.elIsMass,this.elIsMass?(this.electron.mswitch.currentFrame=1,this.electron.mdeng.currentFrame=1,this.electron.fdeng.currentFrame=0,this.electron.un.currentFrame=1):(this.electron.fdeng.currentFrame=1,this.electron.mdeng.currentFrame=0,this.electron.mswitch.currentFrame=0,this.electron.un.currentFrame=0)}},{key:"createJoint",value:function(){var t=this.body.posy-this.tuo.weldVec().get_y();this.spring=this.JointUtil.createDistanceJoint(this.body,this.tuo.body,this.body.position,this.tuo.weldVec(),t,t),this.spring.stiff=!0,this.spring.frequency=30,this.spring.damping=.5;var e=d.get(this.tuo.body.posx,this.tuo.body.posy+10),i=d.get(this.tuo.body.posx,this.tuo.body.posy);this.JointUtil.createLineJoint(this.body,this.tuo.body,e,i,i.sub(e),0,10)}},{key:"backgroundColorChange",value:function(t){this.txtColor=t,this.txt&&(this.txt.style.fill=t,this.txt.updateText())}},{key:"showElecValue",value:function(t,e){var i=0;i=this.elIsMass?t+"":e+"";var o=0;for(o=0;5>o;o++)this.electron["n"+o].currentFrame=10;if(this.electron.dot.visible=!1,0==t)return void(this.electron.n0.currentFrame=0);var n=i.split("");n=n.reverse();var s=n.indexOf(".");for(n.splice(s,1),s--,o=0;n.length>o&&this.electron["n"+o];o++){if("-"==n[o]){this.electron["n"+o].currentFrame=11;break}this.electron["n"+o].currentFrame=parseInt(n[o])}if(s>=0){this.electron.dot.visible=!0;this.electron.dot.x=this.electron["n"+s].x-15}}},{key:"update",value:function(){var t=this;r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this);var i=this.spring.impulse(),o=this.getGravity(),n=o*this.off_fc/this.NapeConst.EARTH_GRAVITY,s=i.x(0,0)-n;0>s&&(s=0);var a=s*this.k;this.rdqu&&(this.qpvalue=a,this.rdqu=!1),a-=this.qpvalue;var l=void 0,u=void 0;0==this.pan.currentFrame?(l=a/1e3,u="1000g\n"+h.M.getNumJie(this.jsrmg(1e3,o),2)+"N"):(l=a/200,u="200g\n"+h.M.getNumJie(this.jsrmg(200,o),2)+"N");var c=!1;if(l>1&&(l=1,c=!0),a>this.prevMass)return void(this.prevMass=a);var d=this.jsrmg(a,o);if(0==this.modelIndex){var p=2*l*Math.PI;this.tempArr.push(p),this.tempArr.length>5&&this.tempArr.shift(),this.prevMass=a,TweenMax.killTweensOf(this.zhen),c?(this.zhen.rotation=359.99*Math.PI/180,this.txt.text=u):this.txt.text=h.M.getNumJie(a,1)+"g\n"+h.M.getNumJie(d,2)+"N";var y=0>this.zhen.rotation?2*Math.PI+this.zhen.rotation:this.zhen.rotation,f={value:y};if(y===p)return;TweenMax.to(f,.2,{value:p,onUpdate:function(){t.hadDestory?TweenMax.killTweensOf(f):t.zhen.rotation=f.value}})}else this.showElecValue(h.M.getNumJie(a,1),h.M.getNumJie(d,2))}},{key:"jsrmg",value:function(t,e){var i=t*e;return.001*(0==e?0:9.8*i/e)}},{key:"getLiangCheng",value:function(){return 0==this.lcIndex?"1000g":"200g"}},{key:"changeLiang",value:function(t){var e=t.showValue;"1000g"==e?(this.lcIndex=0,this.pan.gotoAndStop(0)):"200g"==e&&(this.lcIndex=1,this.pan.gotoAndStop(1))}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.lc=this.getLiangCheng(),t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.changeLiang({showValue:t.lc})}},{key:"changeRange",value:function(t){this.lcIndex=t.checked,this.pan.gotoAndStop(this.lcIndex)}},{key:"modelChange",value:function(t){this.modelIndex=this.modelArr.indexOf(t.showValue);var e=!1;this.elShape||(this.elShape=new y(y.box(550,115)),this.elShape.set_sensorEnabled(!0),this.elShape.set_localCOM(d.get(0,-190)));var i=this.body.get_shapes();0==this.modelIndex?(e=!0,i.add(this.plShape),i.remove(this.elShape),this.qpvalue=0,this.rdqu=!1):(e=!1,i.remove(this.plShape),i.add(this.elShape)),this.tuopan.visible=e,this.zhen.visible=e,this.pan.visible=e,this.txt.visible=e,this.bg.visible=e,this.electron.visible=!e,this.freshLibPan()}},{key:"getConf",value:function(){var t={};if(t.confArr=[],t.confArr.push(this.getDropMenu([this.getLocaleStr("model","模型"),!1,"",this.modelArr[this.modelIndex],this.modelArr,this,this.modelChange])),0==this.modelIndex){var e=["1000g","200g"];t.confArr.push(this.getRadio([this.getLocaleStr("range","量程"),this.lcIndex,e,this.changeRange]))}return t}},{key:"freshEquipShows",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"freshEquipShows",this).call(this,t),this.txt.visible=t}},{key:"removed",value:function(){h.M.removeTouch(this.electron.mswitch,this.swTouchId),h.M.removeTouch(this.electron.exceptPi,this.qpTouchId),h.M.removeTouch(this.electron.tZero,this.tlTouchId),this.tuo.removed(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"getLocalBoundsElecs",value:function(){return 0==this.modelIndex?[this.bg,this.tuopan]:[this.electron]}},{key:"getTipMess",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getTipMess",this).call(this);return 0==this.modelIndex&&(t+="\n      "+this.getLocaleStr("range","量程 ")+": "+["1000g","200g"][this.lcIndex]+"\n      "),t}}]),e}(u["default"]);var f=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.material=new c.phys.Material(0,.5,.6,2.7,.001),i._width=530,i._height=33,i}return s(e,t),a(e,[{key:"removed",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.noDrag=!0,this.body.noallowRotation=!0,this.body.shapesAt(0).set_localCOM(d.get(0,-176.5)),this.body.set_gravMass(0)}},{key:"weldVec",value:function(){return d.get(this.body.posx,this.body.posy-193+16.5)}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function c(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:c(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(673),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.datalength=0,i.haveWeight=!1,i.speedisFast=!1,i}return s(e,t),a(e,[{key:"init",value:function(t){var i=this;r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this,t),this.startBtn.tab=function(){i.initComplete&&i.setSpeed(i.speedisFast?{showValue:2}:{showValue:1})}}},{key:"initWeightBox",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initWeightBox",this).call(this,t),this.weight&&!this.weight.hadDestory&&this.removeFromFramework(this.weight),this.weight=null}},{key:"addTable",value:function(t){var e=this,i={data:{col:5,row:7}},o=setTimeout(function(){o&&t&&t()},2e3);this.boardStr=this.language.getLocaleStr("board"),this.glassStr=this.language.getLocaleStr("glass"),this.cottonStr=this.language.getLocaleStr("cotton"),this.towelStr=this.language.getLocaleStr("towel"),this.noneStr=this.language.getLocaleStr("none"),this.haveStr=this.language.getLocaleStr("have"),this.frontStr=this.language.getLocaleStr("front"),this.flankStr=this.language.getLocaleStr("flank");var n=[[this.boardStr,this.noneStr,"正面","慢",""],[this.glassStr,this.noneStr,"正面","慢",""],[this.cottonStr,this.noneStr,"正面","慢",""],[this.towelStr,this.noneStr,"正面","慢",""],[this.boardStr,this.haveStr,"正面","慢",""],[this.boardStr,this.noneStr,"侧面","慢",""],[this.boardStr,this.noneStr,"正面","快",""]];this.globalConfig.main.addTable(i,function(i){clearTimeout(o),o=null,e.seComp=i,e.table=i.table,i.allowSave=!1,i.setTableData({heads:["接触面材质","砝码","接触面","拉动速度","摩擦力f/N"]});for(var s=0;n.length>s;s++)i.setTableData({row:{index:s,data:n[s]}});i.setLineData([{x:0,y:2,linkType:3,ifTr:!0}]),t&&t()})}},{key:"tensionMove",value:function(t){if(t>400){this.tension.speed=0,this.BodyUtil.frezzBody(this.wood.body);this.fillTableData({df:this.tension.force})}}},{key:"getcurrentType",value:function(){return("无"==this.board.currentMatrial?"木板":this.board.currentMatrial)+(1==this.haveWeight?"有":"无")+(0==this.getWoodFace()?"正面":"侧面")+(this.speedisFast?"快":"慢")}},{key:"fillTableData",value:function(t){var e=["木板无正面慢","玻璃无正面慢","棉布无正面慢","毛巾无正面慢","木板有正面慢","木板无侧面慢","木板无正面快"],i=this.getcurrentType(),o=e.indexOf(i);if(-1!=o){this.seComp.setTableData({cell:{row:o,col:4,value:h.M.getNumJie(t.df,2)}})}}},{key:"getWoodFace",value:function(){return this.wood.dirBoo?0:1}},{key:"woodFaceChange",value:function(t,e){var i=this;if(!this.onces||e){this.onces=setTimeout(function(){clearTimeout(i.onces),i.onces=null},100),this.wood.hock.dragToolClick();var o=0==t.checked;this.wood.func_changeAngle({checked:o}),this.wood.body.set_rotation(o?0:Math.PI/2),this.wood.addWeight(this.wood.b200.visible),this.resetBtn.tab()}}},{key:"resetTensionPosition",value:function(){if(this.lineJoint&&this.lineJoint.set_active(!1),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"resetTensionPosition",this).call(this),this.lineJoint){this.lineJoint.set_anchor1(this.nbdesk.body.worldPointToLocal(this.tension.body.get_position())),this.lineJoint.set_active(!0)}}},{key:"setSpeed",value:function(t){this.tension.setSpeed(t)}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return this.wood&&(t.face=this.getWoodFace(),t.haveweight=this.haveWeight),t}},{key:"completeSetData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"completeSetData",this).call(this,t),t.face!=this.getWoodFace()&&this.woodFaceChange({checked:t.face},!0),t.haveweight&&this.changePutWeight({checked:!0})}},{key:"changePutWeight",value:function(t){this.haveWeight=t.checked,this.wood.addWeight(t.checked)}},{key:"changelaSpeed",value:function(t){this.speedisFast=0!==t.checked}},{key:"selectRenderChild",value:function(){return this.nbdesk?this.nbdesk.bg.getBounds():this.getBounds()}},{key:"getConf",value:function(){var t={};t.confArr=[];var e=[this.language.getLocaleStr("front"),this.language.getLocaleStr("flank")],i=[this.language.getLocaleStr("slow"),this.language.getLocaleStr("fast")];return t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("roughness"),!0,"",1,0,this.board.curtf,.1,this.changef,this),this.ComponentProperty.getDropMenu(this.language.getLocaleStr("material"),!1,"",this.board.currentMatrial,this.board.czi,this,this.switchCaizhi,1,0),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("move_speed"),!0,"",4,0,this.tension.speed,1,this.setSpeed,this),this.ComponentProperty.getRadio(this.language.getLocaleStr("interface"),this.getWoodFace(),e,this.woodFaceChange,this),this.ComponentProperty.getRadio(this.language.getLocaleStr("pull_speed"),this.laspeed,i,this.changelaSpeed,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("farmar"),this.haveWeight,this.changePutWeight,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("auto_entry"),this.saveTable,this.changeSaveTable,this)),t}},{key:"laspeed",get:function(){return 1==this.speedisFast?1:0}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(675),c=o(u),d=i(513),p=o(d);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.hockMc=null,i}return a(e,t),r(e,[{key:"init",value:function(t){var i=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this,t),this.resetBtn.tab=function(){if(i.initComplete){if(i.ticker.powerOpen&&i.ticker.powerClick(),i.ticker.paper.useing){var t=i.ticker.paper.hock.get_userData().bind.get_body().userData.view;t instanceof p["default"]&&t.topHock.dragToolClick()}i.ticker.setPaperDefPos(),i.resetHock(i.hockMc)}}}},{key:"initHock",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initHock",this).call(this,t),this.hockMc=t}},{key:"addTable",value:function(t){var e=this;this.globalConfig.main.addTable({data:{col:4,row:5}},function(i){e.seComp=i,e.table=i.table,i.allowSave=!1,i.setTableData({heads:[e.language.getLocaleStr("position"),"t/s","v1(m/s)","v2(m/s)","v3(m/s)"]}),i.setLineData([{x:1,y:2,linkType:3,ifTr:!0}]),t&&t()})}},{key:"fillTableData",value:function(t){if(3>=this.datalength){var e=t.velocity,i=0;if(0==this.datalength)for(i=1;6>i;i++){var o=i-1;this.seComp.setTableData({cell:{row:i-1,col:0,value:o+1}});var n=.02*o+.02;this.seComp.setTableData({cell:{row:i-1,col:1,value:5*n}})}for(i=1;6>i;i++){var s=.01*e[i-1]+.01-.02*Math.random();this.seComp.setTableData({cell:{row:i-1,col:this.datalength+2,value:l.M.getNumJie(s,2)}})}}}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getSwitch(this.language.getLocaleStr("auto_entry"),this.saveTable,this.changeSaveTable,this)),t}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(674),c=o(u),d=i(454),p=o(d);e["default"]=function(t){function e(t){return n(this,e),s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return a(e,t),r(e,[{key:"addTable1",value:function(t){var e=this;this.globalConfig.main.addTable({data:{col:5,row:5}},function(i){e.seComp=i,e.table=i.table,i.allowSave=!1,i.setTableData({heads:[e.language.getLocaleStr("position"),"△x/m","△t/s","t/s","v(m/s)"]}),i.setLineData([{x:3,y:4,linkType:3,ifTr:!0}]),t&&t()})}},{key:"addTable2",value:function(t){var e=this;this.globalConfig.main.addTable({data:{col:5,row:5}},function(i){e.seComp2=i,e.table2=i.table,i.allowSave=!1,i.setTableData({heads:[e.language.getLocaleStr("position"),"t/s","v1(m/s)","v2(m/s)","v3(m/s)"]}),i.setLineData([{x:1,y:2,linkType:3,ifTr:!0}]),t&&t()})}},{key:"fillTableData",value:function(t){var e=t.velocity,i=t.displacement,o=Math.floor(.7*i.length);i.length>o+2||(o=i.length-3),this.seComp.setTableData({row:{index:this.datalength,data:[o+1,l.M.getNumJie(.01*(i[o+2]-i[o]),2),.2,l.M.getNumJie(5*(o+1)*.02,2),l.M.getNumJie(.01*e[o+1],2)]}})}},{key:"fillTableData2",value:function(t){if(3>=this.datalength2){var e=t.velocity,i=1;if(0==this.datalength2)for(i;6>i;i++){var o=i-1;this.seComp2.setTableData({cell:{row:i-1,col:0,value:o+1}});var n=.02*o+.02;this.seComp2.setTableData({cell:{row:i-1,col:1,value:5*n}})}for(i=1;6>i;i++){this.seComp2.setTableData({cell:{row:i-1,col:this.datalength2+2,value:l.M.getNumJie(.01*e[i-1],2)}})}}}},{key:"initTicker",value:function(t){var i=this;this.tickerGetPaperfunc=function(t){var e=t;e.leftBiaoOff=300,e.rightBiaoOff=500,i.getOnePaperDataFunc=function(t){e.paperMenuChange(i.language.getLocaleStr("speed")),e.paperMenuChange(i.language.getLocaleStr("pos_shift")),e.removeEventListener(p["default"].CAN_GET_SPEEDDATA,i.getOnePaperDataFunc),0==i.imgIndex?(i.fillTableData(t),i.datalength++):(i.fillTableData2(t),i.datalength2++)},e.addEventListener(p["default"].CAN_GET_SPEEDDATA,i.getOnePaperDataFunc)},h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initTicker",this).call(this,t)}},{key:"getConf",value:function(){var t={};if(t.confArr=[],t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("roughness"),!0,"",1,0,this.getboardFri(),.1,this.changeFri,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("car_mass"),!0,"",500,100,this.car.getThisMass(),50,this.changeCarMass,this),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("hock_mass"),!0,"",100,10,this.curtHockMass,10,this.changeHockMass,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("auto_entry"),this.saveTable,this.changeSaveTable,this)),this.saveTable){var e=[this.language.getLocaleStr("table")+1,this.language.getLocaleStr("table")+2];t.confArr.push(this.ComponentProperty.getRadio(this.language.getLocaleStr("image"),this.imgIndex,e,this.imgChange,this))}return this.haveWood?t.confArr.push(this.ComponentProperty.getSwitch(this.language.getLocaleStr("hidden_wood"),!1,this.hideWood,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("leveling"),this.onekeyph,this.changePingHeng,this)):t.confArr.push(this.ComponentProperty.getSwitch(this.language.getLocaleStr("hidden_wood"),!0,this.hideWood,this)),t}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(506),c=o(u),d=i(515),p=o(d);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.table=null,i.furred=null,i.spring=null,i.tension=null,i.springview=null,i.compo=null,i.saveTable=!0,i.lineJoint=null,i.datalength=0,i.flagline=new PIXI.Graphics,i.springline=new PIXI.Graphics,i.lenline=new PIXI.Graphics,i.preSetData=null,i.zeroX=0,i.flagK=17.83,i.k=30,i.lineColor=16777215,i.txt=new PIXI.Text("",{font:"26px Arial",fill:i.lineColor}),i}return a(e,t),r(e,[{key:"init",value:function(t){var e=this;this.startBtn.fontColor="#ffffff",this.startBtn.text=this.language.getLocaleStr("record"),this.resetBtn.fontColor="#ffffff",this.resetBtn.text=this.language.getLocaleStr("reset"),this.startBtn["this"]=this,this.startBtn.x=this.resetBtn.x=-150,this.addChild(this.flagline),this.addChild(this.springline),this.addChild(this.lenline),this.addChild(this.txt),this.startBtn.tab=function(){e.initComplete&&e.fillTableData({force:e.tension.textValue,dis:l.M.getNumStr(e.txt.text)})},this.resetBtn["this"]=this,this.resetBtn.tab=function(){e.initComplete&&(e.tension.headPj.set_active(!1),e.tension.body.get_position().set_x(e.furred.body.get_position().get_x()+500),e.tension.refreshHeadPJ(),e.tension.headPj.set_active(!0))},this.addTable(t),this.addCursor(this.startBtn,"hand"),this.addCursor(this.resetBtn,"hand")}},{key:"fillTableData",value:function(t){this.seComp.setTableData({row:{index:this.datalength,data:[t.dis,t.force]}}),this.datalength++}},{key:"addTable",value:function(t){var e=this,i=setTimeout(function(){i&&t&&t()},2e3);this.globalConfig.main.addTable({data:{col:2,row:5}},function(o){clearTimeout(i),i=null,e.seComp=o,e.table=o.table,o.allowSave=!1,o.setTableData({heads:[e.language.getLocaleStr("elongation")+" △x/cm",e.language.getLocaleStr("pull_force")+"F/N"]}),o.setLineData([{x:0,y:1,linkType:3,ifTr:!0}]),t&&t()})}},{key:"addOthers",value:function(){var t=this.dependEquipments;this.getMain().view.updateTransform(),this.initFurred(t[0]),this.initTension(t[1]),this.initSpring(),this.limitTension(),this.preSetData?this.completeSetData(this.preSetData):this.changeNM({showValue:"100N/m"}),this.initComplete=!0}},{key:"initFurred",value:function(t){this.furred=t,this.furred.getConfJumpTarget=this,this.furred.changDir({showValue:this.language.getLocaleStr("to_right")}),this.furred.setComponent(),this.furred.body.userData.moveCompo=!0,this.furred.body.userData.dragTomoveTool=!0,this.furred.removeHockCbtype()}},{key:"initTension",value:function(t){var e=this;this.tension=t,this.tension.setComponent(!0),this.tension.getConfJumpTarget=this,this.tension.lockDirChange({showValue:this.language.getLocaleStr("horizontal_to_left")}),this.tension.revertTiaoLing(null),this.tension.body.userData.handJointFrequency=100,this.tension.body.userData.allowMove=!1,this.tension.setRange({showValue:"20N"}),this.tension.removeHockCbtype(),this.furred.translateMove=function(t,i){e.tension.translateMove(t,i)},this.compo=this.tension.compo,this.furred.body.set_compound(this.compo)}},{key:"initSpring",value:function(){var t=this.furred.body,e=this.tension.springHock.body,i=this.furred.gethockPosition(),o=e.get_position();this.spring=this.JointUtil.createDistanceJoint(t,e,i,o,0,Math.abs(o.get_x()-i.get_x())),this.spring.set_stiff(!1),this.spring.set_damping(0),this.spring.set_frequency(this.k),this.springview=new p["default"](this.paramObj),this.springview.joint=this.spring,this.springview.count=23,this.spring.userData.view=this.springview,this.parent.addChild(this.springview),this.spring.set_compound(this.compo),this.zeroX=t.worldPointToLocal(o).get_y(),this.drawlinecolor()}},{key:"limitTension",value:function(){var t=this.furred.body.get_position();this.lineJoint=this.JointUtil.createLineJoint(this.furred.body,this.tension.body,t,t,t.sub(this.tension.body.get_position()).rotate(-Math.PI/2),-100,1e3),this.lineJoint.set_compound(this.compo)}},{key:"drawlinecolor",value:function(){this.flagline.clear(),this.springline.clear(),this.flagline.lineStyle(3,this.lineColor,.8),l.M.drawDashed(this.flagline,new l.Point(this.zeroX,-150),new l.Point(this.zeroX,150)),this.springline.lineStyle(3,this.lineColor,.8),l.M.drawDashed(this.springline,new l.Point(0,-150),new l.Point(0,150))}},{key:"backgroundColorChange",value:function(t){this.lineColor=t,this.drawlinecolor(),this.txt.style.fill="#"+t.toString(16);var e=this.txt.text;this.txt.text="",this.txt.text=e}},{key:"update",value:function(){if(this.furred&&this.furred.hadDestory)return void this.removeFromFramework(this);if(this.furred&&this.furred.body){var t=this.furred.body.get_position();this.x=t.get_x(),this.y=t.get_y()}if(this.springview){var e=this.tension.springHock.body.get_position(),i=this.toLocal(new l.Point(e.get_x(),e.get_y()),this.getMain().view);this.springline.x=i.x;var o=i.x-this.zeroX;this.txt.text=l.M.getNumJie(.1*Math.abs(o)/this.NapeConst.SCALE_SPACE,1)+"cm";var n=this.zeroX+o/2;if(this.lenline.clear(),this.lenline.lineStyle(3,this.lineColor,.7),Math.abs(o)>90){var s=o>0?n-40:n+40,a=o>0?n+40:n-40;this.lenline.moveTo(this.zeroX,140),this.lenline.lineTo(s,140),this.lenline.moveTo(i.x,140),this.lenline.lineTo(a,140)}this.txt.pivot.x=this.txt.width/2,this.txt.x=n,this.txt.y=150}}},{key:"removed",value:function(){this.removedCursor(this.startBtn),this.removedCursor(this.resetBtn),this.tension&&!this.tension.hadDestory&&this.removeFromFramework(this.tension),this.furred&&!this.furred.hadDestory&&this.removeFromFramework(this.furred),this.table&&this.table.seComp&&!this.table.seComp.hadDestory&&this.table.seComp.destroy(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return this.tension&&this.furred&&this.spring&&(t.datalength=this.datalength,t.k=this.flagK,this.seComp&&(t.tabledata=this.seComp.getData())),t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.datalength=t.datalength,this.preSetData=t}},{key:"completeSetData",value:function(t){t.k&&this.changeNM({showValue:t.k})}},{key:"changeNM",value:function(t){var e=l.M.getNumStr(t.showValue)-0;this.flagK=e;var i=e/100;this.k=15/Math.sqrt(.65)*Math.sqrt(i),this.spring.set_frequency(this.k)}},{key:"selectRenderChild",value:function(){return this.tension?this.tension.bg.getBounds():this.getBounds()}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.ComponentProperty.getScrollBar(this.language.getLocaleStr("stiffness_coefficient"),!0,"N/m",150,50,this.elastic,1,this.changeNM,this)),t}},{key:"elastic",get:function(){return this.flagK}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function v(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:v(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(506),c=o(u),d=i(449),p=o(d),y=i(454),f=o(y),g=void 0,b=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return g=i.moduleMain.nape,b=g.geom.Vec2,i.nbdesk=null,i.wood=null,i.board=null,i.woodJoint=null,i.woodLineJoint=null,i.ticker=null,i.tickerpaperBreakfunc=null,i.tickerGetPaperfunc=null,i.getOnePaperDataFunc=null,i.onekeyph=!1,i.seComp=null,i.table=null,i.datalength=0,i.preSetData=null,i.tempRubberNum=null,i.haveWood=!0,i.saveTable=!0,i.resetDisLoadComp=!0,i}return a(e,t),r(e,[{key:"init",value:function(t){var e=this;this.startBtn.fontColor="#ffffff",this.startBtn.text=this.language.getLocaleStr("eject"),this.resetBtn.fontColor="#ffffff",this.resetBtn.text=this.language.getLocaleStr("reset"),this.startBtn["this"]=this,this.startBtn.tab=function(){e.initComplete&&e.board.nbCar.tic&&e.board.nbCar.weldJoint&&(e.ticker.var_powerIsOpen||e.ticker.func_powerClick(),e.board.nbCar.breakWeldJoint())},this.resetBtn["this"]=this,this.resetBtn.tab=function(){e.initComplete&&(e.ticker.var_powerIsOpen&&e.ticker.func_powerClick(),e.ticker.firstShowPaper(),e.board.nbCar.breakWeldJoint(),e.resetNbCar())},this.nummc.addBtn.fontColor="#ffffff",this.nummc.addBtn.text="+",this.nummc.subBtn.fontColor="#ffffff",this.nummc.subBtn.text="－",this.nummc.addBtn.tab=function(){if(e.initComplete){var t=e.getrubberNum();t++,t>10&&(t=10),e.changeRubberNum({showValue:t}),e.freshLibPan()}},this.nummc.subBtn.tab=function(){if(e.initComplete){var t=e.getrubberNum();t--,1>t&&(t=1),e.changeRubberNum({showValue:t}),e.freshLibPan()}},this.addTable(t),this.addCursor(this.startBtn,"hand"),this.addCursor(this.resetBtn,"hand"),this.addCursor(this.nummc.addBtn,"hand"),this.addCursor(this.nummc.subBtn,"hand")}},{key:"addTable",value:function(t){var e=this;this.globalConfig.main.addTable({data:{col:3,row:5}},function(i){e.seComp=i,e.table=i.table,i.allowSave=!1,i.setTableData({heads:[e.language.getLocaleStr("rubber_work")+"w",e.language.getLocaleStr("car_speed")+" v/(m/s)",e.language.getLocaleStr("car_speed_square")+" v²/(m²/s²)"]}),i.setLineData([{x:0,y:2,linkType:3,ifTr:!0}]),t&&t()})}},{key:"addOthers",value:function(){var t=this.dependEquipments;this.getMain().view.updateTransform(),this.initDesk(t[0]),this.initWood(t[1]),this.initBoard(t[2]),this.initTicker(t[3]),this.preSetData?this.completeSetData(this.preSetData):this.changeSaveTable({checked:!0});$("#second-tools-id");this.nummc.txt.text=this.getrubberNum(),this.initComplete=!0,this.testConsole()}},{key:"testConsole",value:function(){}},{key:"initDesk",value:function(t){this.nbdesk=t,this.nbdesk.getConfJumpTarget=this,this.nbdesk.setComponent()}},{key:"resetWoodPosition",value:function(){var t=this.nbdesk.body.get_position(),e=t.sub(b.get(258,186.8));return this.wood.body.set_position(e),e}},{key:"initWood",value:function(t){var e=this;this.wood=t,this.wood.getConfJumpTarget=this,this.wood.owner=this.wood.parent;var i=this.resetWoodPosition();this.wood.setComponent();var o=this.nbdesk.body.localPointToWorld(b.get(-355,0)).get_x();this.woodLineJoint=this.JointUtil.createLineJoint(this.nbdesk.body,this.wood.body,b.get(o,i.get_y()),i,b.get(1,0),0,300),this.woodJoint=this.JointUtil.createWeldJoint(this.nbdesk.body,this.wood.body,i,i),this.woodBegin=function(){e.onekeyph||(e.woodJoint.set_active(!1),e.board.body.set_allowRotation(!0))},this.woodEnd=function(){if(!e.onekeyph){var t=e.nbdesk.body.worldPointToLocal(e.wood.body.get_position());e.woodJoint.set_anchor1(t),e.woodJoint.set_active(!0),e.board.body.set_allowRotation(!1)}},this.wood.addEventListener(p["default"].BEGIN,this.woodBegin),this.wood.addEventListener(p["default"].END,this.woodEnd)}},{key:"initBoard",value:function(t){this.board=t,this.board.getConfJumpTarget=this,this.board.nbCar.visible=!1,this.board.body.set_position(this.nbdesk.body.get_position().sub(b.get(0,216.985))),this.board.body.set_rotation(.08941238207918926),this.board.setComponent();var e=this.nbdesk.rightPi();this.JointUtil.createPivotJoint(this.nbdesk.body,this.board.body,e,e),this.board.body.set_allowRotation(!1)}},{key:"initTicker",value:function(t){var e=this;this.ticker=t,this.ticker.getConfJumpTarget=this,this.ticker.setComponent(),this.ticker.func_bindBoard(this.board),this.resetNbCar(),this.board.nbCar.visible=!0,this.tickerpaperBreakfunc=function(){e.tempRubberNum=e.getrubberNum(),e.ticker.var_paper.breakPaper(),e.ticker.func_powerClick()},this.tickerGetPaperfunc=function(t){var i=t;i.paperMenuChange(e.language.getLocaleStr("speed")),i.menu.sdBtn.swap(),i.leftBiaoOff=450,i.rightBiaoOff=500,e.getOnePaperDataFunc=function(t){i.removeEventListener(f["default"].CAN_GET_SPEEDDATA,e.getOnePaperDataFunc),e.fillTableData(t)},i.addEventListener(f["default"].CAN_GET_SPEEDDATA,e.getOnePaperDataFunc)},this.ticker.addEventListener(f["default"].TICKER_PAPER_AUTOMATIC_BREAK,this.tickerpaperBreakfunc),this.ticker.addEventListener(f["default"].SCALE_BIG_PAPER,this.tickerGetPaperfunc)}},{key:"fillTableData",value:function(t){var e=t.velocity,i=e.length,o=0;for(var n in e)o+=e[n];var s=this.tempRubberNum,a=l.M.getNumJie(.01*o/i,2);this.seComp.setTableData({row:{index:this.datalength,data:[s,a,l.M.getNumJie(a*a,2)]}}),this.datalength++}},{key:"resetNbCar",value:function(){this.board.nbCar.body.set_position(this.board.body.localPointToWorld(b.get(-142,-42.8))),this.board.nbCar.body.set_rotation(this.board.body.get_rotation()),this.board.nbCar.checkHitTickerPaper(),this.board.nbCar.frezzTwoLun()}},{key:"update",value:function(){if(this.nbdesk&&this.nbdesk.body){var t=this.nbdesk.body.get_position();this.x=t.get_x(),this.y=t.get_y()}this.board&&this.board.body&&this.board.body.set_angularVel(0)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return this.nbdesk&&this.board&&this.wood&&this.ticker&&(t.datalength=this.datalength,t.onekeyph=this.onekeyph,t.rubberNum=this.getrubberNum(),t.fir=this.getboardFri(),t.haveWood=this.haveWood,t.saveTable=this.saveTable,this.seComp&&(t.tabledata=this.seComp.getData())),t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.datalength=t.datalength,this.onekeyph=t.onekeyph,this.preSetData=t}},{key:"completeSetData",value:function(t){t.rubberNum!=this.getrubberNum&&this.changeRubberNum({showValue:t.rubberNum}),t.fir!=this.getboardFri()&&this.changeFri({showValue:t.fir}),this.onekeyph&&this.changePingHeng({checked:this.onekeyph}),0==t.haveWood&&this.hideWood({checked:!0}),this.changeSaveTable(0==t.saveTable?{checked:!1}:{checked:!0})}},{key:"removed",value:function(){this.removedCursor(this.startBtn),this.removedCursor(this.resetBtn),this.removedCursor(this.nummc.addBtn),this.removedCursor(this.nummc.subBtn),this.ticker&&(this.ticker.removeEventListener(f["default"].TICKER_PAPER_AUTOMATIC_BREAK,this.tickerpaperBreakfunc),this.ticker.removeEventListener(f["default"].SCALE_BIG_PAPER,this.tickerGetPaperfunc)),this.wood&&(this.wood.removeEventListener(p["default"].BEGIN,this.woodBegin),this.wood.removeEventListener(p["default"].END,this.woodEnd)),this.seComp&&!this.seComp.hadDestory&&this.seComp.destroy(),this.nbdesk&&!this.nbdesk.hadDestory&&this.removeFromFramework(this.nbdesk),this.board&&!this.board.hadDestory&&this.removeFromFramework(this.board),this.wood&&!this.wood.hadDestory&&this.removeFromFramework(this.wood),this.ticker&&!this.ticker.hadDestory&&this.removeFromFramework(this.ticker),this.startBtn.dispose(),this.resetBtn.dispose(),this.nummc.addBtn.dispose(),this.nummc.subBtn.dispose(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"getrubberNum",value:function(){return this.board.curLinkNum_}},{key:"changeRubberNum",value:function(t){this.board.changeXPJ(t),this.nummc.txt.text=this.getrubberNum()}},{key:"getboardFri",value:function(){return this.board.fparam}},{key:"changeFri",value:function(t){this.board.changeFri(t)}},{key:"changePingHeng",value:function(t){var e=this;if(this.onekeyph=t.checked){this.changeFri({showValue:.5}),this.board.body.set_allowRotation(!0);var i=this.nbdesk.body.get_position().sub(b.get(238.1688,186.8));this.wood.body.set_position(i);this.woodJoint.set_anchor1(this.nbdesk.body.worldPointToLocal(i)),setTimeout(function(){e.hadDestory||e.board.body.set_allowRotation(!1)},500),this.freshLibPan()}}},{key:"hideWood",value:function(t){var e=arguments.length>1&&arguments[1]!==undefined&&arguments[1];this.haveWood=!t.checked,this.haveWood?(this.board.body.set_rotation(.08941238207918926),this.wood.body.set_space(this.nbdesk.body.get_space()),this.woodLineJoint.set_active(!0),this.woodJoint.set_active(!0),this.wood.owner.addChild(this.wood)):(this.wood.body.set_space(null),this.woodLineJoint.set_active(!1),this.woodJoint.set_active(!1),this.wood.owner.removeChild(this.wood),this.board.body.set_rotation(0)),e||this.freshLibPan()}},{key:"selectRenderChild",value:function(){return this.nbdesk?this.nbdesk.bg.getBounds():this.getBounds()}},{key:"changeSaveTable",value:function(t){this.saveTable=t.checked}},{key:"getConf",value:function(){var t={};t.confArr=[],t.confArr.push(this.ComponentProperty.getDropMenu(this.language.getLocaleStr("rubber_num"),!0,"",this.getrubberNum()+"",["1","2","3","4","5","10"],this,this.changeRubberNum,10,1),this.ComponentProperty.getScrollBar(this.language.getLocaleStr("roughness"),!0,"",1,0,this.getboardFri(),.1,this.changeFri,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("auto_entry"),this.saveTable,this.changeSaveTable,this));var e=this.language.getLocaleStr("hidden_wood");return this.haveWood?t.confArr.push(this.ComponentProperty.getSwitch(e,!1,this.hideWood,this),this.ComponentProperty.getSwitch(this.language.getLocaleStr("leveling"),this.onekeyph,this.changePingHeng,this)):t.confArr.push(this.ComponentProperty.getSwitch(e,!0,this.hideWood,this)),t}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(226),h=function(t){return t&&t.__esModule?t:{"default":t}}(r),l=i(1);e["default"]=function(t){function e(t,i){o(this,e);var s=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return s.touchId=0,s.poNum=0,s.ang=.5*Math.PI,s.speed=.03,s.offX=0,s.maxOff=0,s.dir=1,s.isBig=!1,s.addChild(i),s.touchGroup=!0,i.pivot.x=.5*i.width,i.pivot.y=14,s._centerP=new l.Point(0,.5*i.height-14),s}return s(e,t),a(e,[{key:"reset",value:function(){this.dir=1,this.poNum=0,this.ang=0,this.x=this.orignX,this.y=this.orignY,this.offX=0,this.scale.x=1,this.scale.y=1}},{key:"getAS",value:function(){return this.speed+=.02,1>this.speed||(this.speed=1),this.speed}},{key:"centerP",get:function(){return this.toGlobalView(this._centerP,this)}}]),e}(h["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(226),c=o(u),d=i(614),p=o(d);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.colorArr=[255,16711680,10027212,16776960,65280],i.colorIndex=0,i.vec=[],i.container=null,i.readyDraw=!0,i.grc=new PIXI.Container,i.grid1=null,i.grid2=null,i.oldX=0,i.shapeVec=[],i.firstLine=null,i.hisObj={},i.init(),i.touchid=null,i}return a(e,t),r(e,[{key:"init",value:function(){var t=this,e=new PIXI.Graphics;e.beginFill(16711680,.3),e.drawRect(0,-160,410,320),this.addChild(e),this.addChild(this.grc),this.grc.mask=e,this.grid1=PIXI.Sprite.fromFrame("ForcedVibration/coorBg"),this.grc.addChild(this.grid1),this.grid2=PIXI.Sprite.fromFrame("ForcedVibration/coorBg"),this.grc.addChild(this.grid2),this.grid1.pivot.y=this.grid2.pivot.y=152,this.grid2.x=this.grid1.width,this.var_img=PIXI.Sprite.fromFrame("ForcedVibration/zuobiao"),this.addChild(this.var_img),this.var_img.pivot.x=40,this.var_img.pivot.y=187,this.container=new PIXI.Sprite,this.addChild(this.container),this.container.x=-10,this.createView(),this.startP=null,this.touchid=l.M.addTouch(this,{begin:function(e){t.parent.cannotSystemDrag=!0,t.startP=t.getMouseXY(e)},move:function(e){var i=t.getMouseXY(e);t.x+=i.x-t.startP.x,t.y+=i.y-t.startP.y,t.startP=i},end:function(e){t.parent.cannotSystemDrag=!1}})}},{key:"removed",value:function(){l.M.removeTouch(this,this.touchid),this.removeEventListener("showOneLine",this.checkCallBack),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"createView",value:function(){for(var t=this,e=0;this.colorArr.length>e;e++){var i=new PIXI.Graphics;i.lineStyle(3,this.colorArr[e]),this.shapeVec.push(i),this.container.addChild(i);var o=new p["default"](this.paramObj,"","",null,30,"ForcedVibration");o.line=i,o.owner=this;var n=String.fromCharCode(65+e),s=this.globalConfig.main.language.getLocaleStr("library.mechanics.xiaoqiu");"A"==n?o.checkLabel(s+" A(15cm/30g)"):"B"==n?o.checkLabel(s+" B(50cm/30g)"):"C"==n?o.checkLabel(s+" C(65cm/30g)"):"D"==n?o.checkLabel(s+" D(50cm/90g)"):"E"==n&&o.checkLabel(s+" E(40cm/30g)"),this.addChild(o),o.x=10+e%2*300,o.y=200+50*Math.floor(e/2),this.vec.push(o)}this.checkCallBack=function(e){e.boo?t.container.addChild(e.ln):t.container.removeChild(e.ln)},this.addEventListener("showOneLine",this.checkCallBack)}},{key:"reset",value:function(){this.hisObj={};for(var t=0;this.shapeVec.length>t;t++)this.shapeVec[t].clear(),this.shapeVec[t].lineStyle(3,this.colorArr[t]),this.shapeVec[t].x=0;this.grid1.x=0,this.grid2.x=this.grid1.width,this.oldX=0}},{key:"draw",value:function(t,e,i){var o=void 0;if(null==this.hisObj[t])o=[],o.push({x:e/50,y:3.2*i}),this.hisObj[t]=o;else{o=this.hisObj[t];var n=new l.Point(e/50,3.2*i),s=new l.Point(o[o.length-1].x,o[o.length-1].y);if(3>l.Point.distance(n,s))return;o.push({x:e/50,y:3.2*i})}null==this.firstLine&&(this.firstLine=this.shapeVec[t]);var a=this.shapeVec[t];a.clear(),a.lineStyle(3,this.colorArr[t],1);for(var r=o.length,h=void 0,u=-1,c=r-1;c>=0;c--){var d=o[c];if(c==r-1)a.moveTo(d.x,d.y),h=d.x;else if(a.lineTo(d.x,d.y),h-d.x>410){if(u=c,o=o.slice(u),this.firstLine==a){this.moveLineX(-d.x);var p=this.oldX-this.firstLine.x;this.grid1.x-=p,this.grid2.x-=p,-this.grid1.width>this.grid1.x&&(this.grid1.x=this.grid2.x+this.grid2.width),-this.grid2.width>this.grid2.x&&(this.grid2.x=this.grid1.x+this.grid1.width),this.oldX=this.firstLine.x}break}}}},{key:"moveLineX",value:function(t){for(var e=0;this.shapeVec.length>e;e++)this.shapeVec[e].x=t}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function f(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:f(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=(i(1),i(226)),u=o(l),c=i(1070),d=o(c),p=i(1069),y=o(p);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.trackMc=null,i.planeMc=null,i.mdtypes=["模型一","模型二"],i.selectIndex=0,i}return a(e,t),r(e,[{key:"added",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"added",this).call(this),this.trackMc=new d["default"](this.paramObj,this),this.bg.plane.removeChild(this.bg.plane.color),this.bg.track.addChild(this.trackMc),this.trackMc.added(),this.main.activeModule.looplist.push(this),this.planeMc=new y["default"](this.paramObj,this),this.bg.plane.addChildAt(this.planeMc,0),this.planeMc.added(),this.bg.plane.visible=!1}},{key:"update",value:function(){0==this.selectIndex?this.trackMc.update():this.planeMc.update()}},{key:"removed",value:function(){var t=this.main.activeModule.looplist,i=t.indexOf(this);-1!=i&&t.splice(i,1),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"getData",value:function(){return h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this)}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t)}},{key:"changeType",value:function(t){this.selectIndex=this.mdtypes.indexOf(t.showValue),0==this.selectIndex?(this.bg.plane.visible=!1,this.bg.track.visible=!0):(this.bg.plane.visible=!0,this.bg.track.visible=!1,this.trackMc.hideModel()),this.freshLibPan()}},{key:"getConf",value:function(){var t={};if(t.confArr=[this.getDropMenu([this.getLocaleStr("type","类型"),!1,"",this.mdtypes[this.selectIndex],this.mdtypes,this,this.changeType,1,0])],0==this.selectIndex){t.confArr=t.confArr.concat(this.trackMc.getConf().confArr)}return t}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(1);e["default"]=function(t){function e(t,i){o(this,e);var s=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));s.parentMc=i,s.globalConfig=t,s.frame=PIXI.Texture.fromFrame("GalileoExp/skin"),s.g=.1,s.leftPoints=[],s.rightPoints=[],s.leftHorLen=400,s.leftAng=30*Math.PI/180,s.lefta=0,s.rightAng=s.leftAng,s.righta=0,s.halfbtc=80,s.rightHalfbtc=s.halfbtc,s.minBotH=30,s.p1=null,s.p2=null,s.p3=null,s.p5=null,s.p6=null,s.startP=null,s.speed=0,s.leftLJP=null,s.rightLJP=null,s.isDraging=!1,s.dragRect=new PIXI.Graphics,s.botDrag=new PIXI.Graphics,s.line=new PIXI.Graphics,s.track=new PIXI.Graphics,s.maxH=null,s.maxW=null,s.rectTouchid=null,s.botTouchid=null,s.lineTouchid=null,s.skinMask=new PIXI.Graphics;var a=i.bg.plane;return s.ball=a.ball,s.txtA=a.txtA,s.txtB=a.txtB,s}return s(e,t),a(e,[{key:"added",value:function(){this.removeChild(this.color),this.addChild(this.botDrag),this.addChild(this.dragRect),this.dragRect.beginFill(1044480,0),this.dragRect.drawRect(-120,-50,150,200),this.dragRect.endFill(),this.dragRect.x=400,this.dragRect.y=-300,this.botDrag.beginFill(16711680,0),this.botDrag.drawRect(-100,-80,150,160),this.botDrag.endFill(),this.botDrag.x=this.leftHorLen+this.rightHalfbtc;var t=new PIXI.extras.TilingSprite(this.frame,1500,600);this.addChildAt(t,0),t.pivot.x=490,t.pivot.y=450,this.addChildAt(this.skinMask,0),t.mask=this.skinMask,t.interactive=!1,t.interactiveChildren=!1,this.startP=new r.Point(-this.halfbtc-this.leftHorLen+this.ball.width/2,0),this.addChild(this.line),this.addChildAt(this.track,0),this.initLeftPart(),this.refreshRightPart(),this.initDrag(),this.txtA.y=-20}},{key:"update",value:function(){if(!this.isDraging){var t=0,e=Math.atan2(-this.startP.y+this.leftLJP.y,-this.startP.x+this.leftLJP.x);if(this.leftLJP.x>this.ball.x){t=this.lefta,this.speed+=t;var i=this.speed*Math.cos(e),o=this.speed*Math.sin(e);this.ball.x+=i,this.ball.y+=o,.02>Math.abs(this.speed)&&5>this.ball.x-this.startP.x&&(this.speed=0,this.ball.x=this.startP.x,this.ball.y=this.startP.y)}else if(this.ball.x<this.leftLJP.x||this.rightLJP.x<this.ball.x){t=this.righta,this.speed-=t;var n=this.speed*Math.cos(this.rightAng),s=this.speed*Math.sin(this.rightAng);this.ball.x+=n,this.ball.y-=s}else this.ball.x+=this.speed,this.ball.y=this.leftLJP.y;this.startP.y>this.ball.y&&(this.ball.y=this.startP.y),this.ball.x>this.dragRect.x&&(this.ball.x=this.startP.x,this.ball.y=this.startP.y,this.speed=0)}}},{key:"initDrag",value:function(){function t(t){this.parentMc.cannotSystemDrag=!0,n=this.parentMc.getMouseXY(t),this.ball.x=this.startP.x,this.ball.y=this.startP.y,this.isDraging=!0,this.speed=0}function e(t){var e=this.parentMc.getMouseXY(t);this.dragRect.x+=e.x-n.x,this.dragRect.y+=e.y-n.y,this.botDrag.x=this.dragRect.x,n=e,this.rightHalfbtc+150>this.dragRect.x&&(this.dragRect.x=this.rightHalfbtc+150),this.dragRect.x>1e3&&(this.dragRect.x=1e3),this.dragRect.y<-Math.abs(2*this.maxH)&&(this.dragRect.y=-Math.abs(2*this.maxH)),0>this.dragRect.y||(this.dragRect.y=0),this.refreshRightPart()}function i(t){this.parentMc.cannotSystemDrag=!1,this.isDraging=!1}function o(t){var e=this.parentMc.getMouseXY(t),i=this.botDrag.x;this.botDrag.x+=e.x-n.x,this.rightHalfbtc+=e.x-n.x,this.dragRect.x=this.botDrag.x,n=e,-50>this.rightHalfbtc&&(this.rightHalfbtc=-50,this.dragRect.x=this.botDrag.x=i),this.rightHalfbtc>200&&(this.rightHalfbtc=200,this.dragRect.x=this.botDrag.x=i),this.dragRect.x>1e3&&(this.dragRect.x=this.botDrag.x=1e3),this.p1.x=this.rightHalfbtc,this.refreshRightPart()}this.rectTouchid=r.M.addTouch(this.dragRect,{begin:t,move:e,end:i},this);var n=void 0;this.botTouchid=r.M.addTouch(this.botDrag,{begin:t,move:o,end:i},this)}},{key:"refreshRightPart",value:function(){this.p5=new r.Point(this.dragRect.x,this.minBotH),this.p6=new r.Point(this.dragRect.x,this.dragRect.y),this.rightPoints=[this.p5,this.p6],this.txtB.y=-20,this.txtB.x=this.p1.x+.5*(this.p6.x-this.p1.x);var t=this.p5.y-this.p6.y-this.minBotH,e=this.p5.x-this.rightHalfbtc;this.rightAng=Math.atan(t/e),this.righta=this.g*Math.sin(this.rightAng);var i=(Math.PI-this.rightAng)/2,o=Math.cos(i)*this.ball.width/2,n=Math.sin(i)*this.ball.width/2;this.rightLJP=new r.Point(this.p1.x-o,-n),this.drawTrack(),this.refreshBgTexture(this.leftPoints.concat(this.rightPoints)),this.line.clear(),this.line.lineStyle(3,16750848),r.M.drawDashed(this.line,new r.Point(0,0),new r.Point(this.p6.x-this.maxW+50,0),10,5),this.line.lineStyle(1,16750848,0),this.line.beginFill(16711680,0),this.line.drawRect(0,-30,this.p6.x-this.maxW+50,60),this.line.endFill()}},{key:"drawTrack",value:function(){this.track.clear(),this.track.lineStyle(1,0,0),this.track.beginFill(39423),this.track.moveTo(this.p1.x-5,this.p1.y-15),this.track.lineTo(this.p2.x+5,this.p2.y-15),this.track.lineTo(this.p3.x+5,this.p3.y-15),this.track.lineTo(this.p3.x,this.p3.y),this.track.lineTo(this.p2.x,this.p2.y),this.track.lineTo(this.p1.x,this.p1.y),this.track.lineTo(this.p6.x,this.p6.y),this.track.lineTo(this.p6.x-5,this.p6.y-15)}},{key:"refreshBgTexture",value:function(t){this.skinMask.clear(),this.skinMask.beginFill(0),this.skinMask.moveTo(this.p1.x,this.p1.y),this.skinMask.lineTo(this.p2.x,this.p2.y),this.skinMask.lineTo(this.p3.x,this.p3.y),this.skinMask.lineTo(this.p4.x,this.p4.y),this.skinMask.lineTo(this.p5.x,this.p5.y),this.skinMask.lineTo(this.p6.x,this.p6.y),this.skinMask.lineTo(this.p1.x,this.p1.y)}},{key:"initLeftPart",value:function(){function t(t){h=this.parentMc.getMouseXY(t),this.parentMc.cannotSystemDrag=!0,this.ball.x=this.startP.x,this.ball.y=this.startP.y,this.isDraging=!0,this.speed=0}function e(t){var e=this.parentMc.getMouseXY(t);this.line.y+=e.y-h.y,this.maxH>this.line.y&&(this.line.y=this.maxH),this.line.y>-50&&(this.line.y=-50),this.startP.y=this.line.y-this.ball.height/2,this.startP.x=this.maxW+(Math.abs(this.maxH-this.ball.height/2)-Math.abs(this.startP.y))/Math.tan(this.leftAng),this.ball.x=this.startP.x,this.ball.y=this.startP.y,this.speed=0,h=e}function i(t){this.parentMc.cannotSystemDrag=!1,this.isDraging=!1}this.p1=new r.Point(this.rightHalfbtc,0),this.p2=new r.Point(-this.halfbtc,0);var o=Math.tan(this.leftAng)*this.leftHorLen;this.p3=new r.Point(-this.halfbtc-this.leftHorLen,-o),this.startP.y=-Math.tan(this.leftAng)*(this.leftHorLen-this.ball.width/2)-this.ball.width/2/Math.cos(this.leftAng),this.p4=new r.Point(-this.halfbtc-this.leftHorLen,this.minBotH),this.leftPoints.push(this.p1,this.p2,this.p3,this.p4),this.lefta=this.g*Math.sin(this.leftAng);var n=(Math.PI-this.leftAng)/2,s=Math.cos(n)*this.ball.width/2,a=Math.sin(n)*this.ball.width/2;this.leftLJP=new r.Point(this.p2.x+s,-a),this.ball.x=this.startP.x,this.ball.y=this.startP.y,this.line.x=this.startP.x-50,this.maxH=this.startP.y+this.ball.height/2,this.maxW=this.startP.x,this.line.y=this.maxH,this.txtA.x=this.p2.x+.5*(this.p4.x-this.p2.x);var h=void 0;this.lineTouchid=r.M.addTouch(this.line,{begin:t,move:e,end:i},this)}},{key:"removed",value:function(){r.M.removeTouch(this.dragRect,this.rectTouchid),r.M.removeTouch(this.botDrag,this.botTouchid),r.M.removeTouch(this.line,this.lineTouchid)}},{key:"getData",value:function(){return obj.drect={x:this.dragRect.x,y:this.dragRect.y},obj.bot={x:this.botDrag.x,y:this.botDrag.y},obj.startP={x:this.startP.x,y:this.startP.y},obj}},{key:"setData",value:function(t){this.dragRect.x=t.drect.x,this.dragRect.y=t.drect.y,this.botDrag.x=t.bot.x,this.botDrag.y=t.bot.y,this.startP.x=t.startP.x,this.startP.y=t.startP.y,this.ball.x=this.startP.x,this.ball.y=this.startP.y,this.speed=0,this.line.y=this.startP.y+this.ball.height/2,this.refreshRightPart()}},{key:"selectRenderChild",value:function(){this.updateTransform();var t=this.getBounds();return t.width=(this.p6.x-this.p3.x+60)*this.getMain().view.scale.x,t}},{key:"hideTips",value:function(){}}]),e}(PIXI.Container)},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(1);e["default"]=function(t){function e(t,i){o(this,e);var s=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));s.globalConfig=t,s.originO={x:-212,y:62},s.trackPoints=[],s.leftFunA=0,s.rightFunA=0,s.bigR=22,s.smallR=15,s.cutR=s.bigR,s.isStart=!1,s.cutImg=!0,s.firstImg=!0,s.totalStep=0,s.cutStep=200,s.lrPoints={left:null,right:null},s.dragIdArr=[],s.isdamage=!1,s.parentMc=i;var a=i.bg.track;return s.xuLine=new PIXI.Graphics,s.track=a.track,s.fixed=a.fixed,s.line=a.line,s.startBtn=a.startBtn,s.stopBtn=a.stopBtn,s.resetBtn=a.resetBtn,s.ball=a.ball,a.removeChild(a.tm),s}return s(e,t),a(e,[{key:"added",value:function(){this.track.visible=!1,this.imgContainer=new PIXI.Sprite,this.imgContainer.interactive=!1,this.imgContainer.interactiveChildren=!1,this.fixed.parent.addChildAt(this.imgContainer,this.fixed.parent.getChildIndex(this.fixed)),this.ropeLine=new PIXI.mesh.Rope(PIXI.Texture.fromImage(this.parentMc.globalConfig.cdn_static+"mechanics/ropeimg/duidao.png"),[]),this.addChild(this.ropeLine),this.ropeLine.interactive=!1,this.ropeLine.interactiveChildren=!1,this.ropeLine.x=this.originO.x,this.ropeLine.y=this.originO.y,this.imgContainer.x=this.originO.x,this.imgContainer.y=this.originO.y,this.line.removeChildren(),this.line.addChild(this.xuLine),this.xuLine.clear(),this.xuLine.lineStyle(2,16750848),this.xuLine.moveTo(-600,0),r.M.drawDashed(this.xuLine,{x:-600,y:0},{x:1300,y:0},10,5),this.xuLine.lineStyle(2,16750848,0),this.xuLine.beginFill(16711680,0),this.xuLine.drawRect(-600,-15,1900,30),this.xuLine.endFill(),this.drawTrack(),this.addDragListener(),this.initButton(),this.settingBall(),this.setXulinepos()}},{key:"setXulinepos",value:function(){this.xuLine.y=this.cutR==this.bigR?-18:-12}},{key:"settingBall",value:function(){this.isStart=!1,this.setLeftTop()}},{key:"setLeftTop",value:function(){var t=this.ropeLine.toLocal({x:0,y:0},this.line);this.lrPoints.left=this.setBallFromFuncP({x:-this.getFuncX(t.y,this.leftFunA),y:t.y},"left")}},{key:"setRightTop",value:function(){var t=this.ropeLine.toLocal({x:0,y:0},this.line);this.lrPoints.right=this.setBallFromFuncP({x:this.getFuncX(t.y,this.rightFunA),y:t.y},"right")}},{key:"setBallFromFuncP",value:function(t,e){var i=2>=arguments.length||arguments[2]===undefined||arguments[2],o=null,n=0,s=!0;"left"==e?n=this.leftFunA:(s=!1,n=this.rightFunA);var a=-2*n*t.x*t.x+t.y;o={x:0,y:a};var h=r.M.getXianDuanGaoXianDian(t,o,this.cutR,s);if(h=this.toLocal(h,this.ropeLine),i){var l=.1*this.globalConfig.moduleMain.napeEngine.getGravity(),u=Math.atan2(a-t.y,-t.x);this.ball.acc=l*Math.sin(u)*(s?1:-1),this.ball.pos=t,this.ball.x=h.x,this.ball.y=h.y}return h}},{key:"initButton",value:function(){var t=this;this.startBtn.fontColor="#ffffff",this.startBtn.text="开始",this.stopBtn.fontColor="#ffffff",this.stopBtn.text="停止",this.resetBtn.fontColor="#ffffff",this.resetBtn.text="重置",this.resetBtn["this"]=this,this.startBtn["this"]=this,this.stopBtn["this"]=this,this.startBtn.tab=function(){t.isStart||(t.isStart=!0,t.firstImg=!0,t.ball.speed=0)},this.stopBtn.tab=function(){t.isStart=!1,t.settingBall(),t.firstImg=!0},this.resetBtn.tab=function(){t.stopBtn.tab(),t.imgContainer.removeChildren(),t.totalStep=0,t.firstImg=!0}}},{key:"hideModel",value:function(){this.resetBtn.tab()}},{key:"drawTrack",value:function(){var t=this,e=arguments.length>0&&arguments[0]!==undefined&&arguments[0],i={x:-380,y:-130};this.leftFunA=-130/144400,this.trackPoints.length=0,this.trackPoints.push(i);for(var o=i.x,n=0;380>n;n++){o++;this.trackPoints.push({x:o,y:this.getFuncY(o,this.leftFunA)})}var s=this.ropeLine.toLocal({x:0,y:-15},this.fixed);this.rightFunA=s.y/(s.x*s.x),o=0;for(var a=0;1500>a;a++){o++;this.trackPoints.push({x:o,y:this.getFuncY(o,this.rightFunA)})}this.ropeupdate(this.ropeLine),e||setTimeout(function(){var e=t.ropeLine.getBounds();t.ropeLine.rightP=t.toLocal({x:e.x+e.width,y:e.y})},500)}},{key:"ropeupdate",value:function(t){for(var e=[],i=this.trackPoints.length,o=0;i>o;o++){var n=this.trackPoints[o];e.push({x:n.x,y:n.y+8})}r.M.setRopePoints(t,e)}},{key:"saveTrackLine",value:function(){var t=new PIXI.mesh.Rope(PIXI.Texture.fromImage(this.parentMc.globalConfig.cdn_static+"mechanics/ropeimg/duidao.png"),[]);t.alpha=.3,this.ropeupdate(t),this.imgContainer.addChild(t)}},{key:"getLocalFromMouse",value:function(t){return this.toLocal(r.M.getMouseXY(t),this.parentMc.main.view)}},{key:"addDragListener",value:function(){var t=this;this.dragIdArr.push(this.addDrag({mc:this.fixed,y:-87,height:164,begin:function(){t.saveTrackLine(),t.drawTrack(),t.stopBtn.tab()},move:function(){t.drawTrack(!0)},end:function(){t.drawTrack()}}),this.addDrag({mc:this.line,y:-60,height:105,end:function(){t.stopBtn.tab()}}))}},{key:"addDrag",value:function(t){var e=this;t.mc.getMScale=function(){return e.parentMc.main.view.scale};var i=r.M.addDrag(t.mc,{x:t.mc.x,y:t.y,width:0,height:t.height},{begin:function(){e.parentMc.cannotSystemDrag=!0,t.begin&&t.begin()},move:function(){t.move&&t.move()},end:function(){e.parentMc.cannotSystemDrag=!1,t.end&&t.end()}});return{mc:t.mc,touchID:i}}},{key:"getFuncY",value:function(t,e){return e*t*t}},{key:"getFuncX",value:function(t,e){return Math.sqrt(Math.abs(t/e))}},{key:"update",value:function(){if(this.isStart){var t=this.ball.pos,e=this.ball.acc,i=this.ball.speed,o=i,n=!1;if(this.isdamage)i+=e,o>0&&0>i&&(this.firstImg&&(n=!0),this.firstImg=!1),this.ball.speed=.999*i;else{if(i+=e,o>0&&0>i)this.firstImg&&(n=!0),this.firstImg=!1;else if(0>o&&i>0&&o>=-.05)return this.setLeftTop(),void(this.ball.speed=0);this.ball.speed=i}t.x+=i;var s=0,a="";t.x>0?(s=this.rightFunA,a="right"):(s=this.leftFunA,a="left");if(this.setBallFromFuncP({x:t.x,y:this.getFuncY(t.x,s)},a),this.cutImg&&this.firstImg){this.totalStep%Math.round(this.cutStep/16.6666666)==0&&this.drawBallShadows(),this.totalStep++}else n&&this.drawBallShadows()}}},{key:"drawBallShadows",value:function(){var t=this.cutR==this.bigR?"GalileoExp/ball_v2.png":"GalileoExp/ball_v1.png",e=PIXI.Sprite.fromImage(t);this.imgContainer.addChild(e);var i=this.imgContainer.toLocal({x:this.ball.x,y:this.ball.y},this);e.x=i.x,e.y=i.y,e.pivot.x=e.width/2,e.pivot.y=e.height/2}},{key:"changeBallSize",value:function(t){t.checked?(this.cutR=this.bigR,this.ball.currentFrame=0):(this.cutR=this.smallR,this.ball.currentFrame=1),this.stopBtn.tab(),this.setXulinepos()}},{key:"changeCutImg",value:function(t){(this.cutImg=t.checked)||(this.totalStep=0)}},{key:"changeCutStep",value:function(t){this.cutStep=t.showValue}},{key:"removed",value:function(){this.dragIdArr.forEach(function(t){r.M.removeDrag(t.mc,t.touchID)})}},{key:"changeDamage",value:function(t){this.isdamage=t.checked,this.stopBtn.tab()}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.parentMc.getSwitch(["切换大小",this.cutR==this.bigR,this.changeBallSize.bind(this),this]),this.parentMc.getSwitch(["考虑阻力",this.isdamage,this.changeDamage.bind(this),this]),this.parentMc.getSwitch(["快照",this.cutImg,this.changeCutImg.bind(this),this])),this.cutImg&&t.confArr.push(this.parentMc.getScrollBar(["快照间隔",!1,"",500,100,this.cutStep,50,this.changeCutStep.bind(this),this])),t}},{key:"selectRenderChild",value:function(){return this.getChildAt(0).getBounds()}}]),e}(PIXI.Container)},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function p(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:p(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(451),l=function(t){return t&&t.__esModule?t:{"default":t}}(h),u=void 0,c=void 0,d=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return u=i.phy.nape,c=u.geom.Vec2,d=u.shape.HockShapeBase,i.pulleyjoint=null,i.hitshape=null,i.isconnect=!1,i}return s(e,t),a(e,[{key:"removed",value:function(){this.pulleyjoint=null,this.hitshape.dragToolClick(),this.hitshape.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"init",value:function(){var t=this;r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.get_shapes().clear(),this.hitshape=new d(20),this.hitshape.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.hitshape),this.hitshape.addCbtype(this.CbTypeStr.HOOK_BOTTOM_GOU,!0),this.body.noallowRotation=!0,this.body.userData.dragLevel=2,this.body.userData.notHockDrag=!0,this.addTweenQuan(this.hitshape),this.hitshape.connectCallback=function(e,i){return t.main.dispatchEvent(t.main.constructor.HOCK_CHANGE,{bind:!0}),t.connectCallback(e,i)},this.hitshape.breakClickCallback=function(e){t.breakClickCallback(e)},this.mass=5}},{key:"connectCallback",value:function(t,e){this.connectBody=t;var i=t.worldPointToLocal(e);return this.pulleyjoint.set_body1(t),this.pulleyjoint.set_anchor1(i),this.napeEngine.hockCtrol.addJointShape(this.pulleyjoint,this.hitshape),this.pulleyjoint.userData.hocknum=1,this.isconnect=!0,!0}},{key:"breakClickCallback",value:function(t){this.pulleyjoint&&(this.pulleyjoint.set_body1(this.body),this.pulleyjoint.set_anchor1(c.get(0,0))),this.isconnect=!1,this.connectBody=null}},{key:"update",value:function(){if(r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.isconnect&&this.body.get_allowMovement()&&this.body.set_allowMovement(!1),this.isconnect||this.body.get_allowMovement()||this.body.set_allowMovement(!0),this.isconnect){var t=this.pulleyjoint.get_anchor1();t=this.connectBody.localPointToWorld(t),this.body.set_position(t)}}},{key:"useing",get:function(){return this.hitshape.get_userData().useing}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function d(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:d(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(451),l=function(t){return t&&t.__esModule?t:{"default":t}}(h),u=void 0,c=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return u=i.phy.nape,c=u.shape.HockShapeBase,i.hock=null,i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.noallowRotation=!0,this.body.get_shapes().clear(),this.hock=new c(15),this.hock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.hock),this.hock.addCbtype(this.CbTypeStr.LEVER_DIAO_HOCK);var t=this.CbTypeStr.ALL_HOOK_ARY.concat();t.push(this.CbTypeStr.STONE_HOCK),this.hock.createListener(this.CbTypeStr.LEVER_DIAO_HOCK,t),this.addTweenQuan(this.hock),this.body.mass=.3,this.body.set_gravMass(0),this.body.userData.notHockDrag=!0}},{key:"update",value:function(){if(r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.useing&&this.hock.get_userData().bind){var t=this.hock.get_userData().bind.get_body();t&&this.BodyUtil.dampingBodyVelocity(t,.9,.9)}}},{key:"removed",value:function(){this.hock.dragToolClick(),this.hock.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"useing",get:function(){return this.hock.get_userData().useing}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function p(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:p(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(451),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.shape.HockShapeBase,i.txt=new PIXI.Text("",{font:"25px Arial",fill:16711680}),i.addChild(i.txt),i.txt.y=-40,i.hand=PIXI.Sprite.fromFrame("PullComp/hand"),i.addChildAt(i.hand,0),i.hand.pivot.x=i.hand.width-5,i.hand.pivot.y=42,i.hand.scale.x=.6,i.hand.scale.y=.6,i.owner=null,i.guJ=null,i.var_draging=!1,i.hock=null,i.touchId=null,i}return s(e,t),a(e,[{key:"init",value:function(){var t=this;r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.get_shapes().clear(),this.hock=new d(15),this.hock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.hock),this.hock.addCbtype(this.CbTypeStr.PULL_LA_HOCK),this.hock.createListener(this.CbTypeStr.PULL_LA_HOCK,this.CbTypeStr.SPRING_HOCK),this.addTweenQuan(this.hock),this.guJ=this.JointUtil.createWeldJoint(this.body,this.getWorldBody(),this.body.position,this.body.position),this.guJ.set_frequency(50),this.guJ.set_stiff(!1);var i=void 0;this.touchId=h.M.addTouch(this.hand,{begin:function(e){t.guJ.active=!1,t.var_draging=!0,t.owner&&(t.owner.body.userData.noDrag=!0);var o=t.getEngineTouchManager();if(o.getCurrentToolStatus()===t.ToolStatusStr.DRAG){i=new o.currentTool(t.paramObj),i.cannotStart=!0,i.init(o.dis,o.space);var n=t.getMouseXY(e);i.toDragJoint(t.body,n)}},move:function(e){if(i){var o=t.getMouseXY(e);i.func_touchMove(o)}},end:function(e){if(i){var o=t.getMouseXY(e);i.func_touchEnd(o),i.dispose()}t.owner&&(t.owner.body.userData.noDrag=!1),t.var_draging=!1,t.guJ.active=!0,t.guJ.anchor2=t.body.get_position()}},this)}},{key:"removed",value:function(){this.hock.dragToolClick(),this.hock.dispose(),this.owner=null,h.M.removeTouch(this.hand,this.touchId),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"handRot",value:function(t){this.hand.rotation=t-Math.PI}},{key:"update",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.hock.get_userData().useing?(this.hand.visible&&(this.hand.visible=!1,this.txt.visible=!1),this.guJ.active&&(this.guJ.active=!1)):(this.hand.visible||(this.hand.visible=!0,this.txt.visible=!0),this.var_draging||this.guJ.active||(this.guJ.anchor2=this.body.position,this.guJ.active=!0))}},{key:"useing",get:function(){return this.hock.get_userData().useing}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function d(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:d(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(451),l=function(t){return t&&t.__esModule?t:{"default":t}}(h),u=void 0,c=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return u=i.phy.nape,c=u.shape.HockShapeBase,i.classType="SpringHeadHock",i.bindParent=null,i.springhock=null,i.hock=null,i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.get_shapes().clear(),this.hock=new c(15),this.hock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.hock),this.hock.addCbtype(this.CbTypeStr.SPRING_HEAD_HOCK),this.hock.createListener(this.CbTypeStr.SPRING_HEAD_HOCK,this.CbTypeStr.SPRING_HOCK),this.addTweenQuan(this.hock)}},{key:"removeHockCbtype",value:function(){this.hock.removeCbtype(this.CbTypeStr.SPRING_HEAD_HOCK)}},{key:"func_handlerInteraction",value:function(t){if(!this.var_isbreaking){var e=t.zpp_inner.int1.outer,i=t.zpp_inner.int2.outer,o=e.userData.view,n=i.userData.view;if(!(o!=this&&n!=this||o.isUseing||n.isUseing)){for(var s=o,a=!1;;){var r=s.springhock;if(r==n){a=!0;break}{if(!r||!r.var_bind||"SpringHeadHock"!=r.var_bind.classType)break;s=r.var_bind}}a||this.func_bindJoint(e,i)}}}},{key:"func_unlockJoint",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"func_unlockJoint",this).call(this),this.bindParent&&(this.bindParent.var_headPj.active=!0,this.bindParent.func_correctHeadPJ())}},{key:"removed",value:function(){this.hock.dragToolClick(),this.hock.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"isUseing",get:function(){return this.hock.get_userData().useing}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function p(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:p(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(451),l=function(t){return t&&t.__esModule?t:{"default":t}}(h),u=void 0,c=void 0,d=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return u=i.phy.nape,c=u.geom.Vec2,d=u.shape.HockShapeBase,i.bindParent=null,i.hock=null,i.connectBody=null,i}return s(e,t),a(e,[{key:"init",value:function(){var t=this;r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.classType="SpringHock",this.body.noallowRotation=!0,this.body.userData.dragLevel=2,this.body.userData.notHockDrag=!0,this.body.set_isBullet(!0),this.body.get_shapes().clear(),this.hock=new d(15),this.hock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.hock),this.hock.addCbtype(this.CbTypeStr.SPRING_HOCK,!0),this.body.set_gravMass(0),this.addTweenQuan(this.hock),this.hock.connectCallback=function(e,i){t.connectBody=e;return!!t.closedLoop(e,t.bindParent)&&(t.hock.dragToolClick(),!0)},this.hock.breakClickCallback=function(e){t.connectBody=null},this.correctMass()}},{key:"removeHockCbtype",value:function(){this.hock.removeCbtype(this.CbTypeStr.SPRING_HOCK)}},{key:"closedLoop",value:function(t,e){if(!t.userData.view)return!1;var i=t.userData.view;if("SpringHeadHock"==i.classType){if(i.bindParent==e)return!0;if(i.bindParent&&i.bindParent.springHock.connectBody){return i.bindParent.springHock.closedLoop(i.bindParent.springHock.connectBody,e)}}return!1}},{key:"correctMass",value:function(){this.body.mass=.5}},{key:"removed",value:function(){this.hock.dragToolClick(),delete this.hock.connectCallback,delete this.hock.breakClickCallback,this.connectBody=null,this.hock.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"isUseing",get:function(){return this.hock.get_userData().useing}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(1),h=void 0,l=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return h=t.moduleMain.phy.nape,l=h.geom.Vec2,i.paper=new PIXI.Graphics,i.pointColor=2756966,i.defaultColor=16777215,i.textCon=new PIXI.Sprite,i.arr=[i.defaultColor],i.init(),i}return s(e,t),a(e,[{key:"init",value:function(){this.addChild(this.paper),this.otext=this.getPointText("O"),this.addChild(this.otext),this.otext0=this.getPointText("O'"),this.addChild(this.otext0),this.addChild(this.textCon)}},{key:"disposeIt",value:function(){r.M.removeTouch(this,this.touchid),this.paper.clear(),this.paper=null,this.removeChildren()}},{key:"initFirstPoint",value:function(t){var e={};e.count="",e.vec2=t,e.type=0,this.oPoint=e,this.otext.x=t.get_x();var i={};i.count="",i.vec2=new l(t.get_x()+34),i.type=0,this.oPoint0=i,this.otext0.x=t.get_x()+34}},{key:"changeColor",value:function(){this.pointColor=r.M.getRandColor()}},{key:"clear",value:function(t){this.pointColor=2756966,this.paper.clear(),this.drawBack(),this.textCon.removeChildren(),this.ptext=this.getPointText("P"),this.mtext=this.getPointText("M"),this.ntext=this.getPointText("N"),this.arr=[t],this.oPoint.count=t,this.oPoint0.count=t,this.addPoint(this.oPoint),this.addPoint(this.oPoint0)}},{key:"addPoint",value:function(t){var e=t.vec2,i=t.count,o=t.type;switch(-1==this.arr.indexOf(i)&&(this.arr.push(i),this.changeColor(),this.changePMN()),o){case 1:this.textCon.addChild(this.ptext),this.ptext.x=e.get_x();break;case 2:this.textCon.addChild(this.mtext),this.mtext.x=e.get_x();break;case 3:this.textCon.addChild(this.ntext),this.ntext.x=e.get_x()}this.paper.beginFill(this.pointColor),o>0?this.paper.drawCircle(e.get_x()+5*Math.cos(Math.random()*Math.PI*2),5*Math.sin(Math.random()*Math.PI*2),4):this.paper.drawCircle(e.get_x(),0,4),this.paper.endFill()}},{key:"changePMN",value:function(){var t="";if(this.arr.length>1){var e=void 0;for(e=1;this.arr.length>e;e++)t+="'"}this.ptext=this.getPointText("P"+t),this.mtext=this.getPointText("M"+t),this.ntext=this.getPointText("N"+t)}},{key:"drawBack",value:function(){this.paper.beginFill(13421772),this.paper.drawRect(-400,-200,800,400),this.paper.endFill()}},{key:"getPointText",value:function(t){return new PIXI.Text(t,{font:"25px Arial",fill:this.pointColor})}}]),e}(PIXI.Container)},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function p(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:p(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(614),u=o(l),c=i(615),d=o(c);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.img=null,i.colorArr=[16711680,65280,255,16776960,13434624,16750848],i.colorIndex=0,i.line=null,i.vec=[],i.container=null,i.readyDraw=!1,i.grc=new PIXI.Sprite,i.grid1=null,i.grid2=null,i.MAX_LENGTH=200,i.queue=[],i.var_oldP=null,i.nbtouchid=null,i.oldX=0,i.head_line_data=[],i.isHead=!0,i.init(),i}return a(e,t),r(e,[{key:"init",value:function(){this.addChild(this.grc),this.grc.x=-5;var t=new PIXI.Graphics;t.beginFill(0),t.drawRect(-5,-160,410,320),t.endFill(),this.addChild(t),this.grc.mask=t,this.grid1=PIXI.Sprite.fromFrame("PhasePosition/coorBg"),this.grc.addChild(this.grid1),this.grid2=PIXI.Sprite.fromFrame("PhasePosition/coorBg"),this.grc.addChild(this.grid2),this.grid1.pivot.y=this.grid2.pivot.y=152,this.grid2.x=this.grid1.width,this.img=PIXI.Sprite.fromFrame("PhasePosition/zuobiao"),this.addChild(this.img),this.img.pivot.x=40,this.img.pivot.y=187,this.container=new PIXI.Sprite,this.addChild(this.container),this.container.x=-10,this.addDragSelf()}},{key:"removed",value:function(){for(var t=0;this.vec.length>t;t++){this.vec[t].dispose()}this.vec.length=0,this.removeEventListener("showOneLine",this.showThisImg),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"drawBegin",value:function(t,e){this.line&&(this.line.alpha=.6,this.container.removeChildren()),this.isHead=!0,this.head_line_data.length=0,this.queue.length=0,this.readyDraw=!0,this.line=new PIXI.Graphics,this.container.addChild(this.line);var i=new u["default"](this.paramObj,t,e);i.owner=this,i.line=this.line,this.addChild(i),i.x=44,this.vec.push(i),this.updateCheck(i),this.colorIndex++,this.colorIndex==this.colorArr.length&&(this.colorIndex=0),this.grid1.x=0,this.grid2.x=this.grid1.width,this.oldX=0,this.addEventListener("showOneLine",this.showThisImg)}},{key:"showThisImg",value:function(t){t.boo?this.container.addChild(t.ln):this.container.removeChild(t.ln)}},{key:"updateCheck",value:function(t){var e=0,i=void 0;for(i=this.vec.length-1;i>=0&&(this.vec[i]!=t&&(this.vec[i].isSelected=!1),this.vec[i].y=200+50*e,++e<3);i--);for(;this.vec.length>3;){var o=this.vec[0];o.dispose(),this.removeChild(o),this.vec.splice(0,1)}}},{key:"draw",value:function(t,e){this.queue.push({x:t/10,y:-e/2.5}),this.isHead&&this.head_line_data.push({x:t/10,y:-e/2.5}),this.line.clear(),this.line.lineStyle(3,this.colorArr[this.colorIndex],1);var i=this.queue.length,o=void 0,n=-1,s=void 0;for(s=i-1;s>=0;s--){var a=this.queue[s];if(s==i-1)this.line.moveTo(a.x,a.y),o=a.x;else if(this.line.lineTo(a.x,a.y),o-a.x>410){this.isHead=!1,this.line.x=-a.x,n=s,this.queue=this.queue.slice(n);var r=this.oldX-this.line.x;this.grid1.x-=r,this.grid2.x-=r,-this.grid1.width>this.grid1.x&&(this.grid1.x=this.grid2.x+this.grid2.width),-this.grid2.width>this.grid2.x&&(this.grid2.x=this.grid1.x+this.grid1.width),this.oldX=this.line.x;break}}}},{key:"stopDraw",value:function(){if(null!=this.line){this.line.clear(),this.line.lineStyle(3,this.colorArr[this.colorIndex],1),this.line.x=0,this.grid1.x=0,this.grid2.x=this.grid1.width;var t=this.head_line_data.length,e=void 0;for(e=t-1;e>=0;e--){var i=this.head_line_data[e];e==t-1?this.line.moveTo(i.x,i.y):this.line.lineTo(i.x,i.y)}}}}]),e}(d["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(1);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.globalConfig=t.moduleMain.globalConfig,i.container=new PIXI.Sprite,i.index=0,i.vec=[],i.addChild(i.container),i}return s(e,t),a(e,[{key:"clear",value:function(){this.index=0,this.container.removeChildren(),this.vec.length=0}},{key:"draw",value:function(t){var e=this.container.toLocal(r.Point.vec2ToPoint(t.weldPy()),this.globalConfig.main.view),i=PIXI.Sprite.fromFrame("SpringVibrator/imgball");for(this.container.addChild(i),i.y=e.y,this.vec.push(i);this.vec.length>40;)this.container.removeChild(this.vec[0]),this.vec.splice(0,1);var o=void 0;for(o=0;this.vec.length>o;o++)this.vec[o].x+=.25*i.width,this.vec[o].alpha=.4,20>this.vec.length||o>10||(this.vec[o].alpha=.05*o)}}]),e}(PIXI.Container)},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(49),u=i(615),c=function(t){return t&&t.__esModule?t:{"default":t}}(u),d=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.container=null,i.readyDraw=!0,i.grc=new PIXI.Sprite,i.grid1=null,i.grid2=null,i.oldX=0,i.dragid=0,i.firstLine=null,i.secondLine=null,i.thirdLine=null,i.fourthLine=null,i.period=40,i.lastT=0,i.pos=0,i.velocity=0,i.m=1,i.queue=[],i.accArr=[],i.openFilter=!0,i.init(),i}return s(e,t),a(e,[{key:"init",value:function(){this.addChild(this.grc),this.grc.x=-5;var t=new PIXI.Graphics;t.beginFill(0),t.drawRect(-5,-160,410,320),t.endFill(),this.addChild(t),this.grc.mask=t,this.grid1=new PIXI.Graphics,this.grc.addChild(this.grid1),this.grid2=new PIXI.Graphics,this.grc.addChild(this.grid2),this.grid1.pivot.y=this.grid2.pivot.y=152,this.grid2.x=this.grid1.width,this.img=PIXI.Sprite.fromFrame("SpringVibrator/zuobiao"),this.addChild(this.img),this.img.pivot.x=40,this.img.pivot.y=187,this.container=new PIXI.Sprite,this.addChild(this.container),this.container.x=-10,this.firstLine=new PIXI.Graphics,this.container.addChild(this.firstLine),this.secondLine=new PIXI.Graphics,this.container.addChild(this.secondLine),this.thirdLine=new PIXI.Graphics,this.container.addChild(this.thirdLine),this.fourthLine=new PIXI.Graphics,this.container.addChild(this.fourthLine),this.lineArr=[this.firstLine,this.secondLine,this.thirdLine,this.fourthLine],this.checkBoxArr=[],this.touchIdArr=[],this.addDragSelf(),this.initCheckBox(),this.drawGrid()}},{key:"setPeriod",value:function(t){this.period=t/4,this.drawGrid()}},{key:"disposeAll",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disposeAll",this).call(this),this.removedCursor(this.firstCheckBox),this.removedCursor(this.secondCheckBox),this.removedCursor(this.thirdCheckBox),this.removedCursor(this.fourthCheckBox),h.M.removeTouch(this.firstCheckBox,this.firstTouchid),h.M.removeTouch(this.secondCheckBox,this.secondTouchid),h.M.removeTouch(this.thirdCheckBox,this.thirdTouchid),h.M.removeTouch(this.fourthCheckBox,this.fourthTouchid)}},{key:"initCheckBox",value:function(){var t=this,i=this.globalConfig.main.language.getLocaleStr("wave_form");this.firstCheckBox=this.createCheckBox(30,180,"s-t "+i,16711680),this.secondCheckBox=this.createCheckBox(230,180,"v-t "+i,65280),this.thirdCheckBox=this.createCheckBox(30,215,"a-t "+i,255),this.fourthCheckBox=this.createCheckBox(230,215,"f-t "+i,16711935),this.checkBoxArr=[this.firstCheckBox,this.secondCheckBox,this.thirdCheckBox,this.fourthCheckBox];for(var o=0;this.checkBoxArr.length>o;o++)!function(i){var o=t.checkBoxArr[i];o.id=i,t.addCursor(o,"hand"),t.touchIdArr[i]=h.M.addTouch(o,{tab:function(i){t.showWave(o.id,!o.checked),t.dispatchEvent(e.WAVE_VISIBLE_CHANGED,o.id,o.checked)}},t)}(o)}},{key:"createCheckBox",value:function(t,e,i,o){var n=new p(i,o);return n.x=t,n.y=e,this.addChild(n),n}},{key:"reset",value:function(){this.grid1.x=0,this.grid2.x=this.grid1.width,this.oldX=0,this.fourthLine.x=this.thirdLine.x=this.secondLine.x=this.firstLine.x=0,this.queue.length=0,this.accArr.length=0,this.lastT=0,this.velocity=0,this.pos=0}},{key:"getLineNum",value:function(){return this.lineArr.length}},{key:"getWaveVisible",value:function(t){return this.lineArr[t].visible}},{key:"showWave",value:function(t,e){var i=this.lineArr[t],o=this.checkBoxArr[t];i.visible=e,o.setChecked(e)}},{key:"draw",value:function(t,e){var i=e-this.pos,o=i-this.velocity;if(1>this.queue.length&&(i=0),2>this.queue.length&&(o=0),this.accArr.push({a:o,v:i}),this.openFilter&&this.queue.length>=3){var n=(0,l.takeRight)(this.accArr,5),s=[],a=[];(0,l.forEach)(n,function(t){s.push(t.a),a.push(t.v)}),s=s.sort(function(t,e){return t>e?1:-1}),a=a.sort(function(t,e){return t>e?1:-1});for(var r=s.length,h=0,u=0,c=1;r-1>c;c++)h+=s[c],u+=a[c];o=h/(r-2),i=u/(r-2)}this.pos=e,this.velocity=i,this.lastT=t,this.queue.push({x:t/10,y:e/2.5,v:6*i/2.5,a:10*o/2.5,f:.5*this.m*o/2.5}),this.firstLine.clear(),this.firstLine.lineStyle(3,16711680,1),this.secondLine.clear(),this.secondLine.lineStyle(3,65280,1),this.thirdLine.clear(),this.thirdLine.lineStyle(3,255,1),this.fourthLine.clear(),this.fourthLine.lineStyle(3,16711935,1);var d=this.queue.length,p=void 0,y=void 0;for(y=d-1;y>=2;y--){var f=this.queue[y],g=this.queue[y-1];if(y===d-1)this.firstLine.moveTo(f.x,g.y),this.secondLine.moveTo(f.x,g.v),this.thirdLine.moveTo(f.x,f.a),this.fourthLine.moveTo(f.x,f.f),p=f.x;else if(this.firstLine.lineTo(f.x,g.y),this.secondLine.lineTo(f.x,g.v),this.thirdLine.lineTo(f.x,f.a),this.fourthLine.lineTo(f.x,f.f),p-f.x>410){this.queue=this.queue.slice(y),this.fourthLine.x=this.thirdLine.x=this.secondLine.x=this.firstLine.x=-f.x;var b=this.oldX-this.firstLine.x;this.grid1.x-=b,this.grid2.x-=b,-this.grid1.width>this.grid1.x&&(this.grid1.x=this.grid2.x+this.grid2.width),-this.grid2.width>this.grid2.x&&(this.grid2.x=this.grid1.x+this.grid1.width),this.oldX=this.firstLine.x;break}}}},{key:"drawGrid",value:function(){this.grid1.clear(),this.grid1.lineStyle(1,9725498,1),this.grid2.clear(),this.grid2.lineStyle(1,9725498,1);for(var t=304,e=Math.ceil(410/this.period),i=t/this.period,o=e*this.period,n=-this.grid1.x,s=(t-Math.floor(i)*this.period)/2,a=Math.ceil(n/this.period)*this.period-n,r=0;e>r;r++){var l=n+this.period*r+a;h.M.drawDashed(this.grid1,new PIXI.Point(l,0),new PIXI.Point(l,t),6,2),h.M.drawDashed(this.grid2,new PIXI.Point(l,0),new PIXI.Point(l,t),6,2)}for(var u=0;i>=u;u++){var c=0+this.period*u+s;h.M.drawDashed(this.grid1,new PIXI.Point(n,c),new PIXI.Point(n+o-1,c),3,3),h.M.drawDashed(this.grid2,new PIXI.Point(n,c),new PIXI.Point(n+o-1,c),3,3)}}}]),e}(c["default"]);d.WAVE_VISIBLE_CHANGED="waveVisbleChanged",e["default"]=d;var p=function(t){function e(t,i){o(this,e);var s=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return s.id=0,s.text=t,s.lineColor=i,s.kuang=PIXI.Sprite.fromFrame("SpringVibrator/kuang"),s.gou=PIXI.Sprite.fromFrame("SpringVibrator/gou"),s.addChild(s.gou),s.addChild(s.kuang),s.tf=new PIXI.Text(s.text,{font:"20px Arial",fill:s.lineColor}),s.addChild(s.tf),s.tf.x=35,s.lineStyle(4,s.lineColor,1),s.moveTo(120,10),s.lineTo(160,10),s.checked=!0,s}return s(e,t),a(e,[{key:"setChecked",value:function(t){this.checked=t,this.gou.visible=this.checked}}]),e}(PIXI.Graphics)},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(615),c=o(u),d=i(614),p=o(d);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.colorArr=[16711680,16776960],i.textrueArr=null,i.colorIndex=0,i.vec=[],i.container=null,i.readyDraw=!0,i.grc=new PIXI.Sprite,i.grid1=null,i.grid2=null,i.oldX=0,i.shapeVec=[],i.firstLine=null,i.hisObj={},i.init(),i}return a(e,t),r(e,[{key:"init",value:function(){this.addChild(this.grc),this.grc.x=-5;var t=new PIXI.Graphics;t.beginFill(0),t.drawRect(-5,-160,410,320),t.endFill(),this.addChild(t),this.grc.mask=t,this.grid1=PIXI.Sprite.fromFrame("TwoPendulum/coorBg"),this.grc.addChild(this.grid1),this.grid2=PIXI.Sprite.fromFrame("TwoPendulum/coorBg"),this.grc.addChild(this.grid2),this.grid1.pivot.y=this.grid2.pivot.y=152,this.grid2.x=this.grid1.width,this.var_img=PIXI.Sprite.fromFrame("TwoPendulum/zuobiao"),this.addChild(this.var_img),this.var_img.pivot.x=40,this.var_img.pivot.y=187,this.container=new PIXI.Sprite,this.addChild(this.container),this.container.x=-10,this.createView(),this.addDragSelf()}},{key:"createView",value:function(){var t=void 0;for(t=0;this.colorArr.length>t;t++){var e=new PIXI.Graphics;e.lineStyle(3,this.colorArr[t]),this.shapeVec.push(e),this.container.addChild(e);var i=new p["default"](this.paramObj,"","",null,30,"TwoPendulum");i.line=e,i.owner=this;var o=String.fromCharCode(65+t);"A"==o?i.checkLabel(this.language.getLocaleStr("wave_ball_A")):"B"==o&&i.checkLabel(this.language.getLocaleStr("wave_ball_B")),this.addChild(i),i.x=20+200*t,i.y=180,this.vec.push(i)}this.addEventListener("showOneLine",this.showThisImg)}},{key:"showThisImg",value:function(t){t.boo?this.container.addChild(t.ln):this.container.removeChild(t.ln)}},{key:"removed",value:function(){for(var t=0;this.vec.length>t;t++){this.vec[t].dispose()}this.vec.length=0,this.removeEventListener("showOneLine",this.showThisImg),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"reset",value:function(){this.hisObj={};var t=void 0;for(t=0;this.shapeVec.length>t;t++)this.shapeVec[t].clear(),this.shapeVec[t].lineStyle(3,this.colorArr[t]),this.shapeVec[t].x=0;this.grid1.x=0,this.grid2.x=this.grid1.width,this.oldX=0}},{key:"draw",value:function(t,e,i){var o=void 0;if(null==this.hisObj[t])o=[],o.push({x:e/10,y:-i/2.5}),this.hisObj[t]=o;else{o=this.hisObj[t];var n=new l.Point(e/10,-i/2.5),s=new l.Point(o[o.length-1].x,o[o.length-1].y);if(1>l.Point.distance(n,s))return;o.push({x:e/10,y:-i/2.5})}null==this.firstLine&&(this.firstLine=this.shapeVec[t]);var a=this.shapeVec[t];a.clear(),a.lineStyle(3,this.colorArr[t],1);for(var r=o.length,h=void 0,u=-1,c=r-1;c>=0;c--){var d=o[c];if(c==r-1)a.moveTo(d.x,d.y),h=d.x;else if(a.lineTo(d.x,d.y),h-d.x>410){if(a.x=-d.x,u=c,o=o.slice(u),this.firstLine==a){var p=this.oldX-this.firstLine.x;this.grid1.x-=p,this.grid2.x-=p,-this.grid1.width>this.grid1.x&&(this.grid1.x=this.grid2.x+this.grid2.width),-this.grid2.width>this.grid2.x&&(this.grid2.x=this.grid1.x+this.grid1.width),this.oldX=this.firstLine.x}break}}}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}();e["default"]=function(t){function e(){o(this,e);var t=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.xinArr=[],t.pullOneArr=[],t.rotationXi=1,t}return s(e,t),a(e,[{key:"dispose",value:function(){this.pullOneArr.length=0,this.xinArr.length=0,this.removeChildren()}},{key:"addBack",value:function(t,e,i){e=e||0,i=i||0,this.addChild(t),t.x=e,t.y=i}},{key:"addAndSetXY_xinArr",value:function(t,e,i){this.addChild(t),t.pivot.x=t.width/2,t.pivot.y=t.height/2,this.xinArr.push(t),t.x=e,t.y=i}},{key:"fresh_rotation",value:function(t){if(this.pullOneArr.length==this.xinArr.length){var e=void 0;for(e=0;this.xinArr.length>e;e++){this.xinArr[e].rotation-=t*this.pullOneArr[e].rotationXi}}}},{key:"pushOne",value:function(t){this.pullOneArr.push(t)}},{key:"clear",value:function(){this.pullOneArr.length=0}}]),e}(PIXI.Container)},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(1),h=i(226),l=function(t){return t&&t.__esModule?t:{"default":t}}(h);e["default"]=function(t){function e(t,i,s,a){o(this,e);var h=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,a));return h.type=i,h.leftP=new r.Point(-t.w/2,0),h.rightP=new r.Point(t.w/2,0),h.cenP=new r.Point(0,0),h.bottomP=new r.Point(0,t.h/2),h.topP=new r.Point(0,-t.h/2),h.y=s,h.rotationXi=1,h}return s(e,t),a(e,[{key:"set_rotationXi",value:function(t){this.rotationXi=t}},{key:"gLeftP",value:function(){return this.toGlobalView(this.leftP,this)}},{key:"gRightP",value:function(){return this.toGlobalView(this.rightP,this)}},{key:"gCenP",value:function(){return this.toGlobalView(this.cenP,this)}},{key:"gBottomP",value:function(){return this.toGlobalView(this.bottomP,this)}},{key:"gBottomP_gou",value:function(){return this.toGlobalView(this.bottomP.add(new r.Point(0,38)),this)}},{key:"gTopP_gou",value:function(){return this.toGlobalView(this.topP.add(new r.Point(0,0)),this)}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function b(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:b(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(451),c=o(u),d=i(449),p=o(d),y=void 0,f=void 0,g=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.geom.Vec2,g=y.geom.Ray,i.horStr=i.language.getLocaleStr("par_horizontal"),i.verStr=i.language.getLocaleStr("par_vertical"),i.dirArr=[i.horStr,i.verStr],i.firearr=["左侧发射","右侧发射","双向发射"],i.lockDir=i.horStr,i.fireDir=1,i.lineStart={x:102,y:20},i.currentMass=50,i.bdshape=null,i.bindCar=null,i.oldSensor1=null,i.oldSensor2=null,i.lstep=0,i}return a(e,t),r(e,[{key:"init",value:function(){this._width=200,this._height=112,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.dragLevel=3,this.bdshape=this.body.get_shapes().at(0),this.body.set_allowRotation(!1),this.body.set_mass(this.currentMass),this.addlistenJoints(),this.fireDirChange({showValue:this.firearr[this.fireDir]})}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return this.bindCar&&(t.caruid=this.bindCar.UID),t.fire=this.firearr[this.fireDir],t.mass=this.currentMass,t}},{key:"setData",value:function(t){var i=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.caruid&&setTimeout(function(){i.endDragHandler()},10),t.fire&&this.fireDirChange({showValue:t.fire}),t.mass&&this.changMass({showValue:t.mass})}},{key:"addlistenJoints",value:function(){var t=this,e={x:0,y:0},i=null;this.beginDragHandler=function(o){t.bdshape.set_sensorEnabled(!0),t.bindCar&&(e=o.data.global,(i=t.body.userData.dragManager)&&i.handJoint.set_active(!1))},this.moveDragHandler=function(o){if(t.bindCar){l.Point.distance(e,o.data.global)>50&&(i.handJoint.set_active(!0),i=null,t.bindCar&&(t.bindCar.unBindDmSensor(),t.bindCar=null,t.bg.alpha=1,t.body.set_allowRotation(!1),t.body.set_rotation(0)))}},this.endDragHandler=function(){if(!t.bindCar){t.body.get_arbiters().foreach(function(e){var i=e.get_body1(),o=e.get_body2(),n=i;i==t.body&&(n=o);var s=n.userData.view;if(s&&"SensorCar"==s.classname){if(s.bindJoint)return;t.lockDirChange({showValue:t.horStr}),s.bindDmSensor(t.body),t.bindCar=s,t.bg.alpha=0,t.body.set_allowRotation(!0)}}),t.bdshape.set_sensorEnabled(!1)}},this.addEventListener(p["default"].BEGIN,this.beginDragHandler),this.addEventListener(p["default"].END,this.endDragHandler),this.addEventListener(p["default"].MOVE,this.moveDragHandler)}},{key:"lockDirChange",value:function(t){var e=t.showValue;this.lockDir=e,e==this.horStr?this.body.set_rotation(0):e==this.verStr&&this.body.set_rotation(-Math.PI/2)}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this);try{this.lstep++;var t=.5;60>this.lstep?t=.5:90>this.lstep?t=0:this.lstep=1;var i=[];i.push({option:"line",step:"start"}),i.push({type:"lineStyle",thin:2,color:16711680,alpha:t});var o=this.body.localPointToWorld(f.get(0,this.lineStart.y)),n=this.body.localPointToWorld(f.get(this.lineStart.x,this.lineStart.y)),s=n.sub(o),a=this.body.localPointToWorld(f.get(-this.lineStart.x,this.lineStart.y)),r=a.sub(o),l=this.oldSensor1,u=this.oldSensor2;0==this.fireDir?(this.oldSensor1=this.jsDistance(a,r,i),this.oldSensor2=null):1==this.fireDir?(this.oldSensor1=null,this.oldSensor2=this.jsDistance(n,s,i)):(this.oldSensor1=this.jsDistance(a,r,i),this.oldSensor2=this.jsDistance(n,s,i)),l&&l!=this.oldSensor1&&l.userData.view.recevieData(null),u&&u!=this.oldSensor2&&u.userData.view.recevieData(null),i.length>2&&this.getTopGrc().dispatchEvent("Start_Graphic",i,this.UID)}catch(c){}this.bindCar&&(this.bdshape.get_sensorEnabled()||this.bdshape.set_sensorEnabled(!0))}},{key:"jsDistance",value:function(t,e,i){var o=new g(t,e),n=this.space.rayCast(o),s=null;if(n){var a=o.at(n.get_distance());i.push({type:"moveTo",line_x:t.get_x(),line_y:t.get_y()}),i.push({type:"lineTo",line_x:a.get_x(),line_y:a.get_y()});var r=n.get_shape();"DisplacementReceive"===r.get_userData().sensorType&&(s=r.get_body(),s.userData.view.recevieData(n))}return s}},{key:"removed",value:function(){this.removeEventListener(p["default"].BEGIN,this.beginDragHandler),this.removeEventListener(p["default"].END,this.endDragHandler),this.removeEventListener(p["default"].MOVE,this.moveDragHandler),this.bindCar&&(this.bindCar.unBindDmSensor(),this.bindCar=null,this.bg.alpha=1),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"changMass",value:function(t){var e=t.showValue;this.body.set_mass(e),this.currentMass=e}},{key:"fireDirChange",value:function(t){this.fireDir=this.firearr.indexOf(t.showValue)}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.getScrollBar([this.getLocaleStr("mass","质量"),!0,"g",500,10,this.currentMass,1,this.changMass,this]),this.getDropMenu([this.getLocaleStr("发射方向","发射方向"),!1,"",this.firearr[this.fireDir],this.firearr,this,this.fireDirChange,1,0])),this.bindCar||t.confArr.unshift(this.getDropMenu([this.getLocaleStr("lock_direction","锁定方向"),!1,"",this.lockDir,this.dirArr,this,this.lockDirChange,1,0])),t}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function v(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:v(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(451),u=o(l),c=i(449),d=o(c),p=void 0,y=void 0,f=void 0,g=void 0,b=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return p=i.phy.nape,y=p.phys.BodyType,f=p.shape.Polygon,g=p.geom.Vec2,i.horStr=i.language.getLocaleStr("par_horizontal"),i.verStr=i.language.getLocaleStr("par_vertical"),i.dirArr=[i.horStr,i.verStr],i.lockDir=i.horStr,i.level=16,i.sensor=null,i.disvalue=0,i.stateReversal=!1,i.tlnum=5-10*Math.random(),i.startValue=0,i.showStart=!1,i.istl=!1,i.isSensor=!0,i.defaultName="S",i.sfObj={sensor:{x:88,y:19},tl:{x:-98,y:-6},tl2:{x:35,y:-6},txt:{x:80},txt2:{x:80}},i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;this._width=200,this._height=112,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_allowRotation(!1),this.body.set_type(y.get_KINEMATIC()),this.sensor=new f(f.box(28,28)),this.body.add(this.sensor),this.sensor.get_userData().sensorType="DisplacementReceive",this.sensor.set_localCOM(g.get(-this.sfObj.sensor.x,this.sfObj.sensor.y)),this.recevieData(null),this.bg.tlBtn.scale.x=.9,this.bg.tlBtn.scale.y=.9,this.bg.tlBtn.tab=function(){t.sensorZero(),t.recevieData(null)},this.addDragListeners()}},{key:"addDragListeners",value:function(){var t=this;this.dragEnd=function(e){var i=t.body.get_arbiters(),o=null;if(i.foreach(function(t){if(!o){var e=t.get_shape1(),i=t.get_shape2();"dragshape"==e.stype&&(o=t.get_body1()),"dragshape"==i.stype&&(o=t.get_body2())}}),o)t.body.set_rotation(o.get_rotation());else{var n=t.body.get_rotation();0!=n&&n!=-Math.PI/2&&t.body.set_rotation(0)}},this.addEventListener(d["default"].END,this.dragEnd)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);this.istl&&(t.tl=!0),t.dir=this.lockDir,t.reversal=this.stateReversal;var i=this.body.get_rotation();return 0!=i&&i!=-Math.PI/2&&(t.qxieRot=i),t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.tl&&this.sensorZero(),this.lockDirChange({showValue:t.dir}),this.changeReversal({checked:t.reversal}),isNaN(t.qxieRot)||this.body.set_rotation(t.qxieRot)}},{key:"lockDirChange",value:function(t){var e=t.showValue;this.lockDir=e,e==this.horStr?this.body.set_rotation(0):e==this.verStr&&this.body.set_rotation(-Math.PI/2)}},{key:"recevieData",value:function(t){if(t){this.disvalue=t.get_distance()/this.NapeConst.NB_WORLD_GRAVITY_PER_N,this.bg.txt.text=(this.disvalue+this.tlnum-this.startValue).toFixed(2),this.showStart=!0}else this.bg.txt.text=this.tlnum.toFixed(2),this.showStart=!1,this.startValue=0;this.bg.txt.x=this.stateReversal?-this.sfObj.txt2.x:this.sfObj.txt.x-this.bg.txt.width}},{key:"startValueChange",value:function(){this.tlnum=0,this.startValue=this.disvalue}},{key:"changeReversal",value:function(t){this.stateReversal=t.checked,this.stateReversal?(this.bg.mc.currentFrame=1,this.sensor.set_localCOM(g.get(this.sfObj.sensor.x,this.sfObj.sensor.y)),this.bg.tlBtn.x=this.sfObj.tl2.x,this.bg.txt.x=-this.sfObj.txt2.x):(this.bg.mc.currentFrame=0,this.sensor.set_localCOM(g.get(-this.sfObj.sensor.x,this.sfObj.sensor.y)),this.bg.tlBtn.x=this.sfObj.tl.x,this.bg.txt.x=this.sfObj.txt.x-this.bg.txt.width)}},{key:"removed",value:function(){this.bg.tlBtn.dispose(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.getDropMenu([this.getLocaleStr("lock_direction","锁定方向"),!1,"",this.lockDir,this.dirArr,this,this.lockDirChange,1,0]),this.getSwitch([this.getLocaleStr("reversal","反转"),this.stateReversal,this.changeReversal,this])),this.showStart&&t.confArr.push(this.getButton(["",this.getLocaleStr("设为起始值","设为起始值"),this.startValueChange,this])),t}},{key:"getParam",value:function(t){var e=0;switch(t){case"S":e=this.disvalue+this.tlnum-this.startValue}return e}},{key:"sensorZero",value:function(){this.tlnum=0,this.istl=!0,this.recevieData(null)}}]),e}(u["default"]);e["default"]=b,window.DisplacementReceive=b},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function w(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:w(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(449),c=o(u),d=i(451),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0,m=void 0,x=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.phys.BodyType,g=y.shape.Polygon,b=y.geom.Vec2,v=y.callbacks.CbType,_=y.callbacks.CbEvent,x=y.callbacks.InteractionType,m=y.callbacks.InteractionListener,i.level=12,i.touchid=null,i.useTop=!0,i.spdoor=null,i.cbType=new v,i.stS=0,i.stW=0,i.bindBoard=null,i.isSensor=!0,i.defaultName="t",i}return a(e,t),r(e,[{key:"init",value:function(){this._width=24,this._height=275,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_allowRotation(!1),this.body.get_shapes().at(0).set_sensorEnabled(!0),this.body.set_type(f.get_KINEMATIC());var t=this.topCon.toLocal({x:this.door.x,y:this.door.y},this);this.topCon.addChild(this.door),this.topCon.interactive=!0,this.topCon.interactiveChildren=!0,this.door.x=t.x,this.door.y=t.y,this.addDragDoor(),this.addShapeDoor(),this.addInteractionListener()}},{key:"removed",value:function(){this.removeNapeListeners(this.s1HitStart),this.removeNapeListeners(this.s1HitEnd),l.M.removeTouch(this.door,this.touchid),this.removeEventListener(c["default"].BEGIN,this.beginDragFunc),this.removeEventListener(c["default"].END,this.endDragFunc),this.bindBoard&&(this.bindBoard.unbindGate(this),this.bindBoard=null),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"addShapeDoor",value:function(){this.spdoor=new g(g.box(2,24)),this.spdoor.set_sensorEnabled(!0),this.spdoor.get_cbTypes().add(this.cbType),this.body.add(this.spdoor),this.spdoor.set_localCOM(b.get(0,this.door.y+51))}},{key:"addDragDoor",value:function(){var t=this;this.door.y=20;var e={x:0,y:0};this.touchid=l.M.addTouch(this.door,{begin:function(i){var o=t.getMouseXY(i);o=t.toLocal(o,t.main.view),e.y=o.y,t.body.forbidDrag(!0)},move:function(i){var o=t.getMouseXY(i);o=t.toLocal(o,t.main.view),t.door.y+=o.y-e.y,e.y=o.y,-40>t.door.y&&(t.door.y=-40),t.door.y>40&&(t.door.y=40),t.spdoor.set_localCOM(b.get(0,t.door.y+51))},end:function(e){t.body.forbidDrag(!1),t.spdoor.set_localCOM(b.get(0,t.door.y+51))}})}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.doory=this.door.y,t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),isNaN(t.doory)||(this.door.y=t.doory,this.spdoor.set_localCOM(b.get(0,this.door.y+51)))}},{key:"setDataOver",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setDataOver",this).call(this,t),this.endDragFunc()}},{key:"addInteractionListener",value:function(){var t=this;this.s1HitStart=new m(_.get_BEGIN(),x.get_SENSOR(),this.cbType,this.CbTypeStr.SHELTER_LIGHT,function(t){}),this.s1HitEnd=new m(_.get_END(),x.get_SENSOR(),this.cbType,this.CbTypeStr.SHELTER_LIGHT,function(e){var i=e.get_int2().get_body(),o=i.userData.view,n=o.dgpw,s=i.get_velocity().get_x(),a=Math.abs(s)/t.NapeConst.K_VELOCITY;t.stS=.01*n/a,t.stW=n,t.sensorDataChanged(null)}),this.addNapeListeners(this.s1HitStart),this.addNapeListeners(this.s1HitEnd),this.endDragFunc=function(){var e=t.BodyUtil.findArbMc(t.body,"SensorBoardBg");t.bindBoard?e||(t.bindBoard.breakGateFromMc(t),t.body.set_allowRotation(!1)):e&&(e.parent.bindGate(t),t.body.set_allowRotation(!0))},this.beginDragFunc=function(){t.bindBoard&&t.bindBoard.breakGateFromMc(t)},this.addEventListener(c["default"].BEGIN,this.beginDragFunc),this.addEventListener(c["default"].END,this.endDragFunc)}},{key:"setBindBoard",value:function(t){this.bindBoard=t,this.body.set_type(t?f.get_DYNAMIC():f.get_KINEMATIC()),this.BodyUtil.frezzBody(this.body)}},{key:"getParam",value:function(t){var e=0;switch(t){case"T":e=this.stS;break;case"W":e=.01*this.stW}return e}}]),e}(p["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function T(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:T(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(451),c=o(u),d=i(449),p=o(d),y=i(507),f=o(y),g=void 0,b=void 0,v=void 0,_=void 0,m=void 0,x=void 0,w=void 0,k=void 0,P=void 0,O=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return g=i.phy.nape,b=g.NbBody,v=g.phys.BodyType,_=g.shape.Polygon,x=g.callbacks.ConstraintListener,w=g.callbacks.CbEvent,m=g.geom.Vec2,k=g.callbacks.CbType,P=g.phys.Material,O=g.shape.HitShape,i.level=13,i.bindJoint=null,i.upJp={x:85,y:-62,cx:0,cy:0},i.downJp={x:115,y:-30,cx:0,cy:0},i.boardLength=50,i.prevscale=1,i.pulleyLine=new PIXI.Graphics,i.kd=new f["default"](i.paramObj),i.czi=[i.getLocaleStr("none","无"),i.getLocaleStr("glass","玻璃"),i.getLocaleStr("cotton","棉布"),i.getLocaleStr("towel","毛巾")],i.caizhi=0,i.mcxs=[.4,.2,.6,.8],i.curtf=i.mcxs[0],i.selfsp=null,i.dragsp=null,i.dangsp=null,i.tssp=null,i.dangbdJoint=null,i.gate1=null,i.gate2=null,i.lineJoint1=null,i.lineJoint2=null,i.weldJoint1=null,i.weldJoint2=null,i.deskBody=null,i.pivotJoint=null,i.dangBody=null,i.dangJoint=null,i.pullJs={top:null,bottom:null},i.topBox=null,i.botBox=null,i.topHock=null,i.botHock=null,i.topHockCbType=new k,i.botHockCbType=new k,i.distanceJ1=null,i.distanceJ2=null,i.pullJoint=null,i.hidePull=!1,i.towel=null,i.glass=null,i.cotton=null,i.materialGp=new PIXI.Container,i.dangbd=null,i.tsJoint=null,i.tsSpeed=0,i.tscar=null,i}return a(e,t),r(e,[{key:"init",value:function(){this.points=[{x:750,y:-2},{x:-750,y:-2},{x:-750,y:64},{x:750,y:64}],this.material=new P(.4,1,2,.7,2),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.dragLevel=-1,this.body.userData.view=this.bg,this.body.set_allowRotation(!1),this.body.set_mass(30),this.body.userData.bindupdate={field:this,func:this.update},this.bg.classname="SensorBoardBg",this.addBodyToSpace(this.body,this),this.addOtherShapes(),this.initBoard(),this.initDesk(),this.tsDevice(),this.changeBoardW(),this.dragListeners(),this.changeCaizhi(!1)}},{key:"tsDevice",value:function(){var t=this;this.bg.tsBtn.fontColor="#ffffff",this.bg.tsBtn.text="弹射",this.bg.tsBtn.tab=function(){if(t.tsJoint){var e=t.tsJoint.get_body2(),i=m.get(1,1);i.set_angle(e.get_rotation()),i.set_length(150*t.tsSpeed),e.set_velocity(i),t.BodyUtil.destoryJoint(t.tsJoint),t.tsJoint=null}t.tscar=null},this.tssp=new _(_.rect(0,0,100,100)),this.tssp.get_userData().sensorType="tansheq",this.tssp.get_userData().tsLockCar=function(e){t.tsLockCar(e)},this.body.get_shapes().add(this.tssp),this.tssp.set_sensorEnabled(!0)}},{key:"tsLockCar",value:function(t){if(!this.tsJoint){this.tscar=t;var e=this.tssp.get_localCOM(),i=t.body.get_position();e=e.add(m.get(20,0)),i=m.get(-100,18);var o=new g.constraint.PivotJoint(this.body,t.body,e,i);o.set_ignore(!0),o.set_stiff(!0),o.set_damping(0),o.set_frequency(1e5),o.set_space(this.space),this.tsJoint=o}}},{key:"initPullLine",value:function(){var t=this;if(!this.hidePull){if(!this.topBox){this.topBox=new PIXI.Graphics,this.bg.addChild(this.topBox),this.botBox=new PIXI.Graphics,this.bg.addChild(this.botBox),this.bg.addChildAt(this.pulleyLine,1);var e=this.body.get_shapes();this.topHock=new O(15),e.add(this.topHock),this.topHock.addCbtype(this.topHockCbType),this.topHock.createListener(this.topHockCbType,this.CbTypeStr.SENSOR_CAR,function(e){t.hockConnect(e,t.topHock)}),this.botHock=new O(15),this.botHock.addCbtype(this.botHockCbType),e.add(this.botHock),this.botHock.createListener(this.botHockCbType,this.CbTypeStr.SENSOR_ALL,function(e){t.hockConnect(e,t.botHock)})}this.upJp.cx=this.bg.mc2.x+this.upJp.x,this.upJp.cy=this.bg.mc2.y+this.upJp.y,this.downJp.cx=this.bg.mc2.x+this.downJp.x,this.downJp.cy=this.bg.mc2.y+this.downJp.y;this.topBox.beginFill(16711680,0),this.topBox.drawRect(-25,-25,50,50),this.topBox.endFill(),this.botBox.beginFill(16711680,0),this.botBox.drawRect(-25,-25,50,50),this.botBox.endFill(),this.topBox.x=0,this.topBox.y=this.upJp.cy,this.botBox.x=this.downJp.cx,this.botBox.y=this.downJp.cy+300,this.drawPullLine(),this.changePullHockPos()}}},{key:"hockConnect",value:function(t,e){var i=t.get_int1(),o=t.get_int2(),n=null;n=e==i?o:i;var s=n.get_body(),a=void 0,r=n.get_worldCOM(),h=void 0;if(e==this.topHock?(a=this.body.localPointToWorld(m.get(this.upJp.cx,this.upJp.cy)),h=m.distance(a,r),this.distanceJ1=this.JointUtil.createDistanceJoint(this.body,s,a,r,50,h),this.topHock.setFirstDrag(!0)):(a=this.body.localPointToWorld(m.get(this.downJp.cx,this.downJp.cy)),h=m.distance(a,r),this.distanceJ2=this.JointUtil.createDistanceJoint(this.body,s,a,r,50,h),this.botHock.setFirstDrag(!0)),this.distanceJ1&&this.distanceJ2){var l=this.distanceJ1.get_jointMax(),u=this.distanceJ2.get_jointMax(),c=l+u,d=this.distanceJ1.get_body2(),p=this.distanceJ2.get_body2(),y=d.localPointToWorld(this.distanceJ1.get_anchor2()),f=this.body.localPointToWorld(m.get(this.upJp.cx,this.upJp.cy)),g=this.body.localPointToWorld(m.get(this.downJp.cx,this.downJp.cy)),b=p.localPointToWorld(this.distanceJ2.get_anchor2());this.BodyUtil.destoryJoint(this.distanceJ1),this.BodyUtil.destoryJoint(this.distanceJ2),this.distanceJ1=null,this.distanceJ2=null,this.pullJoint=this.JointUtil.createPulleyJoint(d,this.body,this.body,p,y,f,g,b,0,c)}return!0}},{key:"changePullHockPos",value:function(){this.topHock.set_localCOM(m.get(this.topBox.x,this.topBox.y)),this.botHock.set_localCOM(m.get(this.botBox.x,this.botBox.y))}},{key:"drawPullLine",value:function(){this.pulleyLine.clear(),this.pulleyLine.lineStyle(2,16750848),this.pulleyLine.moveTo(this.topBox.x,this.topBox.y),this.pulleyLine.lineTo(this.upJp.cx,this.upJp.cy),this.pulleyLine.moveTo(this.downJp.cx,this.downJp.cy),this.pulleyLine.lineTo(this.botBox.x,this.botBox.y)}},{key:"dragListeners",value:function(){var t=this;this.boardDragBegin=function(){t.body.set_allowRotation(!0)},this.boardDragEnd=function(){t.body.set_allowRotation(!1),t.BodyUtil.frezzBody(t.body)},this.boardClick=function(e){if(t.topHock){var i=l.M.getMouseXY(e),o=t.topHock.contains(m.get(i.x,i.y)),n=t.botHock.contains(m.get(i.x,i.y));t.distanceJ1&&o&&(t.BodyUtil.destoryJoint(t.distanceJ1),t.topHock.leaveing=!0,t.distanceJ1=null,t.topHock.addEndListener()),t.distanceJ2&&n&&(t.BodyUtil.destoryJoint(t.distanceJ2),t.botHock.leaveing=!0,t.distanceJ2=null,t.botHock.addEndListener()),t.pullJoint&&(o||n)&&(t.BodyUtil.destoryJoint(t.pullJoint),t.pullJoint=null,o&&(t.topHock.leaveing=!0,t.topHock.addEndListener()),n&&(t.botHock.leaveing=!0,t.botHock.addEndListener()))}},this.bg.addEventListener(p["default"].BEGIN,this.boardDragBegin),this.bg.addEventListener(p["default"].END,this.boardDragEnd),this.bg.addEventListener(p["default"].CLICK,this.boardClick);var e={x:0,y:0};this.tbboxBegin=function(i,o){t.body.userData.noDrag=!0;var n=l.M.getMouseXY(i);e=t.bg.toLocal(n),o==t.topBox?t.topHock.draging(!0):t.botHock.draging(!0)},this.tbboxMove=function(i,o){t.movePullPos(i,e,o)},this.tbboxEnd=function(i,o){t.body.userData.noDrag=!1,t.movePullPos(i,e,o),t.topHock.draging(!1),t.botHock.draging(!1)},this.topboxId=l.M.addTouch(this.topBox,{begin:function(e){t.distanceJ1||t.pullJoint||t.tbboxBegin(e,t.topBox)},move:function(e){t.distanceJ1||t.pullJoint||t.tbboxMove(e,t.topBox)},end:function(e){t.distanceJ1||t.pullJoint||t.tbboxEnd(e,t.topBox)}}),this.topboxId=l.M.addTouch(this.botBox,{begin:function(e){t.distanceJ2||t.pullJoint||t.tbboxBegin(e,t.botBox)},move:function(e){t.distanceJ2||t.pullJoint||t.tbboxMove(e,t.botBox)},end:function(e){t.distanceJ2||t.pullJoint||t.tbboxEnd(e,t.botBox)}})}},{key:"movePullPos",value:function(t,e,i){var o=l.M.getMouseXY(t);o=this.bg.toLocal(o),i.x+=o.x-e.x,i.y+=o.y-e.y,e.x=o.x,e.y=o.y,this.drawPullLine(),this.changePullHockPos()}},{key:"initBoard",value:function(){this.bg.removeChild(this.bg.mc1),this.bg.mc1=this.createNineSlice("SensorBoard/banTexture"),this.bg.addChildAt(this.bg.mc1,0),this.bg.addChildAt(this.materialGp,2),this.bg.mc1.pivot.y=62.5,this.bg.addChild(this.kd),this.towel=this.createNineSlice("SensorBoard/towel",20,20,20,20),this.glass=this.createNineSlice("SensorBoard/glass",20,20,20,20),this.cotton=this.createNineSlice("SensorBoard/cotton",20,20,20,20),this.materialGp.addChild(this.towel),this.materialGp.addChild(this.glass),this.materialGp.addChild(this.cotton),this.materialGp.pivot.y=40}},{key:"initDesk",value:function(){this.desk.removeChild(this.desk.middle),this.desk.middle=this.createNineSlice("SensorBoard/d_middle",40,40,40,40),this.desk.addChildAt(this.desk.middle,0),this.desk.middle.y=this.desk.left.y}},{key:"createNineSlice",value:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:50,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:50,o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:50,n=arguments.length>4&&arguments[4]!==undefined?arguments[4]:50;return new PIXI.mesh.NineSlicePlane(PIXI.Texture.fromFrame(t),e,i,o,n)}},{key:"changeBoardW",value:function(){var t=this.boardLength*this.NapeConst.SCALE_SPACE*10;this.bg.mc1.width=t,this.bg.mc1.x=-t/2,this.materialGp.x=this.bg.mc1.x+15,this.towel.width=t,this.cotton.width=t,this.glass.width=t,this.bg.mc2.x=this.bg.mc1.x+t-25;var e=1/this.prevscale;this.dragsp.scale(e,1),this.selfsp.scale(e,1);var i=this.boardLength/50;if(this.prevscale=i,this.dragsp.scale(i,1),this.selfsp.scale(i,1),this.dangbdJoint)this.dangbdJoint.set_anchor1(m.get(.5*t+25,0));else{var o=this.body.localPointToWorld(m.get(.5*t+25,0));this.dangbd.set_position(o),this.dangbdJoint=this.JointUtil.createWeldJoint(this.body,this.dangbd,o,o)}this.kd.initLongBoard(this.boardLength),this.kd.visible=!1,this.kd.x=-t/2,this.kd.y=45;var n=t-600;if(!this.deskBody){this.deskBody=new b(v.get_KINEMATIC());var s=this.deskBody.get_shapes(),a=new _(_.box(n,65));s.add(a),a.set_localCOM(m.get(0,32.5)),this.addBodyToSpace(this.deskBody,this),this.deskBody.userData.view=this.desk;this.deskBody.set_position(this.body.localPointToWorld(m.get(this.desk.x,this.desk.y))),this.desk.leftshape=new _(_.box(90,310)),this.desk.rightshape=new _(_.box(90,310)),this.desk.middleshape=a,s.add(this.desk.leftshape),s.add(this.desk.rightshape)}var r=n/2;this.desk.middleshape.scale(e,1),this.desk.middleshape.scale(i,1),this.desk.middle.width=n,this.desk.middle.x=-r,this.desk.left.x=this.desk.middle.x+4,this.desk.right.x=-this.desk.middle.x-4,this.desk.leftshape.set_localCOM(m.get(-r-45,155)),this.desk.rightshape.set_localCOM(m.get(r+75,155));var h=this.desk.rightshape.get_bounds(),l=m.get(h.get_x()+h.get_width(),h.get_y());if(this.pivotJoint){var u=m.get(this.pivotJoint.oriPivtP.get_x()*i,this.pivotJoint.oriPivtP.get_y());this.pivotJoint.set_anchor1(this.deskBody.worldPointToLocal(l)),this.pivotJoint.set_anchor2(u)}else this.pivotJoint=this.JointUtil.createPivotJoint(this.deskBody,this.body,l,l),this.pivotJoint.oriPivtP=this.pivotJoint.get_anchor2().copy();if(!this.dangBody){this.dangBody=new b;var c=new _(_.box(100,40));this.dangBody.get_shapes().add(c),this.addBodyToSpace(this.dangBody),c.translate(m.get(0,20));var d=this.desk.toLocal({x:55,y:108},this.desk.left),p=this.deskBody.localPointToWorld(m.get(d.x,d.y));this.dangBody.set_position(p),this.dangJoint=this.JointUtil.createWeldJoint(this.dangBody,this.deskBody,p,p)}var y=this.desk.toLocal({x:55,y:108},this.desk.left);this.dangJoint.set_anchor2(m.get(y.x,y.y)),this.initPullLine(),this.bg.tanshe.x=this.bg.mc1.x,this.bg.tanshe.y=this.bg.mc1.y-83,this.bg.tsBtn.x=this.bg.mc1.x,this.bg.tsBtn.y=this.bg.mc1.y+90;var f={x:this.bg.tanshe.x,y:this.bg.tanshe.y};this.tssp.set_localCOM(m.get(f.x+80,f.y+50))}},{key:"addOtherShapes",value:function(){var t=this.body.get_shapes();this.selfsp=t.at(0),this.dragsp=new _(_.box(1480,146)),this.dragsp.set_sensorEnabled(!0),this.dragsp.stype="dragshape",t.add(this.dragsp),this.dangbd=new b,this.dangsp=new _(_.box(50,150)),this.dangsp.set_material(new P(0,1,2,.7,2)),this.dangsp.get_cbTypes().add(this.CbTypeStr.SENSOR_BOARD_DANG),this.dangbd.get_shapes().add(this.dangsp),this.addBodyToSpace(this.dangbd),this.dangbd.set_mass(200)}},{key:"unbindGate",value:function(t){this.gate1==t&&(this.gate1=null),this.gate2==t&&(this.gate2=null),t.endDrag()}},{key:"bindGate",value:function(t){var e=this,i=0;if(this.gate1){if(this.gate2)return;i=2}else i=1;t.setBindBoard(this),this["gate"+i]=t;var o=t.body,n=this.body.worldPointToLocal(o.get_position()),s=this.body.localPointToWorld(m.get(n.get_x(),-160));o.set_rotation(this.body.get_rotation()),o.set_position(s);var a=this.JointUtil.createWeldJoint(this.body,o,s,s);this["weldJoint"+i]=a,t.beginDrag=function(){a.set_active(!1)},t.endDrag=function(){if(null==e["gate"+i])t.setBindBoard(null),t.removeEventListener(p["default"].BEGIN,t.beginDrag),t.removeEventListener(p["default"].END,t.endDrag),t.beginDrag=null,t.endDrag=null;else{a.set_active(!0);var n=e.body.worldPointToLocal(o.get_position());a.set_anchor1(n)}},t.addEventListener(p["default"].BEGIN,t.beginDrag),t.addEventListener(p["default"].END,t.endDrag)}},{key:"breakGateFromMc",value:function(t){this.gate1==t?this.breakGateJoint(1):this.gate2==t&&this.breakGateJoint(2)}},{key:"breakGateJoint",value:function(t){var e=this["gate"+t],i=this["lineJoint"+t],o=this["weldJoint"+t];e.body.set_rotation(0),e.bindBoard=null,this["gate"+t]=null,this.BodyUtil.destoryJoint(i),this.BodyUtil.destoryJoint(o)}},{key:"updateWoodHeight",value:function(){var t=this.body.get_rotation(),e=this.desk.toLocal({x:0,y:0},this.bg);this.desk.left.wood.height=Math.tan(t)*(e.x-this.desk.left.x-this.desk.left.wood.x)+this.desk.left.y+this.desk.left.wood.y-e.y}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.gate1&&this.gate1.body.set_rotation(this.body.get_rotation()),this.gate2&&this.gate2.body.set_rotation(this.body.get_rotation()),this.body.get_allowRotation()&&this.updateWoodHeight(),.087>this.body.get_rotation()||this.body.set_rotation(.087);var t=!1;this.distanceJ1&&(this.updateTargetpos(this.distanceJ1,this.topBox,2),t=!0),this.distanceJ2&&(this.updateTargetpos(this.distanceJ2,this.botBox,2),t=!0),this.pullJoint&&(t=!0,this.updateTargetpos(this.pullJoint,this.topBox,1),this.updateTargetpos(this.pullJoint,this.botBox,4)),t&&(this.drawPullLine(),this.changePullHockPos())}},{key:"updateTargetpos",value:function(t,e,i){try{var o=t["get_anchor"+i]();o=t["get_body"+i]().localPointToWorld(o),o=this.body.worldPointToLocal(o),e.x=o.get_x(),e.y=o.get_y()}catch(n){}}},{key:"removed",value:function(){this.BodyUtil.destoryBody(this.deskBody),this.BodyUtil.destoryBody(this.dangBody),this.BodyUtil.destoryBody(this.dangbd),this.tssp.get_userData().tsLockCar=null,this.tscar=null,this.tsJoint&&(this.BodyUtil.destoryJoint(this.tsJoint),this.tsJoint=null),this.bg.tsBtn.dispose(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"changBoardLong",value:function(t){this.boardLength=t.showValue,this.changeBoardW()}},{key:"hidePullChanged",value:function(t){var e=t.checked;if(!(this.distanceJ1||this.distanceJ2||this.pullJoint))if(e){this.bg.mc2.currentFrame=1,this.bg.removeChild(this.topBox),this.bg.removeChild(this.botBox),this.bg.removeChild(this.pulleyLine);var i=this.body.get_shapes();this.topHock.dispose(),this.botHock.dispose(),i.remove(this.topHock),i.remove(this.botHock),this.topBox=null,this.botBox=null,this.topHock=null,this.botHock=null,this.hidePull=e}else this.bg.mc2.currentFrame=0,this.hidePull=e,this.initPullLine()}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this),i=this.deskBody.get_position();return t.desk={x:i.get_x(),y:i.get_y()},t.hidePull=this.hidePull,t.boardLength=this.boardLength,t.currentMatrial=this.currentMatrial,t.tsSpeed=this.tsSpeed,this.gate1&&(t.gate1=this.gate1.UID),this.gate2&&(t.gate2=this.gate2.UID),this.topHock&&(t.hock={top:{x:this.topBox.x,y:this.topBox.y},bot:{x:this.botBox.x,y:this.botBox.y}}),this.tscar&&(t.tscar=this.tscar.UID),t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),isNaN(t.boardLength)||this.changBoardLong({showValue:t.boardLength}),t.desk&&this.deskBody.set_position(m.get(t.desk.x,t.desk.y)),this.updateWoodHeight(),this.hidePullChanged({checked:t.hidePull}),!t.hidePull&&t.hock&&(this.topBox.x=t.hock.top.x,this.topBox.y=t.hock.top.y,this.botBox.x=t.hock.bot.x,this.botBox.y=t.hock.bot.y,this.changePullHockPos(),this.drawPullLine()),t.currentMatrial&&this.switchCaizhi({showValue:t.currentMatrial}),isNaN(t.tsSpeed)||this.changFireSpeed({showValue:t.tsSpeed})}},{key:"setDataOver",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setDataOver",this).call(this,t);var i=this.getChildByUID(t.tscar);i&&this.tsLockCar(i)}},{key:"setFriction",value:function(){var t=2*this.curtf;this.material.set_dynamicFriction(t),this.material.set_staticFriction(1.3*t),this.material.set_rollingFriction(this.curtf)}},{key:"switchCaizhi",value:function(t){var e=1>=arguments.length||arguments[1]===undefined||arguments[1],i=this.czi.indexOf(t.showValue);0>i&&(i=0),this.caizhi=i,this.changeCaizhi(e)}},{key:"changeCaizhi",value:function(){var t=0>=arguments.length||arguments[0]===undefined||arguments[0];this.glass.visible=this.cotton.visible=this.towel.visible=!1,1==this.caizhi?this.glass.visible=!0:2==this.caizhi?this.cotton.visible=!0:3==this.caizhi&&(this.towel.visible=!0),this.curtf=this.mcxs[this.caizhi],this.setFriction(),t&&this.freshLibPan()}},{key:"changFireSpeed",value:function(t){this.tsSpeed=t.showValue}},{key:"getConf",value:function(){var t={};return t.confArr=[this.getScrollBar([this.getLocaleStr("length","长度"),!0,"",100,50,this.boardLength,5,this.changBoardLong,this]),this.getScrollBar([this.getLocaleStr("catapult_speed","弹射速度"),!0,"",10,0,this.tsSpeed,1,this.changFireSpeed,this]),this.getDropMenu([this.getLocaleStr("material","材质"),!1,"",this.currentMatrial,this.czi,this,this.switchCaizhi,1,0]),this.getSwitch([this.getLocaleStr("隐藏滑轮","隐藏滑轮"),this.hidePull,this.hidePullChanged,this])],t}},{key:"currentMatrial",get:function(){return this.czi[this.caizhi]}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function x(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:x(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(451),u=o(l),c=i(449),d=o(c),p=void 0,y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0,m=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return p=i.phy.nape,y=p.NbBody,f=p.shape.Circle,g=p.geom.Vec2,b=p.shape.HitShape,v=p.callbacks.CbType,_=p.callbacks.InteractionType,m=p.callbacks.PreListener,i.level=14,i.leftlun=null,i.rightlun=null,i.currentMass=200,i.bindJoint=null,i.bindslJoint=null,i.hock=null,i.bdcbtype=new v,i.sfObj={hock:{x:104,y:-12},lun:{r:20,lx:-74,rx:71,y:29}},i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;this._width=217,this._height=80,this.material=new p.phys.Material(0,.5,.6,2.7,.001),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this);var i=this.body.get_shapes().at(0);i.translate(g.get(0,-10)),i.get_cbTypes().add(this.bdcbtype),this.mc.visible=!1,this.dgp.visible=!1,this.hock=new b(15),this.body.add(this.hock),this.body.userData.handJointFrequency=5,this.hock.get_cbTypes().add(this.CbTypeStr.SENSOR_CAR),this.hock.set_localCOM(g.get(this.sfObj.hock.x,this.sfObj.hock.y)),this.addLun(),this.changMass({showValue:this.currentMass}),this.addCarDrag(),this.prelis=new m(_.get_COLLISION(),this.bdcbtype,this.CbTypeStr.SENSOR_BOARD_DANG,function(e){t.frezzBody()}),this.addNapeListeners(this.prelis)}},{key:"frezzBody",value:function(){this.BodyUtil.frezzBody(this.body),this.BodyUtil.frezzBody(this.leftlun),this.BodyUtil.frezzBody(this.rightlun)}},{key:"addCarDrag",value:function(){var t=this;this.beginFunc=function(e){t.hock.draging(!0)},this.endFunc=function(e){t.hock.draging(!1),t.checkBindTanshe()},this.addEventListener(d["default"].BEGIN,this.beginFunc),this.addEventListener(d["default"].END,this.endFunc)}},{key:"checkBindTanshe",value:function(){var t=this;this.body.get_arbiters().foreach(function(e){var i=e.get_shape1(),o=e.get_shape2(),n=null;"tansheq"==i.get_userData().sensorType?n=i.get_userData().tsLockCar:"tansheq"==o.get_userData().sensorType&&(n=o.get_userData().tsLockCar),n&&n(t)})}},{key:"bindDmSensor",value:function(t){t.set_rotation(this.body.get_rotation()),t.sensorEnabled(!0);var e=this.body.localPointToWorld(g.get(this.mc.x,this.mc.y));t.set_position(e),this.mc.visible=!0,this.bindJoint=this.JointUtil.createWeldJoint(t,this.body,e,e)}},{key:"unBindDmSensor",value:function(){this.BodyUtil.destoryJoint(this.bindJoint),this.bindJoint=null,this.mc.visible=!1}},{key:"bindSlSeneor",value:function(t){t.set_rotation(this.body.get_rotation());var e=this.body.localPointToWorld(g.get(this.dgp.x,this.dgp.y));t.set_position(e),this.dgp.visible=!0,this.bindslJoint=this.JointUtil.createWeldJoint(t,this.body,e,e)}},{key:"unbindSlSeneor",value:function(){this.BodyUtil.destoryJoint(this.bindslJoint),this.bindslJoint=null,this.dgp.visible=!1}},{key:"getData",value:function(){return h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this)}},{key:"addLun",value:function(){this.leftlun=this.ctbody(this.sfObj.lun.lx,this.sfObj.lun.y),this.rightlun=this.ctbody(this.sfObj.lun.rx,this.sfObj.lun.y)}},{key:"ctbody",value:function(t,e){var i=new p.phys.Material(0,1,2,1,2),o=new f(this.sfObj.lun.r,null,i),n=new y;n.add(o),n.set_isBullet(!0);var s=this.body.localPointToWorld(g.get(t,e));return n.set_position(s),this.addBodyToSpace(n),this.JointUtil.createPivotJoint(n,this.body,s,s),n}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this)}},{key:"removed",value:function(){this.removeNapeListeners(this.prelis),this.BodyUtil.destoryBody(this.leftlun),this.BodyUtil.destoryBody(this.rightlun),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"changMass",value:function(t){var e=t.showValue;this.body.set_mass(.4*e),this.leftlun.set_mass(.3*e),this.rightlun.set_mass(.3*e),this.currentMass=e}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.getScrollBar([this.getLocaleStr("mass","质量"),!0,"g",500,100,this.currentMass,1,this.changMass,this])),t}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function f(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:f(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(451),l=function(t){return t&&t.__esModule?t:{"default":t}}(h),u=void 0,c=void 0,d=void 0,p=void 0,y=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return u=i.phy.nape,c=u.NbBody,d=u.geom.Vec2,p=u.shape.Polygon,y=u.phys.BodyType,i.level=10,i.sensorType="force_sensor",i.ports=[],i.graph=null,i}return s(e,t),a(e,[{key:"init",value:function(){this.points=[{x:83,y:-168.95},{x:-260.95,y:-41.95},{x:-81,y:81.05},{x:260,y:-55.95}],r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.dragLevel=-5,this.body.set_type(y.get_KINEMATIC()),this.body.set_sensorEnabled_at(0,!0),this.initCtou()}},{key:"update",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.graph&&this.graph.update()}},{key:"removed",value:function(){this.graph&&this.graph.close(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"initCtou",value:function(){for(var t=1;4>=t;t++){var e=this["c"+t];e.alpha=0;var i=new p(p.rect(-23,-22,e.width,e.height)),o=i.get_userData();o.bind=null,o.offset={x:e.width/2-23,y:e.height/2-22},o.type="collector_ck",o.owner=this,o.id=t,this.body.add(i),i.translate(d.get(e.x,e.y)),o.name="A"+t,this.ports.push(o)}}},{key:"getData",value:function(){return r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this)}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t)}},{key:"getConf",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getConf",this).call(this);return t.canSensor=!0,t}},{key:"bindGraph",value:function(t){this.graph=t}},{key:"unBindGraph",value:function(t){t===this.graph&&(this.graph=null)}},{key:"sensorDataChanged",value:function(t){this.graph&&this.graph.sensorDataChanged(t.sensor,t.data)}},{key:"bindSensor",value:function(t){this.graph&&this.graph.bindSensor(t)}},{key:"unBindSensor",value:function(t){this.graph&&this.graph.unBindSensor(t)}},{key:"getSensorList",value:function(){for(var t=[],e=0;this.ports.length>e;e++){var i=this.ports[e];i.bind&&t.push(i.bind)}return t}},{key:"sensorZero",value:function(){this.forEachBindSensor(function(t){t.sensorZero()})}},{key:"forEachBindSensor",value:function(t){for(var e=0;this.ports.length>e;e++){var i=this.ports[e];i.bind&&t(i.bind)}}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function w(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:w(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(451),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0,y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0,m=void 0,x=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,p=c.geom.Vec2,f=c.shape.Polygon,y=c.NbBody,g=c.phys.Material,d=c.phys.BodyType,b=c.callbacks.CbType,v=c.callbacks.CbEvent,m=c.callbacks.InteractionType,_=c.callbacks.InteractionListener,x=c.callbacks.PreListener,i.oriP={x:-93.25,y:-510.3},i.banTouchId=null,i.upjiaTouchId=null,i.downjiaTouchId=null,i.gdmTouchId=null,i.botShape=null,i.gdmShape=null,i.oldrot=0,i.chuiBody=null,i.chuiMass=100,i.jointLong=null,i.jointShort=null,i.longR=665,i.chuiding=null,i.botBody=null,i.botcbtype=new b,i.sensorBody=null,i.botjoint=null,i.senjoint=null,i.czMaterial=new g(0,0,0,5,0),i.gdmcb=new b,i.chuicb=new b,i.stT=0,i.isSensor=!0,i.defaultName="E",i.doorW=2,i.reseting=!1,i.sfObj={botshape:{w:28,h:47,ox:37.5,limity1:157.9,limity2:318},chui:{w:24.6,h:18.6},upjia:{limity1:-430,limity2:-180}},i}return s(e,t),a(e,[{key:"init",value:function(){this._width=this.bg.width,this._height=this.bg.height,r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_allowRotation(!1),this.body.set_type(d.get_KINEMATIC()),this.body.get_shapes().at(0).set_sensorEnabled(!0),this.addbgShape(),this.addbgTouch(),this.addChui(),this.bg.ban.btn.currentFrame=1,this.setgdmPosition(Math.PI/4),this.addBtn(),this.bg.senLine.visible=!1,this.bg.senLine.height=this.bg.upjia.y-this.bg.ban.y,this.addpreListener()}},{key:"addpreListener",value:function(){var t=this;this.prelisten=new x(m.get_COLLISION(),this.botcbtype,this.chuicb,function(e){t.BodyUtil.frezzBody(t.chuiBody)}),this.addNapeListeners(this.prelisten)}},{key:"removed",value:function(){this.removeNapeListeners(this.prelisten),this.bg.startBtn.dispose(),this.bg.stopBtn.dispose(),this.BodyUtil.destoryBody(this.chuiBody),this.BodyUtil.destoryBody(this.botBody),this.BodyUtil.destoryBody(this.sensorBody),this.removeNapeListeners(this.hitEnd),h.M.removeTouch(this.bg.ban,this.banTouchId),h.M.removeTouch(this.bg.upjia,this.upjiaTouchId),h.M.removeTouch(this.bg.bottomJia,this.downjiaTouchId),h.M.removeTouch(this.bg.gdmup,this.gdmTouchId),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"addBtn",value:function(){var t=this;this.bg.startBtn.fontColor="#ffffff",this.bg.startBtn.text="释放",this.bg.stopBtn.fontColor="#ffffff",this.bg.stopBtn.text="重置",this.bg.startBtn["this"]=this,this.bg.stopBtn["this"]=this,this.bg.startBtn.tab=function(){t.chuiding.get_active()&&t.chuiding.set_active(!1)},this.bg.stopBtn.tab=function(e){!e&&t.chuiding.get_active()||(t.chuiding.set_active(!0),t.refreshChuiDing()),t.reseting=!0,setTimeout(function(){t.reseting=!1},500)},this.bg.ban.rotation=.579,this.bg.stopBtn.tab(!0),this.hitEnd=new _(v.get_END(),m.get_SENSOR(),this.gdmcb,this.chuicb,function(e){var i=e.get_int2(),o=.001*i.get_velocity().get_length();t.stT=t.doorW/o*.01,t.reseting||t.sensorDataChanged(null)}),this.addNapeListeners(this.hitEnd)}},{key:"refreshChuiDing",value:function(){var t=this.bg.ban.rotation,e=this.longR-this.sfObj.chui.w;this.chuiding.set_anchor2(p.get(this.oriP.x+Math.cos(t)*e,this.oriP.y+Math.sin(t)*e))}},{key:"addChui",value:function(){this.chuiBody=new y;var t=new f(f.rect(0,-this.sfObj.chui.h/2,this.sfObj.chui.w,this.sfObj.chui.h),this.czMaterial);this.chuiBody.get_shapes().add(t),this.chuiBody.set_allowRotation(!1),this.chuiBody.set_isBullet(!0),this.addBodyToSpace(this.chuiBody),this.chuiBody.get_cbTypes().add(this.chuicb),this.chuiBody.set_mass(this.chuiMass);var e=this.longR-this.sfObj.chui.w,i=this.body.localPointToWorld(p.get(this.bg.chui.x+e,this.bg.chui.y));this.chuiBody.set_position(i),this.chuiding=this.JointUtil.createWeldJoint(this.chuiBody,this.body,i,i),this.jointLong=this.JointUtil.createDistanceJoint(this.body,this.chuiBody,this.body.localPointToWorld(p.get(this.bg.ban.x,this.bg.ban.y)),i,e,e),this.changeChuiLength(this.longR)}},{key:"changeChuiLength",value:function(t){this.bg.chui.m1.width=t-this.sfObj.chui.w,this.bg.chui.m2.x=this.bg.chui.m1.width}},{key:"getData",value:function(){var t=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.ban=this.bg.ban.rotation,t.gdm=this.oldrot,t.upjia=this.bg.upjia.y,t.downjia=this.bg.bottomJia.y,t}},{key:"setData",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),isNaN(t.ban)||(this.bg.ban.rotation=t.ban,this.refreshChuiDing()),isNaN(t.gdm)||(this.oldrot=Math.PI/4,this.setgdmPosition(t.gdm)),isNaN(t.upjia)||(this.bg.upjia.y=t.upjia,this.bg.senLine.height=this.bg.upjia.y-this.bg.ban.y),isNaN(t.downjia)||(this.bg.bottomJia.y=t.downjia,this.botjoint.set_anchor1(p.get(this.bg.bottomJia.x-this.sfObj.botshape.ox,this.bg.bottomJia.y)))}},{key:"addbgShape",value:function(){this.botBody=new y,this.botShape=new f(f.box(this.sfObj.botshape.w,this.sfObj.botshape.h),this.czMaterial),this.botBody.get_shapes().add(this.botShape),this.botShape.get_cbTypes().add(this.botcbtype),this.botBody.set_isBullet(!0);var t=this.body.localPointToWorld(p.get(this.bg.bottomJia.x-this.sfObj.botshape.ox,this.bg.bottomJia.y));this.botBody.set_position(t),this.addBodyToSpace(this.botBody),this.botjoint=this.JointUtil.createWeldJoint(this.body,this.botBody,t,t),this.sensorBody=new y,this.gdmShape=new f(f.box(50,1)),this.gdmShape.set_sensorEnabled(!0),this.sensorBody.get_shapes().add(this.gdmShape),this.gdmShape.set_localCOM(p.get(-25,0)),this.addBodyToSpace(this.sensorBody);var e=this.body.localPointToWorld(p.get(this.bg.gdmup.x,this.bg.gdmup.y));this.sensorBody.get_cbTypes().add(this.gdmcb),this.sensorBody.set_position(e),this.senjoint=this.JointUtil.createWeldJoint(this.body,this.sensorBody,e,e)}},{key:"addbgTouch",value:function(){var t=this;this.banTouchId=h.M.addTouch(this.bg.ban,{begin:function(e){t.body.forbidDrag(!0)},move:function(e){var i=t.bg.toLocal(e.globalP),o=Math.atan2(i.y-t.oriP.y,i.x-t.oriP.x);0>o&&(o=0),o>Math.PI/2&&(o=Math.PI/2),t.bg.ban.rotation=o,t.chuiding.get_active()&&t.refreshChuiDing()},end:function(e){t.body.forbidDrag(!1)}});var e=0;this.upjiaTouchId=h.M.addTouch(this.bg.upjia,{begin:function(i){t.jointShort||(e=i.data.global.y,t.body.forbidDrag(!0))},move:function(i){if(!t.jointShort){var o=i.data.global.y-e;e=i.data.global.y,t.bg.upjia.y+=o/t.main.view.scale.x,t.sfObj.upjia.limity1>t.bg.upjia.y&&(t.bg.upjia.y=t.sfObj.upjia.limity1+1),t.bg.upjia.y>t.sfObj.upjia.limity2&&(t.bg.upjia.y=t.sfObj.upjia.limity2-1),t.bg.senLine.height=t.bg.upjia.y-t.bg.ban.y}},end:function(e){t.body.forbidDrag(!1)}});var i=0;this.downjiaTouchId=h.M.addTouch(this.bg.bottomJia,{begin:function(e){i=e.data.global.y,t.body.forbidDrag(!0)},move:function(e){var o=e.data.global.y-i;i=e.data.global.y,t.bg.bottomJia.y+=o/t.main.view.scale.x,t.sfObj.botshape.limity1>t.bg.bottomJia.y&&(t.bg.bottomJia.y=t.sfObj.botshape.limity1+1),t.bg.bottomJia.y>t.sfObj.botshape.limity2&&(t.bg.bottomJia.y=t.sfObj.botshape.limity2-1),t.botjoint.set_anchor1(p.get(t.bg.bottomJia.x-t.sfObj.botshape.ox,t.bg.bottomJia.y))},end:function(e){t.body.forbidDrag(!1)}}),this.gdmTouchId=h.M.addTouch(this.bg.gdmup,{begin:function(e){t.body.forbidDrag(!0)},move:function(e){var i=t.bg.toLocal(e.data.global),o=Math.atan2(i.y-t.oriP.y,i.x-t.oriP.x);t.setgdmPosition(o)},end:function(e){t.body.forbidDrag(!1)}})}},{key:"update",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this);var t=this.chuiBody.get_position(),i=void 0,o=this.body.worldPointToLocal(t);if(this.jointShort||this.chuiding.get_active()||o.get_x()>this.bg.upjia.x)!this.jointLong.get_active()&&o.get_x()>this.bg.upjia.x&&(this.BodyUtil.destoryJoint(this.jointShort),this.jointShort=null,this.jointLong.set_active(!0),this.bg.chui.x=this.bg.ban.x,this.bg.chui.y=this.bg.ban.y,this.changeChuiLength(this.longR),this.bg.senLine.visible=!1);else{i=this.body.localPointToWorld(p.get(this.bg.upjia.x,this.bg.upjia.y));var n=this.longR-(this.bg.upjia.y-this.oriP.y)-this.sfObj.chui.w;this.jointShort=this.JointUtil.createDistanceJoint(this.body,this.chuiBody,i,t,n,n),this.bg.chui.x=this.bg.upjia.x,this.bg.chui.y=this.bg.upjia.y,this.changeChuiLength(n+this.sfObj.chui.w),this.jointLong.set_active(!1),this.bg.senLine.visible=!0}i=this.body.localPointToWorld(this.jointLong.get_active()?p.get(this.bg.ban.x,this.bg.ban.y):p.get(this.bg.upjia.x,this.bg.upjia.y));var s=Math.atan2(t.get_y()-i.get_y(),t.get_x()-i.get_x());this.bg.chui.rotation=s,this.chuiBody.set_rotation(s)}},{key:"setgdmPosition",value:function(t){var e=this.longR,i=10*Math.PI/180,o=Math.PI/2;i>t?t=i:t>o&&(t=o),this.bg.gdmdown.x=this.bg.gdmup.x=this.oriP.x+e*Math.cos(t),this.bg.gdmdown.y=this.bg.gdmup.y=this.oriP.y+e*Math.sin(t),this.bg.gdmdown.rotation=this.bg.gdmup.rotation=t,this.gdmShape.rotate(-this.oldrot),this.gdmShape.rotate(t),this.oldrot=t,this.senjoint.set_anchor1(p.get(this.bg.gdmup.x,this.bg.gdmup.y))}},{key:"changChuiMass",value:function(t){var e=h.M.getNumStr(t.showValue);this.chuiMass=e,this.chuiBody.set_mass(e)}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.getScrollBar([this.getLocaleStr("摆锤质量","摆锤质量"),!0,"g",200,50,this.chuiMass,5,this.changChuiMass,this])),t}},{key:"getParam",value:function(t){var e=0;switch(t){case"G":e=this.getGravity();break;case"V":var i=this.bg.toLocal({x:this.bg.ban.btn.x,y:this.bg.ban.btn.y},this.bg.ban),o=(159.6-i.y)/19.32*.01,n=(159.6-this.bg.gdmup.y)/19.32*.01,s=2*this.getGravity()*(o-n);e=Math.sqrt(s)+.02-.04*Math.random();break;case"W":e=.01*this.doorW;break;case"T":e=this.stT;break;case"M":e=.001*this.chuiMass;break;case"H":e=(159.6-this.bg.gdmup.y)/19.32*.01}return e}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function b(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:b(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(449),c=o(u),d=i(451),p=o(d),y=void 0,f=void 0,g=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.geom.Vec2,g=y.shape.HockShapeBase,i.level=16,i.hock=null,i.joint=null,i.dingJoint=null,i.beginDragHandler=null,i.endDragHandler=null,i.dirLeftStr=i.language.getLocaleStr("horizontal_to_left"),i.dirRightStr=i.language.getLocaleStr("horizontal_to_right"),i.dirTopStr=i.language.getLocaleStr("vertical_to_top"),i.dirBottomStr=i.language.getLocaleStr("vertical_to_bottom"),i.dirArr=[i.dirLeftStr,i.dirRightStr,i.dirTopStr,i.dirBottomStr],i.lockDir=i.dirLeftStr,i.reversal=!1,i.bshape=null,i.handHock=!1,i.dragStartP={x:0,y:0},i.selfForce=0,i._force=0,i.tlvalue=.2*Math.random()-.1,i.istiao=!1,i.forceDragLine=new PIXI.Graphics,i.isSensor=!0,i.defaultName="F",i.sfObj={hockpos:{x:-85,y:90},hockpos2:{x:-85,y:-95},tlpos:{x:-101,y:-18.6},tlpos2:{x:-30,y:8},txt:{x:100},flabelP2:{x:10,y:80}},i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;this._width=234,this._height=105,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.bshape=this.body.get_shapes().at(0),this.body.set_allowRotation(!1),this.body.userData.notHockDrag=!0,this.body.userData.handJointStiff=!1,this.body.userData.handJointFrequency=10,this.body.userData.pivotDrag=!0,this.body.set_sensorEnabled_at(0,!0),this.hock=new g(25),this.hock.get_userData().type="sensor_force",this.hock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.hock),this.hock.addCbtype(this.CbTypeStr.SPRING_HOCK,!0),this.hock.translate(f.weak(this.sfObj.hockpos.x,this.sfObj.hockpos.y));var i=this.body.get_position();this.dingJoint=this.JointUtil.createWeldJoint(this.body,this.space.get_world(),i,i),this.addlisteners(),this.bg.addChild(this.forceDragLine),this.bg.txt.y+=3.5;var o=this.bg.toLocal({x:this.flabelP.x,y:this.flabelP.y},this);this.bg.addChild(this.flabelP),this.flabelP.x=o.x,this.flabelP.y=o.y,this.sfObj.flabelP=new l.Point(this.flabelP.x+this.flabelP.width/2,this.flabelP.y+20),this.flabel12Box.__getPos=function(){return{p:t.sfObj.flabelP,fromTar:t.bg}}}},{key:"addlisteners",value:function(){var t=this;this.beginDragHandler=function(e){var i=l.M.getMouseXY(e);t.hock.contains(f.get(i.x,i.y))?(t.dragToolBegin(i),t.handHock=!0):t.dingJoint.set_active(!1)},this.endDragHandler=function(e){if(t.dingJoint.get_active()){var i=l.M.getMouseXY(e);t.dragToolEnd(i)}else{var o=t.body.get_position();t.dingJoint.set_anchor2(o),t.dingJoint.set_active(!0)}t.handHock=!1},this.moveDragHandler=function(e){if(t.handHock){var i=l.M.getMouseXY(e);t.dragToolMove(i)}},this.addEventListener(c["default"].BEGIN,this.beginDragHandler),this.addEventListener(c["default"].END,this.endDragHandler),this.addEventListener(c["default"].MOVE,this.moveDragHandler),this.bg.btn["this"]=this,this.bg.btn.tab=this.sensorZero}},{key:"update",value:function(){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.hock.get_userData().useing){var t=this.hock.get_userData().bind;if("sensor_force"===t.get_userData().type){this.selfDragManager=!0;this._force=this.selfForce+t.get_body().userData.view.selfForce}else{this.selfDragManager=!1;var i=this.hock.pivjoint||t.pivjoint;if(!i)return;var o=i.get_body1();o!=this.body&&(o=i.get_body2());this._force=i.bodyImpulse(o).xy().get_length()*this.NapeConst.FORCE_RATIO}}else this.handHock?this._force=-this.selfForce:(this.selfDragManager=!1,this._force=0);if(this.istiao||(this._force+=this.tlvalue),0!=this._force){var n=Math.abs(this._force),s=this._force/n;0>n?n=0:n>50&&(n=50),this._force=(n*s).toFixed(2)}this.bg.txt.text=this._force+"N",this.bg.txt.x=this.bg.txt.rotation==Math.PI?this.sfObj.txt.x:this.sfObj.txt.x-this.bg.txt.width}},{key:"removed",value:function(){this.bg.btn.dispose(),this.hock.dragToolClick(),this.hock.dispose(),this.removeEventListener(c["default"].BEGIN,this.beginDragHandler),this.removeEventListener(c["default"].END,this.endDragHandler),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"lockDirChange",value:function(t){if(!this.hock.get_userData().useing){var e=t.showValue;this.lockDir=e,e==this.dirLeftStr?(this.body.set_rotation(0),this.sfObj.flabelP.x=1,this.sfObj.flabelP.y=52,this.sfObj.flabelP2.x=0,this.sfObj.flabelP2.y=52):e==this.dirRightStr?(this.body.set_rotation(Math.PI),this.sfObj.flabelP.x=1,this.sfObj.flabelP.y=-60,this.sfObj.flabelP2.x=0,this.sfObj.flabelP2.y=-60):e==this.dirTopStr?(this.body.set_rotation(Math.PI/2),this.sfObj.flabelP.x=130,this.sfObj.flabelP.y=0,this.sfObj.flabelP2.x=130,this.sfObj.flabelP2.y=0):e==this.dirBottomStr&&(this.body.set_rotation(-Math.PI/2),this.sfObj.flabelP.x=-130,this.sfObj.flabelP.y=0,this.sfObj.flabelP2.x=-130,this.sfObj.flabelP2.y=0)}}},{key:"reversalChange",value:function(t){var e=this;this.reversal=t.checked,this.reversal?(this.hock.set_localCOM(f.weak(this.sfObj.hockpos2.x,this.sfObj.hockpos2.y)),this.bg.mc.currentFrame=1,this.bg.txt.rotation=Math.PI,this.bg.txt.pivot.y=17,this.bg.btn.rotation=-Math.PI,this.bg.btn.x=this.sfObj.tlpos2.x,this.bg.btn.y=this.sfObj.tlpos2.y,this.flabel12Box.__getPos=function(){return{p:e.sfObj.flabelP2,fromTar:e.bg}}):(this.hock.set_localCOM(f.weak(this.sfObj.hockpos.x,this.sfObj.hockpos.y)),this.bg.mc.currentFrame=0,this.bg.txt.rotation=0,this.bg.txt.pivot.y=0,this.bg.btn.rotation=0,this.bg.btn.x=this.sfObj.tlpos.x,this.bg.btn.y=this.sfObj.tlpos.y,this.flabel12Box.__getPos=function(){return{p:e.sfObj.flabelP,fromTar:e.bg}})}},{key:"dragToolBegin",value:function(t){this.dragStartP=t,this.forceDragLine.visible=!0;var e=this.bg.toLocal(t,this.main.view);this.forceDragLine.x=e.x,this.forceDragLine.y=e.y,this.dragLineShow(null)}},{key:"dragToolMove",value:function(t){var e=t.y-this.dragStartP.y,i=this.body.get_position(),o=this.hock.get_worldCOM();e=this.lockDir==this.dirLeftStr||this.lockDir==this.dirRightStr?i.get_y()>o.get_y()?t.y-this.dragStartP.y:this.dragStartP.y-t.y:i.get_x()>o.get_x()?t.x-this.dragStartP.x:this.dragStartP.x-t.x,this.selfForce=e/6,this.dragLineShow(t)}},{key:"dragToolEnd",value:function(t){this.selfForce=0,this.forceDragLine.visible=!1}},{key:"dragLineShow",value:function(t){if(this.forceDragLine.clear(),t){this.forceDragLine.lineStyle(5,2721023),this.forceDragLine.moveTo(0,0);var e=this.forceDragLine.toLocal(t,this.main.view),i=e.y;-180>i&&(i=-180),i>180&&(i=180),this.forceDragLine.lineTo(0,i),this.forceDragLine.lineStyle(1,2721023,0),this.forceDragLine.beginFill(2721023),this.forceDragLine.moveTo(-10,i),this.forceDragLine.lineTo(10,i),i>0?this.forceDragLine.lineTo(0,i+10):this.forceDragLine.lineTo(0,i-10),this.forceDragLine.lineTo(-10,i)}}},{key:"checkDrag",value:function(t){return!this.hock.contains(f.get(t.x,t.y))}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return t.lockDir=this.lockDir,t.reversal={value:this.reversal},t.tiaoling={value:this.istiao},t}},{key:"setData",value:function(t){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.lockDir&&this.lockDirChange({showValue:t.lockDir}),t.reversal&&this.reversalChange({checked:t.reversal.value}),t.tiaoling&&(this.istiao=t.tiaoling.value)}},{key:"getConf",value:function(){var t={};return t.confArr=[],this.hock.get_userData().useing||(t.confArr.push(this.getDropMenu([this.getLocaleStr("lock_direction","锁定方向"),!1,"",this.lockDir,this.dirArr,this,this.lockDirChange,1,0])),t.confArr.push(this.getSwitch([this.getLocaleStr("reversal","反转"),this.reversal,this.reversalChange,this]))),t}},{key:"getParam",value:function(t){var e=0;switch(t){case"F":e=this._force}return e}},{key:"sensorZero",value:function(){this.istiao=!0}}]),e}(p["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function x(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:x(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(449),c=o(u),d=i(451),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0,v=void 0,_=void 0,m=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.phys.BodyType,g=y.shape.Polygon,_=y.shape.Circle,b=y.geom.Vec2,v=y.NbBody,m=y.phys.Material,i.curtAng=0,i.pivotJoint=null,i.angleJoint=null,i.sensorBody=null,i.ballBody=null,i.leftShape=null,i.rightShape=null,i.sbMatrial=new m(0,.1,.1,6,.05),i.angline=new PIXI.Graphics,i.angText=new PIXI.Text("",{fill:0,font:"25px 微软雅黑",align:"left"}),i.showForce=!1,i.ballMass=200,i.dingJ=null,i.showZhiH=!1,i.showZhongF=!1,i.isSensor=!0,i.defaultName="P",i}return a(e,t),r(e,[{key:"init",value:function(){this._width=950,this._height=724,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.set_type(f.get_KINEMATIC()),this.body.get_shapes().at(0).set_sensorEnabled(!0),this.body.userData.dragLevel=-5,this.addSensorBody(),this.addSensorListeners(),this.sensorBody.set_rotation(-Math.PI/4),this.addBall(),this.angline.addChild(this.angText),this.angText.alpha=0}},{key:"addBall",value:function(){this.ballBody=new v;var t=new _(140,b.get(0,0),this.sbMatrial);this.ballBody.get_shapes().add(t),this.ballBody.set_isBullet(!0),this.ballBody.set_allowRotation(!1),this.addBodyToSpace(this.ballBody,this.parent),this.ball.x+=this.x,this.ball.y+=this.y,this.parent.addChild(this.ball);var e=b.get(this.ball.x,this.ball.y);this.ballBody.set_position(e),this.ballBody.userData.view=this.ball,this.ballBody.userData.dragLevel=5,this.ballBody.set_mass(this.ballMass),this.dingJ=this.JointUtil.createDistanceJoint(this.body,this.ballBody,e,e,0,50)}},{key:"addSensorBody",value:function(){this.sensorBody=new v;var t=this.sensorBody.get_shapes(),e=new g(g.box(this.sensor.width,40),this.sbMatrial);t.add(e),e.set_localCOM(b.get(this.sensor.width/2,-20));var i=new g(g.box(40,188),this.sbMatrial);t.add(i),i.set_localCOM(b.get(100,-134));var o=this.body.localPointToWorld(b.get(this.sensor.x,this.sensor.y));this.addBodyToSpace(this.sensorBody,this.parent),this.sensorBody.set_position(o),this.sensorBody.userData.dragLevel=5,this.sensorBody.set_allowRotation(!1),this.addChild(this.angline),this.angline.x=this.sensor.x,this.angline.y=this.sensor.y,this.sensor.x+=this.x,this.sensor.y+=this.y,this.parent.addChild(this.sensor),this.sensorBody.userData.view=this.sensor,this.addAngleJoint(o);var n=new m(0,0,0,6,0);this.leftShape=new g(g.box(12,12),n),this.rightShape=new g(g.box(12,12),n),t.add(this.leftShape),t.add(this.rightShape),this.leftShape.translate(b.get(128.8,-197.8)),this.rightShape.translate(b.get(274.5,-52.1))}},{key:"addAngleJoint",value:function(t){this.pivotJoint=this.JointUtil.createPivotJoint(this.sensorBody,this.body,t,t),this.angleJoint=this.JointUtil.createAngleJoint(this.sensorBody,this.body,0,Math.PI/2)}},{key:"drawAngleLine",value:function(){var t=this.sensorBody.get_rotation();this.angline.clear(),this.angline.lineStyle(3,16777215),this.angline.moveTo(0,0),this.angline.lineTo(50,0);var e=this.angline.toLocal({x:50,y:0},this.sensor),i=l.M.rotaPointFromP({x:50,y:0},{x:0,y:0},t/2);this.angline.quadraticCurveTo(i.x,i.y,e.x,e.y),this.angline.lineTo(0,0),this.angText.text=(180*-t/Math.PI).toFixed(0),this.angText.x=25,this.angText.y=0}},{key:"addSensorListeners",value:function(){var t=this;this.sensorBegin=function(){t.sensorBody.set_allowRotation(!0)},this.sensorEnd=function(){t.sensorBody.set_allowRotation(!1),t.BodyUtil.frezzBody(t.sensorBody)},this.sensorMove=function(){t.BodyUtil.frezzBody(t.sensorBody);var e=t.sensorBody.get_rotation();e=180*e/Math.PI,e=Math.round(e),t.sensorBody.set_rotation(e*Math.PI/180);var i=t.sensorBody.localPointToWorld(b.get(244,-196));i=t.body.worldPointToLocal(i),t.dingJ.set_anchor1(i)},this.sensor.addEventListener(c["default"].BEGIN,this.sensorBegin),this.sensor.addEventListener(c["default"].END,this.sensorEnd),this.sensor.addEventListener(c["default"].MOVE,this.sensorMove)}},{key:"removed",value:function(){this.BodyUtil.destoryBody(this.sensorBody),this.BodyUtil.destoryBody(this.ballBody),this.sensor.removeEventListener(c["default"].BEGIN,this.sensorBegin),this.sensor.removeEventListener(c["default"].END,this.sensorEnd),this.sensor.removeEventListener(c["default"].MOVE,this.sensorMove),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"update",value:function(){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.sensor.zhou.rotation=-this.sensor.rotation,this.sensorBody.userData.dragManager?(this.drawAngleLine(),this.angText.alpha=1):1==this.angText.alpha&&(this.angText.alpha=0,this.angline.clear()),this.showForce&&this.drawArrows()}},{key:"drawArrows",value:function(){var t=this.forceValue().arrows,e=this.getGravity(),i=this.ballMass*e*.001,o=this.ballBody.get_position();t.push({angle:b.get(0,1),force:i,symbol:"G",pos:o});var n=[];if(this.showZhiH){var s=this.ballBody.totalImpulse(),a=s.xy();a.get_length()>0&&(t.push({angle:a.unit(),force:a.get_length()*this.NapeConst.FORCE_RATIO,symbol:"F合",pos:o}),n.push({head:3,f1:0,f2:1}))}if(this.showZhongF){var r=this.sensorBody.get_rotation(),h=i*Math.cos(r),l=i*Math.sin(r),u=Math.PI-Math.abs(r),c=Math.PI/2-Math.abs(r),d=b.get(Math.cos(c),Math.sin(c)),p=b.get(Math.cos(u),Math.sin(u));t.push({angle:d,force:Math.abs(h),symbol:"G1",pos:o},{angle:p,force:Math.abs(l),symbol:"G2",pos:o}),n.push(n.length>0?{head:2,f1:4,f2:5}:{head:2,f1:3,f2:4})}n.length>0&&t.push({xu:!0,list:n}),this.f_color="#09d822",t.color=this.f_color,this.drawForceArrow(t)}},{key:"forceValue",value:function(){var t=this,e=this.sensorBody.get_arbiters(),i=this.sensorBody.get_rotation(0);i=180*-i/Math.PI;var o={rot:i,leftF:0,rightF:0},n=[];return e.foreach(function(e){if(e.isCollisionArbiter()){var i="",s=null;if(e.get_shape1()==t.leftShape?(i="left",s=e.get_body2()):e.get_shape1()==t.rightShape&&(i="right",s=e.get_body2()),s){var a=e.normalImpulse(s),r=a.get_length();r*=t.NapeConst.FORCE_RATIO,"left"==i?o.leftF=r:"right"==i&&(o.rightF=r);var h=e.get_normal();n.push({angle:h,force:r,pos:s.get_position()})}}}),{form:o,arrows:n}}},{key:"getConf",value:function(){var t=this,e={};return e.confArr=[],e.confArr.push(this.getScrollBar([this.getLocaleStr("mass"),!0,"g",500,100,this.ballMass,10,function(e){t.ballMass=l.M.getNumStr(e.showValue)-0,100>t.ballMass&&(t.ballMass=100),t.ballBody.set_mass(t.ballMass)},this]),this.getSwitch([this.getLocaleStr("force_analysis"),this.showForce,function(e){t.showForce=e.checked,t.showForce||t.removeForceAnalysis(),t.freshLibPan()},this])),this.showForce&&(e.confArr.push(this.getSwitch(["支持力合力",this.showZhiH,function(e){t.showZhiH=e.checked},this])),e.confArr.push(this.getSwitch(["重力分力",this.showZhongF,function(e){t.showZhongF=e.checked},this]))),e}},{key:"getParam",value:function(t){var e=this.forceValue().form,i=0;switch(t){case"θ":i=e.rot;break;case"F1":i=e.leftF;break;case"F2":i=e.rightF}return i}}]),e}(p["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function v(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:v(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(451),c=o(u),d=i(449),p=o(d),y=void 0,f=void 0,g=void 0,b=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return y=i.phy.nape,f=y.NbBody,g=y.shape.Polygon,b=y.geom.Vec2,i.level=15,i.dgpsp=null,i.dgpw=2,i.bdshape=null,i.dangShape=null,i.bindCar=null,i.sfObj={dgpH:45},i}return a(e,t),r(e,[{key:"init",value:function(){this._width=152,this._height=42,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.userData.dragLevel=3,this.bdshape=this.body.get_shapes().at(0),this.removeChild(this.dgp),this.dgpsp=new PIXI.mesh.NineSlicePlane(PIXI.Texture.fromFrame("ShelterLight/dgp.png"),8,8,8,8),this.dgpsp.height=this.sfObj.dgpH,this.dgpsp.x=67.2,this.dgpsp.y=-this.sfObj.dgpH-20,this.addChild(this.dgpsp),this.body.set_allowRotation(!1),this.dpgwChange({showValue:this.dgpw}),this.addDragListener()}},{key:"removed",value:function(){this.removeEventListener(p["default"].BEGIN,this.beginDragHandler),this.removeEventListener(p["default"].END,this.endDragHandler),this.removeEventListener(p["default"].MOVE,this.moveDragHandler),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"getData",value:function(){var t=h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getData",this).call(this);return this.bindCar&&(t.caruid=this.bindCar.UID),t}},{key:"setData",value:function(t){var i=this;h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),t.caruid&&setTimeout(function(){i.endDragHandler()},10)}},{key:"setbodySensor",value:function(t){this.bdshape.set_sensorEnabled(t),this.dangShape.set_sensorEnabled(t)}},{key:"addDragListener",value:function(){var t=this,e={x:0,y:0},i=null;this.beginDragHandler=function(o){t.setbodySensor(!0),t.bindCar&&(e=o.data.global,(i=t.body.userData.dragManager)&&i.handJoint.set_active(!1))},this.moveDragHandler=function(o){if(t.bindCar){l.Point.distance(e,o.data.global)>50&&(i.handJoint.set_active(!0),i=null,t.bindCar&&(t.bindCar.unbindSlSeneor(),t.bindCar=null,t.bg.alpha=1,t.body.set_allowRotation(!1),t.body.set_rotation(0)))}},this.endDragHandler=function(){if(!t.bindCar){t.body.get_arbiters().foreach(function(e){var i=e.get_body1(),o=e.get_body2(),n=i;i==t.body&&(n=o);var s=n.userData.view;if(s&&"SensorCar"==s.classname){if(s.bindslJoint)return;s.bindSlSeneor(t.body),t.bindCar=s,t.bg.alpha=0,t.body.set_allowRotation(!0)}}),t.setbodySensor(!1)}},this.addEventListener(p["default"].BEGIN,this.beginDragHandler),this.addEventListener(p["default"].END,this.endDragHandler),this.addEventListener(p["default"].MOVE,this.moveDragHandler)}},{key:"dpgwChange",value:function(t){var e=l.M.getNumStr(t.showValue),i=this.dgpw;this.dgpw=e,this.dgpsp.width=.6*e*600/20,this.dgpsp.x=75.5-this.dgpsp.width,this.dangShape||(this.dangShape=new g(g.rect(0,0,this.dgpsp.width,this.sfObj.dgpH)),this.dangShape.get_cbTypes().add(this.CbTypeStr.SHELTER_LIGHT),this.body.add(this.dangShape)),this.dangShape.scale(2/i*(e/2),1),this.dangShape.set_localCOM(b.get(this.dgpsp.x+.5*this.dgpsp.width,this.dgpsp.y+.5*this.dgpsp.height))}},{key:"getConf",value:function(){var t={};return t.confArr=[],t.confArr.push(this.getDropMenu([this.getLocaleStr("dgp_width","挡光片宽"),!1,"cm",this.dgpw+"cm",["2cm","4cm","6cm","8cm"],this,this.dpgwChange,1,0])),t}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function y(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:y(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(451),u=function(t){return t&&t.__esModule?t:{"default":t}}(l),c=void 0,d=void 0,p=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return c=i.phy.nape,d=c.shape.HockShapeBase,p=c.geom.Vec2,i.line=new PIXI.Graphics,i.addChild(i.line),i.jy=0,i.hock=null,i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.shapes.clear(),this.hock=new d(15,null,new c.phys.Material(0,1,2,5)),this.hock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.hock),this.hock.addCbtype(this.CbTypeStr.SPRINGSPRING_HOCK,!0),this.hock.translate(p.get(0,40)),this.hock.set_sensorEnabled(!1),this.line.lineStyle(3,16750848),h.M.drawDashed(this.line,new h.Point(-500,0),new h.Point(500,0)),this.body.noallowRotation=!0,this.addTweenQuan(this.hock)}},{key:"update",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.useing&&0!=this.body.angularVel&&(this.body.angularVel*=.1,1e-4>Math.abs(this.body.angularVel)&&(this.body.angularVel=0))}},{key:"removed",value:function(){this.hock.dragToolClick(),this.hock.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"useing",get:function(){return this.hock.get_userData().useing}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function p(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:p(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(451),l=function(t){return t&&t.__esModule?t:{"default":t}}(h),u=void 0,c=void 0,d=void 0;e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return u=i.phy.nape,c=u.geom.Vec2,d=u.shape.HockShapeBase,i.jy=0,i.parentUpdate=null,i.targetThis=null,i.hock=null,i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.shapes.clear(),this.hock=new d(15,null,new u.phys.Material(0,1,2,5)),this.hock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.hock),this.hock.addCbtype(this.CbTypeStr.SPRINGSPRING_HOCK,!0),this.hock.translate(c.get(0,-40)),this.hock.set_sensorEnabled(!1),this.addTweenQuan(this.hock)}},{key:"update",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.parentUpdate&&this.parentUpdate.call(this.targetThis),this.useing&&0!=this.body.angularVel&&(this.body.angularVel*=.1,1e-4>Math.abs(this.body.angularVel)&&(this.body.angularVel=0))}},{key:"removed",value:function(){this.parentUpdate=null,this.targetThis=null,this.hock.dragToolClick(),this.hock.dispose(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"useing",get:function(){return this.hock.get_userData().useing}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(226),h=function(t){return t&&t.__esModule?t:{"default":t}}(r);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.NapeConst=t.moduleMain.NapeConst,i.lineSp=new PIXI.Graphics,i.line_h=30,i.line_color=3904494,i.step=5,i.labelWidth=100,i.isSpeed=!1,i.scale_num=1,i.acceleration=null,i.left_pre=0,i.danwei=null,i.addChild(i.lineSp),i.foxx=3.5065306122448976,i.current_a=0,i.unitTxt=i.language.getLocaleStr("unit"),i}return s(e,t),a(e,[{key:"draw",value:function(t,e,i){if(this.removeChildren(),this.addChild(this.lineSp),this.lineSp.clear(),this.lineSp.lineStyle(2,this.line_color),!(this.step>1&&this.step>i-e||(null===this.danwei&&(this.danwei=new PIXI.Text("",{font:"25px Arial",fill:16777215})),this.addChild(this.danwei),this.danwei.text="",i>t.length-1))){var o=[],n=void 0;for(n=e;i>=n;n++)if((n-e)%this.step==0&&t&&t[n]&&(this.lineSp.moveTo(t[n].x,0),this.lineSp.lineTo(t[n].x,this.line_h),n>e)){var s=n-this.step,a=Math.abs(t[s].x-t[n].x);if(o.push(a),a>90){this.lineSp.moveTo(t[s].x,10);var r=.5*(a-this.labelWidth);this.lineSp.lineTo(t[s].x+r,10),this.lineSp.moveTo(t[n].x,10),this.lineSp.lineTo(t[n].x-r,10),this.lineSp.moveTo(t[s].x+5,5),this.lineSp.lineTo(t[s].x,10),this.lineSp.lineTo(t[s].x+5,15),this.lineSp.moveTo(t[n].x-5,5),this.lineSp.lineTo(t[n].x,10),this.lineSp.lineTo(t[n].x-5,15)}var h=new PIXI.Text("",{font:"20px Arial",fill:3904494});this.addChild(h);var l=void 0;if(this.isSpeed){l=(t[n].x-t[n-this.step].x)/this.foxx/this.scale_num;var u=l/(.02*this.step);h.text=u.toFixed(2),this.danwei.text=this.unitTxt+"：cm/s"}else l=a/this.foxx/this.scale_num,h.text=l.toFixed(2),this.danwei.text=this.unitTxt+"：cm";h.x=t[s].x+.5*(a-h.width)}if(t.length>i&&(this.danwei.x=t[i].x+40),this.isSpeed){null===this.acceleration&&(this.acceleration=new PIXI.Text("",{font:"25px Arial",fill:3904494})),this.acceleration.x=t[e].x-10,this.acceleration.y=200,this.addChild(this.acceleration);var c=o.reverse(),d=0,p=0,y=0;if(1==c.length){var f=this.averageSpeed(t,e,i);return d=(f[1]-f[0])/(.02*this.step),this.acceleration.text=isNaN(d)?"":"a="+d.toFixed(3)+"m/s²",void(this.current_a=d)}if(c.length%2==0){var g=c.length/2-1,b=c.length,v=void 0;for(v=0;c.length>v;v++)v>g?(p-=c[v],y-=b):(p+=c[v],y+=b),b--}else p=c[0]-c[c.length-1],y=c.length-1;d=.01*p/y/Math.pow(.02*this.step,2)/this.foxx/this.scale_num,this.acceleration.text="a="+d.toFixed(3)+"m/s²",this.current_a=d}}}},{key:"averageSpeed",value:function(t,e,i){var o=0,n=0,s=0;if(0==e?0==this.left_pre?o=0:(s=Math.abs(t[e+1].x-this.left_pre)/this.foxx/this.scale_num,o=.01*s/.04):(s=Math.abs(t[e+1].x-t[e-1].x)/this.foxx/this.scale_num,o=.01*s/.04),i==t.length-1){s=(3*(t[e+this.step].x-t[e+this.step-1].x)-(t[e+this.step-1].x-t[e+this.step-2].x))/this.foxx/this.scale_num}else s=Math.abs(t[e+this.step+1].x-t[e+this.step-1].x)/this.foxx/this.scale_num;return n=.01*s/.04,[o,n]}},{key:"backgroundColorChange",value:function(t){try{this.danwei.style.fill="#"+t.toString(16);var e=this.danwei.text;this.danweitxt.text="",this.danweitxt.text=e}catch(i){}}}]),e}(h["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=i(1),l=i(449),u=o(l),c=i(454),d=o(c),p=i(226),y=o(p);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.pa=null,i.thisRoot=null,i.centerVec2=null,i.var_startP=null,i.var_oldP=null,i.var_dot_vec=[],i.var_isDa=!1,i.var_working=!1,i.var_canBreak=!1,i.var_isBreak=!1,i.breakCarFunc=null,i.var_a=-1,i.var_dotCon=new PIXI.Sprite,i.paW=0,i.touchid=null,i.init(),i}return a(e,t),r(e,[{key:"init",value:function(){this.pa=this.getSpriteFromFrame("HTickerTimer/paper"),this.addChild(this.pa),h.M.alignPivot(this.pa),this.paW=this.pa.width,this.visible=!1,this.addChild(this.var_dotCon),this.addPaperTouch()}},{key:"addPaperTouch",value:function(){this.touchid=h.M.addTouch(this,{begin:this.func_touchBegin,move:this.func_touchMove,end:this.func_touchEnd},this)}},{key:"func_touchBegin",value:function(t){this.var_startP=this.getMouseXY(t),this.var_oldP=this.var_startP.clone(),this.thisRoot.var_canTouch=!1,this.var_canBreak=!0}},{key:"func_touchMove",value:function(t){var e=this.getMouseXY(t);if(this.x+=e.x-this.var_oldP.x,this.var_isBreak?this.y+=e.y-this.var_oldP.y:(this.x>.5*this.width+30||.5*-this.width-30>this.x)&&(this.var_isBreak=!0),this.var_oldP=e,!this.var_working&&!this.var_isBreak){if(!this.var_canBreak)return;Math.abs(e.x-this.var_startP.x)>30&&(this.var_canBreak=!1),Math.abs(e.y-this.var_startP.y)>50&&(this.var_isBreak=!0)}}},{key:"func_touchEnd",value:function(t){this.thisRoot.var_canTouch=!0,this.var_isBreak?this.var_isDa?this.breakPaper():this.x>.5*-this.width&&.5*this.width>this.x&&20>Math.abs(this.y)?(this.y=0,this.var_isBreak=!1):this.breakPaper():this.dispatchEvent(u["default"].END)}},{key:"breakPaper",value:function(){this.dispatchEvent(d["default"].NEI_BU_LINEJOINT_BREAK,this.var_dot_vec.concat()),this.resetAll(),this.visible=!1,this.parent&&this.parent.removeChild(this)}},{key:"resetAll",value:function(){this.var_isBreak=!1,this.var_a=-1,this.var_isDa=!1,this.var_dot_vec.length=0,this.var_dotCon.removeChildren()}},{key:"showneipaper",value:function(t){this.visible=!0,this.x=t,this.y=0}},{key:"addDot",value:function(){if(!this.var_isBreak){var t=this.thisRoot.toGlobalView(new h.Point,this.thisRoot),e=this.getSpriteFromFrame("HTickerTimer/dot");h.M.alignPivot(e);t=this.var_dotCon.toLocal(t,this.getMain().view),this.var_dotCon.addChild(e),e.x=t.x,e.y=t.y,this.var_dot_vec.push(t)}}},{key:"dadian",value:function(){this.var_isDa=!0}},{key:"destroyBefore",value:function(){h.M.removeTouch(this,this.touchid)}}]),e}(y["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function f(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:f(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(454),c=o(u),d=i(226),p=o(d);e["default"]=function(t){function e(t,i){n(this,e);var o=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i));return o.skinName=t||"HpaperTicker",o.bg=null,o.bg2=null,o.scalBtn=null,o.sdBtn=null,o.hideBtn=null,o.startP=null,o.isClick=!1,o.canvas=null,o.touchUid=null,o.state="",o.initUI(),o}return a(e,t),r(e,[{key:"initUI",value:function(){this.bg=this.getSpriteFromFrame(this.skinName+"/menu1"),this.addChild(this.bg),this.bg2=this.getSpriteFromFrame(this.skinName+"/menu2"),this.addChild(this.bg2),this.bg.pivot.x=this.bg.width/2,this.bg.pivot.y=this.bg.height,this.bg2.pivot.x=this.bg2.width/2,this.bg2.pivot.y=this.bg2.height,this.bg2.visible=!1,this.hideBtn=new y,this.hideBtn.setData([this.language.getLocaleStr("hide"),this.language.getLocaleStr("show")]),this.scalBtn=new y,this.scalBtn.setData([this.language.getLocaleStr("enlarge"),this.language.getLocaleStr("reduction")]),this.sdBtn=new y,this.sdBtn.setData([this.language.getLocaleStr("speed"),this.language.getLocaleStr("pos_shift")]),this.state=this.language.getLocaleStr("show"),this.addChild(this.hideBtn),this.addChild(this.scalBtn),this.addChild(this.sdBtn),this.sdBtn.y=this.hideBtn.y=this.scalBtn.y=-this.hideBtn.getH()-25,this.hideBtn.x=.5*-this.bg.width+22,this.scalBtn.x=this.hideBtn.x+this.hideBtn.getW()+40,this.sdBtn.x=this.scalBtn.x+this.scalBtn.getW()+40}},{key:"addTouch",value:function(){this.canvas=this.getThisCanvas(),this.touchUid=l.M.addDomTouch($(this.canvas),{begin:this.touchBegin,move:this.touchMove,end:this.touchEnd},this)}},{key:"touchBegin",value:function(t){this.startP=new l.Point;var e=this.getMain(),i=this.getTouchP(t);e.renderer.plugins.interaction.mapPositionToPoint(this.startP,i.x,i.y),this.isClick=!0}},{key:"touchMove",value:function(t){var e=new l.Point,i=this.getMain(),o=this.getTouchP(t);i.renderer.plugins.interaction.mapPositionToPoint(e,o.x,o.y),l.Point.distance(this.startP,e)>10&&(this.isClick=!1)}},{key:"showTwoBtn",value:function(t){t?(this.bg2.visible=!0,this.bg.visible=!1,this.sdBtn.visible=!1,this.hideBtn.x=-this.hideBtn.getW()-20,this.scalBtn.x=20):(this.bg2.visible=!1,this.bg.visible=!0,this.sdBtn.visible=!0,this.hideBtn.x=.5*-this.bg.width+22,this.scalBtn.x=this.hideBtn.x+this.hideBtn.getW()+40,this.sdBtn.x=this.scalBtn.x+this.scalBtn.getW()+40)}},{key:"getTouchP",value:function(t,e){var i=void 0;t.touches&&(i=e?t.changedTouches[0]:t.touches[0]);return i?new l.Point(i.clientX,i.clientY):new l.Point(t.clientX,t.clientY)}},{key:"touchEnd",value:function(t){var e=new l.Point,i=this.getMain(),o=this.getTouchP(t,!0);if(i.renderer.plugins.interaction.mapPositionToPoint(e,o.x,o.y),this.isClick){var n="";l.M.hitTestPoint(this.hideBtn,e,!0)?(this.state=this.hideBtn.text(),n=this.hideBtn.text(),this.hideBtn.swap()):l.M.hitTestPoint(this.scalBtn,e,!0)?(n=this.scalBtn.text(),this.scalBtn.swap()):l.M.hitTestPoint(this.sdBtn,e,!0)&&(n=this.sdBtn.text(),this.sdBtn.swap()),this.dispatchEvent(c["default"].TICKER_PAPER_MENU_CHANGE,n),this.parent&&this.parent.removeChild(this),this.isClick=!1,this.destory()}}},{key:"removed",value:function(){this.destory(),this.removeChildren(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"destory",value:function(){this.canvas&&(l.M.removeTouch(this.canvas,this.touchUid),this.canvas=null)}}]),e}(p["default"]);var y=function(t){function e(){n(this,e);var t=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.index=0,t.txt=new PIXI.Text("",{font:"30px Arial",fill:16777215}),t.addChild(t.txt),t}return a(e,t),r(e,[{key:"text",value:function(){return this.txt.text}},{key:"swap",value:function(){0==this.index?(this.txt.text=this.data[1],this.index=1):(this.txt.text=this.data[0],this.index=0)}},{key:"getW",value:function(){return this.txt.width}},{key:"getH",value:function(){return this.txt.height}},{key:"setData",value:function(t){this.txt.text=t[0],this.data=t,this.index=0}}]),e}(PIXI.Container)},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function u(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:u(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(446),l=function(t){return t&&t.__esModule?t:{"default":t}}(h);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.thisRoot=null,i.classtype="TickerCarbon",i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.noallowRotation=!0,this.addCbType(this.CbTypeStr.TICKER_CARBON),this.body.set_sensorEnabled_at(0,!0)}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=i(1),l=i(226),u=o(l),c=i(678),d=o(c);e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.NapeConst=t.moduleMain.NapeConst,i.skinName="HpaperTicker",i.step=5,i.step_index=0,i.isSpeed=!1,i.left_pre=0,i.danwei=null,i.data=[],i.displacement=[],i.scale_num=1,i.foxx=3.5065306122448976,i.unitTxt=i.language.getLocaleStr("unit"),i}return a(e,t),r(e,[{key:"draw",value:function(t,e,i){if(this.removeChildren(),this.step_index=0,null===this.danwei&&(this.danwei=new PIXI.Text("",{font:"25px Arial",fill:16777215})),this.addChild(this.danwei),this.danwei.text="",t.length-1>=i){this.danwei.x=t[i].x+40,this.danwei.y=40,this.isSpeed?this.data.length=0:this.displacement.length=0;var o=void 0;for(o=e;i>=o;o++)if((o-e)%this.step==0){var n=new PIXI.Text("",{font:"20px Arial",fill:0});n.text=this.step_index+"",this.addChild(n),n.x=t[o].x-5,this.step_index++;var s=void 0;if(o>e){var a=new d["default"](this.paramObj,this.skinName);if(this.isSpeed){if(o==t.length-1){var r=t[o].x-t[o-1].x,l=t[o-1].x-t[o-2].x;s=(3*r-l)/this.foxx/this.scale_num}else s=Math.abs(t[o+1].x-t[o-1].x)/this.foxx/this.scale_num;var u=s/.04;a.label(h.M.getNumJie(u,2)),this.danwei.text=this.unitTxt+"：cm/s",this.data.push(u)}else s=Math.abs(t[o].x-t[e].x),s=s/this.foxx/this.scale_num,a.label(h.M.getNumJie(s,2)),this.danwei.text=this.unitTxt+"：cm",this.displacement.push(s);this.addChildAt(a,0),a.x=n.x+5,a.y=50}else if(this.isSpeed){var c=new d["default"](this.paramObj,this.skinName);if(0==o)if(0==this.left_pre)c.label("0");else{s=Math.abs(t[o+1].x-this.left_pre)/this.foxx/this.scale_num;var p=s/.04;c.label(h.M.getNumJie(p,2)),this.data.push(p)}else{s=Math.abs(t[o+1].x-t[o-1].x)/this.foxx/this.scale_num;var y=s/.04;c.label(h.M.getNumJie(y,2)),this.data.push(y)}this.addChild(c),c.x=n.x+5,c.y=50}}}}},{key:"backgroundColorChange",value:function(t){try{this.danwei.style.fill="#"+t.toString(16);var e=this.danwei.text;this.danweitxt.text="",this.danweitxt.text=e}catch(i){}}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var r=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),h=function _(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:_(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},l=i(1),u=i(446),c=o(u),d=i(449),p=o(d),y=i(454),f=o(y),g=void 0,b=void 0,v=void 0;e["default"]=function(t){function e(t){n(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return g=i.phy.nape,b=g.geom.Vec2,v=g.shape.HockShapeBase,i.weiP=new l.Point,i.thisRoot=null,i.lineJoint=null,i.weldJoint=null,i.centerVec2=null,i.lineJointBreak=null,i.startP=null,i.tempTouch=null,i.dotCon=null,i.dot_vec=[],i.isDa=null,i.working=null,i.breakCarFunc=null,i.hock=null,i.hockWeld=null,i.lineJointLen=null,i.paperOffX=null,i.test=!1,i.isDown=!1,i.ph=0,i.ticker=null,i.autoBreak=!1,i.startPos=null,i}return a(e,t),r(e,[{key:"init",value:function(){var t=this;this._width=this.pa.width,this._height=this.pa.height,h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.ph=this.pa.height,this.body.noallowRotation=!0,this.body.dragLevel=2,this.body.set_sensorEnabled_at(0,!0),this.dotCon=new PIXI.Sprite,this.addChild(this.dotCon),this.hock=new v(15),this.hock.registerClass({CbTypeStr:this.CbTypeStr,JointUtil:this.JointUtil,BodyUtil:this.BodyUtil,InteractionFilterManager:this.InteractionFilterManager}),this.body.add(this.hock),this.hock.addCbtype(this.CbTypeStr.V_PAPER_HOCK,!0),this.hock.translate(b.get(0,this.pa.height/2)),this.addTweenQuan(this.hock),this.addEventListener(p["default"].BEGIN,function(e){t.beginHandler(e)}),this.addEventListener(p["default"].END,function(e){t.endHandler(e)}),this.addEventListener(p["default"].MOVE,function(e){t.tempTouch=t.isDown?e:null})}},{key:"getHitPoint",value:function(){return this.hock.get_worldCOM()}},{key:"openHock",value:function(t){t?(this.hock.addCbtype(this.CbTypeStr.V_PAPER_HOCK),this.hock.var_isbreaking=!1):(this.hock.dragToolClick(),this.hock.removeCbtype(this.CbTypeStr.V_PAPER_HOCK))}},{key:"beginHandler",value:function(t){this.visible&&(this.weldJoint&&(this.weldJoint.active=!1),this.isDown=!0,this.tempTouch=t,this.startP=this.getMouseXY(t),this.finish&&(this.finish=!1,this.breakLineJ()),this.working||(this.ticker=l.M.addTicker(this.enterFrameHandler,this)))}},{key:"breakLineJ",value:function(){this.canDrag=!0,this.lineJointBreak=!0,this.lineJoint&&(this.BodyUtil.destoryJoint(this.lineJoint),this.lineJoint=null),this.breakCarFunc&&this.breakCarFunc(),this.breakCarFunc=null,this.openHock(!1),l.M.removeTicker(this.ticker)}},{key:"enterFrameHandler",value:function(){if(this.tempTouch){var t=this.getMouseXY(this.tempTouch);Math.abs(t.y-this.startP.y)>30&&l.M.removeTicker(this.ticker),Math.abs(t.x-this.startP.x)>50&&(this.breakLineJ(),this.finish=!0)}}},{key:"endHandler",value:function(t){if(this.visible){if(this.isDown=!1,this.tempTouch=null,l.M.removeTicker(this.ticker),this.lineJointBreak)this.visible=!1,this.dispatchEvent(f["default"].NEI_BU_LINEJOINT_BREAK,{arr:this.dot_vec.concat(),a:this.getGravity()}),this.isDa=!1;else if(this.weldJoint){var e=this.thisRoot.body.localPointToWorld(this.weldJoint.anchor1);this.weldJoint.anchor2=this.body.worldPointToLocal(e),this.startPos=this.body.get_position().copy()}!this.isDa&&this.weldJoint&&(this.weldJoint.active=!0),!this.useing&&this.weldJoint&&(this.weldJoint.active=!0)}}},{key:"autoBreakPaper",value:function(){this.breakLineJ(),this.endHandler(null)}},{key:"addDot",value:function(t){if(this.useing||this.tempTouch){if(this.finish)return;var e=this.getMain(),i=this.body.get_position();this.x=i.get_x(),this.y=i.get_y();var o=this.dotCon.toLocal(new l.Point(t.get_x(),t.get_y()),e.view),n=PIXI.Sprite.fromFrame("VTickerTimer/dot");n.x=o.x-2,n.y=o.y,this.dotCon.addChild(n),this.dot_vec.push(new l.Point(o.y,o.x))}}},{key:"dadian",value:function(){this.finish=!1,this.useing&&(this.isDa=!0,this.weldJoint.active=!1)}},{key:"createJoint",value:function(t){this.paperOffX=t.get_x(),this.weldJoint=this.JointUtil.createWeldJoint(this.thisRoot.body,this.body,t,t)}},{key:"show",value:function(t,e){var i=this;this.centerVec2=b.get(e.get_x(),e.get_y()),this.visible=!0,this.finish=!1,this.weldJoint.active=!1,this.body.set_position(b.get(e.get_x(),t)),this.weldJoint.anchor2=this.body.worldPointToLocal(e),this.weldJoint.active=!0,this.lineJoint&&this.breakLineJ(),this.recoveryLineJoint(),this.dot_vec.length=0,this.dotCon.removeChildren(),this.openHock(!0),this.startPos=this.body.get_position().copy(),setTimeout(function(){i.hadDestory||(i.weiP=i.thisRoot.toLocal(l.Point.vec2ToPoint(e),i.getMain().view))},10)}},{key:"recoveryLineJoint",value:function(){var t=b.get(this.centerVec2.get_x(),this.centerVec2.get_y()-.5*this.ph),e=b.get(this.centerVec2.get_x(),this.centerVec2.get_y()+.5*this.ph),i=e.sub(t),o=b.distance(t,e);this.lineJointLen=o,this.lineJoint=this.JointUtil.createLineJoint(this.thisRoot.body,this.body,t,this.body.position,i,0,o),this.lineJointBreak=!1}},{key:"update",value:function(){if(h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.working&&this.isDa&&this.useing){.5*this.ph>this.y-this.parent.toLocal(this.weiP,this.thisRoot).y+30||(this.lineJoint&&(this.BodyUtil.destoryJoint(this.lineJoint),this.lineJoint=null),this.finish=!0)}this.tempTouch&&(this.body.posy-this.centerVec2.get_y()<.5*this.ph||(this.breakLineJ(),this.finish=!0)),!this.visible||this.lineJoint||this.useing||(this.visible=!1,this.dispatchEvent(f["default"].NEI_BU_LINEJOINT_BREAK,{arr:this.dot_vec,a:-1}),this.isDa=!1)}},{key:"removed",value:function(){this.hock.dragToolClick(),this.hock.dispose(),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"finish",get:function(){return this.test},set:function(t){this.test=t}},{key:"useing",get:function(){return this.hock.get_userData().useing}},{key:"canDrag",set:function(t){this.body.userData.noDrag=!t}}]),e}(c["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function u(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:u(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(446),l=function(t){return t&&t.__esModule?t:{"default":t}}(h);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.points=[{x:379,y:-15},{x:-333.95,y:-15},{x:-333.95,y:-58},{x:-357.95,y:-58},{x:-357.95,y:-122},{x:-379.95,y:-74},{x:-379.95,y:-5},{x:379,y:-5}],i}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.noallowRotation=!0,this.body.mass=2,this.body.userData.noDrag=!0}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function c(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:c(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(446),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.view=null,i.points=[{x:-33,y:45},{x:92,y:45},{x:92,y:-62},{x:-89,y:-62},{x:-89,y:61},{x:-92,y:61},{x:-92,y:178.95},{x:-65,y:149.95},{x:-45,y:61}],i.ten=null,i.fifty=null,i.twenty=null,i.scal=null,i.lock=null,i.islock=!1,i.txt=null,i.tar=null,i.graphics=null,i.orgX=0,i}return s(e,t),a(e,[{key:"removed",value:function(){h.M.removeTouch(this.lock,this.lockId),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}},{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.body.noallowRotation=!0,this.body.userData.dragLevel=1,this.body.mass=1,this.body.userData.handJointFrequency=20,this.ten=this.view.ten,this.fifty=this.view.fifty,this.twenty=this.view.twenty,this.ten.scale=new h.Point(.9,.9),this.twenty.scale=new h.Point(.95,.95),this.fifty.scale=new h.Point(.98,.98),this.scal=this.view.scal,this.scal.visible=!1,this.lock=this.view.lock,this.lockId=h.M.addTouch(this.lock,{tab:this.lockClick},this,{time:300,dis:20}),this.txt=new PIXI.Text("",{font:"24px Arial",fill:16777215,align:"center"}),this.view.addChild(this.txt),this.txt.x=this.lock.x+40,this.txt.y=this.lock.y,this.txt.visible=this.globalConfig.SHOWEQUVALUE,this.graphics=new PIXI.Graphics,this.scal.addChildAt(this.graphics,1),this.graphics.x=-87,this.graphics.y=-102}},{key:"lockClick",value:function(t){this.islock=!this.islock,this.islock?(this.scal.visible=!0,this.lock.gotoAndStop(1),this.showValue()):(this.scal.visible=!1,this.lock.gotoAndStop(0),this.txt.text="")}},{key:"showValue",value:function(){var t=0,e=void 0,i=0;1==this.ten.alpha&&(this.ten.x,t=1,i=1),1==this.twenty.alpha&&(this.twenty.x,t=2,i=2),1==this.fifty.alpha&&(this.fifty.x,t=3,i=2),0>(e=h.M.getNumJie((this.view.x-this.tar.x+this.orgX)/this.NapeConst.SCALE_SPACE,i))&&(e=0);var o=void 0;o=h.M.getNumJie(100*e,0)%10,2==t?5>o?o=0:o>5&&(o=5):3==t&&o%2!=0&&o--,e=h.M.getNumJie(e,1)-0+.01*o;var n=h.M.getNumJie(e,i)-0;n=n.toFixed(1==t?1:2),this.txt.text=n+"mm",this.draw(t,n)}},{key:"draw",value:function(t,e){this.graphics.removeChildren(),this.graphics.clear(),3==t?this.graphics.lineStyle(2,0):this.graphics.lineStyle(4,0);var i=e-0;i*=.1;var o=h.M.getNumToInt(i),n=h.M.getNumToInt(10*(i-o)),s=0,a=0,r=0,l=0,u=0;5>n||(a=5),1==t?(s=24,r=a+15,l=10,u=.9*s):2==t?(s=14.4,r=a+25,l=20,u=19*s/20):3==t&&(s=360/55,r=a+55,l=50,u=49*s/50);var c=0,d=void 0,p=0,y=0==a?o:o+1;for(d=a;r>=d;d++){var f=0;if(d%5==0&&d%10!=0)f=0+c*s,this.graphics.moveTo(f,-1),this.graphics.lineTo(f,-24);else if(d%10==0){if(f=0+c*s,this.graphics.moveTo(f,-1),this.graphics.lineTo(f,-34),15>=y){var g=this.getTxt(y);this.graphics.addChild(g),g.x=f-g.width/2,g.y=-60}y++}else f=0+c*s,this.graphics.moveTo(f,-1),this.graphics.lineTo(f,-19);if(c++,d==n){var b=e;p=f+s*(b-h.M.getNumToInt(b))}}if(y=0,1==t||2==t)for(d=0;l>=d;d++)if(d%5==0&&d%10!=0){var v=p+d*u;this.graphics.moveTo(v,-1),this.graphics.lineTo(v,24)}else if(d%10==0){var v=p+d*u;this.graphics.moveTo(v,-1),this.graphics.lineTo(v,34);var g=this.getTxt(y);this.graphics.addChild(g),g.x=v-g.width/2,g.y=40,y+=10}else{var v=p+d*u;this.graphics.moveTo(v,-1),this.graphics.lineTo(v,19)}else for(d=0;l>=d;d++)if(d%5==0){var v=p+d*u;this.graphics.moveTo(v,-1),this.graphics.lineTo(v,34);var g=this.getTxt(y);this.graphics.addChild(g),g.x=v-g.width/2,g.y=40,y++}else{var v=p+d*u;this.graphics.moveTo(v,-1),this.graphics.lineTo(v,19)}}},{key:"getTxt",value:function(t){return new PIXI.Text(t,{font:"25px Arial",fill:0,align:"center"})}},{key:"precision",value:function(t){0==t?(this.ten.alpha=1,this.twenty.alpha=this.fifty.alpha=0):1==t?(this.twenty.alpha=1,this.ten.alpha=this.fifty.alpha=0):2==t&&(this.fifty.alpha=1,this.twenty.alpha=this.ten.alpha=0),this.islock&&this.showValue()}},{key:"backgroundColorChange",value:function(t){this.txt.style.fill="#"+t.toString(16);var e=this.txt.text;this.txt.text="",this.txt.text=e}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function u(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:u(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(665),l=function(t){return t&&t.__esModule?t:{"default":t}}(h);e["default"]=function(t){function e(t){return o(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return s(e,t),a(e,[{key:"init",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.viscosity=6.5,this.density=1.5,this.body.userData.noDrag=!0}}]),e}(l["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=function c(t,e,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:c(n,e,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},h=i(1),l=i(226),u=function(t){return t&&t.__esModule?t:{"default":t}}(l);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.halfH=254,i.rotvalue=0,i.bindBody=null,i.centresp=null,i.dotTouchId=null,i.initSkin(),i}return s(e,t),a(e,[{key:"initSkin",value:function(){var t=this;this.bg=PIXI.Sprite.fromFrame("mechSkin/pourLen"),this.bg.pivot.y=this.bg.height/2,this.addChild(this.bg),this.dot=PIXI.Sprite.fromFrame("mechSkin/pourDot"),this.dot.pivot.x=this.dot.width/2,this.dot.pivot.y=this.dot.height/2,this.addChild(this.dot),this.dot.x=116,this.dot.y=this.halfH,this.startP=null,this.dotTouchId=h.M.addTouch(this.dot,{begin:function(e){t.startP=t.getMouseXY(e)},move:function(e){var i=t.getMouseXY(e);if(t.dot.y+=i.y-t.startP.y,t.dot.y>t.halfH&&(t.dot.y=t.halfH),-t.halfH>t.dot.y&&(t.dot.y=-t.halfH),t.startP=i,t.rotvalue=-(t.halfH-t.dot.y)/(2*t.halfH)*Math.PI/2,t.bindBody&&t.centresp){var o=t.bindBody.localPointToWorld(t.centresp.get_localCOM());t.bindBody.rotate(o,-t.bindBody.get_rotation()),t.bindBody.rotate(o,t.rotvalue)}}})}},{key:"showIt",value:function(){this.visible=!0,this.dot.y=254}},{key:"hideIt",value:function(){this.visible=!1}},{key:"removed",value:function(){h.M.removeTouch(this.dot,this.dotTouchId),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removed",this).call(this)}}]),e}(u["default"])},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(1106),h=function(t){return t&&t.__esModule?t:{"default":t}}(r);e["default"]=function(t){function e(t,i,s){o(this,e);var a=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));a.globalConfig=t.moduleMain.config.globalConfig,a.Button=t.moduleMain.config.Button,a.MouseManager=t.moduleMain.config.MouseManager,a.isPause=!0;var r=a.globalConfig.main.language,l=PIXI.Sprite.fromFrame("Wave3Btn/btnup"),u=PIXI.Sprite.fromFrame("Wave3Btn/btndown"),c=PIXI.Sprite.fromFrame("Wave3Btn/btnup");return a.playbtn=new a.Button({text:r.getLocaleStr("play"),tab:a.tabfunc,fontColor:16777215,fontSize:30,disabledSkin:l,downSkin:u,upSkin:c}),a.playbtn["this"]=a,a.lineC=new h["default"](i),a.addChild(a.lineC),a.lineC.initLine(s),a.playbtn.x=30,a.playbtn.y=-180,a.addChild(a.playbtn),a.lineC.x=0,a.lineC.y=0,a.MouseManager.addMouseEvent(a.globalConfig.main.mouseManager,a.playbtn,"hand"),a}return s(e,t),a(e,[{key:"disposeAll",value:function(){this.removeChildren(),this.playbtn.destroy(),this.lineC.destroy(),this.playbtn=null,this.lineC=null}},{key:"pause",value:function(){this.playbtn.text=this.globalConfig.main.language.getLocaleStr("play"),this.lineC.pause(),this.isPause=!0}},{key:"play",value:function(){this.playbtn.text=this.globalConfig.main.language.getLocaleStr("pause"),this.lineC.start(),this.isPause=!1}},{key:"tabfunc",value:function(){this.isPause?this.play():this.pause()}}]),e}(PIXI.Container)},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=function(){function t(t,e){for(var i=0;e.length>i;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),r=i(1);e["default"]=function(t){function e(t){o(this,e);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));i.line=new PIXI.Graphics,i.addChild(i.line),i.LINE_LEN=800,i.ary1=[],i.ary2=[],i.ary=[],i.cont=0,i.time=null,i.speed=90,i.A1=50,i.T1=1,i.Phi1=0,i.PhiT1=0,i.A2=50,i.T2=1,i.Phi2=0,i.PhiT2=0,i.circleFlag=!1,i.openFlag1=!0,i.openFlag2=!0,i.halfCircle=!0,i.isPause=!0,i.t0=0,i.dt=1,i.lastT=(new Date).getTime();for(var s=[],a=0;i.LINE_LEN>a;a++)s.push(new PIXI.Point(a,0));return i.rope=new h(PIXI.Texture.fromFrame("Wave3Btn/rope01.png"),s),i.addChild(i.rope),i.time=r.M.addTicker(i.enterFrame,i),i.initLine(),i}return s(e,t),a(e,[{key:"destroy",value:function(){this.time&&(this.time.stop(),this.time=null)}},{key:"createOneCycleData",value:function(t,e,i,o){var n=e*o,s=2*Math.PI/e,a=e/n,r=[];!this.circleFlag&&this.halfCircle&&(n/=2);for(var h=0;n>=h;h++){r.push(-t*Math.sin(s*h*a+i))}return r}},{key:"getPhitByIndex",value:function(t,e,i,o){var n=t*i;return 2*Math.PI/t*o*(t/n)+e}},{key:"initLine",value:function(){this.ary1=this.createOneCycleData(this.A1,this.T1,this.Phi1*Math.PI/180,this.speed).reverse(),this.ary2=this.createOneCycleData(this.A2,this.T2,this.Phi2*Math.PI/180,this.speed);for(var t=0;this.LINE_LEN>t;t++)this.ary[t]=0;this.lastT=(new Date).getTime(),this.t0=0,this.PhiT1=0,this.PhiT2=0,this.updatePhiT(0),this.updateRope()}},{key:"start",value:function(){this.isPause=!1}},{key:"nextFrame",value:function(){this.t0+=this.dt;var t=Math.round(this.t0*this.speed/1e3);this.updatePhiT(t),this.refreshLine(t);var e=this.ary1.length,i=this.ary2.length;t>Math.max(e,i)+this.LINE_LEN&&(this.circleFlag||(this.t0=0))}},{key:"preFrame",value:function(){this.t0-=this.dt;var t=Math.round(this.t0*this.speed/1e3);this.updatePhiT(t),this.refreshLine(t),0>t&&(this.t0=0)}},{key:"refreshLine",value:function(t){for(var e=this.ary1.length,i=this.ary2.length,o=0;this.LINE_LEN>o;o++){var n=e-t+o,s=t-(this.LINE_LEN-o);this.ary[o]=0,this.openFlag1&&n>=0&&e>n&&(this.ary[o]+=this.ary1[n]),this.openFlag2&&s>=0&&i>s&&(this.ary[o]+=this.ary2[s]),this.circleFlag&&(this.openFlag1&&0>n&&(n%=e,n+=e,n%=e,this.ary[o]+=this.ary1[n]),this.openFlag2&&s>=i&&(s%=i,this.ary[o]+=this.ary2[s]))}this.updateRope()}},{key:"updateRope",value:function(){for(var t=this.rope.points,e=0;this.ary.length>e;e++)t[e].y=this.ary[e];this.rope.refresh()}},{key:"updatePhiT",value:function(t){var e=this.ary1.length,i=this.ary2.length,o=e-t,n=t;this.circleFlag?(o%=e,o+=e,o%=e,this.PhiT1=this.getPhitByIndex(this.T1,this.Phi1*Math.PI/180,this.speed,e-o),n%=i,this.PhiT2=this.getPhitByIndex(this.T2,this.Phi2*Math.PI/180,this.speed,n)):(o>0&&(this.PhiT1=this.getPhitByIndex(this.T1,this.Phi1*Math.PI/180,this.speed,e-o)),i>n&&(this.PhiT2=this.getPhitByIndex(this.T2,this.Phi2*Math.PI/180,this.speed,n)))}},{key:"enterFrame",value:function(){var t=(new Date).getTime(),e=t-this.lastT;this.lastT=t,this.dt=e,e>1e3||this.isPause||this.nextFrame()}},{key:"pause",value:function(){this.isPause=!0}}]),e}(PIXI.Container);var h=function(t){function e(t,i){return o(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return s(e,t),a(e,[{key:"refresh",value:function(){var t=this.points;if(t.length>=1&&this._texture._uvs){var e=this.uvs,i=this.indices,o=this.colors,n=this._texture._uvs,s=new PIXI.Point(n.x0,n.y0),a=new PIXI.Point(n.x2-n.x0,n.y2-n.y0);e[0]=0+s.x,e[1]=0+s.y,e[2]=0+s.x,e[3]=1*a.y+s.y,o[0]=1,o[1]=1,i[0]=0,i[1]=1;for(var r=t.length,h=void 0,l=void 0,u=0,c=[],d=1;r>d;d++){var p=t[d-1],y=t[d],f=y.x-p.x,g=y.y-p.y,b=Math.sqrt(f*f+g*g);c[d-1]=b,u+=b}for(var v=0,_=1;r>_;_++){t[_],h=4*_;v+=c[_-1],l=v/u,e[h]=l*a.x+s.x,e[h+1]=0+s.y,e[h+2]=l*a.x+s.x,e[h+3]=1*a.y+s.y,h=2*_,o[h]=1,o[h+1]=1,h=2*_,i[h]=h,i[h+1]=h+1}this.dirty=!0}}}]),e}(PIXI.mesh.Rope)}]));